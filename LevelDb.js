// Copyright (c) Microsoft Corporation. Licensed under the MIT License.
var MC=Object.create;var xf=Object.defineProperty;var NC=Object.getOwnPropertyDescriptor;var jC=Object.getOwnPropertyNames;var UC=Object.getPrototypeOf,GC=Object.prototype.hasOwnProperty;var rr=(r=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(r,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):r)(function(r){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+r+'" is not supported')});var ve=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),zC=(r,e)=>{for(var t in e)xf(r,t,{get:e[t],enumerable:!0})},VC=(r,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of jC(e))!GC.call(r,n)&&n!==t&&xf(r,n,{get:()=>e[n],enumerable:!(i=NC(e,n))||i.enumerable});return r};var Le=(r,e,t)=>(t=r!=null?MC(UC(r)):{},VC(e||!r||!r.__esModule?xf(t,"default",{value:r,enumerable:!0}):t,r));var ty=ve(Dc=>{"use strict";Object.defineProperty(Dc,"__esModule",{value:!0});Dc.DispatcherBase=void 0;var eh=go(),th=class{constructor(){this._wrap=new eh.DispatcherWrapper(this),this._subscriptions=new Array}get count(){return this._subscriptions.length}subscribe(e){return e&&this._subscriptions.push(this.createSubscription(e,!1)),()=>{this.unsubscribe(e)}}sub(e){return this.subscribe(e)}one(e){return e&&this._subscriptions.push(this.createSubscription(e,!0)),()=>{this.unsubscribe(e)}}has(e){return e?this._subscriptions.some(t=>t.handler==e):!1}unsubscribe(e){if(e){for(let t=0;t<this._subscriptions.length;t++)if(this._subscriptions[t].handler==e){this._subscriptions.splice(t,1);break}}}unsub(e){this.unsubscribe(e)}_dispatch(e,t,i){for(let n of[...this._subscriptions]){let s=new eh.EventManagement(()=>this.unsub(n.handler)),o=Array.prototype.slice.call(i);if(o.push(s),n.execute(e,t,o),this.cleanup(n),!e&&s.propagationStopped)return{propagationStopped:!0}}return e?null:{propagationStopped:!1}}createSubscription(e,t){return new eh.Subscription(e,t)}cleanup(e){if(e.isOnce&&e.isExecuted){let t=this._subscriptions.indexOf(e);t>-1&&this._subscriptions.splice(t,1)}}asEvent(){return this._wrap}clear(){this._subscriptions.splice(0,this._subscriptions.length)}};Dc.DispatcherBase=th});var iy=ve(Ac=>{"use strict";Object.defineProperty(Ac,"__esModule",{value:!0});Ac.DispatchError=void 0;var ih=class extends Error{constructor(e){super(e)}};Ac.DispatchError=ih});var ry=ve(Rc=>{"use strict";Object.defineProperty(Rc,"__esModule",{value:!0});Rc.DispatcherWrapper=void 0;var rh=class{constructor(e){this._subscribe=t=>e.subscribe(t),this._unsubscribe=t=>e.unsubscribe(t),this._one=t=>e.one(t),this._has=t=>e.has(t),this._clear=()=>e.clear(),this._count=()=>e.count}get count(){return this._count()}subscribe(e){return this._subscribe(e)}sub(e){return this.subscribe(e)}unsubscribe(e){this._unsubscribe(e)}unsub(e){this.unsubscribe(e)}one(e){return this._one(e)}has(e){return this._has(e)}clear(){this._clear()}};Rc.DispatcherWrapper=rh});var ny=ve(Bc=>{"use strict";Object.defineProperty(Bc,"__esModule",{value:!0});Bc.EventListBase=void 0;var nh=class{constructor(){this._events={}}get(e){let t=this._events[e];return t||(t=this.createDispatcher(),this._events[e]=t,t)}remove(e){delete this._events[e]}};Bc.EventListBase=nh});var sy=ve(Lc=>{"use strict";Object.defineProperty(Lc,"__esModule",{value:!0});Lc.EventManagement=void 0;var sh=class{constructor(e){this.unsub=e,this.propagationStopped=!1}stopPropagation(){this.propagationStopped=!0}};Lc.EventManagement=sh});var oy=ve(Oc=>{"use strict";Object.defineProperty(Oc,"__esModule",{value:!0});Oc.HandlingBase=void 0;var oh=class{constructor(e){this.events=e}one(e,t){this.events.get(e).one(t)}has(e,t){return this.events.get(e).has(t)}subscribe(e,t){this.events.get(e).subscribe(t)}sub(e,t){this.subscribe(e,t)}unsubscribe(e,t){this.events.get(e).unsubscribe(t)}unsub(e,t){this.unsubscribe(e,t)}};Oc.HandlingBase=oh});var ay=ve(Nc=>{"use strict";Object.defineProperty(Nc,"__esModule",{value:!0});Nc.PromiseDispatcherBase=void 0;var Mc=go(),ah=class extends Mc.DispatcherBase{constructor(){super()}_dispatch(e,t,i){throw new Mc.DispatchError("_dispatch not supported. Use _dispatchAsPromise.")}createSubscription(e,t){return new Mc.PromiseSubscription(e,t)}async _dispatchAsPromise(e,t,i){for(let n of[...this._subscriptions]){let s=new Mc.EventManagement(()=>this.unsub(n.handler)),o=Array.prototype.slice.call(i);if(o.push(s),await n.execute(e,t,o),this.cleanup(n),!e&&s.propagationStopped)return{propagationStopped:!0}}return e?null:{propagationStopped:!1}}};Nc.PromiseDispatcherBase=ah});var ly=ve(jc=>{"use strict";Object.defineProperty(jc,"__esModule",{value:!0});jc.PromiseSubscription=void 0;var lh=class{constructor(e,t){this.handler=e,this.isOnce=t,this.isExecuted=!1}async execute(e,t,i){if(!this.isOnce||!this.isExecuted){this.isExecuted=!0;var n=this.handler;if(e){setTimeout(()=>{n.apply(t,i)},1);return}await n.apply(t,i)}}};jc.PromiseSubscription=lh});var uy=ve(Uc=>{"use strict";Object.defineProperty(Uc,"__esModule",{value:!0});Uc.Subscription=void 0;var uh=class{constructor(e,t){this.handler=e,this.isOnce=t,this.isExecuted=!1}execute(e,t,i){if(!this.isOnce||!this.isExecuted){this.isExecuted=!0;var n=this.handler;e?setTimeout(()=>{n.apply(t,i)},1):n.apply(t,i)}}};Uc.Subscription=uh});var go=ve(oi=>{"use strict";Object.defineProperty(oi,"__esModule",{value:!0});oi.HandlingBase=oi.PromiseDispatcherBase=oi.PromiseSubscription=oi.DispatchError=oi.EventManagement=oi.EventListBase=oi.DispatcherWrapper=oi.DispatcherBase=oi.Subscription=void 0;var IE=ty();Object.defineProperty(oi,"DispatcherBase",{enumerable:!0,get:function(){return IE.DispatcherBase}});var xE=iy();Object.defineProperty(oi,"DispatchError",{enumerable:!0,get:function(){return xE.DispatchError}});var TE=ry();Object.defineProperty(oi,"DispatcherWrapper",{enumerable:!0,get:function(){return TE.DispatcherWrapper}});var DE=ny();Object.defineProperty(oi,"EventListBase",{enumerable:!0,get:function(){return DE.EventListBase}});var AE=sy();Object.defineProperty(oi,"EventManagement",{enumerable:!0,get:function(){return AE.EventManagement}});var RE=oy();Object.defineProperty(oi,"HandlingBase",{enumerable:!0,get:function(){return RE.HandlingBase}});var BE=ay();Object.defineProperty(oi,"PromiseDispatcherBase",{enumerable:!0,get:function(){return BE.PromiseDispatcherBase}});var LE=ly();Object.defineProperty(oi,"PromiseSubscription",{enumerable:!0,get:function(){return LE.PromiseSubscription}});var OE=uy();Object.defineProperty(oi,"Subscription",{enumerable:!0,get:function(){return OE.Subscription}})});var zc=ve(Gc=>{"use strict";Object.defineProperty(Gc,"__esModule",{value:!0});Gc.EventDispatcher=void 0;var cy=go(),ch=class extends cy.DispatcherBase{constructor(){super()}dispatch(e,t){let i=this._dispatch(!1,this,arguments);if(i==null)throw new cy.DispatchError("Got `null` back from dispatch.");return i}dispatchAsync(e,t){this._dispatch(!0,this,arguments)}asEvent(){return super.asEvent()}};Gc.EventDispatcher=ch});var fh=ve(Vc=>{"use strict";Object.defineProperty(Vc,"__esModule",{value:!0});Vc.EventList=void 0;var ME=go(),NE=zc(),dh=class extends ME.EventListBase{constructor(){super()}createDispatcher(){return new NE.EventDispatcher}};Vc.EventList=dh});var dy=ve(Wc=>{"use strict";Object.defineProperty(Wc,"__esModule",{value:!0});Wc.EventHandlingBase=void 0;var jE=go(),UE=fh(),hh=class extends jE.HandlingBase{constructor(){super(new UE.EventList)}};Wc.EventHandlingBase=hh});var fy=ve(Jc=>{"use strict";Object.defineProperty(Jc,"__esModule",{value:!0});Jc.NonUniformEventList=void 0;var GE=zc(),ph=class{constructor(){this._events={}}get(e){if(this._events[e])return this._events[e];let t=this.createDispatcher();return this._events[e]=t,t}remove(e){delete this._events[e]}createDispatcher(){return new GE.EventDispatcher}};Jc.NonUniformEventList=ph});var Je=ve(Vr=>{"use strict";Object.defineProperty(Vr,"__esModule",{value:!0});Vr.NonUniformEventList=Vr.EventList=Vr.EventHandlingBase=Vr.EventDispatcher=void 0;var zE=zc();Object.defineProperty(Vr,"EventDispatcher",{enumerable:!0,get:function(){return zE.EventDispatcher}});var VE=dy();Object.defineProperty(Vr,"EventHandlingBase",{enumerable:!0,get:function(){return VE.EventHandlingBase}});var WE=fh();Object.defineProperty(Vr,"EventList",{enumerable:!0,get:function(){return WE.EventList}});var JE=fy();Object.defineProperty(Vr,"NonUniformEventList",{enumerable:!0,get:function(){return JE.NonUniformEventList}})});var py=ve((hy,mh)=>{(function(r){typeof hy=="object"&&typeof mh<"u"?mh.exports=r():typeof define=="function"&&define.amd?define([],r):(typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this).JSZip=r()})(function(){return function r(e,t,i){function n(a,l){if(!t[a]){if(!e[a]){var u=typeof rr=="function"&&rr;if(!l&&u)return u(a,!0);if(s)return s(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var d=t[a]={exports:{}};e[a][0].call(d.exports,function(h){var f=e[a][1][h];return n(f||h)},d,d.exports,r,e,t,i)}return t[a].exports}for(var s=typeof rr=="function"&&rr,o=0;o<i.length;o++)n(i[o]);return n}({1:[function(r,e,t){"use strict";var i=r("./utils"),n=r("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.encode=function(o){for(var a,l,u,c,d,h,f,m=[],p=0,g=o.length,b=g,F=i.getTypeOf(o)!=="string";p<o.length;)b=g-p,u=F?(a=o[p++],l=p<g?o[p++]:0,p<g?o[p++]:0):(a=o.charCodeAt(p++),l=p<g?o.charCodeAt(p++):0,p<g?o.charCodeAt(p++):0),c=a>>2,d=(3&a)<<4|l>>4,h=1<b?(15&l)<<2|u>>6:64,f=2<b?63&u:64,m.push(s.charAt(c)+s.charAt(d)+s.charAt(h)+s.charAt(f));return m.join("")},t.decode=function(o){var a,l,u,c,d,h,f=0,m=0,p="data:";if(o.substr(0,p.length)===p)throw new Error("Invalid base64 input, it looks like a data url.");var g,b=3*(o=o.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(o.charAt(o.length-1)===s.charAt(64)&&b--,o.charAt(o.length-2)===s.charAt(64)&&b--,b%1!=0)throw new Error("Invalid base64 input, bad content length.");for(g=n.uint8array?new Uint8Array(0|b):new Array(0|b);f<o.length;)a=s.indexOf(o.charAt(f++))<<2|(c=s.indexOf(o.charAt(f++)))>>4,l=(15&c)<<4|(d=s.indexOf(o.charAt(f++)))>>2,u=(3&d)<<6|(h=s.indexOf(o.charAt(f++))),g[m++]=a,d!==64&&(g[m++]=l),h!==64&&(g[m++]=u);return g}},{"./support":30,"./utils":32}],2:[function(r,e,t){"use strict";var i=r("./external"),n=r("./stream/DataWorker"),s=r("./stream/Crc32Probe"),o=r("./stream/DataLengthProbe");function a(l,u,c,d,h){this.compressedSize=l,this.uncompressedSize=u,this.crc32=c,this.compression=d,this.compressedContent=h}a.prototype={getContentWorker:function(){var l=new n(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),u=this;return l.on("end",function(){if(this.streamInfo.data_length!==u.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),l},getCompressedWorker:function(){return new n(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},a.createWorkerFrom=function(l,u,c){return l.pipe(new s).pipe(new o("uncompressedSize")).pipe(u.compressWorker(c)).pipe(new o("compressedSize")).withStreamInfo("compression",u)},e.exports=a},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,e,t){"use strict";var i=r("./stream/GenericWorker");t.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},t.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,e,t){"use strict";var i=r("./utils"),n=function(){for(var s,o=[],a=0;a<256;a++){s=a;for(var l=0;l<8;l++)s=1&s?3988292384^s>>>1:s>>>1;o[a]=s}return o}();e.exports=function(s,o){return s!==void 0&&s.length?i.getTypeOf(s)!=="string"?function(a,l,u,c){var d=n,h=c+u;a^=-1;for(var f=c;f<h;f++)a=a>>>8^d[255&(a^l[f])];return-1^a}(0|o,s,s.length,0):function(a,l,u,c){var d=n,h=c+u;a^=-1;for(var f=c;f<h;f++)a=a>>>8^d[255&(a^l.charCodeAt(f))];return-1^a}(0|o,s,s.length,0):0}},{"./utils":32}],5:[function(r,e,t){"use strict";t.base64=!1,t.binary=!1,t.dir=!1,t.createFolders=!0,t.date=null,t.compression=null,t.compressionOptions=null,t.comment=null,t.unixPermissions=null,t.dosPermissions=null},{}],6:[function(r,e,t){"use strict";var i=null;i=typeof Promise<"u"?Promise:r("lie"),e.exports={Promise:i}},{lie:37}],7:[function(r,e,t){"use strict";var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",n=r("pako"),s=r("./utils"),o=r("./stream/GenericWorker"),a=i?"uint8array":"array";function l(u,c){o.call(this,"FlateWorker/"+u),this._pako=null,this._pakoAction=u,this._pakoOptions=c,this.meta={}}t.magic="\b\0",s.inherits(l,o),l.prototype.processChunk=function(u){this.meta=u.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(a,u.data),!1)},l.prototype.flush=function(){o.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new n[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var u=this;this._pako.onData=function(c){u.push({data:c,meta:u.meta})}},t.compressWorker=function(u){return new l("Deflate",u)},t.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,e,t){"use strict";function i(d,h){var f,m="";for(f=0;f<h;f++)m+=String.fromCharCode(255&d),d>>>=8;return m}function n(d,h,f,m,p,g){var b,F,w=d.file,_=d.compression,I=g!==a.utf8encode,A=s.transformTo("string",g(w.name)),T=s.transformTo("string",a.utf8encode(w.name)),E=w.comment,K=s.transformTo("string",g(E)),P=s.transformTo("string",a.utf8encode(E)),G=T.length!==w.name.length,y=P.length!==E.length,z="",Fe="",re="",Re=w.dir,pe=w.date,ze={crc32:0,compressedSize:0,uncompressedSize:0};h&&!f||(ze.crc32=d.crc32,ze.compressedSize=d.compressedSize,ze.uncompressedSize=d.uncompressedSize);var ee=0;h&&(ee|=8),I||!G&&!y||(ee|=2048);var Y=0,Ve=0;Re&&(Y|=16),p==="UNIX"?(Ve=798,Y|=function(me,Jt){var Qt=me;return me||(Qt=Jt?16893:33204),(65535&Qt)<<16}(w.unixPermissions,Re)):(Ve=20,Y|=function(me){return 63&(me||0)}(w.dosPermissions)),b=pe.getUTCHours(),b<<=6,b|=pe.getUTCMinutes(),b<<=5,b|=pe.getUTCSeconds()/2,F=pe.getUTCFullYear()-1980,F<<=4,F|=pe.getUTCMonth()+1,F<<=5,F|=pe.getUTCDate(),G&&(Fe=i(1,1)+i(l(A),4)+T,z+="up"+i(Fe.length,2)+Fe),y&&(re=i(1,1)+i(l(K),4)+P,z+="uc"+i(re.length,2)+re);var U="";return U+=`
\0`,U+=i(ee,2),U+=_.magic,U+=i(b,2),U+=i(F,2),U+=i(ze.crc32,4),U+=i(ze.compressedSize,4),U+=i(ze.uncompressedSize,4),U+=i(A.length,2),U+=i(z.length,2),{fileRecord:u.LOCAL_FILE_HEADER+U+A+z,dirRecord:u.CENTRAL_FILE_HEADER+i(Ve,2)+U+i(K.length,2)+"\0\0\0\0"+i(Y,4)+i(m,4)+A+z+K}}var s=r("../utils"),o=r("../stream/GenericWorker"),a=r("../utf8"),l=r("../crc32"),u=r("../signature");function c(d,h,f,m){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=h,this.zipPlatform=f,this.encodeFileName=m,this.streamFiles=d,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(c,o),c.prototype.push=function(d){var h=d.meta.percent||0,f=this.entriesCount,m=this._sources.length;this.accumulate?this.contentBuffer.push(d):(this.bytesWritten+=d.data.length,o.prototype.push.call(this,{data:d.data,meta:{currentFile:this.currentFile,percent:f?(h+100*(f-m-1))/f:100}}))},c.prototype.openedSource=function(d){this.currentSourceOffset=this.bytesWritten,this.currentFile=d.file.name;var h=this.streamFiles&&!d.file.dir;if(h){var f=n(d,h,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:f.fileRecord,meta:{percent:0}})}else this.accumulate=!0},c.prototype.closedSource=function(d){this.accumulate=!1;var h=this.streamFiles&&!d.file.dir,f=n(d,h,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(f.dirRecord),h)this.push({data:function(m){return u.DATA_DESCRIPTOR+i(m.crc32,4)+i(m.compressedSize,4)+i(m.uncompressedSize,4)}(d),meta:{percent:100}});else for(this.push({data:f.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},c.prototype.flush=function(){for(var d=this.bytesWritten,h=0;h<this.dirRecords.length;h++)this.push({data:this.dirRecords[h],meta:{percent:100}});var f=this.bytesWritten-d,m=function(p,g,b,F,w){var _=s.transformTo("string",w(F));return u.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(p,2)+i(p,2)+i(g,4)+i(b,4)+i(_.length,2)+_}(this.dirRecords.length,f,d,this.zipComment,this.encodeFileName);this.push({data:m,meta:{percent:100}})},c.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},c.prototype.registerPrevious=function(d){this._sources.push(d);var h=this;return d.on("data",function(f){h.processChunk(f)}),d.on("end",function(){h.closedSource(h.previous.streamInfo),h._sources.length?h.prepareNextSource():h.end()}),d.on("error",function(f){h.error(f)}),this},c.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},c.prototype.error=function(d){var h=this._sources;if(!o.prototype.error.call(this,d))return!1;for(var f=0;f<h.length;f++)try{h[f].error(d)}catch{}return!0},c.prototype.lock=function(){o.prototype.lock.call(this);for(var d=this._sources,h=0;h<d.length;h++)d[h].lock()},e.exports=c},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,e,t){"use strict";var i=r("../compressions"),n=r("./ZipFileWorker");t.generateWorker=function(s,o,a){var l=new n(o.streamFiles,a,o.platform,o.encodeFileName),u=0;try{s.forEach(function(c,d){u++;var h=function(g,b){var F=g||b,w=i[F];if(!w)throw new Error(F+" is not a valid compression method !");return w}(d.options.compression,o.compression),f=d.options.compressionOptions||o.compressionOptions||{},m=d.dir,p=d.date;d._compressWorker(h,f).withStreamInfo("file",{name:c,dir:m,date:p,comment:d.comment||"",unixPermissions:d.unixPermissions,dosPermissions:d.dosPermissions}).pipe(l)}),l.entriesCount=u}catch(c){l.error(c)}return l}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,e,t){"use strict";function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var n=new i;for(var s in this)typeof this[s]!="function"&&(n[s]=this[s]);return n}}(i.prototype=r("./object")).loadAsync=r("./load"),i.support=r("./support"),i.defaults=r("./defaults"),i.version="3.10.1",i.loadAsync=function(n,s){return new i().loadAsync(n,s)},i.external=r("./external"),e.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,e,t){"use strict";var i=r("./utils"),n=r("./external"),s=r("./utf8"),o=r("./zipEntries"),a=r("./stream/Crc32Probe"),l=r("./nodejsUtils");function u(c){return new n.Promise(function(d,h){var f=c.decompressed.getContentWorker().pipe(new a);f.on("error",function(m){h(m)}).on("end",function(){f.streamInfo.crc32!==c.decompressed.crc32?h(new Error("Corrupted zip : CRC32 mismatch")):d()}).resume()})}e.exports=function(c,d){var h=this;return d=i.extend(d||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),l.isNode&&l.isStream(c)?n.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",c,!0,d.optimizedBinaryString,d.base64).then(function(f){var m=new o(d);return m.load(f),m}).then(function(f){var m=[n.Promise.resolve(f)],p=f.files;if(d.checkCRC32)for(var g=0;g<p.length;g++)m.push(u(p[g]));return n.Promise.all(m)}).then(function(f){for(var m=f.shift(),p=m.files,g=0;g<p.length;g++){var b=p[g],F=b.fileNameStr,w=i.resolve(b.fileNameStr);h.file(w,b.decompressed,{binary:!0,optimizedBinaryString:!0,date:b.date,dir:b.dir,comment:b.fileCommentStr.length?b.fileCommentStr:null,unixPermissions:b.unixPermissions,dosPermissions:b.dosPermissions,createFolders:d.createFolders}),b.dir||(h.file(w).unsafeOriginalName=F)}return m.zipComment.length&&(h.comment=m.zipComment),h})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,e,t){"use strict";var i=r("../utils"),n=r("../stream/GenericWorker");function s(o,a){n.call(this,"Nodejs stream input adapter for "+o),this._upstreamEnded=!1,this._bindStream(a)}i.inherits(s,n),s.prototype._bindStream=function(o){var a=this;(this._stream=o).pause(),o.on("data",function(l){a.push({data:l,meta:{percent:0}})}).on("error",function(l){a.isPaused?this.generatedError=l:a.error(l)}).on("end",function(){a.isPaused?a._upstreamEnded=!0:a.end()})},s.prototype.pause=function(){return!!n.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},e.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,e,t){"use strict";var i=r("readable-stream").Readable;function n(s,o,a){i.call(this,o),this._helper=s;var l=this;s.on("data",function(u,c){l.push(u)||l._helper.pause(),a&&a(c)}).on("error",function(u){l.emit("error",u)}).on("end",function(){l.push(null)})}r("../utils").inherits(n,i),n.prototype._read=function(){this._helper.resume()},e.exports=n},{"../utils":32,"readable-stream":16}],14:[function(r,e,t){"use strict";e.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,n){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,n);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,n)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var n=new Buffer(i);return n.fill(0),n},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(r,e,t){"use strict";function i(w,_,I){var A,T=s.getTypeOf(_),E=s.extend(I||{},l);E.date=E.date||new Date,E.compression!==null&&(E.compression=E.compression.toUpperCase()),typeof E.unixPermissions=="string"&&(E.unixPermissions=parseInt(E.unixPermissions,8)),E.unixPermissions&&16384&E.unixPermissions&&(E.dir=!0),E.dosPermissions&&16&E.dosPermissions&&(E.dir=!0),E.dir&&(w=p(w)),E.createFolders&&(A=m(w))&&g.call(this,A,!0);var K=T==="string"&&E.binary===!1&&E.base64===!1;I&&I.binary!==void 0||(E.binary=!K),(_ instanceof u&&_.uncompressedSize===0||E.dir||!_||_.length===0)&&(E.base64=!1,E.binary=!0,_="",E.compression="STORE",T="string");var P=null;P=_ instanceof u||_ instanceof o?_:h.isNode&&h.isStream(_)?new f(w,_):s.prepareContent(w,_,E.binary,E.optimizedBinaryString,E.base64);var G=new c(w,P,E);this.files[w]=G}var n=r("./utf8"),s=r("./utils"),o=r("./stream/GenericWorker"),a=r("./stream/StreamHelper"),l=r("./defaults"),u=r("./compressedObject"),c=r("./zipObject"),d=r("./generate"),h=r("./nodejsUtils"),f=r("./nodejs/NodejsStreamInputAdapter"),m=function(w){w.slice(-1)==="/"&&(w=w.substring(0,w.length-1));var _=w.lastIndexOf("/");return 0<_?w.substring(0,_):""},p=function(w){return w.slice(-1)!=="/"&&(w+="/"),w},g=function(w,_){return _=_!==void 0?_:l.createFolders,w=p(w),this.files[w]||i.call(this,w,null,{dir:!0,createFolders:_}),this.files[w]};function b(w){return Object.prototype.toString.call(w)==="[object RegExp]"}var F={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(w){var _,I,A;for(_ in this.files)A=this.files[_],(I=_.slice(this.root.length,_.length))&&_.slice(0,this.root.length)===this.root&&w(I,A)},filter:function(w){var _=[];return this.forEach(function(I,A){w(I,A)&&_.push(A)}),_},file:function(w,_,I){if(arguments.length!==1)return w=this.root+w,i.call(this,w,_,I),this;if(b(w)){var A=w;return this.filter(function(E,K){return!K.dir&&A.test(E)})}var T=this.files[this.root+w];return T&&!T.dir?T:null},folder:function(w){if(!w)return this;if(b(w))return this.filter(function(T,E){return E.dir&&w.test(T)});var _=this.root+w,I=g.call(this,_),A=this.clone();return A.root=I.name,A},remove:function(w){w=this.root+w;var _=this.files[w];if(_||(w.slice(-1)!=="/"&&(w+="/"),_=this.files[w]),_&&!_.dir)delete this.files[w];else for(var I=this.filter(function(T,E){return E.name.slice(0,w.length)===w}),A=0;A<I.length;A++)delete this.files[I[A].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(w){var _,I={};try{if((I=s.extend(w||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:n.utf8encode})).type=I.type.toLowerCase(),I.compression=I.compression.toUpperCase(),I.type==="binarystring"&&(I.type="string"),!I.type)throw new Error("No output type specified.");s.checkSupport(I.type),I.platform!=="darwin"&&I.platform!=="freebsd"&&I.platform!=="linux"&&I.platform!=="sunos"||(I.platform="UNIX"),I.platform==="win32"&&(I.platform="DOS");var A=I.comment||this.comment||"";_=d.generateWorker(this,I,A)}catch(T){(_=new o("error")).error(T)}return new a(_,I.type||"string",I.mimeType)},generateAsync:function(w,_){return this.generateInternalStream(w).accumulate(_)},generateNodeStream:function(w,_){return(w=w||{}).type||(w.type="nodebuffer"),this.generateInternalStream(w).toNodejsStream(_)}};e.exports=F},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,e,t){"use strict";e.exports=r("stream")},{stream:void 0}],17:[function(r,e,t){"use strict";var i=r("./DataReader");function n(s){i.call(this,s);for(var o=0;o<this.data.length;o++)s[o]=255&s[o]}r("../utils").inherits(n,i),n.prototype.byteAt=function(s){return this.data[this.zero+s]},n.prototype.lastIndexOfSignature=function(s){for(var o=s.charCodeAt(0),a=s.charCodeAt(1),l=s.charCodeAt(2),u=s.charCodeAt(3),c=this.length-4;0<=c;--c)if(this.data[c]===o&&this.data[c+1]===a&&this.data[c+2]===l&&this.data[c+3]===u)return c-this.zero;return-1},n.prototype.readAndCheckSignature=function(s){var o=s.charCodeAt(0),a=s.charCodeAt(1),l=s.charCodeAt(2),u=s.charCodeAt(3),c=this.readData(4);return o===c[0]&&a===c[1]&&l===c[2]&&u===c[3]},n.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var o=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,o},e.exports=n},{"../utils":32,"./DataReader":18}],18:[function(r,e,t){"use strict";var i=r("../utils");function n(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}n.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(){},readInt:function(s){var o,a=0;for(this.checkOffset(s),o=this.index+s-1;o>=this.index;o--)a=(a<<8)+this.byteAt(o);return this.index+=s,a},readString:function(s){return i.transformTo("string",this.readData(s))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},e.exports=n},{"../utils":32}],19:[function(r,e,t){"use strict";var i=r("./Uint8ArrayReader");function n(s){i.call(this,s)}r("../utils").inherits(n,i),n.prototype.readData=function(s){this.checkOffset(s);var o=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,o},e.exports=n},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,e,t){"use strict";var i=r("./DataReader");function n(s){i.call(this,s)}r("../utils").inherits(n,i),n.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},n.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},n.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},n.prototype.readData=function(s){this.checkOffset(s);var o=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,o},e.exports=n},{"../utils":32,"./DataReader":18}],21:[function(r,e,t){"use strict";var i=r("./ArrayReader");function n(s){i.call(this,s)}r("../utils").inherits(n,i),n.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var o=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,o},e.exports=n},{"../utils":32,"./ArrayReader":17}],22:[function(r,e,t){"use strict";var i=r("../utils"),n=r("../support"),s=r("./ArrayReader"),o=r("./StringReader"),a=r("./NodeBufferReader"),l=r("./Uint8ArrayReader");e.exports=function(u){var c=i.getTypeOf(u);return i.checkSupport(c),c!=="string"||n.uint8array?c==="nodebuffer"?new a(u):n.uint8array?new l(i.transformTo("uint8array",u)):new s(i.transformTo("array",u)):new o(u)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,e,t){"use strict";t.LOCAL_FILE_HEADER="PK",t.CENTRAL_FILE_HEADER="PK",t.CENTRAL_DIRECTORY_END="PK",t.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",t.ZIP64_CENTRAL_DIRECTORY_END="PK",t.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,e,t){"use strict";var i=r("./GenericWorker"),n=r("../utils");function s(o){i.call(this,"ConvertWorker to "+o),this.destType=o}n.inherits(s,i),s.prototype.processChunk=function(o){this.push({data:n.transformTo(this.destType,o.data),meta:o.meta})},e.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(r,e,t){"use strict";var i=r("./GenericWorker"),n=r("../crc32");function s(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(s,i),s.prototype.processChunk=function(o){this.streamInfo.crc32=n(o.data,this.streamInfo.crc32||0),this.push(o)},e.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,e,t){"use strict";var i=r("../utils"),n=r("./GenericWorker");function s(o){n.call(this,"DataLengthProbe for "+o),this.propName=o,this.withStreamInfo(o,0)}i.inherits(s,n),s.prototype.processChunk=function(o){if(o){var a=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=a+o.data.length}n.prototype.processChunk.call(this,o)},e.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(r,e,t){"use strict";var i=r("../utils"),n=r("./GenericWorker");function s(o){n.call(this,"DataWorker");var a=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,o.then(function(l){a.dataIsReady=!0,a.data=l,a.max=l&&l.length||0,a.type=i.getTypeOf(l),a.isPaused||a._tickAndRepeat()},function(l){a.error(l)})}i.inherits(s,n),s.prototype.cleanUp=function(){n.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var o=null,a=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":o=this.data.substring(this.index,a);break;case"uint8array":o=this.data.subarray(this.index,a);break;case"array":case"nodebuffer":o=this.data.slice(this.index,a)}return this.index=a,this.push({data:o,meta:{percent:this.max?this.index/this.max*100:0}})},e.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(r,e,t){"use strict";function i(n){this.name=n||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(n){this.emit("data",n)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(n){this.emit("error",n)}return!0},error:function(n){return!this.isFinished&&(this.isPaused?this.generatedError=n:(this.isFinished=!0,this.emit("error",n),this.previous&&this.previous.error(n),this.cleanUp()),!0)},on:function(n,s){return this._listeners[n].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(n,s){if(this._listeners[n])for(var o=0;o<this._listeners[n].length;o++)this._listeners[n][o].call(this,s)},pipe:function(n){return n.registerPrevious(this)},registerPrevious:function(n){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=n.streamInfo,this.mergeStreamInfo(),this.previous=n;var s=this;return n.on("data",function(o){s.processChunk(o)}),n.on("end",function(){s.end()}),n.on("error",function(o){s.error(o)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var n=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),n=!0),this.previous&&this.previous.resume(),!n},flush:function(){},processChunk:function(n){this.push(n)},withStreamInfo:function(n,s){return this.extraStreamInfo[n]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var n in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,n)&&(this.streamInfo[n]=this.extraStreamInfo[n])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var n="Worker "+this.name;return this.previous?this.previous+" -> "+n:n}},e.exports=i},{}],29:[function(r,e,t){"use strict";var i=r("../utils"),n=r("./ConvertWorker"),s=r("./GenericWorker"),o=r("../base64"),a=r("../support"),l=r("../external"),u=null;if(a.nodestream)try{u=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function c(h,f){return new l.Promise(function(m,p){var g=[],b=h._internalType,F=h._outputType,w=h._mimeType;h.on("data",function(_,I){g.push(_),f&&f(I)}).on("error",function(_){g=[],p(_)}).on("end",function(){try{var _=function(I,A,T){switch(I){case"blob":return i.newBlob(i.transformTo("arraybuffer",A),T);case"base64":return o.encode(A);default:return i.transformTo(I,A)}}(F,function(I,A){var T,E=0,K=null,P=0;for(T=0;T<A.length;T++)P+=A[T].length;switch(I){case"string":return A.join("");case"array":return Array.prototype.concat.apply([],A);case"uint8array":for(K=new Uint8Array(P),T=0;T<A.length;T++)K.set(A[T],E),E+=A[T].length;return K;case"nodebuffer":return Buffer.concat(A);default:throw new Error("concat : unsupported type '"+I+"'")}}(b,g),w);m(_)}catch(I){p(I)}g=[]}).resume()})}function d(h,f,m){var p=f;switch(f){case"blob":case"arraybuffer":p="uint8array";break;case"base64":p="string"}try{this._internalType=p,this._outputType=f,this._mimeType=m,i.checkSupport(p),this._worker=h.pipe(new n(p)),h.lock()}catch(g){this._worker=new s("error"),this._worker.error(g)}}d.prototype={accumulate:function(h){return c(this,h)},on:function(h,f){var m=this;return h==="data"?this._worker.on(h,function(p){f.call(m,p.data,p.meta)}):this._worker.on(h,function(){i.delay(f,arguments,m)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(h){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new u(this,{objectMode:this._outputType!=="nodebuffer"},h)}},e.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,e,t){"use strict";if(t.base64=!0,t.array=!0,t.string=!0,t.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",t.nodebuffer=typeof Buffer<"u",t.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")t.blob=!1;else{var i=new ArrayBuffer(0);try{t.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);n.append(i),t.blob=n.getBlob("application/zip").size===0}catch{t.blob=!1}}}try{t.nodestream=!!r("readable-stream").Readable}catch{t.nodestream=!1}},{"readable-stream":16}],31:[function(r,e,t){"use strict";for(var i=r("./utils"),n=r("./support"),s=r("./nodejsUtils"),o=r("./stream/GenericWorker"),a=new Array(256),l=0;l<256;l++)a[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;a[254]=a[254]=1;function u(){o.call(this,"utf-8 decode"),this.leftOver=null}function c(){o.call(this,"utf-8 encode")}t.utf8encode=function(d){return n.nodebuffer?s.newBufferFrom(d,"utf-8"):function(h){var f,m,p,g,b,F=h.length,w=0;for(g=0;g<F;g++)(64512&(m=h.charCodeAt(g)))==55296&&g+1<F&&(64512&(p=h.charCodeAt(g+1)))==56320&&(m=65536+(m-55296<<10)+(p-56320),g++),w+=m<128?1:m<2048?2:m<65536?3:4;for(f=n.uint8array?new Uint8Array(w):new Array(w),g=b=0;b<w;g++)(64512&(m=h.charCodeAt(g)))==55296&&g+1<F&&(64512&(p=h.charCodeAt(g+1)))==56320&&(m=65536+(m-55296<<10)+(p-56320),g++),m<128?f[b++]=m:(m<2048?f[b++]=192|m>>>6:(m<65536?f[b++]=224|m>>>12:(f[b++]=240|m>>>18,f[b++]=128|m>>>12&63),f[b++]=128|m>>>6&63),f[b++]=128|63&m);return f}(d)},t.utf8decode=function(d){return n.nodebuffer?i.transformTo("nodebuffer",d).toString("utf-8"):function(h){var f,m,p,g,b=h.length,F=new Array(2*b);for(f=m=0;f<b;)if((p=h[f++])<128)F[m++]=p;else if(4<(g=a[p]))F[m++]=65533,f+=g-1;else{for(p&=g===2?31:g===3?15:7;1<g&&f<b;)p=p<<6|63&h[f++],g--;1<g?F[m++]=65533:p<65536?F[m++]=p:(p-=65536,F[m++]=55296|p>>10&1023,F[m++]=56320|1023&p)}return F.length!==m&&(F.subarray?F=F.subarray(0,m):F.length=m),i.applyFromCharCode(F)}(d=i.transformTo(n.uint8array?"uint8array":"array",d))},i.inherits(u,o),u.prototype.processChunk=function(d){var h=i.transformTo(n.uint8array?"uint8array":"array",d.data);if(this.leftOver&&this.leftOver.length){if(n.uint8array){var f=h;(h=new Uint8Array(f.length+this.leftOver.length)).set(this.leftOver,0),h.set(f,this.leftOver.length)}else h=this.leftOver.concat(h);this.leftOver=null}var m=function(g,b){var F;for((b=b||g.length)>g.length&&(b=g.length),F=b-1;0<=F&&(192&g[F])==128;)F--;return F<0||F===0?b:F+a[g[F]]>b?F:b}(h),p=h;m!==h.length&&(n.uint8array?(p=h.subarray(0,m),this.leftOver=h.subarray(m,h.length)):(p=h.slice(0,m),this.leftOver=h.slice(m,h.length))),this.push({data:t.utf8decode(p),meta:d.meta})},u.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:t.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},t.Utf8DecodeWorker=u,i.inherits(c,o),c.prototype.processChunk=function(d){this.push({data:t.utf8encode(d.data),meta:d.meta})},t.Utf8EncodeWorker=c},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,e,t){"use strict";var i=r("./support"),n=r("./base64"),s=r("./nodejsUtils"),o=r("./external");function a(f){return f}function l(f,m){for(var p=0;p<f.length;++p)m[p]=255&f.charCodeAt(p);return m}r("setimmediate"),t.newBlob=function(f,m){t.checkSupport("blob");try{return new Blob([f],{type:m})}catch{try{var p=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return p.append(f),p.getBlob(m)}catch{throw new Error("Bug : can't construct the Blob.")}}};var u={stringifyByChunk:function(f,m,p){var g=[],b=0,F=f.length;if(F<=p)return String.fromCharCode.apply(null,f);for(;b<F;)m==="array"||m==="nodebuffer"?g.push(String.fromCharCode.apply(null,f.slice(b,Math.min(b+p,F)))):g.push(String.fromCharCode.apply(null,f.subarray(b,Math.min(b+p,F)))),b+=p;return g.join("")},stringifyByChar:function(f){for(var m="",p=0;p<f.length;p++)m+=String.fromCharCode(f[p]);return m},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}}()}};function c(f){var m=65536,p=t.getTypeOf(f),g=!0;if(p==="uint8array"?g=u.applyCanBeUsed.uint8array:p==="nodebuffer"&&(g=u.applyCanBeUsed.nodebuffer),g)for(;1<m;)try{return u.stringifyByChunk(f,p,m)}catch{m=Math.floor(m/2)}return u.stringifyByChar(f)}function d(f,m){for(var p=0;p<f.length;p++)m[p]=f[p];return m}t.applyFromCharCode=c;var h={};h.string={string:a,array:function(f){return l(f,new Array(f.length))},arraybuffer:function(f){return h.string.uint8array(f).buffer},uint8array:function(f){return l(f,new Uint8Array(f.length))},nodebuffer:function(f){return l(f,s.allocBuffer(f.length))}},h.array={string:c,array:a,arraybuffer:function(f){return new Uint8Array(f).buffer},uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return s.newBufferFrom(f)}},h.arraybuffer={string:function(f){return c(new Uint8Array(f))},array:function(f){return d(new Uint8Array(f),new Array(f.byteLength))},arraybuffer:a,uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return s.newBufferFrom(new Uint8Array(f))}},h.uint8array={string:c,array:function(f){return d(f,new Array(f.length))},arraybuffer:function(f){return f.buffer},uint8array:a,nodebuffer:function(f){return s.newBufferFrom(f)}},h.nodebuffer={string:c,array:function(f){return d(f,new Array(f.length))},arraybuffer:function(f){return h.nodebuffer.uint8array(f).buffer},uint8array:function(f){return d(f,new Uint8Array(f.length))},nodebuffer:a},t.transformTo=function(f,m){if(m=m||"",!f)return m;t.checkSupport(f);var p=t.getTypeOf(m);return h[p][f](m)},t.resolve=function(f){for(var m=f.split("/"),p=[],g=0;g<m.length;g++){var b=m[g];b==="."||b===""&&g!==0&&g!==m.length-1||(b===".."?p.pop():p.push(b))}return p.join("/")},t.getTypeOf=function(f){return typeof f=="string"?"string":Object.prototype.toString.call(f)==="[object Array]"?"array":i.nodebuffer&&s.isBuffer(f)?"nodebuffer":i.uint8array&&f instanceof Uint8Array?"uint8array":i.arraybuffer&&f instanceof ArrayBuffer?"arraybuffer":void 0},t.checkSupport=function(f){if(!i[f.toLowerCase()])throw new Error(f+" is not supported by this platform")},t.MAX_VALUE_16BITS=65535,t.MAX_VALUE_32BITS=-1,t.pretty=function(f){var m,p,g="";for(p=0;p<(f||"").length;p++)g+="\\x"+((m=f.charCodeAt(p))<16?"0":"")+m.toString(16).toUpperCase();return g},t.delay=function(f,m,p){setImmediate(function(){f.apply(p||null,m||[])})},t.inherits=function(f,m){function p(){}p.prototype=m.prototype,f.prototype=new p},t.extend=function(){var f,m,p={};for(f=0;f<arguments.length;f++)for(m in arguments[f])Object.prototype.hasOwnProperty.call(arguments[f],m)&&p[m]===void 0&&(p[m]=arguments[f][m]);return p},t.prepareContent=function(f,m,p,g,b){return o.Promise.resolve(m).then(function(F){return i.blob&&(F instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(F))!==-1)&&typeof FileReader<"u"?new o.Promise(function(w,_){var I=new FileReader;I.onload=function(A){w(A.target.result)},I.onerror=function(A){_(A.target.error)},I.readAsArrayBuffer(F)}):F}).then(function(F){var w=t.getTypeOf(F);return w?(w==="arraybuffer"?F=t.transformTo("uint8array",F):w==="string"&&(b?F=n.decode(F):p&&g!==!0&&(F=function(_){return l(_,i.uint8array?new Uint8Array(_.length):new Array(_.length))}(F))),F):o.Promise.reject(new Error("Can't read the data of '"+f+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,e,t){"use strict";var i=r("./reader/readerFor"),n=r("./utils"),s=r("./signature"),o=r("./zipEntry"),a=r("./support");function l(u){this.files=[],this.loadOptions=u}l.prototype={checkSignature:function(u){if(!this.reader.readAndCheckSignature(u)){this.reader.index-=4;var c=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+n.pretty(c)+", expected "+n.pretty(u)+")")}},isSignature:function(u,c){var d=this.reader.index;this.reader.setIndex(u);var h=this.reader.readString(4)===c;return this.reader.setIndex(d),h},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var u=this.reader.readData(this.zipCommentLength),c=a.uint8array?"uint8array":"array",d=n.transformTo(c,u);this.zipComment=this.loadOptions.decodeFileName(d)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var u,c,d,h=this.zip64EndOfCentralSize-44;0<h;)u=this.reader.readInt(2),c=this.reader.readInt(4),d=this.reader.readData(c),this.zip64ExtensibleData[u]={id:u,length:c,value:d}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var u,c;for(u=0;u<this.files.length;u++)c=this.files[u],this.reader.setIndex(c.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),c.readLocalPart(this.reader),c.handleUTF8(),c.processAttributes()},readCentralDir:function(){var u;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(u=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(u);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var u=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(u<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(u);var c=u;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===n.MAX_VALUE_16BITS||this.diskWithCentralDirStart===n.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===n.MAX_VALUE_16BITS||this.centralDirRecords===n.MAX_VALUE_16BITS||this.centralDirSize===n.MAX_VALUE_32BITS||this.centralDirOffset===n.MAX_VALUE_32BITS){if(this.zip64=!0,(u=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(u),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var d=this.centralDirOffset+this.centralDirSize;this.zip64&&(d+=20,d+=12+this.zip64EndOfCentralSize);var h=c-d;if(0<h)this.isSignature(c,s.CENTRAL_FILE_HEADER)||(this.reader.zero=h);else if(h<0)throw new Error("Corrupted zip: missing "+Math.abs(h)+" bytes.")},prepareReader:function(u){this.reader=i(u)},load:function(u){this.prepareReader(u),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,e,t){"use strict";var i=r("./reader/readerFor"),n=r("./utils"),s=r("./compressedObject"),o=r("./crc32"),a=r("./utf8"),l=r("./compressions"),u=r("./support");function c(d,h){this.options=d,this.loadOptions=h}c.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(d){var h,f;if(d.skip(22),this.fileNameLength=d.readInt(2),f=d.readInt(2),this.fileName=d.readData(this.fileNameLength),d.skip(f),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((h=function(m){for(var p in l)if(Object.prototype.hasOwnProperty.call(l,p)&&l[p].magic===m)return l[p];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+n.pretty(this.compressionMethod)+" unknown (inner file : "+n.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,h,d.readData(this.compressedSize))},readCentralPart:function(d){this.versionMadeBy=d.readInt(2),d.skip(2),this.bitFlag=d.readInt(2),this.compressionMethod=d.readString(2),this.date=d.readDate(),this.crc32=d.readInt(4),this.compressedSize=d.readInt(4),this.uncompressedSize=d.readInt(4);var h=d.readInt(2);if(this.extraFieldsLength=d.readInt(2),this.fileCommentLength=d.readInt(2),this.diskNumberStart=d.readInt(2),this.internalFileAttributes=d.readInt(2),this.externalFileAttributes=d.readInt(4),this.localHeaderOffset=d.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");d.skip(h),this.readExtraFields(d),this.parseZIP64ExtraField(d),this.fileComment=d.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var d=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),d==0&&(this.dosPermissions=63&this.externalFileAttributes),d==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var d=i(this.extraFields[1].value);this.uncompressedSize===n.MAX_VALUE_32BITS&&(this.uncompressedSize=d.readInt(8)),this.compressedSize===n.MAX_VALUE_32BITS&&(this.compressedSize=d.readInt(8)),this.localHeaderOffset===n.MAX_VALUE_32BITS&&(this.localHeaderOffset=d.readInt(8)),this.diskNumberStart===n.MAX_VALUE_32BITS&&(this.diskNumberStart=d.readInt(4))}},readExtraFields:function(d){var h,f,m,p=d.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});d.index+4<p;)h=d.readInt(2),f=d.readInt(2),m=d.readData(f),this.extraFields[h]={id:h,length:f,value:m};d.setIndex(p)},handleUTF8:function(){var d=u.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=a.utf8decode(this.fileName),this.fileCommentStr=a.utf8decode(this.fileComment);else{var h=this.findExtraFieldUnicodePath();if(h!==null)this.fileNameStr=h;else{var f=n.transformTo(d,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(f)}var m=this.findExtraFieldUnicodeComment();if(m!==null)this.fileCommentStr=m;else{var p=n.transformTo(d,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(p)}}},findExtraFieldUnicodePath:function(){var d=this.extraFields[28789];if(d){var h=i(d.value);return h.readInt(1)!==1||o(this.fileName)!==h.readInt(4)?null:a.utf8decode(h.readData(d.length-5))}return null},findExtraFieldUnicodeComment:function(){var d=this.extraFields[25461];if(d){var h=i(d.value);return h.readInt(1)!==1||o(this.fileComment)!==h.readInt(4)?null:a.utf8decode(h.readData(d.length-5))}return null}},e.exports=c},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,e,t){"use strict";function i(h,f,m){this.name=h,this.dir=m.dir,this.date=m.date,this.comment=m.comment,this.unixPermissions=m.unixPermissions,this.dosPermissions=m.dosPermissions,this._data=f,this._dataBinary=m.binary,this.options={compression:m.compression,compressionOptions:m.compressionOptions}}var n=r("./stream/StreamHelper"),s=r("./stream/DataWorker"),o=r("./utf8"),a=r("./compressedObject"),l=r("./stream/GenericWorker");i.prototype={internalStream:function(h){var f=null,m="string";try{if(!h)throw new Error("No output type specified.");var p=(m=h.toLowerCase())==="string"||m==="text";m!=="binarystring"&&m!=="text"||(m="string"),f=this._decompressWorker();var g=!this._dataBinary;g&&!p&&(f=f.pipe(new o.Utf8EncodeWorker)),!g&&p&&(f=f.pipe(new o.Utf8DecodeWorker))}catch(b){(f=new l("error")).error(b)}return new n(f,m,"")},async:function(h,f){return this.internalStream(h).accumulate(f)},nodeStream:function(h,f){return this.internalStream(h||"nodebuffer").toNodejsStream(f)},_compressWorker:function(h,f){if(this._data instanceof a&&this._data.compression.magic===h.magic)return this._data.getCompressedWorker();var m=this._decompressWorker();return this._dataBinary||(m=m.pipe(new o.Utf8EncodeWorker)),a.createWorkerFrom(m,h,f)},_decompressWorker:function(){return this._data instanceof a?this._data.getContentWorker():this._data instanceof l?this._data:new s(this._data)}};for(var u=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],c=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<u.length;d++)i.prototype[u[d]]=c;e.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,e,t){(function(i){"use strict";var n,s,o=i.MutationObserver||i.WebKitMutationObserver;if(o){var a=0,l=new o(h),u=i.document.createTextNode("");l.observe(u,{characterData:!0}),n=function(){u.data=a=++a%2}}else if(i.setImmediate||i.MessageChannel===void 0)n="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var f=i.document.createElement("script");f.onreadystatechange=function(){h(),f.onreadystatechange=null,f.parentNode.removeChild(f),f=null},i.document.documentElement.appendChild(f)}:function(){setTimeout(h,0)};else{var c=new i.MessageChannel;c.port1.onmessage=h,n=function(){c.port2.postMessage(0)}}var d=[];function h(){var f,m;s=!0;for(var p=d.length;p;){for(m=d,d=[],f=-1;++f<p;)m[f]();p=d.length}s=!1}e.exports=function(f){d.push(f)!==1||s||n()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,e,t){"use strict";var i=r("immediate");function n(){}var s={},o=["REJECTED"],a=["FULFILLED"],l=["PENDING"];function u(p){if(typeof p!="function")throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,p!==n&&f(this,p)}function c(p,g,b){this.promise=p,typeof g=="function"&&(this.onFulfilled=g,this.callFulfilled=this.otherCallFulfilled),typeof b=="function"&&(this.onRejected=b,this.callRejected=this.otherCallRejected)}function d(p,g,b){i(function(){var F;try{F=g(b)}catch(w){return s.reject(p,w)}F===p?s.reject(p,new TypeError("Cannot resolve promise with itself")):s.resolve(p,F)})}function h(p){var g=p&&p.then;if(p&&(typeof p=="object"||typeof p=="function")&&typeof g=="function")return function(){g.apply(p,arguments)}}function f(p,g){var b=!1;function F(I){b||(b=!0,s.reject(p,I))}function w(I){b||(b=!0,s.resolve(p,I))}var _=m(function(){g(w,F)});_.status==="error"&&F(_.value)}function m(p,g){var b={};try{b.value=p(g),b.status="success"}catch(F){b.status="error",b.value=F}return b}(e.exports=u).prototype.finally=function(p){if(typeof p!="function")return this;var g=this.constructor;return this.then(function(b){return g.resolve(p()).then(function(){return b})},function(b){return g.resolve(p()).then(function(){throw b})})},u.prototype.catch=function(p){return this.then(null,p)},u.prototype.then=function(p,g){if(typeof p!="function"&&this.state===a||typeof g!="function"&&this.state===o)return this;var b=new this.constructor(n);return this.state!==l?d(b,this.state===a?p:g,this.outcome):this.queue.push(new c(b,p,g)),b},c.prototype.callFulfilled=function(p){s.resolve(this.promise,p)},c.prototype.otherCallFulfilled=function(p){d(this.promise,this.onFulfilled,p)},c.prototype.callRejected=function(p){s.reject(this.promise,p)},c.prototype.otherCallRejected=function(p){d(this.promise,this.onRejected,p)},s.resolve=function(p,g){var b=m(h,g);if(b.status==="error")return s.reject(p,b.value);var F=b.value;if(F)f(p,F);else{p.state=a,p.outcome=g;for(var w=-1,_=p.queue.length;++w<_;)p.queue[w].callFulfilled(g)}return p},s.reject=function(p,g){p.state=o,p.outcome=g;for(var b=-1,F=p.queue.length;++b<F;)p.queue[b].callRejected(g);return p},u.resolve=function(p){return p instanceof this?p:s.resolve(new this(n),p)},u.reject=function(p){var g=new this(n);return s.reject(g,p)},u.all=function(p){var g=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=p.length,F=!1;if(!b)return this.resolve([]);for(var w=new Array(b),_=0,I=-1,A=new this(n);++I<b;)T(p[I],I);return A;function T(E,K){g.resolve(E).then(function(P){w[K]=P,++_!==b||F||(F=!0,s.resolve(A,w))},function(P){F||(F=!0,s.reject(A,P))})}},u.race=function(p){var g=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=p.length,F=!1;if(!b)return this.resolve([]);for(var w=-1,_=new this(n);++w<b;)I=p[w],g.resolve(I).then(function(A){F||(F=!0,s.resolve(_,A))},function(A){F||(F=!0,s.reject(_,A))});var I;return _}},{immediate:36}],38:[function(r,e,t){"use strict";var i={};(0,r("./lib/utils/common").assign)(i,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),e.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,e,t){"use strict";var i=r("./zlib/deflate"),n=r("./utils/common"),s=r("./utils/strings"),o=r("./zlib/messages"),a=r("./zlib/zstream"),l=Object.prototype.toString,u=0,c=-1,d=0,h=8;function f(p){if(!(this instanceof f))return new f(p);this.options=n.assign({level:c,method:h,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},p||{});var g=this.options;g.raw&&0<g.windowBits?g.windowBits=-g.windowBits:g.gzip&&0<g.windowBits&&g.windowBits<16&&(g.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;var b=i.deflateInit2(this.strm,g.level,g.method,g.windowBits,g.memLevel,g.strategy);if(b!==u)throw new Error(o[b]);if(g.header&&i.deflateSetHeader(this.strm,g.header),g.dictionary){var F;if(F=typeof g.dictionary=="string"?s.string2buf(g.dictionary):l.call(g.dictionary)==="[object ArrayBuffer]"?new Uint8Array(g.dictionary):g.dictionary,(b=i.deflateSetDictionary(this.strm,F))!==u)throw new Error(o[b]);this._dict_set=!0}}function m(p,g){var b=new f(g);if(b.push(p,!0),b.err)throw b.msg||o[b.err];return b.result}f.prototype.push=function(p,g){var b,F,w=this.strm,_=this.options.chunkSize;if(this.ended)return!1;F=g===~~g?g:g===!0?4:0,typeof p=="string"?w.input=s.string2buf(p):l.call(p)==="[object ArrayBuffer]"?w.input=new Uint8Array(p):w.input=p,w.next_in=0,w.avail_in=w.input.length;do{if(w.avail_out===0&&(w.output=new n.Buf8(_),w.next_out=0,w.avail_out=_),(b=i.deflate(w,F))!==1&&b!==u)return this.onEnd(b),!(this.ended=!0);w.avail_out!==0&&(w.avail_in!==0||F!==4&&F!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(n.shrinkBuf(w.output,w.next_out))):this.onData(n.shrinkBuf(w.output,w.next_out)))}while((0<w.avail_in||w.avail_out===0)&&b!==1);return F===4?(b=i.deflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===u):F!==2||(this.onEnd(u),!(w.avail_out=0))},f.prototype.onData=function(p){this.chunks.push(p)},f.prototype.onEnd=function(p){p===u&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg},t.Deflate=f,t.deflate=m,t.deflateRaw=function(p,g){return(g=g||{}).raw=!0,m(p,g)},t.gzip=function(p,g){return(g=g||{}).gzip=!0,m(p,g)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,e,t){"use strict";var i=r("./zlib/inflate"),n=r("./utils/common"),s=r("./utils/strings"),o=r("./zlib/constants"),a=r("./zlib/messages"),l=r("./zlib/zstream"),u=r("./zlib/gzheader"),c=Object.prototype.toString;function d(f){if(!(this instanceof d))return new d(f);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},f||{});var m=this.options;m.raw&&0<=m.windowBits&&m.windowBits<16&&(m.windowBits=-m.windowBits,m.windowBits===0&&(m.windowBits=-15)),!(0<=m.windowBits&&m.windowBits<16)||f&&f.windowBits||(m.windowBits+=32),15<m.windowBits&&m.windowBits<48&&(15&m.windowBits)==0&&(m.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var p=i.inflateInit2(this.strm,m.windowBits);if(p!==o.Z_OK)throw new Error(a[p]);this.header=new u,i.inflateGetHeader(this.strm,this.header)}function h(f,m){var p=new d(m);if(p.push(f,!0),p.err)throw p.msg||a[p.err];return p.result}d.prototype.push=function(f,m){var p,g,b,F,w,_,I=this.strm,A=this.options.chunkSize,T=this.options.dictionary,E=!1;if(this.ended)return!1;g=m===~~m?m:m===!0?o.Z_FINISH:o.Z_NO_FLUSH,typeof f=="string"?I.input=s.binstring2buf(f):c.call(f)==="[object ArrayBuffer]"?I.input=new Uint8Array(f):I.input=f,I.next_in=0,I.avail_in=I.input.length;do{if(I.avail_out===0&&(I.output=new n.Buf8(A),I.next_out=0,I.avail_out=A),(p=i.inflate(I,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&T&&(_=typeof T=="string"?s.string2buf(T):c.call(T)==="[object ArrayBuffer]"?new Uint8Array(T):T,p=i.inflateSetDictionary(this.strm,_)),p===o.Z_BUF_ERROR&&E===!0&&(p=o.Z_OK,E=!1),p!==o.Z_STREAM_END&&p!==o.Z_OK)return this.onEnd(p),!(this.ended=!0);I.next_out&&(I.avail_out!==0&&p!==o.Z_STREAM_END&&(I.avail_in!==0||g!==o.Z_FINISH&&g!==o.Z_SYNC_FLUSH)||(this.options.to==="string"?(b=s.utf8border(I.output,I.next_out),F=I.next_out-b,w=s.buf2string(I.output,b),I.next_out=F,I.avail_out=A-F,F&&n.arraySet(I.output,I.output,b,F,0),this.onData(w)):this.onData(n.shrinkBuf(I.output,I.next_out)))),I.avail_in===0&&I.avail_out===0&&(E=!0)}while((0<I.avail_in||I.avail_out===0)&&p!==o.Z_STREAM_END);return p===o.Z_STREAM_END&&(g=o.Z_FINISH),g===o.Z_FINISH?(p=i.inflateEnd(this.strm),this.onEnd(p),this.ended=!0,p===o.Z_OK):g!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(I.avail_out=0))},d.prototype.onData=function(f){this.chunks.push(f)},d.prototype.onEnd=function(f){f===o.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=f,this.msg=this.strm.msg},t.Inflate=d,t.inflate=h,t.inflateRaw=function(f,m){return(m=m||{}).raw=!0,h(f,m)},t.ungzip=h},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,e,t){"use strict";var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";t.assign=function(o){for(var a=Array.prototype.slice.call(arguments,1);a.length;){var l=a.shift();if(l){if(typeof l!="object")throw new TypeError(l+"must be non-object");for(var u in l)l.hasOwnProperty(u)&&(o[u]=l[u])}}return o},t.shrinkBuf=function(o,a){return o.length===a?o:o.subarray?o.subarray(0,a):(o.length=a,o)};var n={arraySet:function(o,a,l,u,c){if(a.subarray&&o.subarray)o.set(a.subarray(l,l+u),c);else for(var d=0;d<u;d++)o[c+d]=a[l+d]},flattenChunks:function(o){var a,l,u,c,d,h;for(a=u=0,l=o.length;a<l;a++)u+=o[a].length;for(h=new Uint8Array(u),a=c=0,l=o.length;a<l;a++)d=o[a],h.set(d,c),c+=d.length;return h}},s={arraySet:function(o,a,l,u,c){for(var d=0;d<u;d++)o[c+d]=a[l+d]},flattenChunks:function(o){return[].concat.apply([],o)}};t.setTyped=function(o){o?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,n)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,s))},t.setTyped(i)},{}],42:[function(r,e,t){"use strict";var i=r("./common"),n=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var o=new i.Buf8(256),a=0;a<256;a++)o[a]=252<=a?6:248<=a?5:240<=a?4:224<=a?3:192<=a?2:1;function l(u,c){if(c<65537&&(u.subarray&&s||!u.subarray&&n))return String.fromCharCode.apply(null,i.shrinkBuf(u,c));for(var d="",h=0;h<c;h++)d+=String.fromCharCode(u[h]);return d}o[254]=o[254]=1,t.string2buf=function(u){var c,d,h,f,m,p=u.length,g=0;for(f=0;f<p;f++)(64512&(d=u.charCodeAt(f)))==55296&&f+1<p&&(64512&(h=u.charCodeAt(f+1)))==56320&&(d=65536+(d-55296<<10)+(h-56320),f++),g+=d<128?1:d<2048?2:d<65536?3:4;for(c=new i.Buf8(g),f=m=0;m<g;f++)(64512&(d=u.charCodeAt(f)))==55296&&f+1<p&&(64512&(h=u.charCodeAt(f+1)))==56320&&(d=65536+(d-55296<<10)+(h-56320),f++),d<128?c[m++]=d:(d<2048?c[m++]=192|d>>>6:(d<65536?c[m++]=224|d>>>12:(c[m++]=240|d>>>18,c[m++]=128|d>>>12&63),c[m++]=128|d>>>6&63),c[m++]=128|63&d);return c},t.buf2binstring=function(u){return l(u,u.length)},t.binstring2buf=function(u){for(var c=new i.Buf8(u.length),d=0,h=c.length;d<h;d++)c[d]=u.charCodeAt(d);return c},t.buf2string=function(u,c){var d,h,f,m,p=c||u.length,g=new Array(2*p);for(d=h=0;d<p;)if((f=u[d++])<128)g[h++]=f;else if(4<(m=o[f]))g[h++]=65533,d+=m-1;else{for(f&=m===2?31:m===3?15:7;1<m&&d<p;)f=f<<6|63&u[d++],m--;1<m?g[h++]=65533:f<65536?g[h++]=f:(f-=65536,g[h++]=55296|f>>10&1023,g[h++]=56320|1023&f)}return l(g,h)},t.utf8border=function(u,c){var d;for((c=c||u.length)>u.length&&(c=u.length),d=c-1;0<=d&&(192&u[d])==128;)d--;return d<0||d===0?c:d+o[u[d]]>c?d:c}},{"./common":41}],43:[function(r,e,t){"use strict";e.exports=function(i,n,s,o){for(var a=65535&i|0,l=i>>>16&65535|0,u=0;s!==0;){for(s-=u=2e3<s?2e3:s;l=l+(a=a+n[o++]|0)|0,--u;);a%=65521,l%=65521}return a|l<<16|0}},{}],44:[function(r,e,t){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,e,t){"use strict";var i=function(){for(var n,s=[],o=0;o<256;o++){n=o;for(var a=0;a<8;a++)n=1&n?3988292384^n>>>1:n>>>1;s[o]=n}return s}();e.exports=function(n,s,o,a){var l=i,u=a+o;n^=-1;for(var c=a;c<u;c++)n=n>>>8^l[255&(n^s[c])];return-1^n}},{}],46:[function(r,e,t){"use strict";var i,n=r("../utils/common"),s=r("./trees"),o=r("./adler32"),a=r("./crc32"),l=r("./messages"),u=0,c=4,d=0,h=-2,f=-1,m=4,p=2,g=8,b=9,F=286,w=30,_=19,I=2*F+1,A=15,T=3,E=258,K=E+T+1,P=42,G=113,y=1,z=2,Fe=3,re=4;function Re(v,ae){return v.msg=l[ae],ae}function pe(v){return(v<<1)-(4<v?9:0)}function ze(v){for(var ae=v.length;0<=--ae;)v[ae]=0}function ee(v){var ae=v.state,ie=ae.pending;ie>v.avail_out&&(ie=v.avail_out),ie!==0&&(n.arraySet(v.output,ae.pending_buf,ae.pending_out,ie,v.next_out),v.next_out+=ie,ae.pending_out+=ie,v.total_out+=ie,v.avail_out-=ie,ae.pending-=ie,ae.pending===0&&(ae.pending_out=0))}function Y(v,ae){s._tr_flush_block(v,0<=v.block_start?v.block_start:-1,v.strstart-v.block_start,ae),v.block_start=v.strstart,ee(v.strm)}function Ve(v,ae){v.pending_buf[v.pending++]=ae}function U(v,ae){v.pending_buf[v.pending++]=ae>>>8&255,v.pending_buf[v.pending++]=255&ae}function me(v,ae){var ie,O,D=v.max_chain_length,$=v.strstart,ue=v.prev_length,ce=v.nice_match,X=v.strstart>v.w_size-K?v.strstart-(v.w_size-K):0,ge=v.window,Ae=v.w_mask,Ce=v.prev,He=v.strstart+E,Dt=ge[$+ue-1],ft=ge[$+ue];v.prev_length>=v.good_match&&(D>>=2),ce>v.lookahead&&(ce=v.lookahead);do if(ge[(ie=ae)+ue]===ft&&ge[ie+ue-1]===Dt&&ge[ie]===ge[$]&&ge[++ie]===ge[$+1]){$+=2,ie++;do;while(ge[++$]===ge[++ie]&&ge[++$]===ge[++ie]&&ge[++$]===ge[++ie]&&ge[++$]===ge[++ie]&&ge[++$]===ge[++ie]&&ge[++$]===ge[++ie]&&ge[++$]===ge[++ie]&&ge[++$]===ge[++ie]&&$<He);if(O=E-(He-$),$=He-E,ue<O){if(v.match_start=ae,ce<=(ue=O))break;Dt=ge[$+ue-1],ft=ge[$+ue]}}while((ae=Ce[ae&Ae])>X&&--D!=0);return ue<=v.lookahead?ue:v.lookahead}function Jt(v){var ae,ie,O,D,$,ue,ce,X,ge,Ae,Ce=v.w_size;do{if(D=v.window_size-v.lookahead-v.strstart,v.strstart>=Ce+(Ce-K)){for(n.arraySet(v.window,v.window,Ce,Ce,0),v.match_start-=Ce,v.strstart-=Ce,v.block_start-=Ce,ae=ie=v.hash_size;O=v.head[--ae],v.head[ae]=Ce<=O?O-Ce:0,--ie;);for(ae=ie=Ce;O=v.prev[--ae],v.prev[ae]=Ce<=O?O-Ce:0,--ie;);D+=Ce}if(v.strm.avail_in===0)break;if(ue=v.strm,ce=v.window,X=v.strstart+v.lookahead,ge=D,Ae=void 0,Ae=ue.avail_in,ge<Ae&&(Ae=ge),ie=Ae===0?0:(ue.avail_in-=Ae,n.arraySet(ce,ue.input,ue.next_in,Ae,X),ue.state.wrap===1?ue.adler=o(ue.adler,ce,Ae,X):ue.state.wrap===2&&(ue.adler=a(ue.adler,ce,Ae,X)),ue.next_in+=Ae,ue.total_in+=Ae,Ae),v.lookahead+=ie,v.lookahead+v.insert>=T)for($=v.strstart-v.insert,v.ins_h=v.window[$],v.ins_h=(v.ins_h<<v.hash_shift^v.window[$+1])&v.hash_mask;v.insert&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[$+T-1])&v.hash_mask,v.prev[$&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=$,$++,v.insert--,!(v.lookahead+v.insert<T)););}while(v.lookahead<K&&v.strm.avail_in!==0)}function Qt(v,ae){for(var ie,O;;){if(v.lookahead<K){if(Jt(v),v.lookahead<K&&ae===u)return y;if(v.lookahead===0)break}if(ie=0,v.lookahead>=T&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+T-1])&v.hash_mask,ie=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart),ie!==0&&v.strstart-ie<=v.w_size-K&&(v.match_length=me(v,ie)),v.match_length>=T)if(O=s._tr_tally(v,v.strstart-v.match_start,v.match_length-T),v.lookahead-=v.match_length,v.match_length<=v.max_lazy_match&&v.lookahead>=T){for(v.match_length--;v.strstart++,v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+T-1])&v.hash_mask,ie=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart,--v.match_length!=0;);v.strstart++}else v.strstart+=v.match_length,v.match_length=0,v.ins_h=v.window[v.strstart],v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+1])&v.hash_mask;else O=s._tr_tally(v,0,v.window[v.strstart]),v.lookahead--,v.strstart++;if(O&&(Y(v,!1),v.strm.avail_out===0))return y}return v.insert=v.strstart<T-1?v.strstart:T-1,ae===c?(Y(v,!0),v.strm.avail_out===0?Fe:re):v.last_lit&&(Y(v,!1),v.strm.avail_out===0)?y:z}function ut(v,ae){for(var ie,O,D;;){if(v.lookahead<K){if(Jt(v),v.lookahead<K&&ae===u)return y;if(v.lookahead===0)break}if(ie=0,v.lookahead>=T&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+T-1])&v.hash_mask,ie=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart),v.prev_length=v.match_length,v.prev_match=v.match_start,v.match_length=T-1,ie!==0&&v.prev_length<v.max_lazy_match&&v.strstart-ie<=v.w_size-K&&(v.match_length=me(v,ie),v.match_length<=5&&(v.strategy===1||v.match_length===T&&4096<v.strstart-v.match_start)&&(v.match_length=T-1)),v.prev_length>=T&&v.match_length<=v.prev_length){for(D=v.strstart+v.lookahead-T,O=s._tr_tally(v,v.strstart-1-v.prev_match,v.prev_length-T),v.lookahead-=v.prev_length-1,v.prev_length-=2;++v.strstart<=D&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+T-1])&v.hash_mask,ie=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart),--v.prev_length!=0;);if(v.match_available=0,v.match_length=T-1,v.strstart++,O&&(Y(v,!1),v.strm.avail_out===0))return y}else if(v.match_available){if((O=s._tr_tally(v,0,v.window[v.strstart-1]))&&Y(v,!1),v.strstart++,v.lookahead--,v.strm.avail_out===0)return y}else v.match_available=1,v.strstart++,v.lookahead--}return v.match_available&&(O=s._tr_tally(v,0,v.window[v.strstart-1]),v.match_available=0),v.insert=v.strstart<T-1?v.strstart:T-1,ae===c?(Y(v,!0),v.strm.avail_out===0?Fe:re):v.last_lit&&(Y(v,!1),v.strm.avail_out===0)?y:z}function Ze(v,ae,ie,O,D){this.good_length=v,this.max_lazy=ae,this.nice_length=ie,this.max_chain=O,this.func=D}function Xt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=g,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(2*I),this.dyn_dtree=new n.Buf16(2*(2*w+1)),this.bl_tree=new n.Buf16(2*(2*_+1)),ze(this.dyn_ltree),ze(this.dyn_dtree),ze(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(A+1),this.heap=new n.Buf16(2*F+1),ze(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(2*F+1),ze(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function $t(v){var ae;return v&&v.state?(v.total_in=v.total_out=0,v.data_type=p,(ae=v.state).pending=0,ae.pending_out=0,ae.wrap<0&&(ae.wrap=-ae.wrap),ae.status=ae.wrap?P:G,v.adler=ae.wrap===2?0:1,ae.last_flush=u,s._tr_init(ae),d):Re(v,h)}function Hi(v){var ae=$t(v);return ae===d&&function(ie){ie.window_size=2*ie.w_size,ze(ie.head),ie.max_lazy_match=i[ie.level].max_lazy,ie.good_match=i[ie.level].good_length,ie.nice_match=i[ie.level].nice_length,ie.max_chain_length=i[ie.level].max_chain,ie.strstart=0,ie.block_start=0,ie.lookahead=0,ie.insert=0,ie.match_length=ie.prev_length=T-1,ie.match_available=0,ie.ins_h=0}(v.state),ae}function Bi(v,ae,ie,O,D,$){if(!v)return h;var ue=1;if(ae===f&&(ae=6),O<0?(ue=0,O=-O):15<O&&(ue=2,O-=16),D<1||b<D||ie!==g||O<8||15<O||ae<0||9<ae||$<0||m<$)return Re(v,h);O===8&&(O=9);var ce=new Xt;return(v.state=ce).strm=v,ce.wrap=ue,ce.gzhead=null,ce.w_bits=O,ce.w_size=1<<ce.w_bits,ce.w_mask=ce.w_size-1,ce.hash_bits=D+7,ce.hash_size=1<<ce.hash_bits,ce.hash_mask=ce.hash_size-1,ce.hash_shift=~~((ce.hash_bits+T-1)/T),ce.window=new n.Buf8(2*ce.w_size),ce.head=new n.Buf16(ce.hash_size),ce.prev=new n.Buf16(ce.w_size),ce.lit_bufsize=1<<D+6,ce.pending_buf_size=4*ce.lit_bufsize,ce.pending_buf=new n.Buf8(ce.pending_buf_size),ce.d_buf=1*ce.lit_bufsize,ce.l_buf=3*ce.lit_bufsize,ce.level=ae,ce.strategy=$,ce.method=ie,Hi(v)}i=[new Ze(0,0,0,0,function(v,ae){var ie=65535;for(ie>v.pending_buf_size-5&&(ie=v.pending_buf_size-5);;){if(v.lookahead<=1){if(Jt(v),v.lookahead===0&&ae===u)return y;if(v.lookahead===0)break}v.strstart+=v.lookahead,v.lookahead=0;var O=v.block_start+ie;if((v.strstart===0||v.strstart>=O)&&(v.lookahead=v.strstart-O,v.strstart=O,Y(v,!1),v.strm.avail_out===0)||v.strstart-v.block_start>=v.w_size-K&&(Y(v,!1),v.strm.avail_out===0))return y}return v.insert=0,ae===c?(Y(v,!0),v.strm.avail_out===0?Fe:re):(v.strstart>v.block_start&&(Y(v,!1),v.strm.avail_out),y)}),new Ze(4,4,8,4,Qt),new Ze(4,5,16,8,Qt),new Ze(4,6,32,32,Qt),new Ze(4,4,16,16,ut),new Ze(8,16,32,32,ut),new Ze(8,16,128,128,ut),new Ze(8,32,128,256,ut),new Ze(32,128,258,1024,ut),new Ze(32,258,258,4096,ut)],t.deflateInit=function(v,ae){return Bi(v,ae,g,15,8,0)},t.deflateInit2=Bi,t.deflateReset=Hi,t.deflateResetKeep=$t,t.deflateSetHeader=function(v,ae){return v&&v.state?v.state.wrap!==2?h:(v.state.gzhead=ae,d):h},t.deflate=function(v,ae){var ie,O,D,$;if(!v||!v.state||5<ae||ae<0)return v?Re(v,h):h;if(O=v.state,!v.output||!v.input&&v.avail_in!==0||O.status===666&&ae!==c)return Re(v,v.avail_out===0?-5:h);if(O.strm=v,ie=O.last_flush,O.last_flush=ae,O.status===P)if(O.wrap===2)v.adler=0,Ve(O,31),Ve(O,139),Ve(O,8),O.gzhead?(Ve(O,(O.gzhead.text?1:0)+(O.gzhead.hcrc?2:0)+(O.gzhead.extra?4:0)+(O.gzhead.name?8:0)+(O.gzhead.comment?16:0)),Ve(O,255&O.gzhead.time),Ve(O,O.gzhead.time>>8&255),Ve(O,O.gzhead.time>>16&255),Ve(O,O.gzhead.time>>24&255),Ve(O,O.level===9?2:2<=O.strategy||O.level<2?4:0),Ve(O,255&O.gzhead.os),O.gzhead.extra&&O.gzhead.extra.length&&(Ve(O,255&O.gzhead.extra.length),Ve(O,O.gzhead.extra.length>>8&255)),O.gzhead.hcrc&&(v.adler=a(v.adler,O.pending_buf,O.pending,0)),O.gzindex=0,O.status=69):(Ve(O,0),Ve(O,0),Ve(O,0),Ve(O,0),Ve(O,0),Ve(O,O.level===9?2:2<=O.strategy||O.level<2?4:0),Ve(O,3),O.status=G);else{var ue=g+(O.w_bits-8<<4)<<8;ue|=(2<=O.strategy||O.level<2?0:O.level<6?1:O.level===6?2:3)<<6,O.strstart!==0&&(ue|=32),ue+=31-ue%31,O.status=G,U(O,ue),O.strstart!==0&&(U(O,v.adler>>>16),U(O,65535&v.adler)),v.adler=1}if(O.status===69)if(O.gzhead.extra){for(D=O.pending;O.gzindex<(65535&O.gzhead.extra.length)&&(O.pending!==O.pending_buf_size||(O.gzhead.hcrc&&O.pending>D&&(v.adler=a(v.adler,O.pending_buf,O.pending-D,D)),ee(v),D=O.pending,O.pending!==O.pending_buf_size));)Ve(O,255&O.gzhead.extra[O.gzindex]),O.gzindex++;O.gzhead.hcrc&&O.pending>D&&(v.adler=a(v.adler,O.pending_buf,O.pending-D,D)),O.gzindex===O.gzhead.extra.length&&(O.gzindex=0,O.status=73)}else O.status=73;if(O.status===73)if(O.gzhead.name){D=O.pending;do{if(O.pending===O.pending_buf_size&&(O.gzhead.hcrc&&O.pending>D&&(v.adler=a(v.adler,O.pending_buf,O.pending-D,D)),ee(v),D=O.pending,O.pending===O.pending_buf_size)){$=1;break}$=O.gzindex<O.gzhead.name.length?255&O.gzhead.name.charCodeAt(O.gzindex++):0,Ve(O,$)}while($!==0);O.gzhead.hcrc&&O.pending>D&&(v.adler=a(v.adler,O.pending_buf,O.pending-D,D)),$===0&&(O.gzindex=0,O.status=91)}else O.status=91;if(O.status===91)if(O.gzhead.comment){D=O.pending;do{if(O.pending===O.pending_buf_size&&(O.gzhead.hcrc&&O.pending>D&&(v.adler=a(v.adler,O.pending_buf,O.pending-D,D)),ee(v),D=O.pending,O.pending===O.pending_buf_size)){$=1;break}$=O.gzindex<O.gzhead.comment.length?255&O.gzhead.comment.charCodeAt(O.gzindex++):0,Ve(O,$)}while($!==0);O.gzhead.hcrc&&O.pending>D&&(v.adler=a(v.adler,O.pending_buf,O.pending-D,D)),$===0&&(O.status=103)}else O.status=103;if(O.status===103&&(O.gzhead.hcrc?(O.pending+2>O.pending_buf_size&&ee(v),O.pending+2<=O.pending_buf_size&&(Ve(O,255&v.adler),Ve(O,v.adler>>8&255),v.adler=0,O.status=G)):O.status=G),O.pending!==0){if(ee(v),v.avail_out===0)return O.last_flush=-1,d}else if(v.avail_in===0&&pe(ae)<=pe(ie)&&ae!==c)return Re(v,-5);if(O.status===666&&v.avail_in!==0)return Re(v,-5);if(v.avail_in!==0||O.lookahead!==0||ae!==u&&O.status!==666){var ce=O.strategy===2?function(X,ge){for(var Ae;;){if(X.lookahead===0&&(Jt(X),X.lookahead===0)){if(ge===u)return y;break}if(X.match_length=0,Ae=s._tr_tally(X,0,X.window[X.strstart]),X.lookahead--,X.strstart++,Ae&&(Y(X,!1),X.strm.avail_out===0))return y}return X.insert=0,ge===c?(Y(X,!0),X.strm.avail_out===0?Fe:re):X.last_lit&&(Y(X,!1),X.strm.avail_out===0)?y:z}(O,ae):O.strategy===3?function(X,ge){for(var Ae,Ce,He,Dt,ft=X.window;;){if(X.lookahead<=E){if(Jt(X),X.lookahead<=E&&ge===u)return y;if(X.lookahead===0)break}if(X.match_length=0,X.lookahead>=T&&0<X.strstart&&(Ce=ft[He=X.strstart-1])===ft[++He]&&Ce===ft[++He]&&Ce===ft[++He]){Dt=X.strstart+E;do;while(Ce===ft[++He]&&Ce===ft[++He]&&Ce===ft[++He]&&Ce===ft[++He]&&Ce===ft[++He]&&Ce===ft[++He]&&Ce===ft[++He]&&Ce===ft[++He]&&He<Dt);X.match_length=E-(Dt-He),X.match_length>X.lookahead&&(X.match_length=X.lookahead)}if(X.match_length>=T?(Ae=s._tr_tally(X,1,X.match_length-T),X.lookahead-=X.match_length,X.strstart+=X.match_length,X.match_length=0):(Ae=s._tr_tally(X,0,X.window[X.strstart]),X.lookahead--,X.strstart++),Ae&&(Y(X,!1),X.strm.avail_out===0))return y}return X.insert=0,ge===c?(Y(X,!0),X.strm.avail_out===0?Fe:re):X.last_lit&&(Y(X,!1),X.strm.avail_out===0)?y:z}(O,ae):i[O.level].func(O,ae);if(ce!==Fe&&ce!==re||(O.status=666),ce===y||ce===Fe)return v.avail_out===0&&(O.last_flush=-1),d;if(ce===z&&(ae===1?s._tr_align(O):ae!==5&&(s._tr_stored_block(O,0,0,!1),ae===3&&(ze(O.head),O.lookahead===0&&(O.strstart=0,O.block_start=0,O.insert=0))),ee(v),v.avail_out===0))return O.last_flush=-1,d}return ae!==c?d:O.wrap<=0?1:(O.wrap===2?(Ve(O,255&v.adler),Ve(O,v.adler>>8&255),Ve(O,v.adler>>16&255),Ve(O,v.adler>>24&255),Ve(O,255&v.total_in),Ve(O,v.total_in>>8&255),Ve(O,v.total_in>>16&255),Ve(O,v.total_in>>24&255)):(U(O,v.adler>>>16),U(O,65535&v.adler)),ee(v),0<O.wrap&&(O.wrap=-O.wrap),O.pending!==0?d:1)},t.deflateEnd=function(v){var ae;return v&&v.state?(ae=v.state.status)!==P&&ae!==69&&ae!==73&&ae!==91&&ae!==103&&ae!==G&&ae!==666?Re(v,h):(v.state=null,ae===G?Re(v,-3):d):h},t.deflateSetDictionary=function(v,ae){var ie,O,D,$,ue,ce,X,ge,Ae=ae.length;if(!v||!v.state||($=(ie=v.state).wrap)===2||$===1&&ie.status!==P||ie.lookahead)return h;for($===1&&(v.adler=o(v.adler,ae,Ae,0)),ie.wrap=0,Ae>=ie.w_size&&($===0&&(ze(ie.head),ie.strstart=0,ie.block_start=0,ie.insert=0),ge=new n.Buf8(ie.w_size),n.arraySet(ge,ae,Ae-ie.w_size,ie.w_size,0),ae=ge,Ae=ie.w_size),ue=v.avail_in,ce=v.next_in,X=v.input,v.avail_in=Ae,v.next_in=0,v.input=ae,Jt(ie);ie.lookahead>=T;){for(O=ie.strstart,D=ie.lookahead-(T-1);ie.ins_h=(ie.ins_h<<ie.hash_shift^ie.window[O+T-1])&ie.hash_mask,ie.prev[O&ie.w_mask]=ie.head[ie.ins_h],ie.head[ie.ins_h]=O,O++,--D;);ie.strstart=O,ie.lookahead=T-1,Jt(ie)}return ie.strstart+=ie.lookahead,ie.block_start=ie.strstart,ie.insert=ie.lookahead,ie.lookahead=0,ie.match_length=ie.prev_length=T-1,ie.match_available=0,v.next_in=ce,v.input=X,v.avail_in=ue,ie.wrap=$,d},t.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,e,t){"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,e,t){"use strict";e.exports=function(i,n){var s,o,a,l,u,c,d,h,f,m,p,g,b,F,w,_,I,A,T,E,K,P,G,y,z;s=i.state,o=i.next_in,y=i.input,a=o+(i.avail_in-5),l=i.next_out,z=i.output,u=l-(n-i.avail_out),c=l+(i.avail_out-257),d=s.dmax,h=s.wsize,f=s.whave,m=s.wnext,p=s.window,g=s.hold,b=s.bits,F=s.lencode,w=s.distcode,_=(1<<s.lenbits)-1,I=(1<<s.distbits)-1;e:do{b<15&&(g+=y[o++]<<b,b+=8,g+=y[o++]<<b,b+=8),A=F[g&_];t:for(;;){if(g>>>=T=A>>>24,b-=T,(T=A>>>16&255)===0)z[l++]=65535&A;else{if(!(16&T)){if((64&T)==0){A=F[(65535&A)+(g&(1<<T)-1)];continue t}if(32&T){s.mode=12;break e}i.msg="invalid literal/length code",s.mode=30;break e}E=65535&A,(T&=15)&&(b<T&&(g+=y[o++]<<b,b+=8),E+=g&(1<<T)-1,g>>>=T,b-=T),b<15&&(g+=y[o++]<<b,b+=8,g+=y[o++]<<b,b+=8),A=w[g&I];i:for(;;){if(g>>>=T=A>>>24,b-=T,!(16&(T=A>>>16&255))){if((64&T)==0){A=w[(65535&A)+(g&(1<<T)-1)];continue i}i.msg="invalid distance code",s.mode=30;break e}if(K=65535&A,b<(T&=15)&&(g+=y[o++]<<b,(b+=8)<T&&(g+=y[o++]<<b,b+=8)),d<(K+=g&(1<<T)-1)){i.msg="invalid distance too far back",s.mode=30;break e}if(g>>>=T,b-=T,(T=l-u)<K){if(f<(T=K-T)&&s.sane){i.msg="invalid distance too far back",s.mode=30;break e}if(G=p,(P=0)===m){if(P+=h-T,T<E){for(E-=T;z[l++]=p[P++],--T;);P=l-K,G=z}}else if(m<T){if(P+=h+m-T,(T-=m)<E){for(E-=T;z[l++]=p[P++],--T;);if(P=0,m<E){for(E-=T=m;z[l++]=p[P++],--T;);P=l-K,G=z}}}else if(P+=m-T,T<E){for(E-=T;z[l++]=p[P++],--T;);P=l-K,G=z}for(;2<E;)z[l++]=G[P++],z[l++]=G[P++],z[l++]=G[P++],E-=3;E&&(z[l++]=G[P++],1<E&&(z[l++]=G[P++]))}else{for(P=l-K;z[l++]=z[P++],z[l++]=z[P++],z[l++]=z[P++],2<(E-=3););E&&(z[l++]=z[P++],1<E&&(z[l++]=z[P++]))}break}}break}}while(o<a&&l<c);o-=E=b>>3,g&=(1<<(b-=E<<3))-1,i.next_in=o,i.next_out=l,i.avail_in=o<a?a-o+5:5-(o-a),i.avail_out=l<c?c-l+257:257-(l-c),s.hold=g,s.bits=b}},{}],49:[function(r,e,t){"use strict";var i=r("../utils/common"),n=r("./adler32"),s=r("./crc32"),o=r("./inffast"),a=r("./inftrees"),l=1,u=2,c=0,d=-2,h=1,f=852,m=592;function p(P){return(P>>>24&255)+(P>>>8&65280)+((65280&P)<<8)+((255&P)<<24)}function g(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function b(P){var G;return P&&P.state?(G=P.state,P.total_in=P.total_out=G.total=0,P.msg="",G.wrap&&(P.adler=1&G.wrap),G.mode=h,G.last=0,G.havedict=0,G.dmax=32768,G.head=null,G.hold=0,G.bits=0,G.lencode=G.lendyn=new i.Buf32(f),G.distcode=G.distdyn=new i.Buf32(m),G.sane=1,G.back=-1,c):d}function F(P){var G;return P&&P.state?((G=P.state).wsize=0,G.whave=0,G.wnext=0,b(P)):d}function w(P,G){var y,z;return P&&P.state?(z=P.state,G<0?(y=0,G=-G):(y=1+(G>>4),G<48&&(G&=15)),G&&(G<8||15<G)?d:(z.window!==null&&z.wbits!==G&&(z.window=null),z.wrap=y,z.wbits=G,F(P))):d}function _(P,G){var y,z;return P?(z=new g,(P.state=z).window=null,(y=w(P,G))!==c&&(P.state=null),y):d}var I,A,T=!0;function E(P){if(T){var G;for(I=new i.Buf32(512),A=new i.Buf32(32),G=0;G<144;)P.lens[G++]=8;for(;G<256;)P.lens[G++]=9;for(;G<280;)P.lens[G++]=7;for(;G<288;)P.lens[G++]=8;for(a(l,P.lens,0,288,I,0,P.work,{bits:9}),G=0;G<32;)P.lens[G++]=5;a(u,P.lens,0,32,A,0,P.work,{bits:5}),T=!1}P.lencode=I,P.lenbits=9,P.distcode=A,P.distbits=5}function K(P,G,y,z){var Fe,re=P.state;return re.window===null&&(re.wsize=1<<re.wbits,re.wnext=0,re.whave=0,re.window=new i.Buf8(re.wsize)),z>=re.wsize?(i.arraySet(re.window,G,y-re.wsize,re.wsize,0),re.wnext=0,re.whave=re.wsize):(z<(Fe=re.wsize-re.wnext)&&(Fe=z),i.arraySet(re.window,G,y-z,Fe,re.wnext),(z-=Fe)?(i.arraySet(re.window,G,y-z,z,0),re.wnext=z,re.whave=re.wsize):(re.wnext+=Fe,re.wnext===re.wsize&&(re.wnext=0),re.whave<re.wsize&&(re.whave+=Fe))),0}t.inflateReset=F,t.inflateReset2=w,t.inflateResetKeep=b,t.inflateInit=function(P){return _(P,15)},t.inflateInit2=_,t.inflate=function(P,G){var y,z,Fe,re,Re,pe,ze,ee,Y,Ve,U,me,Jt,Qt,ut,Ze,Xt,$t,Hi,Bi,v,ae,ie,O,D=0,$=new i.Buf8(4),ue=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!P||!P.state||!P.output||!P.input&&P.avail_in!==0)return d;(y=P.state).mode===12&&(y.mode=13),Re=P.next_out,Fe=P.output,ze=P.avail_out,re=P.next_in,z=P.input,pe=P.avail_in,ee=y.hold,Y=y.bits,Ve=pe,U=ze,ae=c;e:for(;;)switch(y.mode){case h:if(y.wrap===0){y.mode=13;break}for(;Y<16;){if(pe===0)break e;pe--,ee+=z[re++]<<Y,Y+=8}if(2&y.wrap&&ee===35615){$[y.check=0]=255&ee,$[1]=ee>>>8&255,y.check=s(y.check,$,2,0),Y=ee=0,y.mode=2;break}if(y.flags=0,y.head&&(y.head.done=!1),!(1&y.wrap)||(((255&ee)<<8)+(ee>>8))%31){P.msg="incorrect header check",y.mode=30;break}if((15&ee)!=8){P.msg="unknown compression method",y.mode=30;break}if(Y-=4,v=8+(15&(ee>>>=4)),y.wbits===0)y.wbits=v;else if(v>y.wbits){P.msg="invalid window size",y.mode=30;break}y.dmax=1<<v,P.adler=y.check=1,y.mode=512&ee?10:12,Y=ee=0;break;case 2:for(;Y<16;){if(pe===0)break e;pe--,ee+=z[re++]<<Y,Y+=8}if(y.flags=ee,(255&y.flags)!=8){P.msg="unknown compression method",y.mode=30;break}if(57344&y.flags){P.msg="unknown header flags set",y.mode=30;break}y.head&&(y.head.text=ee>>8&1),512&y.flags&&($[0]=255&ee,$[1]=ee>>>8&255,y.check=s(y.check,$,2,0)),Y=ee=0,y.mode=3;case 3:for(;Y<32;){if(pe===0)break e;pe--,ee+=z[re++]<<Y,Y+=8}y.head&&(y.head.time=ee),512&y.flags&&($[0]=255&ee,$[1]=ee>>>8&255,$[2]=ee>>>16&255,$[3]=ee>>>24&255,y.check=s(y.check,$,4,0)),Y=ee=0,y.mode=4;case 4:for(;Y<16;){if(pe===0)break e;pe--,ee+=z[re++]<<Y,Y+=8}y.head&&(y.head.xflags=255&ee,y.head.os=ee>>8),512&y.flags&&($[0]=255&ee,$[1]=ee>>>8&255,y.check=s(y.check,$,2,0)),Y=ee=0,y.mode=5;case 5:if(1024&y.flags){for(;Y<16;){if(pe===0)break e;pe--,ee+=z[re++]<<Y,Y+=8}y.length=ee,y.head&&(y.head.extra_len=ee),512&y.flags&&($[0]=255&ee,$[1]=ee>>>8&255,y.check=s(y.check,$,2,0)),Y=ee=0}else y.head&&(y.head.extra=null);y.mode=6;case 6:if(1024&y.flags&&(pe<(me=y.length)&&(me=pe),me&&(y.head&&(v=y.head.extra_len-y.length,y.head.extra||(y.head.extra=new Array(y.head.extra_len)),i.arraySet(y.head.extra,z,re,me,v)),512&y.flags&&(y.check=s(y.check,z,me,re)),pe-=me,re+=me,y.length-=me),y.length))break e;y.length=0,y.mode=7;case 7:if(2048&y.flags){if(pe===0)break e;for(me=0;v=z[re+me++],y.head&&v&&y.length<65536&&(y.head.name+=String.fromCharCode(v)),v&&me<pe;);if(512&y.flags&&(y.check=s(y.check,z,me,re)),pe-=me,re+=me,v)break e}else y.head&&(y.head.name=null);y.length=0,y.mode=8;case 8:if(4096&y.flags){if(pe===0)break e;for(me=0;v=z[re+me++],y.head&&v&&y.length<65536&&(y.head.comment+=String.fromCharCode(v)),v&&me<pe;);if(512&y.flags&&(y.check=s(y.check,z,me,re)),pe-=me,re+=me,v)break e}else y.head&&(y.head.comment=null);y.mode=9;case 9:if(512&y.flags){for(;Y<16;){if(pe===0)break e;pe--,ee+=z[re++]<<Y,Y+=8}if(ee!==(65535&y.check)){P.msg="header crc mismatch",y.mode=30;break}Y=ee=0}y.head&&(y.head.hcrc=y.flags>>9&1,y.head.done=!0),P.adler=y.check=0,y.mode=12;break;case 10:for(;Y<32;){if(pe===0)break e;pe--,ee+=z[re++]<<Y,Y+=8}P.adler=y.check=p(ee),Y=ee=0,y.mode=11;case 11:if(y.havedict===0)return P.next_out=Re,P.avail_out=ze,P.next_in=re,P.avail_in=pe,y.hold=ee,y.bits=Y,2;P.adler=y.check=1,y.mode=12;case 12:if(G===5||G===6)break e;case 13:if(y.last){ee>>>=7&Y,Y-=7&Y,y.mode=27;break}for(;Y<3;){if(pe===0)break e;pe--,ee+=z[re++]<<Y,Y+=8}switch(y.last=1&ee,Y-=1,3&(ee>>>=1)){case 0:y.mode=14;break;case 1:if(E(y),y.mode=20,G!==6)break;ee>>>=2,Y-=2;break e;case 2:y.mode=17;break;case 3:P.msg="invalid block type",y.mode=30}ee>>>=2,Y-=2;break;case 14:for(ee>>>=7&Y,Y-=7&Y;Y<32;){if(pe===0)break e;pe--,ee+=z[re++]<<Y,Y+=8}if((65535&ee)!=(ee>>>16^65535)){P.msg="invalid stored block lengths",y.mode=30;break}if(y.length=65535&ee,Y=ee=0,y.mode=15,G===6)break e;case 15:y.mode=16;case 16:if(me=y.length){if(pe<me&&(me=pe),ze<me&&(me=ze),me===0)break e;i.arraySet(Fe,z,re,me,Re),pe-=me,re+=me,ze-=me,Re+=me,y.length-=me;break}y.mode=12;break;case 17:for(;Y<14;){if(pe===0)break e;pe--,ee+=z[re++]<<Y,Y+=8}if(y.nlen=257+(31&ee),ee>>>=5,Y-=5,y.ndist=1+(31&ee),ee>>>=5,Y-=5,y.ncode=4+(15&ee),ee>>>=4,Y-=4,286<y.nlen||30<y.ndist){P.msg="too many length or distance symbols",y.mode=30;break}y.have=0,y.mode=18;case 18:for(;y.have<y.ncode;){for(;Y<3;){if(pe===0)break e;pe--,ee+=z[re++]<<Y,Y+=8}y.lens[ue[y.have++]]=7&ee,ee>>>=3,Y-=3}for(;y.have<19;)y.lens[ue[y.have++]]=0;if(y.lencode=y.lendyn,y.lenbits=7,ie={bits:y.lenbits},ae=a(0,y.lens,0,19,y.lencode,0,y.work,ie),y.lenbits=ie.bits,ae){P.msg="invalid code lengths set",y.mode=30;break}y.have=0,y.mode=19;case 19:for(;y.have<y.nlen+y.ndist;){for(;Ze=(D=y.lencode[ee&(1<<y.lenbits)-1])>>>16&255,Xt=65535&D,!((ut=D>>>24)<=Y);){if(pe===0)break e;pe--,ee+=z[re++]<<Y,Y+=8}if(Xt<16)ee>>>=ut,Y-=ut,y.lens[y.have++]=Xt;else{if(Xt===16){for(O=ut+2;Y<O;){if(pe===0)break e;pe--,ee+=z[re++]<<Y,Y+=8}if(ee>>>=ut,Y-=ut,y.have===0){P.msg="invalid bit length repeat",y.mode=30;break}v=y.lens[y.have-1],me=3+(3&ee),ee>>>=2,Y-=2}else if(Xt===17){for(O=ut+3;Y<O;){if(pe===0)break e;pe--,ee+=z[re++]<<Y,Y+=8}Y-=ut,v=0,me=3+(7&(ee>>>=ut)),ee>>>=3,Y-=3}else{for(O=ut+7;Y<O;){if(pe===0)break e;pe--,ee+=z[re++]<<Y,Y+=8}Y-=ut,v=0,me=11+(127&(ee>>>=ut)),ee>>>=7,Y-=7}if(y.have+me>y.nlen+y.ndist){P.msg="invalid bit length repeat",y.mode=30;break}for(;me--;)y.lens[y.have++]=v}}if(y.mode===30)break;if(y.lens[256]===0){P.msg="invalid code -- missing end-of-block",y.mode=30;break}if(y.lenbits=9,ie={bits:y.lenbits},ae=a(l,y.lens,0,y.nlen,y.lencode,0,y.work,ie),y.lenbits=ie.bits,ae){P.msg="invalid literal/lengths set",y.mode=30;break}if(y.distbits=6,y.distcode=y.distdyn,ie={bits:y.distbits},ae=a(u,y.lens,y.nlen,y.ndist,y.distcode,0,y.work,ie),y.distbits=ie.bits,ae){P.msg="invalid distances set",y.mode=30;break}if(y.mode=20,G===6)break e;case 20:y.mode=21;case 21:if(6<=pe&&258<=ze){P.next_out=Re,P.avail_out=ze,P.next_in=re,P.avail_in=pe,y.hold=ee,y.bits=Y,o(P,U),Re=P.next_out,Fe=P.output,ze=P.avail_out,re=P.next_in,z=P.input,pe=P.avail_in,ee=y.hold,Y=y.bits,y.mode===12&&(y.back=-1);break}for(y.back=0;Ze=(D=y.lencode[ee&(1<<y.lenbits)-1])>>>16&255,Xt=65535&D,!((ut=D>>>24)<=Y);){if(pe===0)break e;pe--,ee+=z[re++]<<Y,Y+=8}if(Ze&&(240&Ze)==0){for($t=ut,Hi=Ze,Bi=Xt;Ze=(D=y.lencode[Bi+((ee&(1<<$t+Hi)-1)>>$t)])>>>16&255,Xt=65535&D,!($t+(ut=D>>>24)<=Y);){if(pe===0)break e;pe--,ee+=z[re++]<<Y,Y+=8}ee>>>=$t,Y-=$t,y.back+=$t}if(ee>>>=ut,Y-=ut,y.back+=ut,y.length=Xt,Ze===0){y.mode=26;break}if(32&Ze){y.back=-1,y.mode=12;break}if(64&Ze){P.msg="invalid literal/length code",y.mode=30;break}y.extra=15&Ze,y.mode=22;case 22:if(y.extra){for(O=y.extra;Y<O;){if(pe===0)break e;pe--,ee+=z[re++]<<Y,Y+=8}y.length+=ee&(1<<y.extra)-1,ee>>>=y.extra,Y-=y.extra,y.back+=y.extra}y.was=y.length,y.mode=23;case 23:for(;Ze=(D=y.distcode[ee&(1<<y.distbits)-1])>>>16&255,Xt=65535&D,!((ut=D>>>24)<=Y);){if(pe===0)break e;pe--,ee+=z[re++]<<Y,Y+=8}if((240&Ze)==0){for($t=ut,Hi=Ze,Bi=Xt;Ze=(D=y.distcode[Bi+((ee&(1<<$t+Hi)-1)>>$t)])>>>16&255,Xt=65535&D,!($t+(ut=D>>>24)<=Y);){if(pe===0)break e;pe--,ee+=z[re++]<<Y,Y+=8}ee>>>=$t,Y-=$t,y.back+=$t}if(ee>>>=ut,Y-=ut,y.back+=ut,64&Ze){P.msg="invalid distance code",y.mode=30;break}y.offset=Xt,y.extra=15&Ze,y.mode=24;case 24:if(y.extra){for(O=y.extra;Y<O;){if(pe===0)break e;pe--,ee+=z[re++]<<Y,Y+=8}y.offset+=ee&(1<<y.extra)-1,ee>>>=y.extra,Y-=y.extra,y.back+=y.extra}if(y.offset>y.dmax){P.msg="invalid distance too far back",y.mode=30;break}y.mode=25;case 25:if(ze===0)break e;if(me=U-ze,y.offset>me){if((me=y.offset-me)>y.whave&&y.sane){P.msg="invalid distance too far back",y.mode=30;break}Jt=me>y.wnext?(me-=y.wnext,y.wsize-me):y.wnext-me,me>y.length&&(me=y.length),Qt=y.window}else Qt=Fe,Jt=Re-y.offset,me=y.length;for(ze<me&&(me=ze),ze-=me,y.length-=me;Fe[Re++]=Qt[Jt++],--me;);y.length===0&&(y.mode=21);break;case 26:if(ze===0)break e;Fe[Re++]=y.length,ze--,y.mode=21;break;case 27:if(y.wrap){for(;Y<32;){if(pe===0)break e;pe--,ee|=z[re++]<<Y,Y+=8}if(U-=ze,P.total_out+=U,y.total+=U,U&&(P.adler=y.check=y.flags?s(y.check,Fe,U,Re-U):n(y.check,Fe,U,Re-U)),U=ze,(y.flags?ee:p(ee))!==y.check){P.msg="incorrect data check",y.mode=30;break}Y=ee=0}y.mode=28;case 28:if(y.wrap&&y.flags){for(;Y<32;){if(pe===0)break e;pe--,ee+=z[re++]<<Y,Y+=8}if(ee!==(4294967295&y.total)){P.msg="incorrect length check",y.mode=30;break}Y=ee=0}y.mode=29;case 29:ae=1;break e;case 30:ae=-3;break e;case 31:return-4;case 32:default:return d}return P.next_out=Re,P.avail_out=ze,P.next_in=re,P.avail_in=pe,y.hold=ee,y.bits=Y,(y.wsize||U!==P.avail_out&&y.mode<30&&(y.mode<27||G!==4))&&K(P,P.output,P.next_out,U-P.avail_out)?(y.mode=31,-4):(Ve-=P.avail_in,U-=P.avail_out,P.total_in+=Ve,P.total_out+=U,y.total+=U,y.wrap&&U&&(P.adler=y.check=y.flags?s(y.check,Fe,U,P.next_out-U):n(y.check,Fe,U,P.next_out-U)),P.data_type=y.bits+(y.last?64:0)+(y.mode===12?128:0)+(y.mode===20||y.mode===15?256:0),(Ve==0&&U===0||G===4)&&ae===c&&(ae=-5),ae)},t.inflateEnd=function(P){if(!P||!P.state)return d;var G=P.state;return G.window&&(G.window=null),P.state=null,c},t.inflateGetHeader=function(P,G){var y;return P&&P.state?(2&(y=P.state).wrap)==0?d:((y.head=G).done=!1,c):d},t.inflateSetDictionary=function(P,G){var y,z=G.length;return P&&P.state?(y=P.state).wrap!==0&&y.mode!==11?d:y.mode===11&&n(1,G,z,0)!==y.check?-3:K(P,G,z,z)?(y.mode=31,-4):(y.havedict=1,c):d},t.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,e,t){"use strict";var i=r("../utils/common"),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(l,u,c,d,h,f,m,p){var g,b,F,w,_,I,A,T,E,K=p.bits,P=0,G=0,y=0,z=0,Fe=0,re=0,Re=0,pe=0,ze=0,ee=0,Y=null,Ve=0,U=new i.Buf16(16),me=new i.Buf16(16),Jt=null,Qt=0;for(P=0;P<=15;P++)U[P]=0;for(G=0;G<d;G++)U[u[c+G]]++;for(Fe=K,z=15;1<=z&&U[z]===0;z--);if(z<Fe&&(Fe=z),z===0)return h[f++]=20971520,h[f++]=20971520,p.bits=1,0;for(y=1;y<z&&U[y]===0;y++);for(Fe<y&&(Fe=y),P=pe=1;P<=15;P++)if(pe<<=1,(pe-=U[P])<0)return-1;if(0<pe&&(l===0||z!==1))return-1;for(me[1]=0,P=1;P<15;P++)me[P+1]=me[P]+U[P];for(G=0;G<d;G++)u[c+G]!==0&&(m[me[u[c+G]]++]=G);if(I=l===0?(Y=Jt=m,19):l===1?(Y=n,Ve-=257,Jt=s,Qt-=257,256):(Y=o,Jt=a,-1),P=y,_=f,Re=G=ee=0,F=-1,w=(ze=1<<(re=Fe))-1,l===1&&852<ze||l===2&&592<ze)return 1;for(;;){for(A=P-Re,E=m[G]<I?(T=0,m[G]):m[G]>I?(T=Jt[Qt+m[G]],Y[Ve+m[G]]):(T=96,0),g=1<<P-Re,y=b=1<<re;h[_+(ee>>Re)+(b-=g)]=A<<24|T<<16|E|0,b!==0;);for(g=1<<P-1;ee&g;)g>>=1;if(g!==0?(ee&=g-1,ee+=g):ee=0,G++,--U[P]==0){if(P===z)break;P=u[c+m[G]]}if(Fe<P&&(ee&w)!==F){for(Re===0&&(Re=Fe),_+=y,pe=1<<(re=P-Re);re+Re<z&&!((pe-=U[re+Re])<=0);)re++,pe<<=1;if(ze+=1<<re,l===1&&852<ze||l===2&&592<ze)return 1;h[F=ee&w]=Fe<<24|re<<16|_-f|0}}return ee!==0&&(h[_+ee]=P-Re<<24|64<<16|0),p.bits=Fe,0}},{"../utils/common":41}],51:[function(r,e,t){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,e,t){"use strict";var i=r("../utils/common"),n=0,s=1;function o(D){for(var $=D.length;0<=--$;)D[$]=0}var a=0,l=29,u=256,c=u+1+l,d=30,h=19,f=2*c+1,m=15,p=16,g=7,b=256,F=16,w=17,_=18,I=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],A=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],E=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=new Array(2*(c+2));o(K);var P=new Array(2*d);o(P);var G=new Array(512);o(G);var y=new Array(256);o(y);var z=new Array(l);o(z);var Fe,re,Re,pe=new Array(d);function ze(D,$,ue,ce,X){this.static_tree=D,this.extra_bits=$,this.extra_base=ue,this.elems=ce,this.max_length=X,this.has_stree=D&&D.length}function ee(D,$){this.dyn_tree=D,this.max_code=0,this.stat_desc=$}function Y(D){return D<256?G[D]:G[256+(D>>>7)]}function Ve(D,$){D.pending_buf[D.pending++]=255&$,D.pending_buf[D.pending++]=$>>>8&255}function U(D,$,ue){D.bi_valid>p-ue?(D.bi_buf|=$<<D.bi_valid&65535,Ve(D,D.bi_buf),D.bi_buf=$>>p-D.bi_valid,D.bi_valid+=ue-p):(D.bi_buf|=$<<D.bi_valid&65535,D.bi_valid+=ue)}function me(D,$,ue){U(D,ue[2*$],ue[2*$+1])}function Jt(D,$){for(var ue=0;ue|=1&D,D>>>=1,ue<<=1,0<--$;);return ue>>>1}function Qt(D,$,ue){var ce,X,ge=new Array(m+1),Ae=0;for(ce=1;ce<=m;ce++)ge[ce]=Ae=Ae+ue[ce-1]<<1;for(X=0;X<=$;X++){var Ce=D[2*X+1];Ce!==0&&(D[2*X]=Jt(ge[Ce]++,Ce))}}function ut(D){var $;for($=0;$<c;$++)D.dyn_ltree[2*$]=0;for($=0;$<d;$++)D.dyn_dtree[2*$]=0;for($=0;$<h;$++)D.bl_tree[2*$]=0;D.dyn_ltree[2*b]=1,D.opt_len=D.static_len=0,D.last_lit=D.matches=0}function Ze(D){8<D.bi_valid?Ve(D,D.bi_buf):0<D.bi_valid&&(D.pending_buf[D.pending++]=D.bi_buf),D.bi_buf=0,D.bi_valid=0}function Xt(D,$,ue,ce){var X=2*$,ge=2*ue;return D[X]<D[ge]||D[X]===D[ge]&&ce[$]<=ce[ue]}function $t(D,$,ue){for(var ce=D.heap[ue],X=ue<<1;X<=D.heap_len&&(X<D.heap_len&&Xt($,D.heap[X+1],D.heap[X],D.depth)&&X++,!Xt($,ce,D.heap[X],D.depth));)D.heap[ue]=D.heap[X],ue=X,X<<=1;D.heap[ue]=ce}function Hi(D,$,ue){var ce,X,ge,Ae,Ce=0;if(D.last_lit!==0)for(;ce=D.pending_buf[D.d_buf+2*Ce]<<8|D.pending_buf[D.d_buf+2*Ce+1],X=D.pending_buf[D.l_buf+Ce],Ce++,ce===0?me(D,X,$):(me(D,(ge=y[X])+u+1,$),(Ae=I[ge])!==0&&U(D,X-=z[ge],Ae),me(D,ge=Y(--ce),ue),(Ae=A[ge])!==0&&U(D,ce-=pe[ge],Ae)),Ce<D.last_lit;);me(D,b,$)}function Bi(D,$){var ue,ce,X,ge=$.dyn_tree,Ae=$.stat_desc.static_tree,Ce=$.stat_desc.has_stree,He=$.stat_desc.elems,Dt=-1;for(D.heap_len=0,D.heap_max=f,ue=0;ue<He;ue++)ge[2*ue]!==0?(D.heap[++D.heap_len]=Dt=ue,D.depth[ue]=0):ge[2*ue+1]=0;for(;D.heap_len<2;)ge[2*(X=D.heap[++D.heap_len]=Dt<2?++Dt:0)]=1,D.depth[X]=0,D.opt_len--,Ce&&(D.static_len-=Ae[2*X+1]);for($.max_code=Dt,ue=D.heap_len>>1;1<=ue;ue--)$t(D,ge,ue);for(X=He;ue=D.heap[1],D.heap[1]=D.heap[D.heap_len--],$t(D,ge,1),ce=D.heap[1],D.heap[--D.heap_max]=ue,D.heap[--D.heap_max]=ce,ge[2*X]=ge[2*ue]+ge[2*ce],D.depth[X]=(D.depth[ue]>=D.depth[ce]?D.depth[ue]:D.depth[ce])+1,ge[2*ue+1]=ge[2*ce+1]=X,D.heap[1]=X++,$t(D,ge,1),2<=D.heap_len;);D.heap[--D.heap_max]=D.heap[1],function(ft,Fi){var Mr,Li,Nr,Gt,ln,Dn,qi=Fi.dyn_tree,An=Fi.max_code,_r=Fi.stat_desc.static_tree,Rn=Fi.stat_desc.has_stree,jr=Fi.stat_desc.extra_bits,Fr=Fi.stat_desc.extra_base,un=Fi.stat_desc.max_length,Oi=0;for(Gt=0;Gt<=m;Gt++)ft.bl_count[Gt]=0;for(qi[2*ft.heap[ft.heap_max]+1]=0,Mr=ft.heap_max+1;Mr<f;Mr++)un<(Gt=qi[2*qi[2*(Li=ft.heap[Mr])+1]+1]+1)&&(Gt=un,Oi++),qi[2*Li+1]=Gt,An<Li||(ft.bl_count[Gt]++,ln=0,Fr<=Li&&(ln=jr[Li-Fr]),Dn=qi[2*Li],ft.opt_len+=Dn*(Gt+ln),Rn&&(ft.static_len+=Dn*(_r[2*Li+1]+ln)));if(Oi!==0){do{for(Gt=un-1;ft.bl_count[Gt]===0;)Gt--;ft.bl_count[Gt]--,ft.bl_count[Gt+1]+=2,ft.bl_count[un]--,Oi-=2}while(0<Oi);for(Gt=un;Gt!==0;Gt--)for(Li=ft.bl_count[Gt];Li!==0;)An<(Nr=ft.heap[--Mr])||(qi[2*Nr+1]!==Gt&&(ft.opt_len+=(Gt-qi[2*Nr+1])*qi[2*Nr],qi[2*Nr+1]=Gt),Li--)}}(D,$),Qt(ge,Dt,D.bl_count)}function v(D,$,ue){var ce,X,ge=-1,Ae=$[1],Ce=0,He=7,Dt=4;for(Ae===0&&(He=138,Dt=3),$[2*(ue+1)+1]=65535,ce=0;ce<=ue;ce++)X=Ae,Ae=$[2*(ce+1)+1],++Ce<He&&X===Ae||(Ce<Dt?D.bl_tree[2*X]+=Ce:X!==0?(X!==ge&&D.bl_tree[2*X]++,D.bl_tree[2*F]++):Ce<=10?D.bl_tree[2*w]++:D.bl_tree[2*_]++,ge=X,Dt=(Ce=0)===Ae?(He=138,3):X===Ae?(He=6,3):(He=7,4))}function ae(D,$,ue){var ce,X,ge=-1,Ae=$[1],Ce=0,He=7,Dt=4;for(Ae===0&&(He=138,Dt=3),ce=0;ce<=ue;ce++)if(X=Ae,Ae=$[2*(ce+1)+1],!(++Ce<He&&X===Ae)){if(Ce<Dt)for(;me(D,X,D.bl_tree),--Ce!=0;);else X!==0?(X!==ge&&(me(D,X,D.bl_tree),Ce--),me(D,F,D.bl_tree),U(D,Ce-3,2)):Ce<=10?(me(D,w,D.bl_tree),U(D,Ce-3,3)):(me(D,_,D.bl_tree),U(D,Ce-11,7));ge=X,Dt=(Ce=0)===Ae?(He=138,3):X===Ae?(He=6,3):(He=7,4)}}o(pe);var ie=!1;function O(D,$,ue,ce){U(D,(a<<1)+(ce?1:0),3),function(X,ge,Ae,Ce){Ze(X),Ce&&(Ve(X,Ae),Ve(X,~Ae)),i.arraySet(X.pending_buf,X.window,ge,Ae,X.pending),X.pending+=Ae}(D,$,ue,!0)}t._tr_init=function(D){ie||(function(){var $,ue,ce,X,ge,Ae=new Array(m+1);for(X=ce=0;X<l-1;X++)for(z[X]=ce,$=0;$<1<<I[X];$++)y[ce++]=X;for(y[ce-1]=X,X=ge=0;X<16;X++)for(pe[X]=ge,$=0;$<1<<A[X];$++)G[ge++]=X;for(ge>>=7;X<d;X++)for(pe[X]=ge<<7,$=0;$<1<<A[X]-7;$++)G[256+ge++]=X;for(ue=0;ue<=m;ue++)Ae[ue]=0;for($=0;$<=143;)K[2*$+1]=8,$++,Ae[8]++;for(;$<=255;)K[2*$+1]=9,$++,Ae[9]++;for(;$<=279;)K[2*$+1]=7,$++,Ae[7]++;for(;$<=287;)K[2*$+1]=8,$++,Ae[8]++;for(Qt(K,c+1,Ae),$=0;$<d;$++)P[2*$+1]=5,P[2*$]=Jt($,5);Fe=new ze(K,I,u+1,c,m),re=new ze(P,A,0,d,m),Re=new ze(new Array(0),T,0,h,g)}(),ie=!0),D.l_desc=new ee(D.dyn_ltree,Fe),D.d_desc=new ee(D.dyn_dtree,re),D.bl_desc=new ee(D.bl_tree,Re),D.bi_buf=0,D.bi_valid=0,ut(D)},t._tr_stored_block=O,t._tr_flush_block=function(D,$,ue,ce){var X,ge,Ae=0;0<D.level?(D.strm.data_type===2&&(D.strm.data_type=function(Ce){var He,Dt=4093624447;for(He=0;He<=31;He++,Dt>>>=1)if(1&Dt&&Ce.dyn_ltree[2*He]!==0)return n;if(Ce.dyn_ltree[18]!==0||Ce.dyn_ltree[20]!==0||Ce.dyn_ltree[26]!==0)return s;for(He=32;He<u;He++)if(Ce.dyn_ltree[2*He]!==0)return s;return n}(D)),Bi(D,D.l_desc),Bi(D,D.d_desc),Ae=function(Ce){var He;for(v(Ce,Ce.dyn_ltree,Ce.l_desc.max_code),v(Ce,Ce.dyn_dtree,Ce.d_desc.max_code),Bi(Ce,Ce.bl_desc),He=h-1;3<=He&&Ce.bl_tree[2*E[He]+1]===0;He--);return Ce.opt_len+=3*(He+1)+5+5+4,He}(D),X=D.opt_len+3+7>>>3,(ge=D.static_len+3+7>>>3)<=X&&(X=ge)):X=ge=ue+5,ue+4<=X&&$!==-1?O(D,$,ue,ce):D.strategy===4||ge===X?(U(D,2+(ce?1:0),3),Hi(D,K,P)):(U(D,4+(ce?1:0),3),function(Ce,He,Dt,ft){var Fi;for(U(Ce,He-257,5),U(Ce,Dt-1,5),U(Ce,ft-4,4),Fi=0;Fi<ft;Fi++)U(Ce,Ce.bl_tree[2*E[Fi]+1],3);ae(Ce,Ce.dyn_ltree,He-1),ae(Ce,Ce.dyn_dtree,Dt-1)}(D,D.l_desc.max_code+1,D.d_desc.max_code+1,Ae+1),Hi(D,D.dyn_ltree,D.dyn_dtree)),ut(D),ce&&Ze(D)},t._tr_tally=function(D,$,ue){return D.pending_buf[D.d_buf+2*D.last_lit]=$>>>8&255,D.pending_buf[D.d_buf+2*D.last_lit+1]=255&$,D.pending_buf[D.l_buf+D.last_lit]=255&ue,D.last_lit++,$===0?D.dyn_ltree[2*ue]++:(D.matches++,$--,D.dyn_ltree[2*(y[ue]+u+1)]++,D.dyn_dtree[2*Y($)]++),D.last_lit===D.lit_bufsize-1},t._tr_align=function(D){U(D,2,3),me(D,b,K),function($){$.bi_valid===16?(Ve($,$.bi_buf),$.bi_buf=0,$.bi_valid=0):8<=$.bi_valid&&($.pending_buf[$.pending++]=255&$.bi_buf,$.bi_buf>>=8,$.bi_valid-=8)}(D)}},{"../utils/common":41}],53:[function(r,e,t){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,e,t){(function(i){(function(n,s){"use strict";if(!n.setImmediate){var o,a,l,u,c=1,d={},h=!1,f=n.document,m=Object.getPrototypeOf&&Object.getPrototypeOf(n);m=m&&m.setTimeout?m:n,o={}.toString.call(n.process)==="[object process]"?function(F){process.nextTick(function(){g(F)})}:function(){if(n.postMessage&&!n.importScripts){var F=!0,w=n.onmessage;return n.onmessage=function(){F=!1},n.postMessage("","*"),n.onmessage=w,F}}()?(u="setImmediate$"+Math.random()+"$",n.addEventListener?n.addEventListener("message",b,!1):n.attachEvent("onmessage",b),function(F){n.postMessage(u+F,"*")}):n.MessageChannel?((l=new MessageChannel).port1.onmessage=function(F){g(F.data)},function(F){l.port2.postMessage(F)}):f&&"onreadystatechange"in f.createElement("script")?(a=f.documentElement,function(F){var w=f.createElement("script");w.onreadystatechange=function(){g(F),w.onreadystatechange=null,a.removeChild(w),w=null},a.appendChild(w)}):function(F){setTimeout(g,0,F)},m.setImmediate=function(F){typeof F!="function"&&(F=new Function(""+F));for(var w=new Array(arguments.length-1),_=0;_<w.length;_++)w[_]=arguments[_+1];var I={callback:F,args:w};return d[c]=I,o(c),c++},m.clearImmediate=p}function p(F){delete d[F]}function g(F){if(h)setTimeout(g,0,F);else{var w=d[F];if(w){h=!0;try{(function(_){var I=_.callback,A=_.args;switch(A.length){case 0:I();break;case 1:I(A[0]);break;case 2:I(A[0],A[1]);break;case 3:I(A[0],A[1],A[2]);break;default:I.apply(s,A)}})(w)}finally{p(F),h=!1}}}}function b(F){F.source===n&&typeof F.data=="string"&&F.data.indexOf(u)===0&&g(+F.data.slice(u.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})});var my=ve((exports,module)=>{(function(){"use strict";var ERROR="input is invalid type",WINDOW=typeof window=="object",root=WINDOW?window:{};root.JS_MD5_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&typeof self=="object",NODE_JS=!root.JS_MD5_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;NODE_JS?root=global:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_MD5_NO_COMMON_JS&&typeof module=="object"&&module.exports,AMD=typeof define=="function"&&define.amd,ARRAY_BUFFER=!root.JS_MD5_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",HEX_CHARS="0123456789abcdef".split(""),EXTRA=[128,32768,8388608,-2147483648],SHIFT=[0,8,16,24],OUTPUT_TYPES=["hex","array","digest","buffer","arrayBuffer","base64"],BASE64_ENCODE_CHAR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),blocks=[],buffer8;if(ARRAY_BUFFER){var buffer=new ArrayBuffer(68);buffer8=new Uint8Array(buffer),blocks=new Uint32Array(buffer)}(root.JS_MD5_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(r){return Object.prototype.toString.call(r)==="[object Array]"}),ARRAY_BUFFER&&(root.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(r){return typeof r=="object"&&r.buffer&&r.buffer.constructor===ArrayBuffer});var createOutputMethod=function(r){return function(e){return new Md5(!0).update(e)[r]()}},createMethod=function(){var r=createOutputMethod("hex");NODE_JS&&(r=nodeWrap(r)),r.create=function(){return new Md5},r.update=function(i){return r.create().update(i)};for(var e=0;e<OUTPUT_TYPES.length;++e){var t=OUTPUT_TYPES[e];r[t]=createOutputMethod(t)}return r},nodeWrap=function(method){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),nodeMethod=function(r){if(typeof r=="string")return crypto.createHash("md5").update(r,"utf8").digest("hex");if(r==null)throw ERROR;return r.constructor===ArrayBuffer&&(r=new Uint8Array(r)),Array.isArray(r)||ArrayBuffer.isView(r)||r.constructor===Buffer?crypto.createHash("md5").update(new Buffer(r)).digest("hex"):method(r)};return nodeMethod};function Md5(r){if(r)blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks,this.buffer8=buffer8;else if(ARRAY_BUFFER){var e=new ArrayBuffer(68);this.buffer8=new Uint8Array(e),this.blocks=new Uint32Array(e)}else this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Md5.prototype.update=function(r){if(!this.finalized){var e,t=typeof r;if(t!=="string"){if(t==="object"){if(r===null)throw ERROR;if(ARRAY_BUFFER&&r.constructor===ArrayBuffer)r=new Uint8Array(r);else if(!Array.isArray(r)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(r)))throw ERROR}else throw ERROR;e=!0}for(var i,n=0,s,o=r.length,a=this.blocks,l=this.buffer8;n<o;){if(this.hashed&&(this.hashed=!1,a[0]=a[16],a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0),e)if(ARRAY_BUFFER)for(s=this.start;n<o&&s<64;++n)l[s++]=r[n];else for(s=this.start;n<o&&s<64;++n)a[s>>2]|=r[n]<<SHIFT[s++&3];else if(ARRAY_BUFFER)for(s=this.start;n<o&&s<64;++n)i=r.charCodeAt(n),i<128?l[s++]=i:i<2048?(l[s++]=192|i>>6,l[s++]=128|i&63):i<55296||i>=57344?(l[s++]=224|i>>12,l[s++]=128|i>>6&63,l[s++]=128|i&63):(i=65536+((i&1023)<<10|r.charCodeAt(++n)&1023),l[s++]=240|i>>18,l[s++]=128|i>>12&63,l[s++]=128|i>>6&63,l[s++]=128|i&63);else for(s=this.start;n<o&&s<64;++n)i=r.charCodeAt(n),i<128?a[s>>2]|=i<<SHIFT[s++&3]:i<2048?(a[s>>2]|=(192|i>>6)<<SHIFT[s++&3],a[s>>2]|=(128|i&63)<<SHIFT[s++&3]):i<55296||i>=57344?(a[s>>2]|=(224|i>>12)<<SHIFT[s++&3],a[s>>2]|=(128|i>>6&63)<<SHIFT[s++&3],a[s>>2]|=(128|i&63)<<SHIFT[s++&3]):(i=65536+((i&1023)<<10|r.charCodeAt(++n)&1023),a[s>>2]|=(240|i>>18)<<SHIFT[s++&3],a[s>>2]|=(128|i>>12&63)<<SHIFT[s++&3],a[s>>2]|=(128|i>>6&63)<<SHIFT[s++&3],a[s>>2]|=(128|i&63)<<SHIFT[s++&3]);this.lastByteIndex=s,this.bytes+=s-this.start,s>=64?(this.start=s-64,this.hash(),this.hashed=!0):this.start=s}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Md5.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var r=this.blocks,e=this.lastByteIndex;r[e>>2]|=EXTRA[e&3],e>=56&&(this.hashed||this.hash(),r[0]=r[16],r[16]=r[1]=r[2]=r[3]=r[4]=r[5]=r[6]=r[7]=r[8]=r[9]=r[10]=r[11]=r[12]=r[13]=r[14]=r[15]=0),r[14]=this.bytes<<3,r[15]=this.hBytes<<3|this.bytes>>>29,this.hash()}},Md5.prototype.hash=function(){var r,e,t,i,n,s,o=this.blocks;this.first?(r=o[0]-680876937,r=(r<<7|r>>>25)-271733879<<0,i=(-1732584194^r&2004318071)+o[1]-117830708,i=(i<<12|i>>>20)+r<<0,t=(-271733879^i&(r^-271733879))+o[2]-1126478375,t=(t<<17|t>>>15)+i<<0,e=(r^t&(i^r))+o[3]-1316259209,e=(e<<22|e>>>10)+t<<0):(r=this.h0,e=this.h1,t=this.h2,i=this.h3,r+=(i^e&(t^i))+o[0]-680876936,r=(r<<7|r>>>25)+e<<0,i+=(t^r&(e^t))+o[1]-389564586,i=(i<<12|i>>>20)+r<<0,t+=(e^i&(r^e))+o[2]+606105819,t=(t<<17|t>>>15)+i<<0,e+=(r^t&(i^r))+o[3]-1044525330,e=(e<<22|e>>>10)+t<<0),r+=(i^e&(t^i))+o[4]-176418897,r=(r<<7|r>>>25)+e<<0,i+=(t^r&(e^t))+o[5]+1200080426,i=(i<<12|i>>>20)+r<<0,t+=(e^i&(r^e))+o[6]-1473231341,t=(t<<17|t>>>15)+i<<0,e+=(r^t&(i^r))+o[7]-45705983,e=(e<<22|e>>>10)+t<<0,r+=(i^e&(t^i))+o[8]+1770035416,r=(r<<7|r>>>25)+e<<0,i+=(t^r&(e^t))+o[9]-1958414417,i=(i<<12|i>>>20)+r<<0,t+=(e^i&(r^e))+o[10]-42063,t=(t<<17|t>>>15)+i<<0,e+=(r^t&(i^r))+o[11]-1990404162,e=(e<<22|e>>>10)+t<<0,r+=(i^e&(t^i))+o[12]+1804603682,r=(r<<7|r>>>25)+e<<0,i+=(t^r&(e^t))+o[13]-40341101,i=(i<<12|i>>>20)+r<<0,t+=(e^i&(r^e))+o[14]-1502002290,t=(t<<17|t>>>15)+i<<0,e+=(r^t&(i^r))+o[15]+1236535329,e=(e<<22|e>>>10)+t<<0,r+=(t^i&(e^t))+o[1]-165796510,r=(r<<5|r>>>27)+e<<0,i+=(e^t&(r^e))+o[6]-1069501632,i=(i<<9|i>>>23)+r<<0,t+=(r^e&(i^r))+o[11]+643717713,t=(t<<14|t>>>18)+i<<0,e+=(i^r&(t^i))+o[0]-373897302,e=(e<<20|e>>>12)+t<<0,r+=(t^i&(e^t))+o[5]-701558691,r=(r<<5|r>>>27)+e<<0,i+=(e^t&(r^e))+o[10]+38016083,i=(i<<9|i>>>23)+r<<0,t+=(r^e&(i^r))+o[15]-660478335,t=(t<<14|t>>>18)+i<<0,e+=(i^r&(t^i))+o[4]-405537848,e=(e<<20|e>>>12)+t<<0,r+=(t^i&(e^t))+o[9]+568446438,r=(r<<5|r>>>27)+e<<0,i+=(e^t&(r^e))+o[14]-1019803690,i=(i<<9|i>>>23)+r<<0,t+=(r^e&(i^r))+o[3]-187363961,t=(t<<14|t>>>18)+i<<0,e+=(i^r&(t^i))+o[8]+1163531501,e=(e<<20|e>>>12)+t<<0,r+=(t^i&(e^t))+o[13]-1444681467,r=(r<<5|r>>>27)+e<<0,i+=(e^t&(r^e))+o[2]-51403784,i=(i<<9|i>>>23)+r<<0,t+=(r^e&(i^r))+o[7]+1735328473,t=(t<<14|t>>>18)+i<<0,e+=(i^r&(t^i))+o[12]-1926607734,e=(e<<20|e>>>12)+t<<0,n=e^t,r+=(n^i)+o[5]-378558,r=(r<<4|r>>>28)+e<<0,i+=(n^r)+o[8]-2022574463,i=(i<<11|i>>>21)+r<<0,s=i^r,t+=(s^e)+o[11]+1839030562,t=(t<<16|t>>>16)+i<<0,e+=(s^t)+o[14]-35309556,e=(e<<23|e>>>9)+t<<0,n=e^t,r+=(n^i)+o[1]-1530992060,r=(r<<4|r>>>28)+e<<0,i+=(n^r)+o[4]+1272893353,i=(i<<11|i>>>21)+r<<0,s=i^r,t+=(s^e)+o[7]-155497632,t=(t<<16|t>>>16)+i<<0,e+=(s^t)+o[10]-1094730640,e=(e<<23|e>>>9)+t<<0,n=e^t,r+=(n^i)+o[13]+681279174,r=(r<<4|r>>>28)+e<<0,i+=(n^r)+o[0]-358537222,i=(i<<11|i>>>21)+r<<0,s=i^r,t+=(s^e)+o[3]-722521979,t=(t<<16|t>>>16)+i<<0,e+=(s^t)+o[6]+76029189,e=(e<<23|e>>>9)+t<<0,n=e^t,r+=(n^i)+o[9]-640364487,r=(r<<4|r>>>28)+e<<0,i+=(n^r)+o[12]-421815835,i=(i<<11|i>>>21)+r<<0,s=i^r,t+=(s^e)+o[15]+530742520,t=(t<<16|t>>>16)+i<<0,e+=(s^t)+o[2]-995338651,e=(e<<23|e>>>9)+t<<0,r+=(t^(e|~i))+o[0]-198630844,r=(r<<6|r>>>26)+e<<0,i+=(e^(r|~t))+o[7]+1126891415,i=(i<<10|i>>>22)+r<<0,t+=(r^(i|~e))+o[14]-1416354905,t=(t<<15|t>>>17)+i<<0,e+=(i^(t|~r))+o[5]-57434055,e=(e<<21|e>>>11)+t<<0,r+=(t^(e|~i))+o[12]+1700485571,r=(r<<6|r>>>26)+e<<0,i+=(e^(r|~t))+o[3]-1894986606,i=(i<<10|i>>>22)+r<<0,t+=(r^(i|~e))+o[10]-1051523,t=(t<<15|t>>>17)+i<<0,e+=(i^(t|~r))+o[1]-2054922799,e=(e<<21|e>>>11)+t<<0,r+=(t^(e|~i))+o[8]+1873313359,r=(r<<6|r>>>26)+e<<0,i+=(e^(r|~t))+o[15]-30611744,i=(i<<10|i>>>22)+r<<0,t+=(r^(i|~e))+o[6]-1560198380,t=(t<<15|t>>>17)+i<<0,e+=(i^(t|~r))+o[13]+1309151649,e=(e<<21|e>>>11)+t<<0,r+=(t^(e|~i))+o[4]-145523070,r=(r<<6|r>>>26)+e<<0,i+=(e^(r|~t))+o[11]-1120210379,i=(i<<10|i>>>22)+r<<0,t+=(r^(i|~e))+o[2]+718787259,t=(t<<15|t>>>17)+i<<0,e+=(i^(t|~r))+o[9]-343485551,e=(e<<21|e>>>11)+t<<0,this.first?(this.h0=r+1732584193<<0,this.h1=e-271733879<<0,this.h2=t-1732584194<<0,this.h3=i+271733878<<0,this.first=!1):(this.h0=this.h0+r<<0,this.h1=this.h1+e<<0,this.h2=this.h2+t<<0,this.h3=this.h3+i<<0)},Md5.prototype.hex=function(){this.finalize();var r=this.h0,e=this.h1,t=this.h2,i=this.h3;return HEX_CHARS[r>>4&15]+HEX_CHARS[r&15]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[e&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[t&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[i&15]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]},Md5.prototype.toString=Md5.prototype.hex,Md5.prototype.digest=function(){this.finalize();var r=this.h0,e=this.h1,t=this.h2,i=this.h3;return[r&255,r>>8&255,r>>16&255,r>>24&255,e&255,e>>8&255,e>>16&255,e>>24&255,t&255,t>>8&255,t>>16&255,t>>24&255,i&255,i>>8&255,i>>16&255,i>>24&255]},Md5.prototype.array=Md5.prototype.digest,Md5.prototype.arrayBuffer=function(){this.finalize();var r=new ArrayBuffer(16),e=new Uint32Array(r);return e[0]=this.h0,e[1]=this.h1,e[2]=this.h2,e[3]=this.h3,r},Md5.prototype.buffer=Md5.prototype.arrayBuffer,Md5.prototype.base64=function(){for(var r,e,t,i="",n=this.array(),s=0;s<15;)r=n[s++],e=n[s++],t=n[s++],i+=BASE64_ENCODE_CHAR[r>>>2]+BASE64_ENCODE_CHAR[(r<<4|e>>>4)&63]+BASE64_ENCODE_CHAR[(e<<2|t>>>6)&63]+BASE64_ENCODE_CHAR[t&63];return r=n[s],i+=BASE64_ENCODE_CHAR[r>>>2]+BASE64_ENCODE_CHAR[r<<4&63]+"==",i};var exports=createMethod();COMMON_JS?module.exports=exports:(root.md5=exports,AMD&&define(function(){return exports}))})()});var Jw=ve((zV,hp)=>{(r=>{"use strict";var e=Object.defineProperty,t=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,n=Object.prototype.hasOwnProperty,s=(N,V)=>{for(var H in V)e(N,H,{get:V[H],enumerable:!0})},o=(N,V,H,de)=>{if(V&&typeof V=="object"||typeof V=="function")for(let ke of i(V))!n.call(N,ke)&&ke!==H&&e(N,ke,{get:()=>V[ke],enumerable:!(de=t(V,ke))||de.enumerable});return N},a=N=>o(e({},"__esModule",{value:!0}),N),l=(N,V,H)=>new Promise((de,ke)=>{var Te=he=>{try{Me(H.next(he))}catch(We){ke(We)}},we=he=>{try{Me(H.throw(he))}catch(We){ke(We)}},Me=he=>he.done?de(he.value):Promise.resolve(he.value).then(Te,we);Me((H=H.apply(N,V)).next())}),u={};s(u,{analyzeMetafile:()=>Nr,analyzeMetafileSync:()=>qi,build:()=>ft,buildSync:()=>Gt,context:()=>Fi,default:()=>Pf,formatMessages:()=>Li,formatMessagesSync:()=>Dn,initialize:()=>un,stop:()=>An,transform:()=>Mr,transformSync:()=>ln,version:()=>Dt}),r.exports=a(u);function c(N){let V=de=>{if(de===null)H.write8(0);else if(typeof de=="boolean")H.write8(1),H.write8(+de);else if(typeof de=="number")H.write8(2),H.write32(de|0);else if(typeof de=="string")H.write8(3),H.write(f(de));else if(de instanceof Uint8Array)H.write8(4),H.write(de);else if(de instanceof Array){H.write8(5),H.write32(de.length);for(let ke of de)V(ke)}else{let ke=Object.keys(de);H.write8(6),H.write32(ke.length);for(let Te of ke)H.write(f(Te)),V(de[Te])}},H=new h;return H.write32(0),H.write32(N.id<<1|+!N.isRequest),V(N.value),b(H.buf,H.len-4,0),H.buf.subarray(0,H.len)}function d(N){let V=()=>{switch(H.read8()){case 0:return null;case 1:return!!H.read8();case 2:return H.read32();case 3:return m(H.read());case 4:return H.read();case 5:{let we=H.read32(),Me=[];for(let he=0;he<we;he++)Me.push(V());return Me}case 6:{let we=H.read32(),Me={};for(let he=0;he<we;he++)Me[m(H.read())]=V();return Me}default:throw new Error("Invalid packet")}},H=new h(N),de=H.read32(),ke=(de&1)===0;de>>>=1;let Te=V();if(H.ptr!==N.length)throw new Error("Invalid packet");return{id:de,isRequest:ke,value:Te}}var h=class{constructor(N=new Uint8Array(1024)){this.buf=N,this.len=0,this.ptr=0}_write(N){if(this.len+N>this.buf.length){let V=new Uint8Array((this.len+N)*2);V.set(this.buf),this.buf=V}return this.len+=N,this.len-N}write8(N){let V=this._write(1);this.buf[V]=N}write32(N){let V=this._write(4);b(this.buf,N,V)}write(N){let V=this._write(4+N.length);b(this.buf,N.length,V),this.buf.set(N,V+4)}_read(N){if(this.ptr+N>this.buf.length)throw new Error("Invalid packet");return this.ptr+=N,this.ptr-N}read8(){return this.buf[this._read(1)]}read32(){return g(this.buf,this._read(4))}read(){let N=this.read32(),V=new Uint8Array(N),H=this._read(V.length);return V.set(this.buf.subarray(H,H+N)),V}},f,m,p;if(typeof TextEncoder<"u"&&typeof TextDecoder<"u"){let N=new TextEncoder,V=new TextDecoder;f=H=>N.encode(H),m=H=>V.decode(H),p='new TextEncoder().encode("")'}else if(typeof Buffer<"u")f=N=>Buffer.from(N),m=N=>{let{buffer:V,byteOffset:H,byteLength:de}=N;return Buffer.from(V,H,de).toString()},p='Buffer.from("")';else throw new Error("No UTF-8 codec found");if(!(f("")instanceof Uint8Array))throw new Error(`Invariant violation: "${p} instanceof Uint8Array" is incorrectly false

This indicates that your JavaScript environment is broken. You cannot use
esbuild in this environment because esbuild relies on this invariant. This
is not a problem with esbuild. You need to fix your environment instead.
`);function g(N,V){return N[V++]|N[V++]<<8|N[V++]<<16|N[V++]<<24}function b(N,V,H){N[H++]=V,N[H++]=V>>8,N[H++]=V>>16,N[H++]=V>>24}var F=JSON.stringify,w="warning",_="silent";function I(N){if(Ze(N,"target"),N.indexOf(",")>=0)throw new Error(`Invalid target: ${N}`);return N}var A=()=>null,T=N=>typeof N=="boolean"?null:"a boolean",E=N=>typeof N=="string"?null:"a string",K=N=>N instanceof RegExp?null:"a RegExp object",P=N=>typeof N=="number"&&N===(N|0)?null:"an integer",G=N=>typeof N=="function"?null:"a function",y=N=>Array.isArray(N)?null:"an array",z=N=>typeof N=="object"&&N!==null&&!Array.isArray(N)?null:"an object",Fe=N=>typeof N=="object"&&N!==null?null:"an array or an object",re=N=>N instanceof WebAssembly.Module?null:"a WebAssembly.Module",Re=N=>typeof N=="object"&&!Array.isArray(N)?null:"an object or null",pe=N=>typeof N=="string"||typeof N=="boolean"?null:"a string or a boolean",ze=N=>typeof N=="string"||typeof N=="object"&&N!==null&&!Array.isArray(N)?null:"a string or an object",ee=N=>typeof N=="string"||Array.isArray(N)?null:"a string or an array",Y=N=>typeof N=="string"||N instanceof Uint8Array?null:"a string or a Uint8Array",Ve=N=>typeof N=="string"||N instanceof URL?null:"a string or a URL";function U(N,V,H,de){let ke=N[H];if(V[H+""]=!0,ke===void 0)return;let Te=de(ke);if(Te!==null)throw new Error(`${F(H)} must be ${Te}`);return ke}function me(N,V,H){for(let de in N)if(!(de in V))throw new Error(`Invalid option ${H}: ${F(de)}`)}function Jt(N){let V=Object.create(null),H=U(N,V,"wasmURL",Ve),de=U(N,V,"wasmModule",re),ke=U(N,V,"worker",T);return me(N,V,"in initialize() call"),{wasmURL:H,wasmModule:de,worker:ke}}function Qt(N){let V;if(N!==void 0){V=Object.create(null);for(let H in N){let de=N[H];if(typeof de=="string"||de===!1)V[H]=de;else throw new Error(`Expected ${F(H)} in mangle cache to map to either a string or false`)}}return V}function ut(N,V,H,de,ke){let Te=U(V,H,"color",T),we=U(V,H,"logLevel",E),Me=U(V,H,"logLimit",P);Te!==void 0?N.push(`--color=${Te}`):de&&N.push("--color=true"),N.push(`--log-level=${we||ke}`),N.push(`--log-limit=${Me||0}`)}function Ze(N,V,H){if(typeof N!="string")throw new Error(`Expected value for ${V}${H!==void 0?" "+F(H):""} to be a string, got ${typeof N} instead`);return N}function Xt(N,V,H){let de=U(V,H,"legalComments",E),ke=U(V,H,"sourceRoot",E),Te=U(V,H,"sourcesContent",T),we=U(V,H,"target",ee),Me=U(V,H,"format",E),he=U(V,H,"globalName",E),We=U(V,H,"mangleProps",K),Xe=U(V,H,"reserveProps",K),et=U(V,H,"mangleQuoted",T),Pt=U(V,H,"minify",T),dt=U(V,H,"minifySyntax",T),st=U(V,H,"minifyWhitespace",T),ni=U(V,H,"minifyIdentifiers",T),Ie=U(V,H,"lineLimit",P),pt=U(V,H,"drop",y),mt=U(V,H,"dropLabels",y),Ee=U(V,H,"charset",E),ne=U(V,H,"treeShaking",T),Q=U(V,H,"ignoreAnnotations",T),te=U(V,H,"jsx",E),Pe=U(V,H,"jsxFactory",E),xe=U(V,H,"jsxFragment",E),je=U(V,H,"jsxImportSource",E),Ke=U(V,H,"jsxDev",T),R=U(V,H,"jsxSideEffects",T),q=U(V,H,"define",z),be=U(V,H,"logOverride",z),De=U(V,H,"supported",z),Ue=U(V,H,"pure",y),ot=U(V,H,"keepNames",T),Ye=U(V,H,"platform",E),at=U(V,H,"tsconfigRaw",ze);if(de&&N.push(`--legal-comments=${de}`),ke!==void 0&&N.push(`--source-root=${ke}`),Te!==void 0&&N.push(`--sources-content=${Te}`),we&&(Array.isArray(we)?N.push(`--target=${Array.from(we).map(I).join(",")}`):N.push(`--target=${I(we)}`)),Me&&N.push(`--format=${Me}`),he&&N.push(`--global-name=${he}`),Ye&&N.push(`--platform=${Ye}`),at&&N.push(`--tsconfig-raw=${typeof at=="string"?at:JSON.stringify(at)}`),Pt&&N.push("--minify"),dt&&N.push("--minify-syntax"),st&&N.push("--minify-whitespace"),ni&&N.push("--minify-identifiers"),Ie&&N.push(`--line-limit=${Ie}`),Ee&&N.push(`--charset=${Ee}`),ne!==void 0&&N.push(`--tree-shaking=${ne}`),Q&&N.push("--ignore-annotations"),pt)for(let tt of pt)N.push(`--drop:${Ze(tt,"drop")}`);if(mt&&N.push(`--drop-labels=${Array.from(mt).map(tt=>Ze(tt,"dropLabels")).join(",")}`),We&&N.push(`--mangle-props=${We.source}`),Xe&&N.push(`--reserve-props=${Xe.source}`),et!==void 0&&N.push(`--mangle-quoted=${et}`),te&&N.push(`--jsx=${te}`),Pe&&N.push(`--jsx-factory=${Pe}`),xe&&N.push(`--jsx-fragment=${xe}`),je&&N.push(`--jsx-import-source=${je}`),Ke&&N.push("--jsx-dev"),R&&N.push("--jsx-side-effects"),q)for(let tt in q){if(tt.indexOf("=")>=0)throw new Error(`Invalid define: ${tt}`);N.push(`--define:${tt}=${Ze(q[tt],"define",tt)}`)}if(be)for(let tt in be){if(tt.indexOf("=")>=0)throw new Error(`Invalid log override: ${tt}`);N.push(`--log-override:${tt}=${Ze(be[tt],"log override",tt)}`)}if(De)for(let tt in De){if(tt.indexOf("=")>=0)throw new Error(`Invalid supported: ${tt}`);let Qe=De[tt];if(typeof Qe!="boolean")throw new Error(`Expected value for supported ${F(tt)} to be a boolean, got ${typeof Qe} instead`);N.push(`--supported:${tt}=${Qe}`)}if(Ue)for(let tt of Ue)N.push(`--pure:${Ze(tt,"pure")}`);ot&&N.push("--keep-names")}function $t(N,V,H,de,ke){var Te;let we=[],Me=[],he=Object.create(null),We=null,Xe=null;ut(we,V,he,H,de),Xt(we,V,he);let et=U(V,he,"sourcemap",pe),Pt=U(V,he,"bundle",T),dt=U(V,he,"splitting",T),st=U(V,he,"preserveSymlinks",T),ni=U(V,he,"metafile",T),Ie=U(V,he,"outfile",E),pt=U(V,he,"outdir",E),mt=U(V,he,"outbase",E),Ee=U(V,he,"tsconfig",E),ne=U(V,he,"resolveExtensions",y),Q=U(V,he,"nodePaths",y),te=U(V,he,"mainFields",y),Pe=U(V,he,"conditions",y),xe=U(V,he,"external",y),je=U(V,he,"packages",E),Ke=U(V,he,"alias",z),R=U(V,he,"loader",z),q=U(V,he,"outExtension",z),be=U(V,he,"publicPath",E),De=U(V,he,"entryNames",E),Ue=U(V,he,"chunkNames",E),ot=U(V,he,"assetNames",E),Ye=U(V,he,"inject",y),at=U(V,he,"banner",z),tt=U(V,he,"footer",z),Qe=U(V,he,"entryPoints",Fe),Ft=U(V,he,"absWorkingDir",E),gt=U(V,he,"stdin",z),_t=(Te=U(V,he,"write",T))!=null?Te:ke,k=U(V,he,"allowOverwrite",T),M=U(V,he,"mangleCache",z);if(he.plugins=!0,me(V,he,`in ${N}() call`),et&&we.push(`--sourcemap${et===!0?"":`=${et}`}`),Pt&&we.push("--bundle"),k&&we.push("--allow-overwrite"),dt&&we.push("--splitting"),st&&we.push("--preserve-symlinks"),ni&&we.push("--metafile"),Ie&&we.push(`--outfile=${Ie}`),pt&&we.push(`--outdir=${pt}`),mt&&we.push(`--outbase=${mt}`),Ee&&we.push(`--tsconfig=${Ee}`),je&&we.push(`--packages=${je}`),ne){let L=[];for(let J of ne){if(Ze(J,"resolve extension"),J.indexOf(",")>=0)throw new Error(`Invalid resolve extension: ${J}`);L.push(J)}we.push(`--resolve-extensions=${L.join(",")}`)}if(be&&we.push(`--public-path=${be}`),De&&we.push(`--entry-names=${De}`),Ue&&we.push(`--chunk-names=${Ue}`),ot&&we.push(`--asset-names=${ot}`),te){let L=[];for(let J of te){if(Ze(J,"main field"),J.indexOf(",")>=0)throw new Error(`Invalid main field: ${J}`);L.push(J)}we.push(`--main-fields=${L.join(",")}`)}if(Pe){let L=[];for(let J of Pe){if(Ze(J,"condition"),J.indexOf(",")>=0)throw new Error(`Invalid condition: ${J}`);L.push(J)}we.push(`--conditions=${L.join(",")}`)}if(xe)for(let L of xe)we.push(`--external:${Ze(L,"external")}`);if(Ke)for(let L in Ke){if(L.indexOf("=")>=0)throw new Error(`Invalid package name in alias: ${L}`);we.push(`--alias:${L}=${Ze(Ke[L],"alias",L)}`)}if(at)for(let L in at){if(L.indexOf("=")>=0)throw new Error(`Invalid banner file type: ${L}`);we.push(`--banner:${L}=${Ze(at[L],"banner",L)}`)}if(tt)for(let L in tt){if(L.indexOf("=")>=0)throw new Error(`Invalid footer file type: ${L}`);we.push(`--footer:${L}=${Ze(tt[L],"footer",L)}`)}if(Ye)for(let L of Ye)we.push(`--inject:${Ze(L,"inject")}`);if(R)for(let L in R){if(L.indexOf("=")>=0)throw new Error(`Invalid loader extension: ${L}`);we.push(`--loader:${L}=${Ze(R[L],"loader",L)}`)}if(q)for(let L in q){if(L.indexOf("=")>=0)throw new Error(`Invalid out extension: ${L}`);we.push(`--out-extension:${L}=${Ze(q[L],"out extension",L)}`)}if(Qe)if(Array.isArray(Qe))for(let L=0,J=Qe.length;L<J;L++){let W=Qe[L];if(typeof W=="object"&&W!==null){let se=Object.create(null),fe=U(W,se,"in",E),ye=U(W,se,"out",E);if(me(W,se,"in entry point at index "+L),fe===void 0)throw new Error('Missing property "in" for entry point at index '+L);if(ye===void 0)throw new Error('Missing property "out" for entry point at index '+L);Me.push([ye,fe])}else Me.push(["",Ze(W,"entry point at index "+L)])}else for(let L in Qe)Me.push([L,Ze(Qe[L],"entry point",L)]);if(gt){let L=Object.create(null),J=U(gt,L,"contents",Y),W=U(gt,L,"resolveDir",E),se=U(gt,L,"sourcefile",E),fe=U(gt,L,"loader",E);me(gt,L,'in "stdin" object'),se&&we.push(`--sourcefile=${se}`),fe&&we.push(`--loader=${fe}`),W&&(Xe=W),typeof J=="string"?We=f(J):J instanceof Uint8Array&&(We=J)}let x=[];if(Q)for(let L of Q)L+="",x.push(L);return{entries:Me,flags:we,write:_t,stdinContents:We,stdinResolveDir:Xe,absWorkingDir:Ft,nodePaths:x,mangleCache:Qt(M)}}function Hi(N,V,H,de){let ke=[],Te=Object.create(null);ut(ke,V,Te,H,de),Xt(ke,V,Te);let we=U(V,Te,"sourcemap",pe),Me=U(V,Te,"sourcefile",E),he=U(V,Te,"loader",E),We=U(V,Te,"banner",E),Xe=U(V,Te,"footer",E),et=U(V,Te,"mangleCache",z);return me(V,Te,`in ${N}() call`),we&&ke.push(`--sourcemap=${we===!0?"external":we}`),Me&&ke.push(`--sourcefile=${Me}`),he&&ke.push(`--loader=${he}`),We&&ke.push(`--banner=${We}`),Xe&&ke.push(`--footer=${Xe}`),{flags:ke,mangleCache:Qt(et)}}function Bi(N){let V={},H={didClose:!1,reason:""},de={},ke=0,Te=0,we=new Uint8Array(16*1024),Me=0,he=Ee=>{let ne=Me+Ee.length;if(ne>we.length){let te=new Uint8Array(ne*2);te.set(we),we=te}we.set(Ee,Me),Me+=Ee.length;let Q=0;for(;Q+4<=Me;){let te=g(we,Q);if(Q+4+te>Me)break;Q+=4,st(we.subarray(Q,Q+te)),Q+=te}Q>0&&(we.copyWithin(0,Q,Me),Me-=Q)},We=Ee=>{H.didClose=!0,Ee&&(H.reason=": "+(Ee.message||Ee));let ne="The service was stopped"+H.reason;for(let Q in de)de[Q](ne,null);de={}},Xe=(Ee,ne,Q)=>{if(H.didClose)return Q("The service is no longer running"+H.reason,null);let te=ke++;de[te]=(Pe,xe)=>{try{Q(Pe,xe)}finally{Ee&&Ee.unref()}},Ee&&Ee.ref(),N.writeToStdin(c({id:te,isRequest:!0,value:ne}))},et=(Ee,ne)=>{if(H.didClose)throw new Error("The service is no longer running"+H.reason);N.writeToStdin(c({id:Ee,isRequest:!1,value:ne}))},Pt=(Ee,ne)=>l(this,null,function*(){try{if(ne.command==="ping"){et(Ee,{});return}if(typeof ne.key=="number"){let Q=V[ne.key];if(!Q)return;let te=Q[ne.command];if(te){yield te(Ee,ne);return}}throw new Error("Invalid command: "+ne.command)}catch(Q){let te=[D(Q,N,null,void 0,"")];try{et(Ee,{errors:te})}catch{}}}),dt=!0,st=Ee=>{if(dt){dt=!1;let Q=String.fromCharCode(...Ee);if(Q!=="0.21.5")throw new Error(`Cannot start service: Host version "0.21.5" does not match binary version ${F(Q)}`);return}let ne=d(Ee);if(ne.isRequest)Pt(ne.id,ne.value);else{let Q=de[ne.id];delete de[ne.id],ne.value.error?Q(ne.value.error,{}):Q(null,ne.value)}};return{readFromStdout:he,afterClose:We,service:{buildOrContext:({callName:Ee,refs:ne,options:Q,isTTY:te,defaultWD:Pe,callback:xe})=>{let je=0,Ke=Te++,R={},q={ref(){++je===1&&ne&&ne.ref()},unref(){--je===0&&(delete V[Ke],ne&&ne.unref())}};V[Ke]=R,q.ref(),v(Ee,Ke,Xe,et,q,N,R,Q,te,Pe,(be,De)=>{try{xe(be,De)}finally{q.unref()}})},transform:({callName:Ee,refs:ne,input:Q,options:te,isTTY:Pe,fs:xe,callback:je})=>{let Ke=ie(),R=q=>{try{if(typeof Q!="string"&&!(Q instanceof Uint8Array))throw new Error('The input to "transform" must be a string or a Uint8Array');let{flags:be,mangleCache:De}=Hi(Ee,te,Pe,_),Ue={command:"transform",flags:be,inputFS:q!==null,input:q!==null?f(q):typeof Q=="string"?f(Q):Q};De&&(Ue.mangleCache=De),Xe(ne,Ue,(ot,Ye)=>{if(ot)return je(new Error(ot),null);let at=ce(Ye.errors,Ke),tt=ce(Ye.warnings,Ke),Qe=1,Ft=()=>{if(--Qe===0){let gt={warnings:tt,code:Ye.code,map:Ye.map,mangleCache:void 0,legalComments:void 0};"legalComments"in Ye&&(gt.legalComments=Ye?.legalComments),Ye.mangleCache&&(gt.mangleCache=Ye?.mangleCache),je(null,gt)}};if(at.length>0)return je(ue("Transform failed",at,tt),null);Ye.codeFS&&(Qe++,xe.readFile(Ye.code,(gt,_t)=>{gt!==null?je(gt,null):(Ye.code=_t,Ft())})),Ye.mapFS&&(Qe++,xe.readFile(Ye.map,(gt,_t)=>{gt!==null?je(gt,null):(Ye.map=_t,Ft())})),Ft()})}catch(be){let De=[];try{ut(De,te,{},Pe,_)}catch{}let Ue=D(be,N,Ke,void 0,"");Xe(ne,{command:"error",flags:De,error:Ue},()=>{Ue.detail=Ke.load(Ue.detail),je(ue("Transform failed",[Ue],[]),null)})}};if((typeof Q=="string"||Q instanceof Uint8Array)&&Q.length>1024*1024){let q=R;R=()=>xe.writeFile(Q,q)}R(null)},formatMessages:({callName:Ee,refs:ne,messages:Q,options:te,callback:Pe})=>{if(!te)throw new Error(`Missing second argument in ${Ee}() call`);let xe={},je=U(te,xe,"kind",E),Ke=U(te,xe,"color",T),R=U(te,xe,"terminalWidth",P);if(me(te,xe,`in ${Ee}() call`),je===void 0)throw new Error(`Missing "kind" in ${Ee}() call`);if(je!=="error"&&je!=="warning")throw new Error(`Expected "kind" to be "error" or "warning" in ${Ee}() call`);let q={command:"format-msgs",messages:ge(Q,"messages",null,"",R),isWarning:je==="warning"};Ke!==void 0&&(q.color=Ke),R!==void 0&&(q.terminalWidth=R),Xe(ne,q,(be,De)=>{if(be)return Pe(new Error(be),null);Pe(null,De.messages)})},analyzeMetafile:({callName:Ee,refs:ne,metafile:Q,options:te,callback:Pe})=>{te===void 0&&(te={});let xe={},je=U(te,xe,"color",T),Ke=U(te,xe,"verbose",T);me(te,xe,`in ${Ee}() call`);let R={command:"analyze-metafile",metafile:Q};je!==void 0&&(R.color=je),Ke!==void 0&&(R.verbose=Ke),Xe(ne,R,(q,be)=>{if(q)return Pe(new Error(q),null);Pe(null,be.result)})}}}}function v(N,V,H,de,ke,Te,we,Me,he,We,Xe){let et=ie(),Pt=N==="context",dt=(Ie,pt)=>{let mt=[];try{ut(mt,Me,{},he,w)}catch{}let Ee=D(Ie,Te,et,void 0,pt);H(ke,{command:"error",flags:mt,error:Ee},()=>{Ee.detail=et.load(Ee.detail),Xe(ue(Pt?"Context failed":"Build failed",[Ee],[]),null)})},st;if(typeof Me=="object"){let Ie=Me.plugins;if(Ie!==void 0){if(!Array.isArray(Ie))return dt(new Error('"plugins" must be an array'),"");st=Ie}}if(st&&st.length>0){if(Te.isSync)return dt(new Error("Cannot use plugins in synchronous API calls"),"");ae(V,H,de,ke,Te,we,Me,st,et).then(Ie=>{if(!Ie.ok)return dt(Ie.error,Ie.pluginName);try{ni(Ie.requestPlugins,Ie.runOnEndCallbacks,Ie.scheduleOnDisposeCallbacks)}catch(pt){dt(pt,"")}},Ie=>dt(Ie,""));return}try{ni(null,(Ie,pt)=>pt([],[]),()=>{})}catch(Ie){dt(Ie,"")}function ni(Ie,pt,mt){let Ee=Te.hasFS,{entries:ne,flags:Q,write:te,stdinContents:Pe,stdinResolveDir:xe,absWorkingDir:je,nodePaths:Ke,mangleCache:R}=$t(N,Me,he,w,Ee);if(te&&!Te.hasFS)throw new Error('The "write" option is unavailable in this environment');let q={command:"build",key:V,entries:ne,flags:Q,write:te,stdinContents:Pe,stdinResolveDir:xe,absWorkingDir:je||We,nodePaths:Ke,context:Pt};Ie&&(q.plugins=Ie),R&&(q.mangleCache=R);let be=(ot,Ye)=>{let at={errors:ce(ot.errors,et),warnings:ce(ot.warnings,et),outputFiles:void 0,metafile:void 0,mangleCache:void 0},tt=at.errors.slice(),Qe=at.warnings.slice();ot.outputFiles&&(at.outputFiles=ot.outputFiles.map(He)),ot.metafile&&(at.metafile=JSON.parse(ot.metafile)),ot.mangleCache&&(at.mangleCache=ot.mangleCache),ot.writeToStdout!==void 0&&console.log(m(ot.writeToStdout).replace(/\n$/,"")),pt(at,(Ft,gt)=>{if(tt.length>0||Ft.length>0){let _t=ue("Build failed",tt.concat(Ft),Qe.concat(gt));return Ye(_t,null,Ft,gt)}Ye(null,at,Ft,gt)})},De,Ue;Pt&&(we["on-end"]=(ot,Ye)=>new Promise(at=>{be(Ye,(tt,Qe,Ft,gt)=>{let _t={errors:Ft,warnings:gt};Ue&&Ue(tt,Qe),De=void 0,Ue=void 0,de(ot,_t),at()})})),H(ke,q,(ot,Ye)=>{if(ot)return Xe(new Error(ot),null);if(!Pt)return be(Ye,(Qe,Ft)=>(mt(),Xe(Qe,Ft)));if(Ye.errors.length>0)return Xe(ue("Context failed",Ye.errors,Ye.warnings),null);let at=!1,tt={rebuild:()=>(De||(De=new Promise((Qe,Ft)=>{let gt;Ue=(k,M)=>{gt||(gt=()=>k?Ft(k):Qe(M))};let _t=()=>{H(ke,{command:"rebuild",key:V},(M,x)=>{M?Ft(new Error(M)):gt?gt():_t()})};_t()})),De),watch:(Qe={})=>new Promise((Ft,gt)=>{if(!Te.hasFS)throw new Error('Cannot use the "watch" API in this environment');me(Qe,{},"in watch() call"),H(ke,{command:"watch",key:V},M=>{M?gt(new Error(M)):Ft(void 0)})}),serve:(Qe={})=>new Promise((Ft,gt)=>{if(!Te.hasFS)throw new Error('Cannot use the "serve" API in this environment');let _t={},k=U(Qe,_t,"port",P),M=U(Qe,_t,"host",E),x=U(Qe,_t,"servedir",E),L=U(Qe,_t,"keyfile",E),J=U(Qe,_t,"certfile",E),W=U(Qe,_t,"fallback",E),se=U(Qe,_t,"onRequest",G);me(Qe,_t,"in serve() call");let fe={command:"serve",key:V,onRequest:!!se};k!==void 0&&(fe.port=k),M!==void 0&&(fe.host=M),x!==void 0&&(fe.servedir=x),L!==void 0&&(fe.keyfile=L),J!==void 0&&(fe.certfile=J),W!==void 0&&(fe.fallback=W),H(ke,fe,(ye,_e)=>{if(ye)return gt(new Error(ye));se&&(we["serve-request"]=(Se,Ge)=>{se(Ge.args),de(Se,{})}),Ft(_e)})}),cancel:()=>new Promise(Qe=>{if(at)return Qe();H(ke,{command:"cancel",key:V},()=>{Qe()})}),dispose:()=>new Promise(Qe=>{if(at)return Qe();at=!0,H(ke,{command:"dispose",key:V},()=>{Qe(),mt(),ke.unref()})})};ke.ref(),Xe(null,tt)})}}var ae=(N,V,H,de,ke,Te,we,Me,he)=>l(void 0,null,function*(){let We=[],Xe=[],et={},Pt={},dt=[],st=0,ni=0,Ie=[],pt=!1;Me=[...Me];for(let ne of Me){let Q={};if(typeof ne!="object")throw new Error(`Plugin at index ${ni} must be an object`);let te=U(ne,Q,"name",E);if(typeof te!="string"||te==="")throw new Error(`Plugin at index ${ni} is missing a name`);try{let Pe=U(ne,Q,"setup",G);if(typeof Pe!="function")throw new Error("Plugin is missing a setup function");me(ne,Q,`on plugin ${F(te)}`);let xe={name:te,onStart:!1,onEnd:!1,onResolve:[],onLoad:[]};ni++;let Ke=Pe({initialOptions:we,resolve:(R,q={})=>{if(!pt)throw new Error('Cannot call "resolve" before plugin setup has completed');if(typeof R!="string")throw new Error("The path to resolve must be a string");let be=Object.create(null),De=U(q,be,"pluginName",E),Ue=U(q,be,"importer",E),ot=U(q,be,"namespace",E),Ye=U(q,be,"resolveDir",E),at=U(q,be,"kind",E),tt=U(q,be,"pluginData",A),Qe=U(q,be,"with",z);return me(q,be,"in resolve() call"),new Promise((Ft,gt)=>{let _t={command:"resolve",path:R,key:N,pluginName:te};if(De!=null&&(_t.pluginName=De),Ue!=null&&(_t.importer=Ue),ot!=null&&(_t.namespace=ot),Ye!=null&&(_t.resolveDir=Ye),at!=null)_t.kind=at;else throw new Error('Must specify "kind" when calling "resolve"');tt!=null&&(_t.pluginData=he.store(tt)),Qe!=null&&(_t.with=Ce(Qe,"with")),V(de,_t,(k,M)=>{k!==null?gt(new Error(k)):Ft({errors:ce(M.errors,he),warnings:ce(M.warnings,he),path:M.path,external:M.external,sideEffects:M.sideEffects,namespace:M.namespace,suffix:M.suffix,pluginData:he.load(M.pluginData)})})})},onStart(R){let q='This error came from the "onStart" callback registered here:',be=O(new Error(q),ke,"onStart");We.push({name:te,callback:R,note:be}),xe.onStart=!0},onEnd(R){let q='This error came from the "onEnd" callback registered here:',be=O(new Error(q),ke,"onEnd");Xe.push({name:te,callback:R,note:be}),xe.onEnd=!0},onResolve(R,q){let be='This error came from the "onResolve" callback registered here:',De=O(new Error(be),ke,"onResolve"),Ue={},ot=U(R,Ue,"filter",K),Ye=U(R,Ue,"namespace",E);if(me(R,Ue,`in onResolve() call for plugin ${F(te)}`),ot==null)throw new Error("onResolve() call is missing a filter");let at=st++;et[at]={name:te,callback:q,note:De},xe.onResolve.push({id:at,filter:ot.source,namespace:Ye||""})},onLoad(R,q){let be='This error came from the "onLoad" callback registered here:',De=O(new Error(be),ke,"onLoad"),Ue={},ot=U(R,Ue,"filter",K),Ye=U(R,Ue,"namespace",E);if(me(R,Ue,`in onLoad() call for plugin ${F(te)}`),ot==null)throw new Error("onLoad() call is missing a filter");let at=st++;Pt[at]={name:te,callback:q,note:De},xe.onLoad.push({id:at,filter:ot.source,namespace:Ye||""})},onDispose(R){dt.push(R)},esbuild:ke.esbuild});Ke&&(yield Ke),Ie.push(xe)}catch(Pe){return{ok:!1,error:Pe,pluginName:te}}}Te["on-start"]=(ne,Q)=>l(void 0,null,function*(){let te={errors:[],warnings:[]};yield Promise.all(We.map(Pe=>l(void 0,[Pe],function*({name:xe,callback:je,note:Ke}){try{let R=yield je();if(R!=null){if(typeof R!="object")throw new Error(`Expected onStart() callback in plugin ${F(xe)} to return an object`);let q={},be=U(R,q,"errors",y),De=U(R,q,"warnings",y);me(R,q,`from onStart() callback in plugin ${F(xe)}`),be!=null&&te.errors.push(...ge(be,"errors",he,xe,void 0)),De!=null&&te.warnings.push(...ge(De,"warnings",he,xe,void 0))}}catch(R){te.errors.push(D(R,ke,he,Ke&&Ke(),xe))}}))),H(ne,te)}),Te["on-resolve"]=(ne,Q)=>l(void 0,null,function*(){let te={},Pe="",xe,je;for(let Ke of Q.ids)try{({name:Pe,callback:xe,note:je}=et[Ke]);let R=yield xe({path:Q.path,importer:Q.importer,namespace:Q.namespace,resolveDir:Q.resolveDir,kind:Q.kind,pluginData:he.load(Q.pluginData),with:Q.with});if(R!=null){if(typeof R!="object")throw new Error(`Expected onResolve() callback in plugin ${F(Pe)} to return an object`);let q={},be=U(R,q,"pluginName",E),De=U(R,q,"path",E),Ue=U(R,q,"namespace",E),ot=U(R,q,"suffix",E),Ye=U(R,q,"external",T),at=U(R,q,"sideEffects",T),tt=U(R,q,"pluginData",A),Qe=U(R,q,"errors",y),Ft=U(R,q,"warnings",y),gt=U(R,q,"watchFiles",y),_t=U(R,q,"watchDirs",y);me(R,q,`from onResolve() callback in plugin ${F(Pe)}`),te.id=Ke,be!=null&&(te.pluginName=be),De!=null&&(te.path=De),Ue!=null&&(te.namespace=Ue),ot!=null&&(te.suffix=ot),Ye!=null&&(te.external=Ye),at!=null&&(te.sideEffects=at),tt!=null&&(te.pluginData=he.store(tt)),Qe!=null&&(te.errors=ge(Qe,"errors",he,Pe,void 0)),Ft!=null&&(te.warnings=ge(Ft,"warnings",he,Pe,void 0)),gt!=null&&(te.watchFiles=Ae(gt,"watchFiles")),_t!=null&&(te.watchDirs=Ae(_t,"watchDirs"));break}}catch(R){te={id:Ke,errors:[D(R,ke,he,je&&je(),Pe)]};break}H(ne,te)}),Te["on-load"]=(ne,Q)=>l(void 0,null,function*(){let te={},Pe="",xe,je;for(let Ke of Q.ids)try{({name:Pe,callback:xe,note:je}=Pt[Ke]);let R=yield xe({path:Q.path,namespace:Q.namespace,suffix:Q.suffix,pluginData:he.load(Q.pluginData),with:Q.with});if(R!=null){if(typeof R!="object")throw new Error(`Expected onLoad() callback in plugin ${F(Pe)} to return an object`);let q={},be=U(R,q,"pluginName",E),De=U(R,q,"contents",Y),Ue=U(R,q,"resolveDir",E),ot=U(R,q,"pluginData",A),Ye=U(R,q,"loader",E),at=U(R,q,"errors",y),tt=U(R,q,"warnings",y),Qe=U(R,q,"watchFiles",y),Ft=U(R,q,"watchDirs",y);me(R,q,`from onLoad() callback in plugin ${F(Pe)}`),te.id=Ke,be!=null&&(te.pluginName=be),De instanceof Uint8Array?te.contents=De:De!=null&&(te.contents=f(De)),Ue!=null&&(te.resolveDir=Ue),ot!=null&&(te.pluginData=he.store(ot)),Ye!=null&&(te.loader=Ye),at!=null&&(te.errors=ge(at,"errors",he,Pe,void 0)),tt!=null&&(te.warnings=ge(tt,"warnings",he,Pe,void 0)),Qe!=null&&(te.watchFiles=Ae(Qe,"watchFiles")),Ft!=null&&(te.watchDirs=Ae(Ft,"watchDirs"));break}}catch(R){te={id:Ke,errors:[D(R,ke,he,je&&je(),Pe)]};break}H(ne,te)});let mt=(ne,Q)=>Q([],[]);Xe.length>0&&(mt=(ne,Q)=>{l(void 0,null,function*(){let te=[],Pe=[];for(let{name:xe,callback:je,note:Ke}of Xe){let R,q;try{let be=yield je(ne);if(be!=null){if(typeof be!="object")throw new Error(`Expected onEnd() callback in plugin ${F(xe)} to return an object`);let De={},Ue=U(be,De,"errors",y),ot=U(be,De,"warnings",y);me(be,De,`from onEnd() callback in plugin ${F(xe)}`),Ue!=null&&(R=ge(Ue,"errors",he,xe,void 0)),ot!=null&&(q=ge(ot,"warnings",he,xe,void 0))}}catch(be){R=[D(be,ke,he,Ke&&Ke(),xe)]}if(R){te.push(...R);try{ne.errors.push(...R)}catch{}}if(q){Pe.push(...q);try{ne.warnings.push(...q)}catch{}}}Q(te,Pe)})});let Ee=()=>{for(let ne of dt)setTimeout(()=>ne(),0)};return pt=!0,{ok:!0,requestPlugins:Ie,runOnEndCallbacks:mt,scheduleOnDisposeCallbacks:Ee}});function ie(){let N=new Map,V=0;return{load(H){return N.get(H)},store(H){if(H===void 0)return-1;let de=V++;return N.set(de,H),de}}}function O(N,V,H){let de,ke=!1;return()=>{if(ke)return de;ke=!0;try{let Te=(N.stack+"").split(`
`);Te.splice(1,1);let we=$(V,Te,H);if(we)return de={text:N.message,location:we},de}catch{}}}function D(N,V,H,de,ke){let Te="Internal error",we=null;try{Te=(N&&N.message||N)+""}catch{}try{we=$(V,(N.stack+"").split(`
`),"")}catch{}return{id:"",pluginName:ke,text:Te,location:we,notes:de?[de]:[],detail:H?H.store(N):-1}}function $(N,V,H){let de="    at ";if(N.readFileSync&&!V[0].startsWith(de)&&V[1].startsWith(de))for(let ke=1;ke<V.length;ke++){let Te=V[ke];if(Te.startsWith(de))for(Te=Te.slice(de.length);;){let we=/^(?:new |async )?\S+ \((.*)\)$/.exec(Te);if(we){Te=we[1];continue}if(we=/^eval at \S+ \((.*)\)(?:, \S+:\d+:\d+)?$/.exec(Te),we){Te=we[1];continue}if(we=/^(\S+):(\d+):(\d+)$/.exec(Te),we){let Me;try{Me=N.readFileSync(we[1],"utf8")}catch{break}let he=Me.split(/\r\n|\r|\n|\u2028|\u2029/)[+we[2]-1]||"",We=+we[3]-1,Xe=he.slice(We,We+H.length)===H?H.length:0;return{file:we[1],namespace:"file",line:+we[2],column:f(he.slice(0,We)).length,length:f(he.slice(We,We+Xe)).length,lineText:he+`
`+V.slice(1).join(`
`),suggestion:""}}break}}return null}function ue(N,V,H){let de=5;N+=V.length<1?"":` with ${V.length} error${V.length<2?"":"s"}:`+V.slice(0,de+1).map((Te,we)=>{if(we===de)return`
...`;if(!Te.location)return`
error: ${Te.text}`;let{file:Me,line:he,column:We}=Te.location,Xe=Te.pluginName?`[plugin: ${Te.pluginName}] `:"";return`
${Me}:${he}:${We}: ERROR: ${Xe}${Te.text}`}).join("");let ke=new Error(N);for(let[Te,we]of[["errors",V],["warnings",H]])Object.defineProperty(ke,Te,{configurable:!0,enumerable:!0,get:()=>we,set:Me=>Object.defineProperty(ke,Te,{configurable:!0,enumerable:!0,value:Me})});return ke}function ce(N,V){for(let H of N)H.detail=V.load(H.detail);return N}function X(N,V,H){if(N==null)return null;let de={},ke=U(N,de,"file",E),Te=U(N,de,"namespace",E),we=U(N,de,"line",P),Me=U(N,de,"column",P),he=U(N,de,"length",P),We=U(N,de,"lineText",E),Xe=U(N,de,"suggestion",E);if(me(N,de,V),We){let et=We.slice(0,(Me&&Me>0?Me:0)+(he&&he>0?he:0)+(H&&H>0?H:80));!/[\x7F-\uFFFF]/.test(et)&&!/\n/.test(We)&&(We=et)}return{file:ke||"",namespace:Te||"",line:we||0,column:Me||0,length:he||0,lineText:We||"",suggestion:Xe||""}}function ge(N,V,H,de,ke){let Te=[],we=0;for(let Me of N){let he={},We=U(Me,he,"id",E),Xe=U(Me,he,"pluginName",E),et=U(Me,he,"text",E),Pt=U(Me,he,"location",Re),dt=U(Me,he,"notes",y),st=U(Me,he,"detail",A),ni=`in element ${we} of "${V}"`;me(Me,he,ni);let Ie=[];if(dt)for(let pt of dt){let mt={},Ee=U(pt,mt,"text",E),ne=U(pt,mt,"location",Re);me(pt,mt,ni),Ie.push({text:Ee||"",location:X(ne,ni,ke)})}Te.push({id:We||"",pluginName:Xe||de,text:et||"",location:X(Pt,ni,ke),notes:Ie,detail:H?H.store(st):-1}),we++}return Te}function Ae(N,V){let H=[];for(let de of N){if(typeof de!="string")throw new Error(`${F(V)} must be an array of strings`);H.push(de)}return H}function Ce(N,V){let H=Object.create(null);for(let de in N){let ke=N[de];if(typeof ke!="string")throw new Error(`key ${F(de)} in object ${F(V)} must be a string`);H[de]=ke}return H}function He({path:N,contents:V,hash:H}){let de=null;return{path:N,contents:V,hash:H,get text(){let ke=this.contents;return(de===null||ke!==V)&&(V=ke,de=m(ke)),de}}}var Dt="0.21.5",ft=N=>Fr().build(N),Fi=N=>Fr().context(N),Mr=(N,V)=>Fr().transform(N,V),Li=(N,V)=>Fr().formatMessages(N,V),Nr=(N,V)=>Fr().analyzeMetafile(N,V),Gt=()=>{throw new Error('The "buildSync" API only works in node')},ln=()=>{throw new Error('The "transformSync" API only works in node')},Dn=()=>{throw new Error('The "formatMessagesSync" API only works in node')},qi=()=>{throw new Error('The "analyzeMetafileSync" API only works in node')},An=()=>(Rn&&Rn(),Promise.resolve()),_r,Rn,jr,Fr=()=>{if(jr)return jr;throw _r?new Error('You need to wait for the promise returned from "initialize" to be resolved before calling this'):new Error('You need to call "initialize" before calling this')},un=N=>{N=Jt(N||{});let V=N.wasmURL,H=N.wasmModule,de=N.worker!==!1;if(!V&&!H)throw new Error('Must provide either the "wasmURL" option or the "wasmModule" option');if(_r)throw new Error('Cannot call "initialize" more than once');return _r=Oi(V||"",H,de),_r.catch(()=>{_r=void 0}),_r},Oi=(N,V,H)=>l(void 0,null,function*(){let de;if(H){let We=new Blob([`onmessage=((postMessage) => {
      // Copyright 2018 The Go Authors. All rights reserved.
      // Use of this source code is governed by a BSD-style
      // license that can be found in the LICENSE file.
      var __async = (__this, __arguments, generator) => {
        return new Promise((resolve, reject) => {
          var fulfilled = (value) => {
            try {
              step(generator.next(value));
            } catch (e) {
              reject(e);
            }
          };
          var rejected = (value) => {
            try {
              step(generator.throw(value));
            } catch (e) {
              reject(e);
            }
          };
          var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
          step((generator = generator.apply(__this, __arguments)).next());
        });
      };
      let onmessage;
      let globalThis = {};
      for (let o = self; o; o = Object.getPrototypeOf(o))
        for (let k of Object.getOwnPropertyNames(o))
          if (!(k in globalThis))
            Object.defineProperty(globalThis, k, { get: () => self[k] });
      "use strict";
      (() => {
        const enosys = () => {
          const err = new Error("not implemented");
          err.code = "ENOSYS";
          return err;
        };
        if (!globalThis.fs) {
          let outputBuf = "";
          globalThis.fs = {
            constants: { O_WRONLY: -1, O_RDWR: -1, O_CREAT: -1, O_TRUNC: -1, O_APPEND: -1, O_EXCL: -1 },
            // unused
            writeSync(fd, buf) {
              outputBuf += decoder.decode(buf);
              const nl = outputBuf.lastIndexOf("\\n");
              if (nl != -1) {
                console.log(outputBuf.substring(0, nl));
                outputBuf = outputBuf.substring(nl + 1);
              }
              return buf.length;
            },
            write(fd, buf, offset, length, position, callback) {
              if (offset !== 0 || length !== buf.length || position !== null) {
                callback(enosys());
                return;
              }
              const n = this.writeSync(fd, buf);
              callback(null, n);
            },
            chmod(path, mode, callback) {
              callback(enosys());
            },
            chown(path, uid, gid, callback) {
              callback(enosys());
            },
            close(fd, callback) {
              callback(enosys());
            },
            fchmod(fd, mode, callback) {
              callback(enosys());
            },
            fchown(fd, uid, gid, callback) {
              callback(enosys());
            },
            fstat(fd, callback) {
              callback(enosys());
            },
            fsync(fd, callback) {
              callback(null);
            },
            ftruncate(fd, length, callback) {
              callback(enosys());
            },
            lchown(path, uid, gid, callback) {
              callback(enosys());
            },
            link(path, link, callback) {
              callback(enosys());
            },
            lstat(path, callback) {
              callback(enosys());
            },
            mkdir(path, perm, callback) {
              callback(enosys());
            },
            open(path, flags, mode, callback) {
              callback(enosys());
            },
            read(fd, buffer, offset, length, position, callback) {
              callback(enosys());
            },
            readdir(path, callback) {
              callback(enosys());
            },
            readlink(path, callback) {
              callback(enosys());
            },
            rename(from, to, callback) {
              callback(enosys());
            },
            rmdir(path, callback) {
              callback(enosys());
            },
            stat(path, callback) {
              callback(enosys());
            },
            symlink(path, link, callback) {
              callback(enosys());
            },
            truncate(path, length, callback) {
              callback(enosys());
            },
            unlink(path, callback) {
              callback(enosys());
            },
            utimes(path, atime, mtime, callback) {
              callback(enosys());
            }
          };
        }
        if (!globalThis.process) {
          globalThis.process = {
            getuid() {
              return -1;
            },
            getgid() {
              return -1;
            },
            geteuid() {
              return -1;
            },
            getegid() {
              return -1;
            },
            getgroups() {
              throw enosys();
            },
            pid: -1,
            ppid: -1,
            umask() {
              throw enosys();
            },
            cwd() {
              throw enosys();
            },
            chdir() {
              throw enosys();
            }
          };
        }
        if (!globalThis.crypto) {
          throw new Error("globalThis.crypto is not available, polyfill required (crypto.getRandomValues only)");
        }
        if (!globalThis.performance) {
          throw new Error("globalThis.performance is not available, polyfill required (performance.now only)");
        }
        if (!globalThis.TextEncoder) {
          throw new Error("globalThis.TextEncoder is not available, polyfill required");
        }
        if (!globalThis.TextDecoder) {
          throw new Error("globalThis.TextDecoder is not available, polyfill required");
        }
        const encoder = new TextEncoder("utf-8");
        const decoder = new TextDecoder("utf-8");
        globalThis.Go = class {
          constructor() {
            this.argv = ["js"];
            this.env = {};
            this.exit = (code) => {
              if (code !== 0) {
                console.warn("exit code:", code);
              }
            };
            this._exitPromise = new Promise((resolve) => {
              this._resolveExitPromise = resolve;
            });
            this._pendingEvent = null;
            this._scheduledTimeouts = /* @__PURE__ */ new Map();
            this._nextCallbackTimeoutID = 1;
            const setInt64 = (addr, v) => {
              this.mem.setUint32(addr + 0, v, true);
              this.mem.setUint32(addr + 4, Math.floor(v / 4294967296), true);
            };
            const getInt64 = (addr) => {
              const low = this.mem.getUint32(addr + 0, true);
              const high = this.mem.getInt32(addr + 4, true);
              return low + high * 4294967296;
            };
            const loadValue = (addr) => {
              const f = this.mem.getFloat64(addr, true);
              if (f === 0) {
                return void 0;
              }
              if (!isNaN(f)) {
                return f;
              }
              const id = this.mem.getUint32(addr, true);
              return this._values[id];
            };
            const storeValue = (addr, v) => {
              const nanHead = 2146959360;
              if (typeof v === "number" && v !== 0) {
                if (isNaN(v)) {
                  this.mem.setUint32(addr + 4, nanHead, true);
                  this.mem.setUint32(addr, 0, true);
                  return;
                }
                this.mem.setFloat64(addr, v, true);
                return;
              }
              if (v === void 0) {
                this.mem.setFloat64(addr, 0, true);
                return;
              }
              let id = this._ids.get(v);
              if (id === void 0) {
                id = this._idPool.pop();
                if (id === void 0) {
                  id = this._values.length;
                }
                this._values[id] = v;
                this._goRefCounts[id] = 0;
                this._ids.set(v, id);
              }
              this._goRefCounts[id]++;
              let typeFlag = 0;
              switch (typeof v) {
                case "object":
                  if (v !== null) {
                    typeFlag = 1;
                  }
                  break;
                case "string":
                  typeFlag = 2;
                  break;
                case "symbol":
                  typeFlag = 3;
                  break;
                case "function":
                  typeFlag = 4;
                  break;
              }
              this.mem.setUint32(addr + 4, nanHead | typeFlag, true);
              this.mem.setUint32(addr, id, true);
            };
            const loadSlice = (addr) => {
              const array = getInt64(addr + 0);
              const len = getInt64(addr + 8);
              return new Uint8Array(this._inst.exports.mem.buffer, array, len);
            };
            const loadSliceOfValues = (addr) => {
              const array = getInt64(addr + 0);
              const len = getInt64(addr + 8);
              const a = new Array(len);
              for (let i = 0; i < len; i++) {
                a[i] = loadValue(array + i * 8);
              }
              return a;
            };
            const loadString = (addr) => {
              const saddr = getInt64(addr + 0);
              const len = getInt64(addr + 8);
              return decoder.decode(new DataView(this._inst.exports.mem.buffer, saddr, len));
            };
            const timeOrigin = Date.now() - performance.now();
            this.importObject = {
              go: {
                // Go's SP does not change as long as no Go code is running. Some operations (e.g. calls, getters and setters)
                // may synchronously trigger a Go event handler. This makes Go code get executed in the middle of the imported
                // function. A goroutine can switch to a new stack if the current stack is too small (see morestack function).
                // This changes the SP, thus we have to update the SP used by the imported function.
                // func wasmExit(code int32)
                "runtime.wasmExit": (sp) => {
                  sp >>>= 0;
                  const code = this.mem.getInt32(sp + 8, true);
                  this.exited = true;
                  delete this._inst;
                  delete this._values;
                  delete this._goRefCounts;
                  delete this._ids;
                  delete this._idPool;
                  this.exit(code);
                },
                // func wasmWrite(fd uintptr, p unsafe.Pointer, n int32)
                "runtime.wasmWrite": (sp) => {
                  sp >>>= 0;
                  const fd = getInt64(sp + 8);
                  const p = getInt64(sp + 16);
                  const n = this.mem.getInt32(sp + 24, true);
                  globalThis.fs.writeSync(fd, new Uint8Array(this._inst.exports.mem.buffer, p, n));
                },
                // func resetMemoryDataView()
                "runtime.resetMemoryDataView": (sp) => {
                  sp >>>= 0;
                  this.mem = new DataView(this._inst.exports.mem.buffer);
                },
                // func nanotime1() int64
                "runtime.nanotime1": (sp) => {
                  sp >>>= 0;
                  setInt64(sp + 8, (timeOrigin + performance.now()) * 1e6);
                },
                // func walltime() (sec int64, nsec int32)
                "runtime.walltime": (sp) => {
                  sp >>>= 0;
                  const msec = (/* @__PURE__ */ new Date()).getTime();
                  setInt64(sp + 8, msec / 1e3);
                  this.mem.setInt32(sp + 16, msec % 1e3 * 1e6, true);
                },
                // func scheduleTimeoutEvent(delay int64) int32
                "runtime.scheduleTimeoutEvent": (sp) => {
                  sp >>>= 0;
                  const id = this._nextCallbackTimeoutID;
                  this._nextCallbackTimeoutID++;
                  this._scheduledTimeouts.set(id, setTimeout(
                    () => {
                      this._resume();
                      while (this._scheduledTimeouts.has(id)) {
                        console.warn("scheduleTimeoutEvent: missed timeout event");
                        this._resume();
                      }
                    },
                    getInt64(sp + 8) + 1
                    // setTimeout has been seen to fire up to 1 millisecond early
                  ));
                  this.mem.setInt32(sp + 16, id, true);
                },
                // func clearTimeoutEvent(id int32)
                "runtime.clearTimeoutEvent": (sp) => {
                  sp >>>= 0;
                  const id = this.mem.getInt32(sp + 8, true);
                  clearTimeout(this._scheduledTimeouts.get(id));
                  this._scheduledTimeouts.delete(id);
                },
                // func getRandomData(r []byte)
                "runtime.getRandomData": (sp) => {
                  sp >>>= 0;
                  crypto.getRandomValues(loadSlice(sp + 8));
                },
                // func finalizeRef(v ref)
                "syscall/js.finalizeRef": (sp) => {
                  sp >>>= 0;
                  const id = this.mem.getUint32(sp + 8, true);
                  this._goRefCounts[id]--;
                  if (this._goRefCounts[id] === 0) {
                    const v = this._values[id];
                    this._values[id] = null;
                    this._ids.delete(v);
                    this._idPool.push(id);
                  }
                },
                // func stringVal(value string) ref
                "syscall/js.stringVal": (sp) => {
                  sp >>>= 0;
                  storeValue(sp + 24, loadString(sp + 8));
                },
                // func valueGet(v ref, p string) ref
                "syscall/js.valueGet": (sp) => {
                  sp >>>= 0;
                  const result = Reflect.get(loadValue(sp + 8), loadString(sp + 16));
                  sp = this._inst.exports.getsp() >>> 0;
                  storeValue(sp + 32, result);
                },
                // func valueSet(v ref, p string, x ref)
                "syscall/js.valueSet": (sp) => {
                  sp >>>= 0;
                  Reflect.set(loadValue(sp + 8), loadString(sp + 16), loadValue(sp + 32));
                },
                // func valueDelete(v ref, p string)
                "syscall/js.valueDelete": (sp) => {
                  sp >>>= 0;
                  Reflect.deleteProperty(loadValue(sp + 8), loadString(sp + 16));
                },
                // func valueIndex(v ref, i int) ref
                "syscall/js.valueIndex": (sp) => {
                  sp >>>= 0;
                  storeValue(sp + 24, Reflect.get(loadValue(sp + 8), getInt64(sp + 16)));
                },
                // valueSetIndex(v ref, i int, x ref)
                "syscall/js.valueSetIndex": (sp) => {
                  sp >>>= 0;
                  Reflect.set(loadValue(sp + 8), getInt64(sp + 16), loadValue(sp + 24));
                },
                // func valueCall(v ref, m string, args []ref) (ref, bool)
                "syscall/js.valueCall": (sp) => {
                  sp >>>= 0;
                  try {
                    const v = loadValue(sp + 8);
                    const m = Reflect.get(v, loadString(sp + 16));
                    const args = loadSliceOfValues(sp + 32);
                    const result = Reflect.apply(m, v, args);
                    sp = this._inst.exports.getsp() >>> 0;
                    storeValue(sp + 56, result);
                    this.mem.setUint8(sp + 64, 1);
                  } catch (err) {
                    sp = this._inst.exports.getsp() >>> 0;
                    storeValue(sp + 56, err);
                    this.mem.setUint8(sp + 64, 0);
                  }
                },
                // func valueInvoke(v ref, args []ref) (ref, bool)
                "syscall/js.valueInvoke": (sp) => {
                  sp >>>= 0;
                  try {
                    const v = loadValue(sp + 8);
                    const args = loadSliceOfValues(sp + 16);
                    const result = Reflect.apply(v, void 0, args);
                    sp = this._inst.exports.getsp() >>> 0;
                    storeValue(sp + 40, result);
                    this.mem.setUint8(sp + 48, 1);
                  } catch (err) {
                    sp = this._inst.exports.getsp() >>> 0;
                    storeValue(sp + 40, err);
                    this.mem.setUint8(sp + 48, 0);
                  }
                },
                // func valueNew(v ref, args []ref) (ref, bool)
                "syscall/js.valueNew": (sp) => {
                  sp >>>= 0;
                  try {
                    const v = loadValue(sp + 8);
                    const args = loadSliceOfValues(sp + 16);
                    const result = Reflect.construct(v, args);
                    sp = this._inst.exports.getsp() >>> 0;
                    storeValue(sp + 40, result);
                    this.mem.setUint8(sp + 48, 1);
                  } catch (err) {
                    sp = this._inst.exports.getsp() >>> 0;
                    storeValue(sp + 40, err);
                    this.mem.setUint8(sp + 48, 0);
                  }
                },
                // func valueLength(v ref) int
                "syscall/js.valueLength": (sp) => {
                  sp >>>= 0;
                  setInt64(sp + 16, parseInt(loadValue(sp + 8).length));
                },
                // valuePrepareString(v ref) (ref, int)
                "syscall/js.valuePrepareString": (sp) => {
                  sp >>>= 0;
                  const str = encoder.encode(String(loadValue(sp + 8)));
                  storeValue(sp + 16, str);
                  setInt64(sp + 24, str.length);
                },
                // valueLoadString(v ref, b []byte)
                "syscall/js.valueLoadString": (sp) => {
                  sp >>>= 0;
                  const str = loadValue(sp + 8);
                  loadSlice(sp + 16).set(str);
                },
                // func valueInstanceOf(v ref, t ref) bool
                "syscall/js.valueInstanceOf": (sp) => {
                  sp >>>= 0;
                  this.mem.setUint8(sp + 24, loadValue(sp + 8) instanceof loadValue(sp + 16) ? 1 : 0);
                },
                // func copyBytesToGo(dst []byte, src ref) (int, bool)
                "syscall/js.copyBytesToGo": (sp) => {
                  sp >>>= 0;
                  const dst = loadSlice(sp + 8);
                  const src = loadValue(sp + 32);
                  if (!(src instanceof Uint8Array || src instanceof Uint8ClampedArray)) {
                    this.mem.setUint8(sp + 48, 0);
                    return;
                  }
                  const toCopy = src.subarray(0, dst.length);
                  dst.set(toCopy);
                  setInt64(sp + 40, toCopy.length);
                  this.mem.setUint8(sp + 48, 1);
                },
                // func copyBytesToJS(dst ref, src []byte) (int, bool)
                "syscall/js.copyBytesToJS": (sp) => {
                  sp >>>= 0;
                  const dst = loadValue(sp + 8);
                  const src = loadSlice(sp + 16);
                  if (!(dst instanceof Uint8Array || dst instanceof Uint8ClampedArray)) {
                    this.mem.setUint8(sp + 48, 0);
                    return;
                  }
                  const toCopy = src.subarray(0, dst.length);
                  dst.set(toCopy);
                  setInt64(sp + 40, toCopy.length);
                  this.mem.setUint8(sp + 48, 1);
                },
                "debug": (value) => {
                  console.log(value);
                }
              }
            };
          }
          run(instance) {
            return __async(this, null, function* () {
              if (!(instance instanceof WebAssembly.Instance)) {
                throw new Error("Go.run: WebAssembly.Instance expected");
              }
              this._inst = instance;
              this.mem = new DataView(this._inst.exports.mem.buffer);
              this._values = [
                // JS values that Go currently has references to, indexed by reference id
                NaN,
                0,
                null,
                true,
                false,
                globalThis,
                this
              ];
              this._goRefCounts = new Array(this._values.length).fill(Infinity);
              this._ids = /* @__PURE__ */ new Map([
                // mapping from JS values to reference ids
                [0, 1],
                [null, 2],
                [true, 3],
                [false, 4],
                [globalThis, 5],
                [this, 6]
              ]);
              this._idPool = [];
              this.exited = false;
              let offset = 4096;
              const strPtr = (str) => {
                const ptr = offset;
                const bytes = encoder.encode(str + "\\0");
                new Uint8Array(this.mem.buffer, offset, bytes.length).set(bytes);
                offset += bytes.length;
                if (offset % 8 !== 0) {
                  offset += 8 - offset % 8;
                }
                return ptr;
              };
              const argc = this.argv.length;
              const argvPtrs = [];
              this.argv.forEach((arg) => {
                argvPtrs.push(strPtr(arg));
              });
              argvPtrs.push(0);
              const keys = Object.keys(this.env).sort();
              keys.forEach((key) => {
                argvPtrs.push(strPtr(\`\${key}=\${this.env[key]}\`));
              });
              argvPtrs.push(0);
              const argv = offset;
              argvPtrs.forEach((ptr) => {
                this.mem.setUint32(offset, ptr, true);
                this.mem.setUint32(offset + 4, 0, true);
                offset += 8;
              });
              const wasmMinDataAddr = 4096 + 8192;
              if (offset >= wasmMinDataAddr) {
                throw new Error("total length of command line and environment variables exceeds limit");
              }
              this._inst.exports.run(argc, argv);
              if (this.exited) {
                this._resolveExitPromise();
              }
              yield this._exitPromise;
            });
          }
          _resume() {
            if (this.exited) {
              throw new Error("Go program has already exited");
            }
            this._inst.exports.resume();
            if (this.exited) {
              this._resolveExitPromise();
            }
          }
          _makeFuncWrapper(id) {
            const go = this;
            return function() {
              const event = { id, this: this, args: arguments };
              go._pendingEvent = event;
              go._resume();
              return event.result;
            };
          }
        };
      })();
      onmessage = ({ data: wasm }) => {
        let decoder = new TextDecoder();
        let fs = globalThis.fs;
        let stderr = "";
        fs.writeSync = (fd, buffer) => {
          if (fd === 1) {
            postMessage(buffer);
          } else if (fd === 2) {
            stderr += decoder.decode(buffer);
            let parts = stderr.split("\\n");
            if (parts.length > 1) console.log(parts.slice(0, -1).join("\\n"));
            stderr = parts[parts.length - 1];
          } else {
            throw new Error("Bad write");
          }
          return buffer.length;
        };
        let stdin = [];
        let resumeStdin;
        let stdinPos = 0;
        onmessage = ({ data }) => {
          if (data.length > 0) {
            stdin.push(data);
            if (resumeStdin) resumeStdin();
          }
          return go;
        };
        fs.read = (fd, buffer, offset, length, position, callback) => {
          if (fd !== 0 || offset !== 0 || length !== buffer.length || position !== null) {
            throw new Error("Bad read");
          }
          if (stdin.length === 0) {
            resumeStdin = () => fs.read(fd, buffer, offset, length, position, callback);
            return;
          }
          let first = stdin[0];
          let count = Math.max(0, Math.min(length, first.length - stdinPos));
          buffer.set(first.subarray(stdinPos, stdinPos + count), offset);
          stdinPos += count;
          if (stdinPos === first.length) {
            stdin.shift();
            stdinPos = 0;
          }
          callback(null, count);
        };
        let go = new globalThis.Go();
        go.argv = ["", \`--service=\${"0.21.5"}\`];
        tryToInstantiateModule(wasm, go).then(
          (instance) => {
            postMessage(null);
            go.run(instance);
          },
          (error) => {
            postMessage(error);
          }
        );
        return go;
      };
      function tryToInstantiateModule(wasm, go) {
        return __async(this, null, function* () {
          if (wasm instanceof WebAssembly.Module) {
            return WebAssembly.instantiate(wasm, go.importObject);
          }
          const res = yield fetch(wasm);
          if (!res.ok) throw new Error(\`Failed to download \${JSON.stringify(wasm)}\`);
          if ("instantiateStreaming" in WebAssembly && /^application\\/wasm($|;)/i.test(res.headers.get("Content-Type") || "")) {
            const result2 = yield WebAssembly.instantiateStreaming(res, go.importObject);
            return result2.instance;
          }
          const bytes = yield res.arrayBuffer();
          const result = yield WebAssembly.instantiate(bytes, go.importObject);
          return result.instance;
        });
      }
      return (m) => onmessage(m);
    })(postMessage)`],{type:"text/javascript"});de=new Worker(URL.createObjectURL(We))}else{let We=(et=>{var Pt=(Ie,pt,mt)=>new Promise((Ee,ne)=>{var Q=xe=>{try{Pe(mt.next(xe))}catch(je){ne(je)}},te=xe=>{try{Pe(mt.throw(xe))}catch(je){ne(je)}},Pe=xe=>xe.done?Ee(xe.value):Promise.resolve(xe.value).then(Q,te);Pe((mt=mt.apply(Ie,pt)).next())});let dt,st={};for(let Ie=self;Ie;Ie=Object.getPrototypeOf(Ie))for(let pt of Object.getOwnPropertyNames(Ie))pt in st||Object.defineProperty(st,pt,{get:()=>self[pt]});(()=>{let Ie=()=>{let Ee=new Error("not implemented");return Ee.code="ENOSYS",Ee};if(!st.fs){let Ee="";st.fs={constants:{O_WRONLY:-1,O_RDWR:-1,O_CREAT:-1,O_TRUNC:-1,O_APPEND:-1,O_EXCL:-1},writeSync(ne,Q){Ee+=mt.decode(Q);let te=Ee.lastIndexOf(`
`);return te!=-1&&(console.log(Ee.substring(0,te)),Ee=Ee.substring(te+1)),Q.length},write(ne,Q,te,Pe,xe,je){if(te!==0||Pe!==Q.length||xe!==null){je(Ie());return}let Ke=this.writeSync(ne,Q);je(null,Ke)},chmod(ne,Q,te){te(Ie())},chown(ne,Q,te,Pe){Pe(Ie())},close(ne,Q){Q(Ie())},fchmod(ne,Q,te){te(Ie())},fchown(ne,Q,te,Pe){Pe(Ie())},fstat(ne,Q){Q(Ie())},fsync(ne,Q){Q(null)},ftruncate(ne,Q,te){te(Ie())},lchown(ne,Q,te,Pe){Pe(Ie())},link(ne,Q,te){te(Ie())},lstat(ne,Q){Q(Ie())},mkdir(ne,Q,te){te(Ie())},open(ne,Q,te,Pe){Pe(Ie())},read(ne,Q,te,Pe,xe,je){je(Ie())},readdir(ne,Q){Q(Ie())},readlink(ne,Q){Q(Ie())},rename(ne,Q,te){te(Ie())},rmdir(ne,Q){Q(Ie())},stat(ne,Q){Q(Ie())},symlink(ne,Q,te){te(Ie())},truncate(ne,Q,te){te(Ie())},unlink(ne,Q){Q(Ie())},utimes(ne,Q,te,Pe){Pe(Ie())}}}if(st.process||(st.process={getuid(){return-1},getgid(){return-1},geteuid(){return-1},getegid(){return-1},getgroups(){throw Ie()},pid:-1,ppid:-1,umask(){throw Ie()},cwd(){throw Ie()},chdir(){throw Ie()}}),!st.crypto)throw new Error("globalThis.crypto is not available, polyfill required (crypto.getRandomValues only)");if(!st.performance)throw new Error("globalThis.performance is not available, polyfill required (performance.now only)");if(!st.TextEncoder)throw new Error("globalThis.TextEncoder is not available, polyfill required");if(!st.TextDecoder)throw new Error("globalThis.TextDecoder is not available, polyfill required");let pt=new TextEncoder("utf-8"),mt=new TextDecoder("utf-8");st.Go=class{constructor(){this.argv=["js"],this.env={},this.exit=R=>{R!==0&&console.warn("exit code:",R)},this._exitPromise=new Promise(R=>{this._resolveExitPromise=R}),this._pendingEvent=null,this._scheduledTimeouts=new Map,this._nextCallbackTimeoutID=1;let Ee=(R,q)=>{this.mem.setUint32(R+0,q,!0),this.mem.setUint32(R+4,Math.floor(q/4294967296),!0)},ne=R=>{let q=this.mem.getUint32(R+0,!0),be=this.mem.getInt32(R+4,!0);return q+be*4294967296},Q=R=>{let q=this.mem.getFloat64(R,!0);if(q===0)return;if(!isNaN(q))return q;let be=this.mem.getUint32(R,!0);return this._values[be]},te=(R,q)=>{if(typeof q=="number"&&q!==0){if(isNaN(q)){this.mem.setUint32(R+4,2146959360,!0),this.mem.setUint32(R,0,!0);return}this.mem.setFloat64(R,q,!0);return}if(q===void 0){this.mem.setFloat64(R,0,!0);return}let De=this._ids.get(q);De===void 0&&(De=this._idPool.pop(),De===void 0&&(De=this._values.length),this._values[De]=q,this._goRefCounts[De]=0,this._ids.set(q,De)),this._goRefCounts[De]++;let Ue=0;switch(typeof q){case"object":q!==null&&(Ue=1);break;case"string":Ue=2;break;case"symbol":Ue=3;break;case"function":Ue=4;break}this.mem.setUint32(R+4,2146959360|Ue,!0),this.mem.setUint32(R,De,!0)},Pe=R=>{let q=ne(R+0),be=ne(R+8);return new Uint8Array(this._inst.exports.mem.buffer,q,be)},xe=R=>{let q=ne(R+0),be=ne(R+8),De=new Array(be);for(let Ue=0;Ue<be;Ue++)De[Ue]=Q(q+Ue*8);return De},je=R=>{let q=ne(R+0),be=ne(R+8);return mt.decode(new DataView(this._inst.exports.mem.buffer,q,be))},Ke=Date.now()-performance.now();this.importObject={go:{"runtime.wasmExit":R=>{R>>>=0;let q=this.mem.getInt32(R+8,!0);this.exited=!0,delete this._inst,delete this._values,delete this._goRefCounts,delete this._ids,delete this._idPool,this.exit(q)},"runtime.wasmWrite":R=>{R>>>=0;let q=ne(R+8),be=ne(R+16),De=this.mem.getInt32(R+24,!0);st.fs.writeSync(q,new Uint8Array(this._inst.exports.mem.buffer,be,De))},"runtime.resetMemoryDataView":R=>{R>>>=0,this.mem=new DataView(this._inst.exports.mem.buffer)},"runtime.nanotime1":R=>{R>>>=0,Ee(R+8,(Ke+performance.now())*1e6)},"runtime.walltime":R=>{R>>>=0;let q=new Date().getTime();Ee(R+8,q/1e3),this.mem.setInt32(R+16,q%1e3*1e6,!0)},"runtime.scheduleTimeoutEvent":R=>{R>>>=0;let q=this._nextCallbackTimeoutID;this._nextCallbackTimeoutID++,this._scheduledTimeouts.set(q,setTimeout(()=>{for(this._resume();this._scheduledTimeouts.has(q);)console.warn("scheduleTimeoutEvent: missed timeout event"),this._resume()},ne(R+8)+1)),this.mem.setInt32(R+16,q,!0)},"runtime.clearTimeoutEvent":R=>{R>>>=0;let q=this.mem.getInt32(R+8,!0);clearTimeout(this._scheduledTimeouts.get(q)),this._scheduledTimeouts.delete(q)},"runtime.getRandomData":R=>{R>>>=0,crypto.getRandomValues(Pe(R+8))},"syscall/js.finalizeRef":R=>{R>>>=0;let q=this.mem.getUint32(R+8,!0);if(this._goRefCounts[q]--,this._goRefCounts[q]===0){let be=this._values[q];this._values[q]=null,this._ids.delete(be),this._idPool.push(q)}},"syscall/js.stringVal":R=>{R>>>=0,te(R+24,je(R+8))},"syscall/js.valueGet":R=>{R>>>=0;let q=Reflect.get(Q(R+8),je(R+16));R=this._inst.exports.getsp()>>>0,te(R+32,q)},"syscall/js.valueSet":R=>{R>>>=0,Reflect.set(Q(R+8),je(R+16),Q(R+32))},"syscall/js.valueDelete":R=>{R>>>=0,Reflect.deleteProperty(Q(R+8),je(R+16))},"syscall/js.valueIndex":R=>{R>>>=0,te(R+24,Reflect.get(Q(R+8),ne(R+16)))},"syscall/js.valueSetIndex":R=>{R>>>=0,Reflect.set(Q(R+8),ne(R+16),Q(R+24))},"syscall/js.valueCall":R=>{R>>>=0;try{let q=Q(R+8),be=Reflect.get(q,je(R+16)),De=xe(R+32),Ue=Reflect.apply(be,q,De);R=this._inst.exports.getsp()>>>0,te(R+56,Ue),this.mem.setUint8(R+64,1)}catch(q){R=this._inst.exports.getsp()>>>0,te(R+56,q),this.mem.setUint8(R+64,0)}},"syscall/js.valueInvoke":R=>{R>>>=0;try{let q=Q(R+8),be=xe(R+16),De=Reflect.apply(q,void 0,be);R=this._inst.exports.getsp()>>>0,te(R+40,De),this.mem.setUint8(R+48,1)}catch(q){R=this._inst.exports.getsp()>>>0,te(R+40,q),this.mem.setUint8(R+48,0)}},"syscall/js.valueNew":R=>{R>>>=0;try{let q=Q(R+8),be=xe(R+16),De=Reflect.construct(q,be);R=this._inst.exports.getsp()>>>0,te(R+40,De),this.mem.setUint8(R+48,1)}catch(q){R=this._inst.exports.getsp()>>>0,te(R+40,q),this.mem.setUint8(R+48,0)}},"syscall/js.valueLength":R=>{R>>>=0,Ee(R+16,parseInt(Q(R+8).length))},"syscall/js.valuePrepareString":R=>{R>>>=0;let q=pt.encode(String(Q(R+8)));te(R+16,q),Ee(R+24,q.length)},"syscall/js.valueLoadString":R=>{R>>>=0;let q=Q(R+8);Pe(R+16).set(q)},"syscall/js.valueInstanceOf":R=>{R>>>=0,this.mem.setUint8(R+24,Q(R+8)instanceof Q(R+16)?1:0)},"syscall/js.copyBytesToGo":R=>{R>>>=0;let q=Pe(R+8),be=Q(R+32);if(!(be instanceof Uint8Array||be instanceof Uint8ClampedArray)){this.mem.setUint8(R+48,0);return}let De=be.subarray(0,q.length);q.set(De),Ee(R+40,De.length),this.mem.setUint8(R+48,1)},"syscall/js.copyBytesToJS":R=>{R>>>=0;let q=Q(R+8),be=Pe(R+16);if(!(q instanceof Uint8Array||q instanceof Uint8ClampedArray)){this.mem.setUint8(R+48,0);return}let De=be.subarray(0,q.length);q.set(De),Ee(R+40,De.length),this.mem.setUint8(R+48,1)},debug:R=>{console.log(R)}}}}run(Ee){return Pt(this,null,function*(){if(!(Ee instanceof WebAssembly.Instance))throw new Error("Go.run: WebAssembly.Instance expected");this._inst=Ee,this.mem=new DataView(this._inst.exports.mem.buffer),this._values=[NaN,0,null,!0,!1,st,this],this._goRefCounts=new Array(this._values.length).fill(1/0),this._ids=new Map([[0,1],[null,2],[!0,3],[!1,4],[st,5],[this,6]]),this._idPool=[],this.exited=!1;let ne=4096,Q=R=>{let q=ne,be=pt.encode(R+"\0");return new Uint8Array(this.mem.buffer,ne,be.length).set(be),ne+=be.length,ne%8!==0&&(ne+=8-ne%8),q},te=this.argv.length,Pe=[];this.argv.forEach(R=>{Pe.push(Q(R))}),Pe.push(0),Object.keys(this.env).sort().forEach(R=>{Pe.push(Q(`${R}=${this.env[R]}`))}),Pe.push(0);let je=ne;if(Pe.forEach(R=>{this.mem.setUint32(ne,R,!0),this.mem.setUint32(ne+4,0,!0),ne+=8}),ne>=12288)throw new Error("total length of command line and environment variables exceeds limit");this._inst.exports.run(te,je),this.exited&&this._resolveExitPromise(),yield this._exitPromise})}_resume(){if(this.exited)throw new Error("Go program has already exited");this._inst.exports.resume(),this.exited&&this._resolveExitPromise()}_makeFuncWrapper(Ee){let ne=this;return function(){let Q={id:Ee,this:this,args:arguments};return ne._pendingEvent=Q,ne._resume(),Q.result}}}})(),dt=({data:Ie})=>{let pt=new TextDecoder,mt=st.fs,Ee="";mt.writeSync=(xe,je)=>{if(xe===1)et(je);else if(xe===2){Ee+=pt.decode(je);let Ke=Ee.split(`
`);Ke.length>1&&console.log(Ke.slice(0,-1).join(`
`)),Ee=Ke[Ke.length-1]}else throw new Error("Bad write");return je.length};let ne=[],Q,te=0;dt=({data:xe})=>(xe.length>0&&(ne.push(xe),Q&&Q()),Pe),mt.read=(xe,je,Ke,R,q,be)=>{if(xe!==0||Ke!==0||R!==je.length||q!==null)throw new Error("Bad read");if(ne.length===0){Q=()=>mt.read(xe,je,Ke,R,q,be);return}let De=ne[0],Ue=Math.max(0,Math.min(R,De.length-te));je.set(De.subarray(te,te+Ue),Ke),te+=Ue,te===De.length&&(ne.shift(),te=0),be(null,Ue)};let Pe=new st.Go;return Pe.argv=["","--service=0.21.5"],ni(Ie,Pe).then(xe=>{et(null),Pe.run(xe)},xe=>{et(xe)}),Pe};function ni(Ie,pt){return Pt(this,null,function*(){if(Ie instanceof WebAssembly.Module)return WebAssembly.instantiate(Ie,pt.importObject);let mt=yield fetch(Ie);if(!mt.ok)throw new Error(`Failed to download ${JSON.stringify(Ie)}`);if("instantiateStreaming"in WebAssembly&&/^application\/wasm($|;)/i.test(mt.headers.get("Content-Type")||""))return(yield WebAssembly.instantiateStreaming(mt,pt.importObject)).instance;let Ee=yield mt.arrayBuffer();return(yield WebAssembly.instantiate(Ee,pt.importObject)).instance})}return Ie=>dt(Ie)})(et=>de.onmessage({data:et})),Xe;de={onmessage:null,postMessage:et=>setTimeout(()=>Xe=We({data:et})),terminate(){if(Xe)for(let et of Xe._scheduledTimeouts.values())clearTimeout(et)}}}let ke,Te,we=new Promise((We,Xe)=>{ke=We,Te=Xe});de.onmessage=({data:We})=>{de.onmessage=({data:Xe})=>Me(Xe),We?Te(We):ke()},de.postMessage(V||new URL(N,location.href).toString());let{readFromStdout:Me,service:he}=Bi({writeToStdin(We){de.postMessage(We)},isSync:!1,hasFS:!1,esbuild:u});yield we,Rn=()=>{de.terminate(),_r=void 0,Rn=void 0,jr=void 0},jr={build:We=>new Promise((Xe,et)=>he.buildOrContext({callName:"build",refs:null,options:We,isTTY:!1,defaultWD:"/",callback:(Pt,dt)=>Pt?et(Pt):Xe(dt)})),context:We=>new Promise((Xe,et)=>he.buildOrContext({callName:"context",refs:null,options:We,isTTY:!1,defaultWD:"/",callback:(Pt,dt)=>Pt?et(Pt):Xe(dt)})),transform:(We,Xe)=>new Promise((et,Pt)=>he.transform({callName:"transform",refs:null,input:We,options:Xe||{},isTTY:!1,fs:{readFile(dt,st){st(new Error("Internal error"),null)},writeFile(dt,st){st(null)}},callback:(dt,st)=>dt?Pt(dt):et(st)})),formatMessages:(We,Xe)=>new Promise((et,Pt)=>he.formatMessages({callName:"formatMessages",refs:null,messages:We,options:Xe,callback:(dt,st)=>dt?Pt(dt):et(st)})),analyzeMetafile:(We,Xe)=>new Promise((et,Pt)=>he.analyzeMetafile({callName:"analyzeMetafile",refs:null,metafile:typeof We=="string"?We:JSON.stringify(We),options:Xe,callback:(dt,st)=>dt?Pt(dt):et(st)}))}}),Pf=u})(typeof hp=="object"?hp:{set exports(r){(typeof self<"u"?self:this).esbuild=r}})});var iu=ve(It=>{"use strict";Object.defineProperty(It,"__esModule",{value:!0});It.regexpCode=It.getEsmExportName=It.getProperty=It.safeStringify=It.stringify=It.strConcat=It.addCodeArg=It.str=It._=It.nil=It._Code=It.Name=It.IDENTIFIER=It._CodeOrName=void 0;var eu=class{};It._CodeOrName=eu;It.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;var Ws=class extends eu{constructor(e){if(super(),!It.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");this.str=e}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}};It.Name=Ws;var gr=class extends eu{constructor(e){super(),this._items=typeof e=="string"?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;let e=this._items[0];return e===""||e==='""'}get str(){var e;return(e=this._str)!==null&&e!==void 0?e:this._str=this._items.reduce((t,i)=>`${t}${i}`,"")}get names(){var e;return(e=this._names)!==null&&e!==void 0?e:this._names=this._items.reduce((t,i)=>(i instanceof Ws&&(t[i.str]=(t[i.str]||0)+1),t),{})}};It._Code=gr;It.nil=new gr("");function F0(r,...e){let t=[r[0]],i=0;for(;i<e.length;)yp(t,e[i]),t.push(r[++i]);return new gr(t)}It._=F0;var bp=new gr("+");function k0(r,...e){let t=[tu(r[0])],i=0;for(;i<e.length;)t.push(bp),yp(t,e[i]),t.push(bp,tu(r[++i]));return Gx(t),new gr(t)}It.str=k0;function yp(r,e){e instanceof gr?r.push(...e._items):e instanceof Ws?r.push(e):r.push(Wx(e))}It.addCodeArg=yp;function Gx(r){let e=1;for(;e<r.length-1;){if(r[e]===bp){let t=zx(r[e-1],r[e+1]);if(t!==void 0){r.splice(e-1,3,t);continue}r[e++]="+"}e++}}function zx(r,e){if(e==='""')return r;if(r==='""')return e;if(typeof r=="string")return e instanceof Ws||r[r.length-1]!=='"'?void 0:typeof e!="string"?`${r.slice(0,-1)}${e}"`:e[0]==='"'?r.slice(0,-1)+e.slice(1):void 0;if(typeof e=="string"&&e[0]==='"'&&!(r instanceof Ws))return`"${r}${e.slice(1)}`}function Vx(r,e){return e.emptyStr()?r:r.emptyStr()?e:k0`${r}${e}`}It.strConcat=Vx;function Wx(r){return typeof r=="number"||typeof r=="boolean"||r===null?r:tu(Array.isArray(r)?r.join(","):r)}function Jx(r){return new gr(tu(r))}It.stringify=Jx;function tu(r){return JSON.stringify(r).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}It.safeStringify=tu;function $x(r){return typeof r=="string"&&It.IDENTIFIER.test(r)?new gr(`.${r}`):F0`[${r}]`}It.getProperty=$x;function Hx(r){if(typeof r=="string"&&It.IDENTIFIER.test(r))return new gr(`${r}`);throw new Error(`CodeGen: invalid export name: ${r}, use explicit $id name mapping`)}It.getEsmExportName=Hx;function qx(r){return new gr(r.toString())}It.regexpCode=qx});var _p=ve(Qi=>{"use strict";Object.defineProperty(Qi,"__esModule",{value:!0});Qi.ValueScope=Qi.ValueScopeName=Qi.Scope=Qi.varKinds=Qi.UsedValueState=void 0;var Yi=iu(),vp=class extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}},Fd;(function(r){r[r.Started=0]="Started",r[r.Completed=1]="Completed"})(Fd||(Qi.UsedValueState=Fd={}));Qi.varKinds={const:new Yi.Name("const"),let:new Yi.Name("let"),var:new Yi.Name("var")};var kd=class{constructor({prefixes:e,parent:t}={}){this._names={},this._prefixes=e,this._parent=t}toName(e){return e instanceof Yi.Name?e:this.name(e)}name(e){return new Yi.Name(this._newName(e))}_newName(e){let t=this._names[e]||this._nameGroup(e);return`${e}${t.index++}`}_nameGroup(e){var t,i;if(!((i=(t=this._parent)===null||t===void 0?void 0:t._prefixes)===null||i===void 0)&&i.has(e)||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}};Qi.Scope=kd;var Cd=class extends Yi.Name{constructor(e,t){super(t),this.prefix=e}setValue(e,{property:t,itemIndex:i}){this.value=e,this.scopePath=(0,Yi._)`.${new Yi.Name(t)}[${i}]`}};Qi.ValueScopeName=Cd;var Kx=(0,Yi._)`\n`,wp=class extends kd{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?Kx:Yi.nil}}get(){return this._scope}name(e){return new Cd(e,this._newName(e))}value(e,t){var i;if(t.ref===void 0)throw new Error("CodeGen: ref must be passed in value");let n=this.toName(e),{prefix:s}=n,o=(i=t.key)!==null&&i!==void 0?i:t.ref,a=this._values[s];if(a){let c=a.get(o);if(c)return c}else a=this._values[s]=new Map;a.set(o,n);let l=this._scope[s]||(this._scope[s]=[]),u=l.length;return l[u]=t.ref,n.setValue(t,{property:s,itemIndex:u}),n}getValue(e,t){let i=this._values[e];if(i)return i.get(t)}scopeRefs(e,t=this._values){return this._reduceValues(t,i=>{if(i.scopePath===void 0)throw new Error(`CodeGen: name "${i}" has no value`);return(0,Yi._)`${e}${i.scopePath}`})}scopeCode(e=this._values,t,i){return this._reduceValues(e,n=>{if(n.value===void 0)throw new Error(`CodeGen: name "${n}" has no value`);return n.value.code},t,i)}_reduceValues(e,t,i={},n){let s=Yi.nil;for(let o in e){let a=e[o];if(!a)continue;let l=i[o]=i[o]||new Map;a.forEach(u=>{if(l.has(u))return;l.set(u,Fd.Started);let c=t(u);if(c){let d=this.opts.es5?Qi.varKinds.var:Qi.varKinds.const;s=(0,Yi._)`${s}${d} ${u} = ${c};${this.opts._n}`}else if(c=n?.(u))s=(0,Yi._)`${s}${c}${this.opts._n}`;else throw new vp(u);l.set(u,Fd.Completed)})}return s}};Qi.ValueScope=wp});var vt=ve(ht=>{"use strict";Object.defineProperty(ht,"__esModule",{value:!0});ht.or=ht.and=ht.not=ht.CodeGen=ht.operators=ht.varKinds=ht.ValueScopeName=ht.ValueScope=ht.Scope=ht.Name=ht.regexpCode=ht.stringify=ht.getProperty=ht.nil=ht.strConcat=ht.str=ht._=void 0;var Ct=iu(),Ar=_p(),Zn=iu();Object.defineProperty(ht,"_",{enumerable:!0,get:function(){return Zn._}});Object.defineProperty(ht,"str",{enumerable:!0,get:function(){return Zn.str}});Object.defineProperty(ht,"strConcat",{enumerable:!0,get:function(){return Zn.strConcat}});Object.defineProperty(ht,"nil",{enumerable:!0,get:function(){return Zn.nil}});Object.defineProperty(ht,"getProperty",{enumerable:!0,get:function(){return Zn.getProperty}});Object.defineProperty(ht,"stringify",{enumerable:!0,get:function(){return Zn.stringify}});Object.defineProperty(ht,"regexpCode",{enumerable:!0,get:function(){return Zn.regexpCode}});Object.defineProperty(ht,"Name",{enumerable:!0,get:function(){return Zn.Name}});var Id=_p();Object.defineProperty(ht,"Scope",{enumerable:!0,get:function(){return Id.Scope}});Object.defineProperty(ht,"ValueScope",{enumerable:!0,get:function(){return Id.ValueScope}});Object.defineProperty(ht,"ValueScopeName",{enumerable:!0,get:function(){return Id.ValueScopeName}});Object.defineProperty(ht,"varKinds",{enumerable:!0,get:function(){return Id.varKinds}});ht.operators={GT:new Ct._Code(">"),GTE:new Ct._Code(">="),LT:new Ct._Code("<"),LTE:new Ct._Code("<="),EQ:new Ct._Code("==="),NEQ:new Ct._Code("!=="),NOT:new Ct._Code("!"),OR:new Ct._Code("||"),AND:new Ct._Code("&&"),ADD:new Ct._Code("+")};var _n=class{optimizeNodes(){return this}optimizeNames(e,t){return this}},Fp=class extends _n{constructor(e,t,i){super(),this.varKind=e,this.name=t,this.rhs=i}render({es5:e,_n:t}){let i=e?Ar.varKinds.var:this.varKind,n=this.rhs===void 0?"":` = ${this.rhs}`;return`${i} ${this.name}${n};`+t}optimizeNames(e,t){if(e[this.name.str])return this.rhs&&(this.rhs=Lo(this.rhs,e,t)),this}get names(){return this.rhs instanceof Ct._CodeOrName?this.rhs.names:{}}},Sd=class extends _n{constructor(e,t,i){super(),this.lhs=e,this.rhs=t,this.sideEffects=i}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,t){if(!(this.lhs instanceof Ct.Name&&!e[this.lhs.str]&&!this.sideEffects))return this.rhs=Lo(this.rhs,e,t),this}get names(){let e=this.lhs instanceof Ct.Name?{}:{...this.lhs.names};return Ed(e,this.rhs)}},kp=class extends Sd{constructor(e,t,i,n){super(e,i,n),this.op=t}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}},Cp=class extends _n{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`${this.label}:`+e}},Sp=class extends _n{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?` ${this.label}`:""};`+e}},Pp=class extends _n{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}},Ep=class extends _n{constructor(e){super(),this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,t){return this.code=Lo(this.code,e,t),this}get names(){return this.code instanceof Ct._CodeOrName?this.code.names:{}}},ru=class extends _n{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce((t,i)=>t+i.render(e),"")}optimizeNodes(){let{nodes:e}=this,t=e.length;for(;t--;){let i=e[t].optimizeNodes();Array.isArray(i)?e.splice(t,1,...i):i?e[t]=i:e.splice(t,1)}return e.length>0?this:void 0}optimizeNames(e,t){let{nodes:i}=this,n=i.length;for(;n--;){let s=i[n];s.optimizeNames(e,t)||(Xx(e,s.names),i.splice(n,1))}return i.length>0?this:void 0}get names(){return this.nodes.reduce((e,t)=>Hs(e,t.names),{})}},Fn=class extends ru{render(e){return"{"+e._n+super.render(e)+"}"+e._n}},Ip=class extends ru{},Bo=class extends Fn{};Bo.kind="else";var Js=class r extends Fn{constructor(e,t){super(t),this.condition=e}render(e){let t=`if(${this.condition})`+super.render(e);return this.else&&(t+="else "+this.else.render(e)),t}optimizeNodes(){super.optimizeNodes();let e=this.condition;if(e===!0)return this.nodes;let t=this.else;if(t){let i=t.optimizeNodes();t=this.else=Array.isArray(i)?new Bo(i):i}if(t)return e===!1?t instanceof r?t:t.nodes:this.nodes.length?this:new r(C0(e),t instanceof r?[t]:t.nodes);if(!(e===!1||!this.nodes.length))return this}optimizeNames(e,t){var i;if(this.else=(i=this.else)===null||i===void 0?void 0:i.optimizeNames(e,t),!!(super.optimizeNames(e,t)||this.else))return this.condition=Lo(this.condition,e,t),this}get names(){let e=super.names;return Ed(e,this.condition),this.else&&Hs(e,this.else.names),e}};Js.kind="if";var $s=class extends Fn{};$s.kind="for";var xp=class extends $s{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iteration=Lo(this.iteration,e,t),this}get names(){return Hs(super.names,this.iteration.names)}},Tp=class extends $s{constructor(e,t,i,n){super(),this.varKind=e,this.name=t,this.from=i,this.to=n}render(e){let t=e.es5?Ar.varKinds.var:this.varKind,{name:i,from:n,to:s}=this;return`for(${t} ${i}=${n}; ${i}<${s}; ${i}++)`+super.render(e)}get names(){let e=Ed(super.names,this.from);return Ed(e,this.to)}},Pd=class extends $s{constructor(e,t,i,n){super(),this.loop=e,this.varKind=t,this.name=i,this.iterable=n}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iterable=Lo(this.iterable,e,t),this}get names(){return Hs(super.names,this.iterable.names)}},nu=class extends Fn{constructor(e,t,i){super(),this.name=e,this.args=t,this.async=i}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}};nu.kind="func";var su=class extends ru{render(e){return"return "+super.render(e)}};su.kind="return";var Dp=class extends Fn{render(e){let t="try"+super.render(e);return this.catch&&(t+=this.catch.render(e)),this.finally&&(t+=this.finally.render(e)),t}optimizeNodes(){var e,t;return super.optimizeNodes(),(e=this.catch)===null||e===void 0||e.optimizeNodes(),(t=this.finally)===null||t===void 0||t.optimizeNodes(),this}optimizeNames(e,t){var i,n;return super.optimizeNames(e,t),(i=this.catch)===null||i===void 0||i.optimizeNames(e,t),(n=this.finally)===null||n===void 0||n.optimizeNames(e,t),this}get names(){let e=super.names;return this.catch&&Hs(e,this.catch.names),this.finally&&Hs(e,this.finally.names),e}},ou=class extends Fn{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}};ou.kind="catch";var au=class extends Fn{render(e){return"finally"+super.render(e)}};au.kind="finally";var Ap=class{constructor(e,t={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...t,_n:t.lines?`
`:""},this._extScope=e,this._scope=new Ar.Scope({parent:e}),this._nodes=[new Ip]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,t){let i=this._extScope.value(e,t);return(this._values[i.prefix]||(this._values[i.prefix]=new Set)).add(i),i}getScopeValue(e,t){return this._extScope.getValue(e,t)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,t,i,n){let s=this._scope.toName(t);return i!==void 0&&n&&(this._constants[s.str]=i),this._leafNode(new Fp(e,s,i)),s}const(e,t,i){return this._def(Ar.varKinds.const,e,t,i)}let(e,t,i){return this._def(Ar.varKinds.let,e,t,i)}var(e,t,i){return this._def(Ar.varKinds.var,e,t,i)}assign(e,t,i){return this._leafNode(new Sd(e,t,i))}add(e,t){return this._leafNode(new kp(e,ht.operators.ADD,t))}code(e){return typeof e=="function"?e():e!==Ct.nil&&this._leafNode(new Ep(e)),this}object(...e){let t=["{"];for(let[i,n]of e)t.length>1&&t.push(","),t.push(i),(i!==n||this.opts.es5)&&(t.push(":"),(0,Ct.addCodeArg)(t,n));return t.push("}"),new Ct._Code(t)}if(e,t,i){if(this._blockNode(new Js(e)),t&&i)this.code(t).else().code(i).endIf();else if(t)this.code(t).endIf();else if(i)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new Js(e))}else(){return this._elseNode(new Bo)}endIf(){return this._endBlockNode(Js,Bo)}_for(e,t){return this._blockNode(e),t&&this.code(t).endFor(),this}for(e,t){return this._for(new xp(e),t)}forRange(e,t,i,n,s=this.opts.es5?Ar.varKinds.var:Ar.varKinds.let){let o=this._scope.toName(e);return this._for(new Tp(s,o,t,i),()=>n(o))}forOf(e,t,i,n=Ar.varKinds.const){let s=this._scope.toName(e);if(this.opts.es5){let o=t instanceof Ct.Name?t:this.var("_arr",t);return this.forRange("_i",0,(0,Ct._)`${o}.length`,a=>{this.var(s,(0,Ct._)`${o}[${a}]`),i(s)})}return this._for(new Pd("of",n,s,t),()=>i(s))}forIn(e,t,i,n=this.opts.es5?Ar.varKinds.var:Ar.varKinds.const){if(this.opts.ownProperties)return this.forOf(e,(0,Ct._)`Object.keys(${t})`,i);let s=this._scope.toName(e);return this._for(new Pd("in",n,s,t),()=>i(s))}endFor(){return this._endBlockNode($s)}label(e){return this._leafNode(new Cp(e))}break(e){return this._leafNode(new Sp(e))}return(e){let t=new su;if(this._blockNode(t),this.code(e),t.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(su)}try(e,t,i){if(!t&&!i)throw new Error('CodeGen: "try" without "catch" and "finally"');let n=new Dp;if(this._blockNode(n),this.code(e),t){let s=this.name("e");this._currNode=n.catch=new ou(s),t(s)}return i&&(this._currNode=n.finally=new au,this.code(i)),this._endBlockNode(ou,au)}throw(e){return this._leafNode(new Pp(e))}block(e,t){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(t),this}endBlock(e){let t=this._blockStarts.pop();if(t===void 0)throw new Error("CodeGen: not in self-balancing block");let i=this._nodes.length-t;if(i<0||e!==void 0&&i!==e)throw new Error(`CodeGen: wrong number of nodes: ${i} vs ${e} expected`);return this._nodes.length=t,this}func(e,t=Ct.nil,i,n){return this._blockNode(new nu(e,t,i)),n&&this.code(n).endFunc(),this}endFunc(){return this._endBlockNode(nu)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,t){let i=this._currNode;if(i instanceof e||t&&i instanceof t)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${t?`${e.kind}/${t.kind}`:e.kind}"`)}_elseNode(e){let t=this._currNode;if(!(t instanceof Js))throw new Error('CodeGen: "else" without "if"');return this._currNode=t.else=e,this}get _root(){return this._nodes[0]}get _currNode(){let e=this._nodes;return e[e.length-1]}set _currNode(e){let t=this._nodes;t[t.length-1]=e}};ht.CodeGen=Ap;function Hs(r,e){for(let t in e)r[t]=(r[t]||0)+(e[t]||0);return r}function Ed(r,e){return e instanceof Ct._CodeOrName?Hs(r,e.names):r}function Lo(r,e,t){if(r instanceof Ct.Name)return i(r);if(!n(r))return r;return new Ct._Code(r._items.reduce((s,o)=>(o instanceof Ct.Name&&(o=i(o)),o instanceof Ct._Code?s.push(...o._items):s.push(o),s),[]));function i(s){let o=t[s.str];return o===void 0||e[s.str]!==1?s:(delete e[s.str],o)}function n(s){return s instanceof Ct._Code&&s._items.some(o=>o instanceof Ct.Name&&e[o.str]===1&&t[o.str]!==void 0)}}function Xx(r,e){for(let t in e)r[t]=(r[t]||0)-(e[t]||0)}function C0(r){return typeof r=="boolean"||typeof r=="number"||r===null?!r:(0,Ct._)`!${Rp(r)}`}ht.not=C0;var Zx=S0(ht.operators.AND);function Yx(...r){return r.reduce(Zx)}ht.and=Yx;var Qx=S0(ht.operators.OR);function eT(...r){return r.reduce(Qx)}ht.or=eT;function S0(r){return(e,t)=>e===Ct.nil?t:t===Ct.nil?e:(0,Ct._)`${Rp(e)} ${r} ${Rp(t)}`}function Rp(r){return r instanceof Ct.Name?r:(0,Ct._)`(${r})`}});var xt=ve(wt=>{"use strict";Object.defineProperty(wt,"__esModule",{value:!0});wt.checkStrictMode=wt.getErrorPath=wt.Type=wt.useFunc=wt.setEvaluated=wt.evaluatedPropsToName=wt.mergeEvaluated=wt.eachItem=wt.unescapeJsonPointer=wt.escapeJsonPointer=wt.escapeFragment=wt.unescapeFragment=wt.schemaRefOrVal=wt.schemaHasRulesButRef=wt.schemaHasRules=wt.checkUnknownRules=wt.alwaysValidSchema=wt.toHash=void 0;var Ut=vt(),tT=iu();function iT(r){let e={};for(let t of r)e[t]=!0;return e}wt.toHash=iT;function rT(r,e){return typeof e=="boolean"?e:Object.keys(e).length===0?!0:(I0(r,e),!x0(e,r.self.RULES.all))}wt.alwaysValidSchema=rT;function I0(r,e=r.schema){let{opts:t,self:i}=r;if(!t.strictSchema||typeof e=="boolean")return;let n=i.RULES.keywords;for(let s in e)n[s]||A0(r,`unknown keyword: "${s}"`)}wt.checkUnknownRules=I0;function x0(r,e){if(typeof r=="boolean")return!r;for(let t in r)if(e[t])return!0;return!1}wt.schemaHasRules=x0;function nT(r,e){if(typeof r=="boolean")return!r;for(let t in r)if(t!=="$ref"&&e.all[t])return!0;return!1}wt.schemaHasRulesButRef=nT;function sT({topSchemaRef:r,schemaPath:e},t,i,n){if(!n){if(typeof t=="number"||typeof t=="boolean")return t;if(typeof t=="string")return(0,Ut._)`${t}`}return(0,Ut._)`${r}${e}${(0,Ut.getProperty)(i)}`}wt.schemaRefOrVal=sT;function oT(r){return T0(decodeURIComponent(r))}wt.unescapeFragment=oT;function aT(r){return encodeURIComponent(Lp(r))}wt.escapeFragment=aT;function Lp(r){return typeof r=="number"?`${r}`:r.replace(/~/g,"~0").replace(/\//g,"~1")}wt.escapeJsonPointer=Lp;function T0(r){return r.replace(/~1/g,"/").replace(/~0/g,"~")}wt.unescapeJsonPointer=T0;function lT(r,e){if(Array.isArray(r))for(let t of r)e(t);else e(r)}wt.eachItem=lT;function P0({mergeNames:r,mergeToName:e,mergeValues:t,resultToName:i}){return(n,s,o,a)=>{let l=o===void 0?s:o instanceof Ut.Name?(s instanceof Ut.Name?r(n,s,o):e(n,s,o),o):s instanceof Ut.Name?(e(n,o,s),s):t(s,o);return a===Ut.Name&&!(l instanceof Ut.Name)?i(n,l):l}}wt.mergeEvaluated={props:P0({mergeNames:(r,e,t)=>r.if((0,Ut._)`${t} !== true && ${e} !== undefined`,()=>{r.if((0,Ut._)`${e} === true`,()=>r.assign(t,!0),()=>r.assign(t,(0,Ut._)`${t} || {}`).code((0,Ut._)`Object.assign(${t}, ${e})`))}),mergeToName:(r,e,t)=>r.if((0,Ut._)`${t} !== true`,()=>{e===!0?r.assign(t,!0):(r.assign(t,(0,Ut._)`${t} || {}`),Op(r,t,e))}),mergeValues:(r,e)=>r===!0?!0:{...r,...e},resultToName:D0}),items:P0({mergeNames:(r,e,t)=>r.if((0,Ut._)`${t} !== true && ${e} !== undefined`,()=>r.assign(t,(0,Ut._)`${e} === true ? true : ${t} > ${e} ? ${t} : ${e}`)),mergeToName:(r,e,t)=>r.if((0,Ut._)`${t} !== true`,()=>r.assign(t,e===!0?!0:(0,Ut._)`${t} > ${e} ? ${t} : ${e}`)),mergeValues:(r,e)=>r===!0?!0:Math.max(r,e),resultToName:(r,e)=>r.var("items",e)})};function D0(r,e){if(e===!0)return r.var("props",!0);let t=r.var("props",(0,Ut._)`{}`);return e!==void 0&&Op(r,t,e),t}wt.evaluatedPropsToName=D0;function Op(r,e,t){Object.keys(t).forEach(i=>r.assign((0,Ut._)`${e}${(0,Ut.getProperty)(i)}`,!0))}wt.setEvaluated=Op;var E0={};function uT(r,e){return r.scopeValue("func",{ref:e,code:E0[e.code]||(E0[e.code]=new tT._Code(e.code))})}wt.useFunc=uT;var Bp;(function(r){r[r.Num=0]="Num",r[r.Str=1]="Str"})(Bp||(wt.Type=Bp={}));function cT(r,e,t){if(r instanceof Ut.Name){let i=e===Bp.Num;return t?i?(0,Ut._)`"[" + ${r} + "]"`:(0,Ut._)`"['" + ${r} + "']"`:i?(0,Ut._)`"/" + ${r}`:(0,Ut._)`"/" + ${r}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return t?(0,Ut.getProperty)(r).toString():"/"+Lp(r)}wt.getErrorPath=cT;function A0(r,e,t=r.opts.strictSchema){if(t){if(e=`strict mode: ${e}`,t===!0)throw new Error(e);r.self.logger.warn(e)}}wt.checkStrictMode=A0});var kn=ve(Mp=>{"use strict";Object.defineProperty(Mp,"__esModule",{value:!0});var Di=vt(),dT={data:new Di.Name("data"),valCxt:new Di.Name("valCxt"),instancePath:new Di.Name("instancePath"),parentData:new Di.Name("parentData"),parentDataProperty:new Di.Name("parentDataProperty"),rootData:new Di.Name("rootData"),dynamicAnchors:new Di.Name("dynamicAnchors"),vErrors:new Di.Name("vErrors"),errors:new Di.Name("errors"),this:new Di.Name("this"),self:new Di.Name("self"),scope:new Di.Name("scope"),json:new Di.Name("json"),jsonPos:new Di.Name("jsonPos"),jsonLen:new Di.Name("jsonLen"),jsonPart:new Di.Name("jsonPart")};Mp.default=dT});var lu=ve(Ai=>{"use strict";Object.defineProperty(Ai,"__esModule",{value:!0});Ai.extendErrors=Ai.resetErrorsCount=Ai.reportExtraError=Ai.reportError=Ai.keyword$DataError=Ai.keywordError=void 0;var St=vt(),xd=xt(),Wi=kn();Ai.keywordError={message:({keyword:r})=>(0,St.str)`must pass "${r}" keyword validation`};Ai.keyword$DataError={message:({keyword:r,schemaType:e})=>e?(0,St.str)`"${r}" keyword must be ${e} ($data)`:(0,St.str)`"${r}" keyword is invalid ($data)`};function fT(r,e=Ai.keywordError,t,i){let{it:n}=r,{gen:s,compositeRule:o,allErrors:a}=n,l=L0(r,e,t);i??(o||a)?R0(s,l):B0(n,(0,St._)`[${l}]`)}Ai.reportError=fT;function hT(r,e=Ai.keywordError,t){let{it:i}=r,{gen:n,compositeRule:s,allErrors:o}=i,a=L0(r,e,t);R0(n,a),s||o||B0(i,Wi.default.vErrors)}Ai.reportExtraError=hT;function pT(r,e){r.assign(Wi.default.errors,e),r.if((0,St._)`${Wi.default.vErrors} !== null`,()=>r.if(e,()=>r.assign((0,St._)`${Wi.default.vErrors}.length`,e),()=>r.assign(Wi.default.vErrors,null)))}Ai.resetErrorsCount=pT;function mT({gen:r,keyword:e,schemaValue:t,data:i,errsCount:n,it:s}){if(n===void 0)throw new Error("ajv implementation error");let o=r.name("err");r.forRange("i",n,Wi.default.errors,a=>{r.const(o,(0,St._)`${Wi.default.vErrors}[${a}]`),r.if((0,St._)`${o}.instancePath === undefined`,()=>r.assign((0,St._)`${o}.instancePath`,(0,St.strConcat)(Wi.default.instancePath,s.errorPath))),r.assign((0,St._)`${o}.schemaPath`,(0,St.str)`${s.errSchemaPath}/${e}`),s.opts.verbose&&(r.assign((0,St._)`${o}.schema`,t),r.assign((0,St._)`${o}.data`,i))})}Ai.extendErrors=mT;function R0(r,e){let t=r.const("err",e);r.if((0,St._)`${Wi.default.vErrors} === null`,()=>r.assign(Wi.default.vErrors,(0,St._)`[${t}]`),(0,St._)`${Wi.default.vErrors}.push(${t})`),r.code((0,St._)`${Wi.default.errors}++`)}function B0(r,e){let{gen:t,validateName:i,schemaEnv:n}=r;n.$async?t.throw((0,St._)`new ${r.ValidationError}(${e})`):(t.assign((0,St._)`${i}.errors`,e),t.return(!1))}var qs={keyword:new St.Name("keyword"),schemaPath:new St.Name("schemaPath"),params:new St.Name("params"),propertyName:new St.Name("propertyName"),message:new St.Name("message"),schema:new St.Name("schema"),parentSchema:new St.Name("parentSchema")};function L0(r,e,t){let{createErrors:i}=r.it;return i===!1?(0,St._)`{}`:gT(r,e,t)}function gT(r,e,t={}){let{gen:i,it:n}=r,s=[bT(n,t),yT(r,t)];return vT(r,e,s),i.object(...s)}function bT({errorPath:r},{instancePath:e}){let t=e?(0,St.str)`${r}${(0,xd.getErrorPath)(e,xd.Type.Str)}`:r;return[Wi.default.instancePath,(0,St.strConcat)(Wi.default.instancePath,t)]}function yT({keyword:r,it:{errSchemaPath:e}},{schemaPath:t,parentSchema:i}){let n=i?e:(0,St.str)`${e}/${r}`;return t&&(n=(0,St.str)`${n}${(0,xd.getErrorPath)(t,xd.Type.Str)}`),[qs.schemaPath,n]}function vT(r,{params:e,message:t},i){let{keyword:n,data:s,schemaValue:o,it:a}=r,{opts:l,propertyName:u,topSchemaRef:c,schemaPath:d}=a;i.push([qs.keyword,n],[qs.params,typeof e=="function"?e(r):e||(0,St._)`{}`]),l.messages&&i.push([qs.message,typeof t=="function"?t(r):t]),l.verbose&&i.push([qs.schema,o],[qs.parentSchema,(0,St._)`${c}${d}`],[Wi.default.data,s]),u&&i.push([qs.propertyName,u])}});var M0=ve(Oo=>{"use strict";Object.defineProperty(Oo,"__esModule",{value:!0});Oo.boolOrEmptySchema=Oo.topBoolOrEmptySchema=void 0;var wT=lu(),_T=vt(),FT=kn(),kT={message:"boolean schema is false"};function CT(r){let{gen:e,schema:t,validateName:i}=r;t===!1?O0(r,!1):typeof t=="object"&&t.$async===!0?e.return(FT.default.data):(e.assign((0,_T._)`${i}.errors`,null),e.return(!0))}Oo.topBoolOrEmptySchema=CT;function ST(r,e){let{gen:t,schema:i}=r;i===!1?(t.var(e,!1),O0(r)):t.var(e,!0)}Oo.boolOrEmptySchema=ST;function O0(r,e){let{gen:t,data:i}=r,n={gen:t,keyword:"false schema",data:i,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:r};(0,wT.reportError)(n,kT,void 0,e)}});var Np=ve(Mo=>{"use strict";Object.defineProperty(Mo,"__esModule",{value:!0});Mo.getRules=Mo.isJSONType=void 0;var PT=["string","number","integer","boolean","null","object","array"],ET=new Set(PT);function IT(r){return typeof r=="string"&&ET.has(r)}Mo.isJSONType=IT;function xT(){let r={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...r,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},r.number,r.string,r.array,r.object],post:{rules:[]},all:{},keywords:{}}}Mo.getRules=xT});var jp=ve(Yn=>{"use strict";Object.defineProperty(Yn,"__esModule",{value:!0});Yn.shouldUseRule=Yn.shouldUseGroup=Yn.schemaHasRulesForType=void 0;function TT({schema:r,self:e},t){let i=e.RULES.types[t];return i&&i!==!0&&N0(r,i)}Yn.schemaHasRulesForType=TT;function N0(r,e){return e.rules.some(t=>j0(r,t))}Yn.shouldUseGroup=N0;function j0(r,e){var t;return r[e.keyword]!==void 0||((t=e.definition.implements)===null||t===void 0?void 0:t.some(i=>r[i]!==void 0))}Yn.shouldUseRule=j0});var uu=ve(Ri=>{"use strict";Object.defineProperty(Ri,"__esModule",{value:!0});Ri.reportTypeError=Ri.checkDataTypes=Ri.checkDataType=Ri.coerceAndCheckDataType=Ri.getJSONTypes=Ri.getSchemaTypes=Ri.DataType=void 0;var DT=Np(),AT=jp(),RT=lu(),ct=vt(),U0=xt(),No;(function(r){r[r.Correct=0]="Correct",r[r.Wrong=1]="Wrong"})(No||(Ri.DataType=No={}));function BT(r){let e=G0(r.type);if(e.includes("null")){if(r.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!e.length&&r.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');r.nullable===!0&&e.push("null")}return e}Ri.getSchemaTypes=BT;function G0(r){let e=Array.isArray(r)?r:r?[r]:[];if(e.every(DT.isJSONType))return e;throw new Error("type must be JSONType or JSONType[]: "+e.join(","))}Ri.getJSONTypes=G0;function LT(r,e){let{gen:t,data:i,opts:n}=r,s=OT(e,n.coerceTypes),o=e.length>0&&!(s.length===0&&e.length===1&&(0,AT.schemaHasRulesForType)(r,e[0]));if(o){let a=Gp(e,i,n.strictNumbers,No.Wrong);t.if(a,()=>{s.length?MT(r,e,s):zp(r)})}return o}Ri.coerceAndCheckDataType=LT;var z0=new Set(["string","number","integer","boolean","null"]);function OT(r,e){return e?r.filter(t=>z0.has(t)||e==="array"&&t==="array"):[]}function MT(r,e,t){let{gen:i,data:n,opts:s}=r,o=i.let("dataType",(0,ct._)`typeof ${n}`),a=i.let("coerced",(0,ct._)`undefined`);s.coerceTypes==="array"&&i.if((0,ct._)`${o} == 'object' && Array.isArray(${n}) && ${n}.length == 1`,()=>i.assign(n,(0,ct._)`${n}[0]`).assign(o,(0,ct._)`typeof ${n}`).if(Gp(e,n,s.strictNumbers),()=>i.assign(a,n))),i.if((0,ct._)`${a} !== undefined`);for(let u of t)(z0.has(u)||u==="array"&&s.coerceTypes==="array")&&l(u);i.else(),zp(r),i.endIf(),i.if((0,ct._)`${a} !== undefined`,()=>{i.assign(n,a),NT(r,a)});function l(u){switch(u){case"string":i.elseIf((0,ct._)`${o} == "number" || ${o} == "boolean"`).assign(a,(0,ct._)`"" + ${n}`).elseIf((0,ct._)`${n} === null`).assign(a,(0,ct._)`""`);return;case"number":i.elseIf((0,ct._)`${o} == "boolean" || ${n} === null
              || (${o} == "string" && ${n} && ${n} == +${n})`).assign(a,(0,ct._)`+${n}`);return;case"integer":i.elseIf((0,ct._)`${o} === "boolean" || ${n} === null
              || (${o} === "string" && ${n} && ${n} == +${n} && !(${n} % 1))`).assign(a,(0,ct._)`+${n}`);return;case"boolean":i.elseIf((0,ct._)`${n} === "false" || ${n} === 0 || ${n} === null`).assign(a,!1).elseIf((0,ct._)`${n} === "true" || ${n} === 1`).assign(a,!0);return;case"null":i.elseIf((0,ct._)`${n} === "" || ${n} === 0 || ${n} === false`),i.assign(a,null);return;case"array":i.elseIf((0,ct._)`${o} === "string" || ${o} === "number"
              || ${o} === "boolean" || ${n} === null`).assign(a,(0,ct._)`[${n}]`)}}}function NT({gen:r,parentData:e,parentDataProperty:t},i){r.if((0,ct._)`${e} !== undefined`,()=>r.assign((0,ct._)`${e}[${t}]`,i))}function Up(r,e,t,i=No.Correct){let n=i===No.Correct?ct.operators.EQ:ct.operators.NEQ,s;switch(r){case"null":return(0,ct._)`${e} ${n} null`;case"array":s=(0,ct._)`Array.isArray(${e})`;break;case"object":s=(0,ct._)`${e} && typeof ${e} == "object" && !Array.isArray(${e})`;break;case"integer":s=o((0,ct._)`!(${e} % 1) && !isNaN(${e})`);break;case"number":s=o();break;default:return(0,ct._)`typeof ${e} ${n} ${r}`}return i===No.Correct?s:(0,ct.not)(s);function o(a=ct.nil){return(0,ct.and)((0,ct._)`typeof ${e} == "number"`,a,t?(0,ct._)`isFinite(${e})`:ct.nil)}}Ri.checkDataType=Up;function Gp(r,e,t,i){if(r.length===1)return Up(r[0],e,t,i);let n,s=(0,U0.toHash)(r);if(s.array&&s.object){let o=(0,ct._)`typeof ${e} != "object"`;n=s.null?o:(0,ct._)`!${e} || ${o}`,delete s.null,delete s.array,delete s.object}else n=ct.nil;s.number&&delete s.integer;for(let o in s)n=(0,ct.and)(n,Up(o,e,t,i));return n}Ri.checkDataTypes=Gp;var jT={message:({schema:r})=>`must be ${r}`,params:({schema:r,schemaValue:e})=>typeof r=="string"?(0,ct._)`{type: ${r}}`:(0,ct._)`{type: ${e}}`};function zp(r){let e=UT(r);(0,RT.reportError)(e,jT)}Ri.reportTypeError=zp;function UT(r){let{gen:e,data:t,schema:i}=r,n=(0,U0.schemaRefOrVal)(r,i,"type");return{gen:e,keyword:"type",data:t,schema:i.type,schemaCode:n,schemaValue:n,parentSchema:i,params:{},it:r}}});var W0=ve(Td=>{"use strict";Object.defineProperty(Td,"__esModule",{value:!0});Td.assignDefaults=void 0;var jo=vt(),GT=xt();function zT(r,e){let{properties:t,items:i}=r.schema;if(e==="object"&&t)for(let n in t)V0(r,n,t[n].default);else e==="array"&&Array.isArray(i)&&i.forEach((n,s)=>V0(r,s,n.default))}Td.assignDefaults=zT;function V0(r,e,t){let{gen:i,compositeRule:n,data:s,opts:o}=r;if(t===void 0)return;let a=(0,jo._)`${s}${(0,jo.getProperty)(e)}`;if(n){(0,GT.checkStrictMode)(r,`default is ignored for: ${a}`);return}let l=(0,jo._)`${a} === undefined`;o.useDefaults==="empty"&&(l=(0,jo._)`${l} || ${a} === null || ${a} === ""`),i.if(l,(0,jo._)`${a} = ${(0,jo.stringify)(t)}`)}});var br=ve(Nt=>{"use strict";Object.defineProperty(Nt,"__esModule",{value:!0});Nt.validateUnion=Nt.validateArray=Nt.usePattern=Nt.callValidateCode=Nt.schemaProperties=Nt.allSchemaProperties=Nt.noPropertyInData=Nt.propertyInData=Nt.isOwnProperty=Nt.hasPropFunc=Nt.reportMissingProp=Nt.checkMissingProp=Nt.checkReportMissingProp=void 0;var Ht=vt(),Vp=xt(),Qn=kn(),VT=xt();function WT(r,e){let{gen:t,data:i,it:n}=r;t.if(Jp(t,i,e,n.opts.ownProperties),()=>{r.setParams({missingProperty:(0,Ht._)`${e}`},!0),r.error()})}Nt.checkReportMissingProp=WT;function JT({gen:r,data:e,it:{opts:t}},i,n){return(0,Ht.or)(...i.map(s=>(0,Ht.and)(Jp(r,e,s,t.ownProperties),(0,Ht._)`${n} = ${s}`)))}Nt.checkMissingProp=JT;function $T(r,e){r.setParams({missingProperty:e},!0),r.error()}Nt.reportMissingProp=$T;function J0(r){return r.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,Ht._)`Object.prototype.hasOwnProperty`})}Nt.hasPropFunc=J0;function Wp(r,e,t){return(0,Ht._)`${J0(r)}.call(${e}, ${t})`}Nt.isOwnProperty=Wp;function HT(r,e,t,i){let n=(0,Ht._)`${e}${(0,Ht.getProperty)(t)} !== undefined`;return i?(0,Ht._)`${n} && ${Wp(r,e,t)}`:n}Nt.propertyInData=HT;function Jp(r,e,t,i){let n=(0,Ht._)`${e}${(0,Ht.getProperty)(t)} === undefined`;return i?(0,Ht.or)(n,(0,Ht.not)(Wp(r,e,t))):n}Nt.noPropertyInData=Jp;function $0(r){return r?Object.keys(r).filter(e=>e!=="__proto__"):[]}Nt.allSchemaProperties=$0;function qT(r,e){return $0(e).filter(t=>!(0,Vp.alwaysValidSchema)(r,e[t]))}Nt.schemaProperties=qT;function KT({schemaCode:r,data:e,it:{gen:t,topSchemaRef:i,schemaPath:n,errorPath:s},it:o},a,l,u){let c=u?(0,Ht._)`${r}, ${e}, ${i}${n}`:e,d=[[Qn.default.instancePath,(0,Ht.strConcat)(Qn.default.instancePath,s)],[Qn.default.parentData,o.parentData],[Qn.default.parentDataProperty,o.parentDataProperty],[Qn.default.rootData,Qn.default.rootData]];o.opts.dynamicRef&&d.push([Qn.default.dynamicAnchors,Qn.default.dynamicAnchors]);let h=(0,Ht._)`${c}, ${t.object(...d)}`;return l!==Ht.nil?(0,Ht._)`${a}.call(${l}, ${h})`:(0,Ht._)`${a}(${h})`}Nt.callValidateCode=KT;var XT=(0,Ht._)`new RegExp`;function ZT({gen:r,it:{opts:e}},t){let i=e.unicodeRegExp?"u":"",{regExp:n}=e.code,s=n(t,i);return r.scopeValue("pattern",{key:s.toString(),ref:s,code:(0,Ht._)`${n.code==="new RegExp"?XT:(0,VT.useFunc)(r,n)}(${t}, ${i})`})}Nt.usePattern=ZT;function YT(r){let{gen:e,data:t,keyword:i,it:n}=r,s=e.name("valid");if(n.allErrors){let a=e.let("valid",!0);return o(()=>e.assign(a,!1)),a}return e.var(s,!0),o(()=>e.break()),s;function o(a){let l=e.const("len",(0,Ht._)`${t}.length`);e.forRange("i",0,l,u=>{r.subschema({keyword:i,dataProp:u,dataPropType:Vp.Type.Num},s),e.if((0,Ht.not)(s),a)})}}Nt.validateArray=YT;function QT(r){let{gen:e,schema:t,keyword:i,it:n}=r;if(!Array.isArray(t))throw new Error("ajv implementation error");if(t.some(l=>(0,Vp.alwaysValidSchema)(n,l))&&!n.opts.unevaluated)return;let o=e.let("valid",!1),a=e.name("_valid");e.block(()=>t.forEach((l,u)=>{let c=r.subschema({keyword:i,schemaProp:u,compositeRule:!0},a);e.assign(o,(0,Ht._)`${o} || ${a}`),r.mergeValidEvaluated(c,a)||e.if((0,Ht.not)(o))})),r.result(o,()=>r.reset(),()=>r.error(!0))}Nt.validateUnion=QT});var K0=ve(Qr=>{"use strict";Object.defineProperty(Qr,"__esModule",{value:!0});Qr.validateKeywordUsage=Qr.validSchemaType=Qr.funcKeywordCode=Qr.macroKeywordCode=void 0;var Ji=vt(),Ks=kn(),eD=br(),tD=lu();function iD(r,e){let{gen:t,keyword:i,schema:n,parentSchema:s,it:o}=r,a=e.macro.call(o.self,n,s,o),l=q0(t,i,a);o.opts.validateSchema!==!1&&o.self.validateSchema(a,!0);let u=t.name("valid");r.subschema({schema:a,schemaPath:Ji.nil,errSchemaPath:`${o.errSchemaPath}/${i}`,topSchemaRef:l,compositeRule:!0},u),r.pass(u,()=>r.error(!0))}Qr.macroKeywordCode=iD;function rD(r,e){var t;let{gen:i,keyword:n,schema:s,parentSchema:o,$data:a,it:l}=r;sD(l,e);let u=!a&&e.compile?e.compile.call(l.self,s,o,l):e.validate,c=q0(i,n,u),d=i.let("valid");r.block$data(d,h),r.ok((t=e.valid)!==null&&t!==void 0?t:d);function h(){if(e.errors===!1)p(),e.modifying&&H0(r),g(()=>r.error());else{let b=e.async?f():m();e.modifying&&H0(r),g(()=>nD(r,b))}}function f(){let b=i.let("ruleErrs",null);return i.try(()=>p((0,Ji._)`await `),F=>i.assign(d,!1).if((0,Ji._)`${F} instanceof ${l.ValidationError}`,()=>i.assign(b,(0,Ji._)`${F}.errors`),()=>i.throw(F))),b}function m(){let b=(0,Ji._)`${c}.errors`;return i.assign(b,null),p(Ji.nil),b}function p(b=e.async?(0,Ji._)`await `:Ji.nil){let F=l.opts.passContext?Ks.default.this:Ks.default.self,w=!("compile"in e&&!a||e.schema===!1);i.assign(d,(0,Ji._)`${b}${(0,eD.callValidateCode)(r,c,F,w)}`,e.modifying)}function g(b){var F;i.if((0,Ji.not)((F=e.valid)!==null&&F!==void 0?F:d),b)}}Qr.funcKeywordCode=rD;function H0(r){let{gen:e,data:t,it:i}=r;e.if(i.parentData,()=>e.assign(t,(0,Ji._)`${i.parentData}[${i.parentDataProperty}]`))}function nD(r,e){let{gen:t}=r;t.if((0,Ji._)`Array.isArray(${e})`,()=>{t.assign(Ks.default.vErrors,(0,Ji._)`${Ks.default.vErrors} === null ? ${e} : ${Ks.default.vErrors}.concat(${e})`).assign(Ks.default.errors,(0,Ji._)`${Ks.default.vErrors}.length`),(0,tD.extendErrors)(r)},()=>r.error())}function sD({schemaEnv:r},e){if(e.async&&!r.$async)throw new Error("async keyword in sync schema")}function q0(r,e,t){if(t===void 0)throw new Error(`keyword "${e}" failed to compile`);return r.scopeValue("keyword",typeof t=="function"?{ref:t}:{ref:t,code:(0,Ji.stringify)(t)})}function oD(r,e,t=!1){return!e.length||e.some(i=>i==="array"?Array.isArray(r):i==="object"?r&&typeof r=="object"&&!Array.isArray(r):typeof r==i||t&&typeof r>"u")}Qr.validSchemaType=oD;function aD({schema:r,opts:e,self:t,errSchemaPath:i},n,s){if(Array.isArray(n.keyword)?!n.keyword.includes(s):n.keyword!==s)throw new Error("ajv implementation error");let o=n.dependencies;if(o?.some(a=>!Object.prototype.hasOwnProperty.call(r,a)))throw new Error(`parent schema must have dependencies of ${s}: ${o.join(",")}`);if(n.validateSchema&&!n.validateSchema(r[s])){let l=`keyword "${s}" value is invalid at path "${i}": `+t.errorsText(n.validateSchema.errors);if(e.validateSchema==="log")t.logger.error(l);else throw new Error(l)}}Qr.validateKeywordUsage=aD});var Z0=ve(es=>{"use strict";Object.defineProperty(es,"__esModule",{value:!0});es.extendSubschemaMode=es.extendSubschemaData=es.getSubschema=void 0;var en=vt(),X0=xt();function lD(r,{keyword:e,schemaProp:t,schema:i,schemaPath:n,errSchemaPath:s,topSchemaRef:o}){if(e!==void 0&&i!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(e!==void 0){let a=r.schema[e];return t===void 0?{schema:a,schemaPath:(0,en._)`${r.schemaPath}${(0,en.getProperty)(e)}`,errSchemaPath:`${r.errSchemaPath}/${e}`}:{schema:a[t],schemaPath:(0,en._)`${r.schemaPath}${(0,en.getProperty)(e)}${(0,en.getProperty)(t)}`,errSchemaPath:`${r.errSchemaPath}/${e}/${(0,X0.escapeFragment)(t)}`}}if(i!==void 0){if(n===void 0||s===void 0||o===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:i,schemaPath:n,topSchemaRef:o,errSchemaPath:s}}throw new Error('either "keyword" or "schema" must be passed')}es.getSubschema=lD;function uD(r,e,{dataProp:t,dataPropType:i,data:n,dataTypes:s,propertyName:o}){if(n!==void 0&&t!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');let{gen:a}=e;if(t!==void 0){let{errorPath:u,dataPathArr:c,opts:d}=e,h=a.let("data",(0,en._)`${e.data}${(0,en.getProperty)(t)}`,!0);l(h),r.errorPath=(0,en.str)`${u}${(0,X0.getErrorPath)(t,i,d.jsPropertySyntax)}`,r.parentDataProperty=(0,en._)`${t}`,r.dataPathArr=[...c,r.parentDataProperty]}if(n!==void 0){let u=n instanceof en.Name?n:a.let("data",n,!0);l(u),o!==void 0&&(r.propertyName=o)}s&&(r.dataTypes=s);function l(u){r.data=u,r.dataLevel=e.dataLevel+1,r.dataTypes=[],e.definedProperties=new Set,r.parentData=e.data,r.dataNames=[...e.dataNames,u]}}es.extendSubschemaData=uD;function cD(r,{jtdDiscriminator:e,jtdMetadata:t,compositeRule:i,createErrors:n,allErrors:s}){i!==void 0&&(r.compositeRule=i),n!==void 0&&(r.createErrors=n),s!==void 0&&(r.allErrors=s),r.jtdDiscriminator=e,r.jtdMetadata=t}es.extendSubschemaMode=cD});var $p=ve((HH,Y0)=>{"use strict";Y0.exports=function r(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var i,n,s;if(Array.isArray(e)){if(i=e.length,i!=t.length)return!1;for(n=i;n--!==0;)if(!r(e[n],t[n]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(s=Object.keys(e),i=s.length,i!==Object.keys(t).length)return!1;for(n=i;n--!==0;)if(!Object.prototype.hasOwnProperty.call(t,s[n]))return!1;for(n=i;n--!==0;){var o=s[n];if(!r(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}});var e_=ve((qH,Q0)=>{"use strict";var ts=Q0.exports=function(r,e,t){typeof e=="function"&&(t=e,e={}),t=e.cb||t;var i=typeof t=="function"?t:t.pre||function(){},n=t.post||function(){};Dd(e,i,n,r,"",r)};ts.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};ts.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};ts.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};ts.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function Dd(r,e,t,i,n,s,o,a,l,u){if(i&&typeof i=="object"&&!Array.isArray(i)){e(i,n,s,o,a,l,u);for(var c in i){var d=i[c];if(Array.isArray(d)){if(c in ts.arrayKeywords)for(var h=0;h<d.length;h++)Dd(r,e,t,d[h],n+"/"+c+"/"+h,s,n,c,i,h)}else if(c in ts.propsKeywords){if(d&&typeof d=="object")for(var f in d)Dd(r,e,t,d[f],n+"/"+c+"/"+dD(f),s,n,c,i,f)}else(c in ts.keywords||r.allKeys&&!(c in ts.skipKeywords))&&Dd(r,e,t,d,n+"/"+c,s,n,c,i)}t(i,n,s,o,a,l,u)}}function dD(r){return r.replace(/~/g,"~0").replace(/\//g,"~1")}});var cu=ve(er=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0});er.getSchemaRefs=er.resolveUrl=er.normalizeId=er._getFullPath=er.getFullPath=er.inlineRef=void 0;var fD=xt(),hD=$p(),pD=e_(),mD=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function gD(r,e=!0){return typeof r=="boolean"?!0:e===!0?!Hp(r):e?t_(r)<=e:!1}er.inlineRef=gD;var bD=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function Hp(r){for(let e in r){if(bD.has(e))return!0;let t=r[e];if(Array.isArray(t)&&t.some(Hp)||typeof t=="object"&&Hp(t))return!0}return!1}function t_(r){let e=0;for(let t in r){if(t==="$ref")return 1/0;if(e++,!mD.has(t)&&(typeof r[t]=="object"&&(0,fD.eachItem)(r[t],i=>e+=t_(i)),e===1/0))return 1/0}return e}function i_(r,e="",t){t!==!1&&(e=Uo(e));let i=r.parse(e);return r_(r,i)}er.getFullPath=i_;function r_(r,e){return r.serialize(e).split("#")[0]+"#"}er._getFullPath=r_;var yD=/#\/?$/;function Uo(r){return r?r.replace(yD,""):""}er.normalizeId=Uo;function vD(r,e,t){return t=Uo(t),r.resolve(e,t)}er.resolveUrl=vD;var wD=/^[a-z_][-a-z0-9._]*$/i;function _D(r,e){if(typeof r=="boolean")return{};let{schemaId:t,uriResolver:i}=this.opts,n=Uo(r[t]||e),s={"":n},o=i_(i,n,!1),a={},l=new Set;return pD(r,{allKeys:!0},(d,h,f,m)=>{if(m===void 0)return;let p=o+h,g=s[m];typeof d[t]=="string"&&(g=b.call(this,d[t])),F.call(this,d.$anchor),F.call(this,d.$dynamicAnchor),s[h]=g;function b(w){let _=this.opts.uriResolver.resolve;if(w=Uo(g?_(g,w):w),l.has(w))throw c(w);l.add(w);let I=this.refs[w];return typeof I=="string"&&(I=this.refs[I]),typeof I=="object"?u(d,I.schema,w):w!==Uo(p)&&(w[0]==="#"?(u(d,a[w],w),a[w]=d):this.refs[w]=p),w}function F(w){if(typeof w=="string"){if(!wD.test(w))throw new Error(`invalid anchor "${w}"`);b.call(this,`#${w}`)}}}),a;function u(d,h,f){if(h!==void 0&&!hD(d,h))throw c(f)}function c(d){return new Error(`reference "${d}" resolves to more than one schema`)}}er.getSchemaRefs=_D});var hu=ve(is=>{"use strict";Object.defineProperty(is,"__esModule",{value:!0});is.getData=is.KeywordCxt=is.validateFunctionCode=void 0;var l_=M0(),n_=uu(),Kp=jp(),Ad=uu(),FD=W0(),fu=K0(),qp=Z0(),$e=vt(),nt=kn(),kD=cu(),Cn=xt(),du=lu();function CD(r){if(d_(r)&&(f_(r),c_(r))){ED(r);return}u_(r,()=>(0,l_.topBoolOrEmptySchema)(r))}is.validateFunctionCode=CD;function u_({gen:r,validateName:e,schema:t,schemaEnv:i,opts:n},s){n.code.es5?r.func(e,(0,$e._)`${nt.default.data}, ${nt.default.valCxt}`,i.$async,()=>{r.code((0,$e._)`"use strict"; ${s_(t,n)}`),PD(r,n),r.code(s)}):r.func(e,(0,$e._)`${nt.default.data}, ${SD(n)}`,i.$async,()=>r.code(s_(t,n)).code(s))}function SD(r){return(0,$e._)`{${nt.default.instancePath}="", ${nt.default.parentData}, ${nt.default.parentDataProperty}, ${nt.default.rootData}=${nt.default.data}${r.dynamicRef?(0,$e._)`, ${nt.default.dynamicAnchors}={}`:$e.nil}}={}`}function PD(r,e){r.if(nt.default.valCxt,()=>{r.var(nt.default.instancePath,(0,$e._)`${nt.default.valCxt}.${nt.default.instancePath}`),r.var(nt.default.parentData,(0,$e._)`${nt.default.valCxt}.${nt.default.parentData}`),r.var(nt.default.parentDataProperty,(0,$e._)`${nt.default.valCxt}.${nt.default.parentDataProperty}`),r.var(nt.default.rootData,(0,$e._)`${nt.default.valCxt}.${nt.default.rootData}`),e.dynamicRef&&r.var(nt.default.dynamicAnchors,(0,$e._)`${nt.default.valCxt}.${nt.default.dynamicAnchors}`)},()=>{r.var(nt.default.instancePath,(0,$e._)`""`),r.var(nt.default.parentData,(0,$e._)`undefined`),r.var(nt.default.parentDataProperty,(0,$e._)`undefined`),r.var(nt.default.rootData,nt.default.data),e.dynamicRef&&r.var(nt.default.dynamicAnchors,(0,$e._)`{}`)})}function ED(r){let{schema:e,opts:t,gen:i}=r;u_(r,()=>{t.$comment&&e.$comment&&p_(r),AD(r),i.let(nt.default.vErrors,null),i.let(nt.default.errors,0),t.unevaluated&&ID(r),h_(r),LD(r)})}function ID(r){let{gen:e,validateName:t}=r;r.evaluated=e.const("evaluated",(0,$e._)`${t}.evaluated`),e.if((0,$e._)`${r.evaluated}.dynamicProps`,()=>e.assign((0,$e._)`${r.evaluated}.props`,(0,$e._)`undefined`)),e.if((0,$e._)`${r.evaluated}.dynamicItems`,()=>e.assign((0,$e._)`${r.evaluated}.items`,(0,$e._)`undefined`))}function s_(r,e){let t=typeof r=="object"&&r[e.schemaId];return t&&(e.code.source||e.code.process)?(0,$e._)`/*# sourceURL=${t} */`:$e.nil}function xD(r,e){if(d_(r)&&(f_(r),c_(r))){TD(r,e);return}(0,l_.boolOrEmptySchema)(r,e)}function c_({schema:r,self:e}){if(typeof r=="boolean")return!r;for(let t in r)if(e.RULES.all[t])return!0;return!1}function d_(r){return typeof r.schema!="boolean"}function TD(r,e){let{schema:t,gen:i,opts:n}=r;n.$comment&&t.$comment&&p_(r),RD(r),BD(r);let s=i.const("_errs",nt.default.errors);h_(r,s),i.var(e,(0,$e._)`${s} === ${nt.default.errors}`)}function f_(r){(0,Cn.checkUnknownRules)(r),DD(r)}function h_(r,e){if(r.opts.jtd)return o_(r,[],!1,e);let t=(0,n_.getSchemaTypes)(r.schema),i=(0,n_.coerceAndCheckDataType)(r,t);o_(r,t,!i,e)}function DD(r){let{schema:e,errSchemaPath:t,opts:i,self:n}=r;e.$ref&&i.ignoreKeywordsWithRef&&(0,Cn.schemaHasRulesButRef)(e,n.RULES)&&n.logger.warn(`$ref: keywords ignored in schema at path "${t}"`)}function AD(r){let{schema:e,opts:t}=r;e.default!==void 0&&t.useDefaults&&t.strictSchema&&(0,Cn.checkStrictMode)(r,"default is ignored in the schema root")}function RD(r){let e=r.schema[r.opts.schemaId];e&&(r.baseId=(0,kD.resolveUrl)(r.opts.uriResolver,r.baseId,e))}function BD(r){if(r.schema.$async&&!r.schemaEnv.$async)throw new Error("async schema in sync schema")}function p_({gen:r,schemaEnv:e,schema:t,errSchemaPath:i,opts:n}){let s=t.$comment;if(n.$comment===!0)r.code((0,$e._)`${nt.default.self}.logger.log(${s})`);else if(typeof n.$comment=="function"){let o=(0,$e.str)`${i}/$comment`,a=r.scopeValue("root",{ref:e.root});r.code((0,$e._)`${nt.default.self}.opts.$comment(${s}, ${o}, ${a}.schema)`)}}function LD(r){let{gen:e,schemaEnv:t,validateName:i,ValidationError:n,opts:s}=r;t.$async?e.if((0,$e._)`${nt.default.errors} === 0`,()=>e.return(nt.default.data),()=>e.throw((0,$e._)`new ${n}(${nt.default.vErrors})`)):(e.assign((0,$e._)`${i}.errors`,nt.default.vErrors),s.unevaluated&&OD(r),e.return((0,$e._)`${nt.default.errors} === 0`))}function OD({gen:r,evaluated:e,props:t,items:i}){t instanceof $e.Name&&r.assign((0,$e._)`${e}.props`,t),i instanceof $e.Name&&r.assign((0,$e._)`${e}.items`,i)}function o_(r,e,t,i){let{gen:n,schema:s,data:o,allErrors:a,opts:l,self:u}=r,{RULES:c}=u;if(s.$ref&&(l.ignoreKeywordsWithRef||!(0,Cn.schemaHasRulesButRef)(s,c))){n.block(()=>g_(r,"$ref",c.all.$ref.definition));return}l.jtd||MD(r,e),n.block(()=>{for(let h of c.rules)d(h);d(c.post)});function d(h){(0,Kp.shouldUseGroup)(s,h)&&(h.type?(n.if((0,Ad.checkDataType)(h.type,o,l.strictNumbers)),a_(r,h),e.length===1&&e[0]===h.type&&t&&(n.else(),(0,Ad.reportTypeError)(r)),n.endIf()):a_(r,h),a||n.if((0,$e._)`${nt.default.errors} === ${i||0}`))}}function a_(r,e){let{gen:t,schema:i,opts:{useDefaults:n}}=r;n&&(0,FD.assignDefaults)(r,e.type),t.block(()=>{for(let s of e.rules)(0,Kp.shouldUseRule)(i,s)&&g_(r,s.keyword,s.definition,e.type)})}function MD(r,e){r.schemaEnv.meta||!r.opts.strictTypes||(ND(r,e),r.opts.allowUnionTypes||jD(r,e),UD(r,r.dataTypes))}function ND(r,e){if(e.length){if(!r.dataTypes.length){r.dataTypes=e;return}e.forEach(t=>{m_(r.dataTypes,t)||Xp(r,`type "${t}" not allowed by context "${r.dataTypes.join(",")}"`)}),zD(r,e)}}function jD(r,e){e.length>1&&!(e.length===2&&e.includes("null"))&&Xp(r,"use allowUnionTypes to allow union type keyword")}function UD(r,e){let t=r.self.RULES.all;for(let i in t){let n=t[i];if(typeof n=="object"&&(0,Kp.shouldUseRule)(r.schema,n)){let{type:s}=n.definition;s.length&&!s.some(o=>GD(e,o))&&Xp(r,`missing type "${s.join(",")}" for keyword "${i}"`)}}}function GD(r,e){return r.includes(e)||e==="number"&&r.includes("integer")}function m_(r,e){return r.includes(e)||e==="integer"&&r.includes("number")}function zD(r,e){let t=[];for(let i of r.dataTypes)m_(e,i)?t.push(i):e.includes("integer")&&i==="number"&&t.push("integer");r.dataTypes=t}function Xp(r,e){let t=r.schemaEnv.baseId+r.errSchemaPath;e+=` at "${t}" (strictTypes)`,(0,Cn.checkStrictMode)(r,e,r.opts.strictTypes)}var Rd=class{constructor(e,t,i){if((0,fu.validateKeywordUsage)(e,t,i),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=i,this.data=e.data,this.schema=e.schema[i],this.$data=t.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,Cn.schemaRefOrVal)(e,this.schema,i,this.$data),this.schemaType=t.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=t,this.$data)this.schemaCode=e.gen.const("vSchema",b_(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,fu.validSchemaType)(this.schema,t.schemaType,t.allowUndefined))throw new Error(`${i} value must be ${JSON.stringify(t.schemaType)}`);("code"in t?t.trackErrors:t.errors!==!1)&&(this.errsCount=e.gen.const("_errs",nt.default.errors))}result(e,t,i){this.failResult((0,$e.not)(e),t,i)}failResult(e,t,i){this.gen.if(e),i?i():this.error(),t?(this.gen.else(),t(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,t){this.failResult((0,$e.not)(e),void 0,t)}fail(e){if(e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);let{schemaCode:t}=this;this.fail((0,$e._)`${t} !== undefined && (${(0,$e.or)(this.invalid$data(),e)})`)}error(e,t,i){if(t){this.setParams(t),this._error(e,i),this.setParams({});return}this._error(e,i)}_error(e,t){(e?du.reportExtraError:du.reportError)(this,this.def.error,t)}$dataError(){(0,du.reportError)(this,this.def.$dataError||du.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,du.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,t){t?Object.assign(this.params,e):this.params=e}block$data(e,t,i=$e.nil){this.gen.block(()=>{this.check$data(e,i),t()})}check$data(e=$e.nil,t=$e.nil){if(!this.$data)return;let{gen:i,schemaCode:n,schemaType:s,def:o}=this;i.if((0,$e.or)((0,$e._)`${n} === undefined`,t)),e!==$e.nil&&i.assign(e,!0),(s.length||o.validateSchema)&&(i.elseIf(this.invalid$data()),this.$dataError(),e!==$e.nil&&i.assign(e,!1)),i.else()}invalid$data(){let{gen:e,schemaCode:t,schemaType:i,def:n,it:s}=this;return(0,$e.or)(o(),a());function o(){if(i.length){if(!(t instanceof $e.Name))throw new Error("ajv implementation error");let l=Array.isArray(i)?i:[i];return(0,$e._)`${(0,Ad.checkDataTypes)(l,t,s.opts.strictNumbers,Ad.DataType.Wrong)}`}return $e.nil}function a(){if(n.validateSchema){let l=e.scopeValue("validate$data",{ref:n.validateSchema});return(0,$e._)`!${l}(${t})`}return $e.nil}}subschema(e,t){let i=(0,qp.getSubschema)(this.it,e);(0,qp.extendSubschemaData)(i,this.it,e),(0,qp.extendSubschemaMode)(i,e);let n={...this.it,...i,items:void 0,props:void 0};return xD(n,t),n}mergeEvaluated(e,t){let{it:i,gen:n}=this;i.opts.unevaluated&&(i.props!==!0&&e.props!==void 0&&(i.props=Cn.mergeEvaluated.props(n,e.props,i.props,t)),i.items!==!0&&e.items!==void 0&&(i.items=Cn.mergeEvaluated.items(n,e.items,i.items,t)))}mergeValidEvaluated(e,t){let{it:i,gen:n}=this;if(i.opts.unevaluated&&(i.props!==!0||i.items!==!0))return n.if(t,()=>this.mergeEvaluated(e,$e.Name)),!0}};is.KeywordCxt=Rd;function g_(r,e,t,i){let n=new Rd(r,t,e);"code"in t?t.code(n,i):n.$data&&t.validate?(0,fu.funcKeywordCode)(n,t):"macro"in t?(0,fu.macroKeywordCode)(n,t):(t.compile||t.validate)&&(0,fu.funcKeywordCode)(n,t)}var VD=/^\/(?:[^~]|~0|~1)*$/,WD=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function b_(r,{dataLevel:e,dataNames:t,dataPathArr:i}){let n,s;if(r==="")return nt.default.rootData;if(r[0]==="/"){if(!VD.test(r))throw new Error(`Invalid JSON-pointer: ${r}`);n=r,s=nt.default.rootData}else{let u=WD.exec(r);if(!u)throw new Error(`Invalid JSON-pointer: ${r}`);let c=+u[1];if(n=u[2],n==="#"){if(c>=e)throw new Error(l("property/index",c));return i[e-c]}if(c>e)throw new Error(l("data",c));if(s=t[e-c],!n)return s}let o=s,a=n.split("/");for(let u of a)u&&(s=(0,$e._)`${s}${(0,$e.getProperty)((0,Cn.unescapeJsonPointer)(u))}`,o=(0,$e._)`${o} && ${s}`);return o;function l(u,c){return`Cannot access ${u} ${c} levels up, current level is ${e}`}}is.getData=b_});var Bd=ve(Yp=>{"use strict";Object.defineProperty(Yp,"__esModule",{value:!0});var Zp=class extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}};Yp.default=Zp});var pu=ve(tm=>{"use strict";Object.defineProperty(tm,"__esModule",{value:!0});var Qp=cu(),em=class extends Error{constructor(e,t,i,n){super(n||`can't resolve reference ${i} from id ${t}`),this.missingRef=(0,Qp.resolveUrl)(e,t,i),this.missingSchema=(0,Qp.normalizeId)((0,Qp.getFullPath)(e,this.missingRef))}};tm.default=em});var Od=ve(yr=>{"use strict";Object.defineProperty(yr,"__esModule",{value:!0});yr.resolveSchema=yr.getCompilingSchema=yr.resolveRef=yr.compileSchema=yr.SchemaEnv=void 0;var Rr=vt(),JD=Bd(),Xs=kn(),Br=cu(),y_=xt(),$D=hu(),Go=class{constructor(e){var t;this.refs={},this.dynamicAnchors={};let i;typeof e.schema=="object"&&(i=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=(t=e.baseId)!==null&&t!==void 0?t:(0,Br.normalizeId)(i?.[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=i?.$async,this.refs={}}};yr.SchemaEnv=Go;function rm(r){let e=v_.call(this,r);if(e)return e;let t=(0,Br.getFullPath)(this.opts.uriResolver,r.root.baseId),{es5:i,lines:n}=this.opts.code,{ownProperties:s}=this.opts,o=new Rr.CodeGen(this.scope,{es5:i,lines:n,ownProperties:s}),a;r.$async&&(a=o.scopeValue("Error",{ref:JD.default,code:(0,Rr._)`require("ajv/dist/runtime/validation_error").default`}));let l=o.scopeName("validate");r.validateName=l;let u={gen:o,allErrors:this.opts.allErrors,data:Xs.default.data,parentData:Xs.default.parentData,parentDataProperty:Xs.default.parentDataProperty,dataNames:[Xs.default.data],dataPathArr:[Rr.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:o.scopeValue("schema",this.opts.code.source===!0?{ref:r.schema,code:(0,Rr.stringify)(r.schema)}:{ref:r.schema}),validateName:l,ValidationError:a,schema:r.schema,schemaEnv:r,rootId:t,baseId:r.baseId||t,schemaPath:Rr.nil,errSchemaPath:r.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,Rr._)`""`,opts:this.opts,self:this},c;try{this._compilations.add(r),(0,$D.validateFunctionCode)(u),o.optimize(this.opts.code.optimize);let d=o.toString();c=`${o.scopeRefs(Xs.default.scope)}return ${d}`,this.opts.code.process&&(c=this.opts.code.process(c,r));let f=new Function(`${Xs.default.self}`,`${Xs.default.scope}`,c)(this,this.scope.get());if(this.scope.value(l,{ref:f}),f.errors=null,f.schema=r.schema,f.schemaEnv=r,r.$async&&(f.$async=!0),this.opts.code.source===!0&&(f.source={validateName:l,validateCode:d,scopeValues:o._values}),this.opts.unevaluated){let{props:m,items:p}=u;f.evaluated={props:m instanceof Rr.Name?void 0:m,items:p instanceof Rr.Name?void 0:p,dynamicProps:m instanceof Rr.Name,dynamicItems:p instanceof Rr.Name},f.source&&(f.source.evaluated=(0,Rr.stringify)(f.evaluated))}return r.validate=f,r}catch(d){throw delete r.validate,delete r.validateName,c&&this.logger.error("Error compiling schema, function code:",c),d}finally{this._compilations.delete(r)}}yr.compileSchema=rm;function HD(r,e,t){var i;t=(0,Br.resolveUrl)(this.opts.uriResolver,e,t);let n=r.refs[t];if(n)return n;let s=XD.call(this,r,t);if(s===void 0){let o=(i=r.localRefs)===null||i===void 0?void 0:i[t],{schemaId:a}=this.opts;o&&(s=new Go({schema:o,schemaId:a,root:r,baseId:e}))}if(s!==void 0)return r.refs[t]=qD.call(this,s)}yr.resolveRef=HD;function qD(r){return(0,Br.inlineRef)(r.schema,this.opts.inlineRefs)?r.schema:r.validate?r:rm.call(this,r)}function v_(r){for(let e of this._compilations)if(KD(e,r))return e}yr.getCompilingSchema=v_;function KD(r,e){return r.schema===e.schema&&r.root===e.root&&r.baseId===e.baseId}function XD(r,e){let t;for(;typeof(t=this.refs[e])=="string";)e=t;return t||this.schemas[e]||Ld.call(this,r,e)}function Ld(r,e){let t=this.opts.uriResolver.parse(e),i=(0,Br._getFullPath)(this.opts.uriResolver,t),n=(0,Br.getFullPath)(this.opts.uriResolver,r.baseId,void 0);if(Object.keys(r.schema).length>0&&i===n)return im.call(this,t,r);let s=(0,Br.normalizeId)(i),o=this.refs[s]||this.schemas[s];if(typeof o=="string"){let a=Ld.call(this,r,o);return typeof a?.schema!="object"?void 0:im.call(this,t,a)}if(typeof o?.schema=="object"){if(o.validate||rm.call(this,o),s===(0,Br.normalizeId)(e)){let{schema:a}=o,{schemaId:l}=this.opts,u=a[l];return u&&(n=(0,Br.resolveUrl)(this.opts.uriResolver,n,u)),new Go({schema:a,schemaId:l,root:r,baseId:n})}return im.call(this,t,o)}}yr.resolveSchema=Ld;var ZD=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function im(r,{baseId:e,schema:t,root:i}){var n;if(((n=r.fragment)===null||n===void 0?void 0:n[0])!=="/")return;for(let a of r.fragment.slice(1).split("/")){if(typeof t=="boolean")return;let l=t[(0,y_.unescapeFragment)(a)];if(l===void 0)return;t=l;let u=typeof t=="object"&&t[this.opts.schemaId];!ZD.has(a)&&u&&(e=(0,Br.resolveUrl)(this.opts.uriResolver,e,u))}let s;if(typeof t!="boolean"&&t.$ref&&!(0,y_.schemaHasRulesButRef)(t,this.RULES)){let a=(0,Br.resolveUrl)(this.opts.uriResolver,e,t.$ref);s=Ld.call(this,i,a)}let{schemaId:o}=this.opts;if(s=s||new Go({schema:t,schemaId:o,root:i,baseId:e}),s.schema!==s.root.schema)return s}});var w_=ve((eq,YD)=>{YD.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var F_=ve((tq,__)=>{"use strict";var QD={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};__.exports={HEX:QD}});var T_=ve((iq,x_)=>{"use strict";var{HEX:e1}=F_();function P_(r){if(I_(r,".")<3)return{host:r,isIPV4:!1};let e=r.match(/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/u)||[],[t]=e;return t?{host:i1(t,"."),isIPV4:!0}:{host:r,isIPV4:!1}}function nm(r,e=!1){let t="",i=!0;for(let n of r){if(e1[n]===void 0)return;n!=="0"&&i===!0&&(i=!1),i||(t+=n)}return e&&t.length===0&&(t="0"),t}function t1(r){let e=0,t={error:!1,address:"",zone:""},i=[],n=[],s=!1,o=!1,a=!1;function l(){if(n.length){if(s===!1){let u=nm(n);if(u!==void 0)i.push(u);else return t.error=!0,!1}n.length=0}return!0}for(let u=0;u<r.length;u++){let c=r[u];if(!(c==="["||c==="]"))if(c===":"){if(o===!0&&(a=!0),!l())break;if(e++,i.push(":"),e>7){t.error=!0;break}u-1>=0&&r[u-1]===":"&&(o=!0);continue}else if(c==="%"){if(!l())break;s=!0}else{n.push(c);continue}}return n.length&&(s?t.zone=n.join(""):a?i.push(n.join("")):i.push(nm(n))),t.address=i.join(""),t}function E_(r,e={}){if(I_(r,":")<2)return{host:r,isIPV6:!1};let t=t1(r);if(t.error)return{host:r,isIPV6:!1};{let i=t.address,n=t.address;return t.zone&&(i+="%"+t.zone,n+="%25"+t.zone),{host:i,escapedHost:n,isIPV6:!0}}}function i1(r,e){let t="",i=!0,n=r.length;for(let s=0;s<n;s++){let o=r[s];o==="0"&&i?(s+1<=n&&r[s+1]===e||s+1===n)&&(t+=o,i=!1):(o===e?i=!0:i=!1,t+=o)}return t}function I_(r,e){let t=0;for(let i=0;i<r.length;i++)r[i]===e&&t++;return t}var k_=/^\.\.?\//u,C_=/^\/\.(?:\/|$)/u,S_=/^\/\.\.(?:\/|$)/u,r1=/^\/?(?:.|\n)*?(?=\/|$)/u;function n1(r){let e=[];for(;r.length;)if(r.match(k_))r=r.replace(k_,"");else if(r.match(C_))r=r.replace(C_,"/");else if(r.match(S_))r=r.replace(S_,"/"),e.pop();else if(r==="."||r==="..")r="";else{let t=r.match(r1);if(t){let i=t[0];r=r.slice(i.length),e.push(i)}else throw new Error("Unexpected dot segment condition")}return e.join("")}function s1(r,e){let t=e!==!0?escape:unescape;return r.scheme!==void 0&&(r.scheme=t(r.scheme)),r.userinfo!==void 0&&(r.userinfo=t(r.userinfo)),r.host!==void 0&&(r.host=t(r.host)),r.path!==void 0&&(r.path=t(r.path)),r.query!==void 0&&(r.query=t(r.query)),r.fragment!==void 0&&(r.fragment=t(r.fragment)),r}function o1(r,e){let t=[];if(r.userinfo!==void 0&&(t.push(r.userinfo),t.push("@")),r.host!==void 0){let i=unescape(r.host),n=P_(i);if(n.isIPV4)i=n.host;else{let s=E_(n.host,{isIPV4:!1});s.isIPV6===!0?i=`[${s.escapedHost}]`:i=r.host}t.push(i)}return(typeof r.port=="number"||typeof r.port=="string")&&(t.push(":"),t.push(String(r.port))),t.length?t.join(""):void 0}x_.exports={recomposeAuthority:o1,normalizeComponentEncoding:s1,removeDotSegments:n1,normalizeIPv4:P_,normalizeIPv6:E_,stringArrayToHexStripped:nm}});var O_=ve((rq,L_)=>{"use strict";var a1=/^[\da-f]{8}\b-[\da-f]{4}\b-[\da-f]{4}\b-[\da-f]{4}\b-[\da-f]{12}$/iu,l1=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu;function D_(r){return typeof r.secure=="boolean"?r.secure:String(r.scheme).toLowerCase()==="wss"}function A_(r){return r.host||(r.error=r.error||"HTTP URIs must have a host."),r}function R_(r){let e=String(r.scheme).toLowerCase()==="https";return(r.port===(e?443:80)||r.port==="")&&(r.port=void 0),r.path||(r.path="/"),r}function u1(r){return r.secure=D_(r),r.resourceName=(r.path||"/")+(r.query?"?"+r.query:""),r.path=void 0,r.query=void 0,r}function c1(r){if((r.port===(D_(r)?443:80)||r.port==="")&&(r.port=void 0),typeof r.secure=="boolean"&&(r.scheme=r.secure?"wss":"ws",r.secure=void 0),r.resourceName){let[e,t]=r.resourceName.split("?");r.path=e&&e!=="/"?e:void 0,r.query=t,r.resourceName=void 0}return r.fragment=void 0,r}function d1(r,e){if(!r.path)return r.error="URN can not be parsed",r;let t=r.path.match(l1);if(t){let i=e.scheme||r.scheme||"urn";r.nid=t[1].toLowerCase(),r.nss=t[2];let n=`${i}:${e.nid||r.nid}`,s=sm[n];r.path=void 0,s&&(r=s.parse(r,e))}else r.error=r.error||"URN can not be parsed.";return r}function f1(r,e){let t=e.scheme||r.scheme||"urn",i=r.nid.toLowerCase(),n=`${t}:${e.nid||i}`,s=sm[n];s&&(r=s.serialize(r,e));let o=r,a=r.nss;return o.path=`${i||e.nid}:${a}`,e.skipEscape=!0,o}function h1(r,e){let t=r;return t.uuid=t.nss,t.nss=void 0,!e.tolerant&&(!t.uuid||!a1.test(t.uuid))&&(t.error=t.error||"UUID is not valid."),t}function p1(r){let e=r;return e.nss=(r.uuid||"").toLowerCase(),e}var B_={scheme:"http",domainHost:!0,parse:A_,serialize:R_},m1={scheme:"https",domainHost:B_.domainHost,parse:A_,serialize:R_},Md={scheme:"ws",domainHost:!0,parse:u1,serialize:c1},g1={scheme:"wss",domainHost:Md.domainHost,parse:Md.parse,serialize:Md.serialize},b1={scheme:"urn",parse:d1,serialize:f1,skipNormalize:!0},y1={scheme:"urn:uuid",parse:h1,serialize:p1,skipNormalize:!0},sm={http:B_,https:m1,ws:Md,wss:g1,urn:b1,"urn:uuid":y1};L_.exports=sm});var N_=ve((nq,jd)=>{"use strict";var{normalizeIPv6:v1,normalizeIPv4:w1,removeDotSegments:mu,recomposeAuthority:_1,normalizeComponentEncoding:Nd}=T_(),om=O_();function F1(r,e){return typeof r=="string"?r=tn(Sn(r,e),e):typeof r=="object"&&(r=Sn(tn(r,e),e)),r}function k1(r,e,t){let i=Object.assign({scheme:"null"},t),n=M_(Sn(r,i),Sn(e,i),i,!0);return tn(n,{...i,skipEscape:!0})}function M_(r,e,t,i){let n={};return i||(r=Sn(tn(r,t),t),e=Sn(tn(e,t),t)),t=t||{},!t.tolerant&&e.scheme?(n.scheme=e.scheme,n.userinfo=e.userinfo,n.host=e.host,n.port=e.port,n.path=mu(e.path||""),n.query=e.query):(e.userinfo!==void 0||e.host!==void 0||e.port!==void 0?(n.userinfo=e.userinfo,n.host=e.host,n.port=e.port,n.path=mu(e.path||""),n.query=e.query):(e.path?(e.path.charAt(0)==="/"?n.path=mu(e.path):((r.userinfo!==void 0||r.host!==void 0||r.port!==void 0)&&!r.path?n.path="/"+e.path:r.path?n.path=r.path.slice(0,r.path.lastIndexOf("/")+1)+e.path:n.path=e.path,n.path=mu(n.path)),n.query=e.query):(n.path=r.path,e.query!==void 0?n.query=e.query:n.query=r.query),n.userinfo=r.userinfo,n.host=r.host,n.port=r.port),n.scheme=r.scheme),n.fragment=e.fragment,n}function C1(r,e,t){return typeof r=="string"?(r=unescape(r),r=tn(Nd(Sn(r,t),!0),{...t,skipEscape:!0})):typeof r=="object"&&(r=tn(Nd(r,!0),{...t,skipEscape:!0})),typeof e=="string"?(e=unescape(e),e=tn(Nd(Sn(e,t),!0),{...t,skipEscape:!0})):typeof e=="object"&&(e=tn(Nd(e,!0),{...t,skipEscape:!0})),r.toLowerCase()===e.toLowerCase()}function tn(r,e){let t={host:r.host,scheme:r.scheme,userinfo:r.userinfo,port:r.port,path:r.path,query:r.query,nid:r.nid,nss:r.nss,uuid:r.uuid,fragment:r.fragment,reference:r.reference,resourceName:r.resourceName,secure:r.secure,error:""},i=Object.assign({},e),n=[],s=om[(i.scheme||t.scheme||"").toLowerCase()];s&&s.serialize&&s.serialize(t,i),t.path!==void 0&&(i.skipEscape?t.path=unescape(t.path):(t.path=escape(t.path),t.scheme!==void 0&&(t.path=t.path.split("%3A").join(":")))),i.reference!=="suffix"&&t.scheme&&n.push(t.scheme,":");let o=_1(t,i);if(o!==void 0&&(i.reference!=="suffix"&&n.push("//"),n.push(o),t.path&&t.path.charAt(0)!=="/"&&n.push("/")),t.path!==void 0){let a=t.path;!i.absolutePath&&(!s||!s.absolutePath)&&(a=mu(a)),o===void 0&&(a=a.replace(/^\/\//u,"/%2F")),n.push(a)}return t.query!==void 0&&n.push("?",t.query),t.fragment!==void 0&&n.push("#",t.fragment),n.join("")}var S1=Array.from({length:127},(r,e)=>/[^!"$&'()*+,\-.;=_`a-z{}~]/u.test(String.fromCharCode(e)));function P1(r){let e=0;for(let t=0,i=r.length;t<i;++t)if(e=r.charCodeAt(t),e>126||S1[e])return!0;return!1}var E1=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function Sn(r,e){let t=Object.assign({},e),i={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},n=r.indexOf("%")!==-1,s=!1;t.reference==="suffix"&&(r=(t.scheme?t.scheme+":":"")+"//"+r);let o=r.match(E1);if(o){if(i.scheme=o[1],i.userinfo=o[3],i.host=o[4],i.port=parseInt(o[5],10),i.path=o[6]||"",i.query=o[7],i.fragment=o[8],isNaN(i.port)&&(i.port=o[5]),i.host){let l=w1(i.host);if(l.isIPV4===!1){let u=v1(l.host,{isIPV4:!1});i.host=u.host.toLowerCase(),s=u.isIPV6}else i.host=l.host,s=!0}i.scheme===void 0&&i.userinfo===void 0&&i.host===void 0&&i.port===void 0&&!i.path&&i.query===void 0?i.reference="same-document":i.scheme===void 0?i.reference="relative":i.fragment===void 0?i.reference="absolute":i.reference="uri",t.reference&&t.reference!=="suffix"&&t.reference!==i.reference&&(i.error=i.error||"URI is not a "+t.reference+" reference.");let a=om[(t.scheme||i.scheme||"").toLowerCase()];if(!t.unicodeSupport&&(!a||!a.unicodeSupport)&&i.host&&(t.domainHost||a&&a.domainHost)&&s===!1&&P1(i.host))try{i.host=URL.domainToASCII(i.host.toLowerCase())}catch(l){i.error=i.error||"Host's domain name can not be converted to ASCII: "+l}(!a||a&&!a.skipNormalize)&&(n&&i.scheme!==void 0&&(i.scheme=unescape(i.scheme)),n&&i.host!==void 0&&(i.host=unescape(i.host)),i.path!==void 0&&i.path.length&&(i.path=escape(unescape(i.path))),i.fragment!==void 0&&i.fragment.length&&(i.fragment=encodeURI(decodeURIComponent(i.fragment)))),a&&a.parse&&a.parse(i,t)}else i.error=i.error||"URI can not be parsed.";return i}var am={SCHEMES:om,normalize:F1,resolve:k1,resolveComponents:M_,equal:C1,serialize:tn,parse:Sn};jd.exports=am;jd.exports.default=am;jd.exports.fastUri=am});var U_=ve(lm=>{"use strict";Object.defineProperty(lm,"__esModule",{value:!0});var j_=N_();j_.code='require("ajv/dist/runtime/uri").default';lm.default=j_});var q_=ve(Si=>{"use strict";Object.defineProperty(Si,"__esModule",{value:!0});Si.CodeGen=Si.Name=Si.nil=Si.stringify=Si.str=Si._=Si.KeywordCxt=void 0;var I1=hu();Object.defineProperty(Si,"KeywordCxt",{enumerable:!0,get:function(){return I1.KeywordCxt}});var zo=vt();Object.defineProperty(Si,"_",{enumerable:!0,get:function(){return zo._}});Object.defineProperty(Si,"str",{enumerable:!0,get:function(){return zo.str}});Object.defineProperty(Si,"stringify",{enumerable:!0,get:function(){return zo.stringify}});Object.defineProperty(Si,"nil",{enumerable:!0,get:function(){return zo.nil}});Object.defineProperty(Si,"Name",{enumerable:!0,get:function(){return zo.Name}});Object.defineProperty(Si,"CodeGen",{enumerable:!0,get:function(){return zo.CodeGen}});var x1=Bd(),J_=pu(),T1=Np(),gu=Od(),D1=vt(),bu=cu(),Ud=uu(),cm=xt(),G_=w_(),A1=U_(),$_=(r,e)=>new RegExp(r,e);$_.code="new RegExp";var R1=["removeAdditional","useDefaults","coerceTypes"],B1=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),L1={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},O1={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},z_=200;function M1(r){var e,t,i,n,s,o,a,l,u,c,d,h,f,m,p,g,b,F,w,_,I,A,T,E,K;let P=r.strict,G=(e=r.code)===null||e===void 0?void 0:e.optimize,y=G===!0||G===void 0?1:G||0,z=(i=(t=r.code)===null||t===void 0?void 0:t.regExp)!==null&&i!==void 0?i:$_,Fe=(n=r.uriResolver)!==null&&n!==void 0?n:A1.default;return{strictSchema:(o=(s=r.strictSchema)!==null&&s!==void 0?s:P)!==null&&o!==void 0?o:!0,strictNumbers:(l=(a=r.strictNumbers)!==null&&a!==void 0?a:P)!==null&&l!==void 0?l:!0,strictTypes:(c=(u=r.strictTypes)!==null&&u!==void 0?u:P)!==null&&c!==void 0?c:"log",strictTuples:(h=(d=r.strictTuples)!==null&&d!==void 0?d:P)!==null&&h!==void 0?h:"log",strictRequired:(m=(f=r.strictRequired)!==null&&f!==void 0?f:P)!==null&&m!==void 0?m:!1,code:r.code?{...r.code,optimize:y,regExp:z}:{optimize:y,regExp:z},loopRequired:(p=r.loopRequired)!==null&&p!==void 0?p:z_,loopEnum:(g=r.loopEnum)!==null&&g!==void 0?g:z_,meta:(b=r.meta)!==null&&b!==void 0?b:!0,messages:(F=r.messages)!==null&&F!==void 0?F:!0,inlineRefs:(w=r.inlineRefs)!==null&&w!==void 0?w:!0,schemaId:(_=r.schemaId)!==null&&_!==void 0?_:"$id",addUsedSchema:(I=r.addUsedSchema)!==null&&I!==void 0?I:!0,validateSchema:(A=r.validateSchema)!==null&&A!==void 0?A:!0,validateFormats:(T=r.validateFormats)!==null&&T!==void 0?T:!0,unicodeRegExp:(E=r.unicodeRegExp)!==null&&E!==void 0?E:!0,int32range:(K=r.int32range)!==null&&K!==void 0?K:!0,uriResolver:Fe}}var yu=class{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...M1(e)};let{es5:t,lines:i}=this.opts.code;this.scope=new D1.ValueScope({scope:{},prefixes:B1,es5:t,lines:i}),this.logger=V1(e.logger);let n=e.validateFormats;e.validateFormats=!1,this.RULES=(0,T1.getRules)(),V_.call(this,L1,e,"NOT SUPPORTED"),V_.call(this,O1,e,"DEPRECATED","warn"),this._metaOpts=G1.call(this),e.formats&&j1.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&U1.call(this,e.keywords),typeof e.meta=="object"&&this.addMetaSchema(e.meta),N1.call(this),e.validateFormats=n}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:e,meta:t,schemaId:i}=this.opts,n=G_;i==="id"&&(n={...G_},n.id=n.$id,delete n.$id),t&&e&&this.addMetaSchema(n,n[i],!1)}defaultMeta(){let{meta:e,schemaId:t}=this.opts;return this.opts.defaultMeta=typeof e=="object"?e[t]||e:void 0}validate(e,t){let i;if(typeof e=="string"){if(i=this.getSchema(e),!i)throw new Error(`no schema with key or ref "${e}"`)}else i=this.compile(e);let n=i(t);return"$async"in i||(this.errors=i.errors),n}compile(e,t){let i=this._addSchema(e,t);return i.validate||this._compileSchemaEnv(i)}compileAsync(e,t){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");let{loadSchema:i}=this.opts;return n.call(this,e,t);async function n(c,d){await s.call(this,c.$schema);let h=this._addSchema(c,d);return h.validate||o.call(this,h)}async function s(c){c&&!this.getSchema(c)&&await n.call(this,{$ref:c},!0)}async function o(c){try{return this._compileSchemaEnv(c)}catch(d){if(!(d instanceof J_.default))throw d;return a.call(this,d),await l.call(this,d.missingSchema),o.call(this,c)}}function a({missingSchema:c,missingRef:d}){if(this.refs[c])throw new Error(`AnySchema ${c} is loaded but ${d} cannot be resolved`)}async function l(c){let d=await u.call(this,c);this.refs[c]||await s.call(this,d.$schema),this.refs[c]||this.addSchema(d,c,t)}async function u(c){let d=this._loading[c];if(d)return d;try{return await(this._loading[c]=i(c))}finally{delete this._loading[c]}}}addSchema(e,t,i,n=this.opts.validateSchema){if(Array.isArray(e)){for(let o of e)this.addSchema(o,void 0,i,n);return this}let s;if(typeof e=="object"){let{schemaId:o}=this.opts;if(s=e[o],s!==void 0&&typeof s!="string")throw new Error(`schema ${o} must be string`)}return t=(0,bu.normalizeId)(t||s),this._checkUnique(t),this.schemas[t]=this._addSchema(e,i,t,n,!0),this}addMetaSchema(e,t,i=this.opts.validateSchema){return this.addSchema(e,t,!0,i),this}validateSchema(e,t){if(typeof e=="boolean")return!0;let i;if(i=e.$schema,i!==void 0&&typeof i!="string")throw new Error("$schema must be a string");if(i=i||this.opts.defaultMeta||this.defaultMeta(),!i)return this.logger.warn("meta-schema not available"),this.errors=null,!0;let n=this.validate(i,e);if(!n&&t){let s="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(s);else throw new Error(s)}return n}getSchema(e){let t;for(;typeof(t=W_.call(this,e))=="string";)e=t;if(t===void 0){let{schemaId:i}=this.opts,n=new gu.SchemaEnv({schema:{},schemaId:i});if(t=gu.resolveSchema.call(this,n,e),!t)return;this.refs[e]=t}return t.validate||this._compileSchemaEnv(t)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let t=W_.call(this,e);return typeof t=="object"&&this._cache.delete(t.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{let t=e;this._cache.delete(t);let i=e[this.opts.schemaId];return i&&(i=(0,bu.normalizeId)(i),delete this.schemas[i],delete this.refs[i]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(let t of e)this.addKeyword(t);return this}addKeyword(e,t){let i;if(typeof e=="string")i=e,typeof t=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),t.keyword=i);else if(typeof e=="object"&&t===void 0){if(t=e,i=t.keyword,Array.isArray(i)&&!i.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(J1.call(this,i,t),!t)return(0,cm.eachItem)(i,s=>um.call(this,s)),this;H1.call(this,t);let n={...t,type:(0,Ud.getJSONTypes)(t.type),schemaType:(0,Ud.getJSONTypes)(t.schemaType)};return(0,cm.eachItem)(i,n.type.length===0?s=>um.call(this,s,n):s=>n.type.forEach(o=>um.call(this,s,n,o))),this}getKeyword(e){let t=this.RULES.all[e];return typeof t=="object"?t.definition:!!t}removeKeyword(e){let{RULES:t}=this;delete t.keywords[e],delete t.all[e];for(let i of t.rules){let n=i.rules.findIndex(s=>s.keyword===e);n>=0&&i.rules.splice(n,1)}return this}addFormat(e,t){return typeof t=="string"&&(t=new RegExp(t)),this.formats[e]=t,this}errorsText(e=this.errors,{separator:t=", ",dataVar:i="data"}={}){return!e||e.length===0?"No errors":e.map(n=>`${i}${n.instancePath} ${n.message}`).reduce((n,s)=>n+t+s)}$dataMetaSchema(e,t){let i=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(let n of t){let s=n.split("/").slice(1),o=e;for(let a of s)o=o[a];for(let a in i){let l=i[a];if(typeof l!="object")continue;let{$data:u}=l.definition,c=o[a];u&&c&&(o[a]=H_(c))}}return e}_removeAllSchemas(e,t){for(let i in e){let n=e[i];(!t||t.test(i))&&(typeof n=="string"?delete e[i]:n&&!n.meta&&(this._cache.delete(n.schema),delete e[i]))}}_addSchema(e,t,i,n=this.opts.validateSchema,s=this.opts.addUsedSchema){let o,{schemaId:a}=this.opts;if(typeof e=="object")o=e[a];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof e!="boolean")throw new Error("schema must be object or boolean")}let l=this._cache.get(e);if(l!==void 0)return l;i=(0,bu.normalizeId)(o||i);let u=bu.getSchemaRefs.call(this,e,i);return l=new gu.SchemaEnv({schema:e,schemaId:a,meta:t,baseId:i,localRefs:u}),this._cache.set(l.schema,l),s&&!i.startsWith("#")&&(i&&this._checkUnique(i),this.refs[i]=l),n&&this.validateSchema(e,!0),l}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):gu.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){let t=this.opts;this.opts=this._metaOpts;try{gu.compileSchema.call(this,e)}finally{this.opts=t}}};yu.ValidationError=x1.default;yu.MissingRefError=J_.default;Si.default=yu;function V_(r,e,t,i="error"){for(let n in r){let s=n;s in e&&this.logger[i](`${t}: option ${n}. ${r[s]}`)}}function W_(r){return r=(0,bu.normalizeId)(r),this.schemas[r]||this.refs[r]}function N1(){let r=this.opts.schemas;if(r)if(Array.isArray(r))this.addSchema(r);else for(let e in r)this.addSchema(r[e],e)}function j1(){for(let r in this.opts.formats){let e=this.opts.formats[r];e&&this.addFormat(r,e)}}function U1(r){if(Array.isArray(r)){this.addVocabulary(r);return}this.logger.warn("keywords option as map is deprecated, pass array");for(let e in r){let t=r[e];t.keyword||(t.keyword=e),this.addKeyword(t)}}function G1(){let r={...this.opts};for(let e of R1)delete r[e];return r}var z1={log(){},warn(){},error(){}};function V1(r){if(r===!1)return z1;if(r===void 0)return console;if(r.log&&r.warn&&r.error)return r;throw new Error("logger must implement log, warn and error methods")}var W1=/^[a-z_$][a-z0-9_$:-]*$/i;function J1(r,e){let{RULES:t}=this;if((0,cm.eachItem)(r,i=>{if(t.keywords[i])throw new Error(`Keyword ${i} is already defined`);if(!W1.test(i))throw new Error(`Keyword ${i} has invalid name`)}),!!e&&e.$data&&!("code"in e||"validate"in e))throw new Error('$data keyword must have "code" or "validate" function')}function um(r,e,t){var i;let n=e?.post;if(t&&n)throw new Error('keyword with "post" flag cannot have "type"');let{RULES:s}=this,o=n?s.post:s.rules.find(({type:l})=>l===t);if(o||(o={type:t,rules:[]},s.rules.push(o)),s.keywords[r]=!0,!e)return;let a={keyword:r,definition:{...e,type:(0,Ud.getJSONTypes)(e.type),schemaType:(0,Ud.getJSONTypes)(e.schemaType)}};e.before?$1.call(this,o,a,e.before):o.rules.push(a),s.all[r]=a,(i=e.implements)===null||i===void 0||i.forEach(l=>this.addKeyword(l))}function $1(r,e,t){let i=r.rules.findIndex(n=>n.keyword===t);i>=0?r.rules.splice(i,0,e):(r.rules.push(e),this.logger.warn(`rule ${t} is not defined`))}function H1(r){let{metaSchema:e}=r;e!==void 0&&(r.$data&&this.opts.$data&&(e=H_(e)),r.validateSchema=this.compile(e,!0))}var q1={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function H_(r){return{anyOf:[r,q1]}}});var K_=ve(dm=>{"use strict";Object.defineProperty(dm,"__esModule",{value:!0});var K1={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};dm.default=K1});var Q_=ve(Zs=>{"use strict";Object.defineProperty(Zs,"__esModule",{value:!0});Zs.callRef=Zs.getValidate=void 0;var X1=pu(),X_=br(),tr=vt(),Vo=kn(),Z_=Od(),Gd=xt(),Z1={keyword:"$ref",schemaType:"string",code(r){let{gen:e,schema:t,it:i}=r,{baseId:n,schemaEnv:s,validateName:o,opts:a,self:l}=i,{root:u}=s;if((t==="#"||t==="#/")&&n===u.baseId)return d();let c=Z_.resolveRef.call(l,u,n,t);if(c===void 0)throw new X1.default(i.opts.uriResolver,n,t);if(c instanceof Z_.SchemaEnv)return h(c);return f(c);function d(){if(s===u)return zd(r,o,s,s.$async);let m=e.scopeValue("root",{ref:u});return zd(r,(0,tr._)`${m}.validate`,u,u.$async)}function h(m){let p=Y_(r,m);zd(r,p,m,m.$async)}function f(m){let p=e.scopeValue("schema",a.code.source===!0?{ref:m,code:(0,tr.stringify)(m)}:{ref:m}),g=e.name("valid"),b=r.subschema({schema:m,dataTypes:[],schemaPath:tr.nil,topSchemaRef:p,errSchemaPath:t},g);r.mergeEvaluated(b),r.ok(g)}}};function Y_(r,e){let{gen:t}=r;return e.validate?t.scopeValue("validate",{ref:e.validate}):(0,tr._)`${t.scopeValue("wrapper",{ref:e})}.validate`}Zs.getValidate=Y_;function zd(r,e,t,i){let{gen:n,it:s}=r,{allErrors:o,schemaEnv:a,opts:l}=s,u=l.passContext?Vo.default.this:tr.nil;i?c():d();function c(){if(!a.$async)throw new Error("async schema referenced by sync schema");let m=n.let("valid");n.try(()=>{n.code((0,tr._)`await ${(0,X_.callValidateCode)(r,e,u)}`),f(e),o||n.assign(m,!0)},p=>{n.if((0,tr._)`!(${p} instanceof ${s.ValidationError})`,()=>n.throw(p)),h(p),o||n.assign(m,!1)}),r.ok(m)}function d(){r.result((0,X_.callValidateCode)(r,e,u),()=>f(e),()=>h(e))}function h(m){let p=(0,tr._)`${m}.errors`;n.assign(Vo.default.vErrors,(0,tr._)`${Vo.default.vErrors} === null ? ${p} : ${Vo.default.vErrors}.concat(${p})`),n.assign(Vo.default.errors,(0,tr._)`${Vo.default.vErrors}.length`)}function f(m){var p;if(!s.opts.unevaluated)return;let g=(p=t?.validate)===null||p===void 0?void 0:p.evaluated;if(s.props!==!0)if(g&&!g.dynamicProps)g.props!==void 0&&(s.props=Gd.mergeEvaluated.props(n,g.props,s.props));else{let b=n.var("props",(0,tr._)`${m}.evaluated.props`);s.props=Gd.mergeEvaluated.props(n,b,s.props,tr.Name)}if(s.items!==!0)if(g&&!g.dynamicItems)g.items!==void 0&&(s.items=Gd.mergeEvaluated.items(n,g.items,s.items));else{let b=n.var("items",(0,tr._)`${m}.evaluated.items`);s.items=Gd.mergeEvaluated.items(n,b,s.items,tr.Name)}}}Zs.callRef=zd;Zs.default=Z1});var eF=ve(fm=>{"use strict";Object.defineProperty(fm,"__esModule",{value:!0});var Y1=K_(),Q1=Q_(),eA=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",Y1.default,Q1.default];fm.default=eA});var tF=ve(hm=>{"use strict";Object.defineProperty(hm,"__esModule",{value:!0});var Vd=vt(),rs=Vd.operators,Wd={maximum:{okStr:"<=",ok:rs.LTE,fail:rs.GT},minimum:{okStr:">=",ok:rs.GTE,fail:rs.LT},exclusiveMaximum:{okStr:"<",ok:rs.LT,fail:rs.GTE},exclusiveMinimum:{okStr:">",ok:rs.GT,fail:rs.LTE}},tA={message:({keyword:r,schemaCode:e})=>(0,Vd.str)`must be ${Wd[r].okStr} ${e}`,params:({keyword:r,schemaCode:e})=>(0,Vd._)`{comparison: ${Wd[r].okStr}, limit: ${e}}`},iA={keyword:Object.keys(Wd),type:"number",schemaType:"number",$data:!0,error:tA,code(r){let{keyword:e,data:t,schemaCode:i}=r;r.fail$data((0,Vd._)`${t} ${Wd[e].fail} ${i} || isNaN(${t})`)}};hm.default=iA});var iF=ve(pm=>{"use strict";Object.defineProperty(pm,"__esModule",{value:!0});var vu=vt(),rA={message:({schemaCode:r})=>(0,vu.str)`must be multiple of ${r}`,params:({schemaCode:r})=>(0,vu._)`{multipleOf: ${r}}`},nA={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:rA,code(r){let{gen:e,data:t,schemaCode:i,it:n}=r,s=n.opts.multipleOfPrecision,o=e.let("res"),a=s?(0,vu._)`Math.abs(Math.round(${o}) - ${o}) > 1e-${s}`:(0,vu._)`${o} !== parseInt(${o})`;r.fail$data((0,vu._)`(${i} === 0 || (${o} = ${t}/${i}, ${a}))`)}};pm.default=nA});var nF=ve(mm=>{"use strict";Object.defineProperty(mm,"__esModule",{value:!0});function rF(r){let e=r.length,t=0,i=0,n;for(;i<e;)t++,n=r.charCodeAt(i++),n>=55296&&n<=56319&&i<e&&(n=r.charCodeAt(i),(n&64512)===56320&&i++);return t}mm.default=rF;rF.code='require("ajv/dist/runtime/ucs2length").default'});var sF=ve(gm=>{"use strict";Object.defineProperty(gm,"__esModule",{value:!0});var Ys=vt(),sA=xt(),oA=nF(),aA={message({keyword:r,schemaCode:e}){let t=r==="maxLength"?"more":"fewer";return(0,Ys.str)`must NOT have ${t} than ${e} characters`},params:({schemaCode:r})=>(0,Ys._)`{limit: ${r}}`},lA={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:aA,code(r){let{keyword:e,data:t,schemaCode:i,it:n}=r,s=e==="maxLength"?Ys.operators.GT:Ys.operators.LT,o=n.opts.unicode===!1?(0,Ys._)`${t}.length`:(0,Ys._)`${(0,sA.useFunc)(r.gen,oA.default)}(${t})`;r.fail$data((0,Ys._)`${o} ${s} ${i}`)}};gm.default=lA});var oF=ve(bm=>{"use strict";Object.defineProperty(bm,"__esModule",{value:!0});var uA=br(),Jd=vt(),cA={message:({schemaCode:r})=>(0,Jd.str)`must match pattern "${r}"`,params:({schemaCode:r})=>(0,Jd._)`{pattern: ${r}}`},dA={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:cA,code(r){let{data:e,$data:t,schema:i,schemaCode:n,it:s}=r,o=s.opts.unicodeRegExp?"u":"",a=t?(0,Jd._)`(new RegExp(${n}, ${o}))`:(0,uA.usePattern)(r,i);r.fail$data((0,Jd._)`!${a}.test(${e})`)}};bm.default=dA});var aF=ve(ym=>{"use strict";Object.defineProperty(ym,"__esModule",{value:!0});var wu=vt(),fA={message({keyword:r,schemaCode:e}){let t=r==="maxProperties"?"more":"fewer";return(0,wu.str)`must NOT have ${t} than ${e} properties`},params:({schemaCode:r})=>(0,wu._)`{limit: ${r}}`},hA={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:fA,code(r){let{keyword:e,data:t,schemaCode:i}=r,n=e==="maxProperties"?wu.operators.GT:wu.operators.LT;r.fail$data((0,wu._)`Object.keys(${t}).length ${n} ${i}`)}};ym.default=hA});var lF=ve(vm=>{"use strict";Object.defineProperty(vm,"__esModule",{value:!0});var _u=br(),Fu=vt(),pA=xt(),mA={message:({params:{missingProperty:r}})=>(0,Fu.str)`must have required property '${r}'`,params:({params:{missingProperty:r}})=>(0,Fu._)`{missingProperty: ${r}}`},gA={keyword:"required",type:"object",schemaType:"array",$data:!0,error:mA,code(r){let{gen:e,schema:t,schemaCode:i,data:n,$data:s,it:o}=r,{opts:a}=o;if(!s&&t.length===0)return;let l=t.length>=a.loopRequired;if(o.allErrors?u():c(),a.strictRequired){let f=r.parentSchema.properties,{definedProperties:m}=r.it;for(let p of t)if(f?.[p]===void 0&&!m.has(p)){let g=o.schemaEnv.baseId+o.errSchemaPath,b=`required property "${p}" is not defined at "${g}" (strictRequired)`;(0,pA.checkStrictMode)(o,b,o.opts.strictRequired)}}function u(){if(l||s)r.block$data(Fu.nil,d);else for(let f of t)(0,_u.checkReportMissingProp)(r,f)}function c(){let f=e.let("missing");if(l||s){let m=e.let("valid",!0);r.block$data(m,()=>h(f,m)),r.ok(m)}else e.if((0,_u.checkMissingProp)(r,t,f)),(0,_u.reportMissingProp)(r,f),e.else()}function d(){e.forOf("prop",i,f=>{r.setParams({missingProperty:f}),e.if((0,_u.noPropertyInData)(e,n,f,a.ownProperties),()=>r.error())})}function h(f,m){r.setParams({missingProperty:f}),e.forOf(f,i,()=>{e.assign(m,(0,_u.propertyInData)(e,n,f,a.ownProperties)),e.if((0,Fu.not)(m),()=>{r.error(),e.break()})},Fu.nil)}}};vm.default=gA});var uF=ve(wm=>{"use strict";Object.defineProperty(wm,"__esModule",{value:!0});var ku=vt(),bA={message({keyword:r,schemaCode:e}){let t=r==="maxItems"?"more":"fewer";return(0,ku.str)`must NOT have ${t} than ${e} items`},params:({schemaCode:r})=>(0,ku._)`{limit: ${r}}`},yA={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:bA,code(r){let{keyword:e,data:t,schemaCode:i}=r,n=e==="maxItems"?ku.operators.GT:ku.operators.LT;r.fail$data((0,ku._)`${t}.length ${n} ${i}`)}};wm.default=yA});var $d=ve(_m=>{"use strict";Object.defineProperty(_m,"__esModule",{value:!0});var cF=$p();cF.code='require("ajv/dist/runtime/equal").default';_m.default=cF});var dF=ve(km=>{"use strict";Object.defineProperty(km,"__esModule",{value:!0});var Fm=uu(),Pi=vt(),vA=xt(),wA=$d(),_A={message:({params:{i:r,j:e}})=>(0,Pi.str)`must NOT have duplicate items (items ## ${e} and ${r} are identical)`,params:({params:{i:r,j:e}})=>(0,Pi._)`{i: ${r}, j: ${e}}`},FA={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:_A,code(r){let{gen:e,data:t,$data:i,schema:n,parentSchema:s,schemaCode:o,it:a}=r;if(!i&&!n)return;let l=e.let("valid"),u=s.items?(0,Fm.getSchemaTypes)(s.items):[];r.block$data(l,c,(0,Pi._)`${o} === false`),r.ok(l);function c(){let m=e.let("i",(0,Pi._)`${t}.length`),p=e.let("j");r.setParams({i:m,j:p}),e.assign(l,!0),e.if((0,Pi._)`${m} > 1`,()=>(d()?h:f)(m,p))}function d(){return u.length>0&&!u.some(m=>m==="object"||m==="array")}function h(m,p){let g=e.name("item"),b=(0,Fm.checkDataTypes)(u,g,a.opts.strictNumbers,Fm.DataType.Wrong),F=e.const("indices",(0,Pi._)`{}`);e.for((0,Pi._)`;${m}--;`,()=>{e.let(g,(0,Pi._)`${t}[${m}]`),e.if(b,(0,Pi._)`continue`),u.length>1&&e.if((0,Pi._)`typeof ${g} == "string"`,(0,Pi._)`${g} += "_"`),e.if((0,Pi._)`typeof ${F}[${g}] == "number"`,()=>{e.assign(p,(0,Pi._)`${F}[${g}]`),r.error(),e.assign(l,!1).break()}).code((0,Pi._)`${F}[${g}] = ${m}`)})}function f(m,p){let g=(0,vA.useFunc)(e,wA.default),b=e.name("outer");e.label(b).for((0,Pi._)`;${m}--;`,()=>e.for((0,Pi._)`${p} = ${m}; ${p}--;`,()=>e.if((0,Pi._)`${g}(${t}[${m}], ${t}[${p}])`,()=>{r.error(),e.assign(l,!1).break(b)})))}}};km.default=FA});var fF=ve(Sm=>{"use strict";Object.defineProperty(Sm,"__esModule",{value:!0});var Cm=vt(),kA=xt(),CA=$d(),SA={message:"must be equal to constant",params:({schemaCode:r})=>(0,Cm._)`{allowedValue: ${r}}`},PA={keyword:"const",$data:!0,error:SA,code(r){let{gen:e,data:t,$data:i,schemaCode:n,schema:s}=r;i||s&&typeof s=="object"?r.fail$data((0,Cm._)`!${(0,kA.useFunc)(e,CA.default)}(${t}, ${n})`):r.fail((0,Cm._)`${s} !== ${t}`)}};Sm.default=PA});var hF=ve(Pm=>{"use strict";Object.defineProperty(Pm,"__esModule",{value:!0});var Cu=vt(),EA=xt(),IA=$d(),xA={message:"must be equal to one of the allowed values",params:({schemaCode:r})=>(0,Cu._)`{allowedValues: ${r}}`},TA={keyword:"enum",schemaType:"array",$data:!0,error:xA,code(r){let{gen:e,data:t,$data:i,schema:n,schemaCode:s,it:o}=r;if(!i&&n.length===0)throw new Error("enum must have non-empty array");let a=n.length>=o.opts.loopEnum,l,u=()=>l??(l=(0,EA.useFunc)(e,IA.default)),c;if(a||i)c=e.let("valid"),r.block$data(c,d);else{if(!Array.isArray(n))throw new Error("ajv implementation error");let f=e.const("vSchema",s);c=(0,Cu.or)(...n.map((m,p)=>h(f,p)))}r.pass(c);function d(){e.assign(c,!1),e.forOf("v",s,f=>e.if((0,Cu._)`${u()}(${t}, ${f})`,()=>e.assign(c,!0).break()))}function h(f,m){let p=n[m];return typeof p=="object"&&p!==null?(0,Cu._)`${u()}(${t}, ${f}[${m}])`:(0,Cu._)`${t} === ${p}`}}};Pm.default=TA});var pF=ve(Em=>{"use strict";Object.defineProperty(Em,"__esModule",{value:!0});var DA=tF(),AA=iF(),RA=sF(),BA=oF(),LA=aF(),OA=lF(),MA=uF(),NA=dF(),jA=fF(),UA=hF(),GA=[DA.default,AA.default,RA.default,BA.default,LA.default,OA.default,MA.default,NA.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},jA.default,UA.default];Em.default=GA});var xm=ve(Su=>{"use strict";Object.defineProperty(Su,"__esModule",{value:!0});Su.validateAdditionalItems=void 0;var Qs=vt(),Im=xt(),zA={message:({params:{len:r}})=>(0,Qs.str)`must NOT have more than ${r} items`,params:({params:{len:r}})=>(0,Qs._)`{limit: ${r}}`},VA={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:zA,code(r){let{parentSchema:e,it:t}=r,{items:i}=e;if(!Array.isArray(i)){(0,Im.checkStrictMode)(t,'"additionalItems" is ignored when "items" is not an array of schemas');return}mF(r,i)}};function mF(r,e){let{gen:t,schema:i,data:n,keyword:s,it:o}=r;o.items=!0;let a=t.const("len",(0,Qs._)`${n}.length`);if(i===!1)r.setParams({len:e.length}),r.pass((0,Qs._)`${a} <= ${e.length}`);else if(typeof i=="object"&&!(0,Im.alwaysValidSchema)(o,i)){let u=t.var("valid",(0,Qs._)`${a} <= ${e.length}`);t.if((0,Qs.not)(u),()=>l(u)),r.ok(u)}function l(u){t.forRange("i",e.length,a,c=>{r.subschema({keyword:s,dataProp:c,dataPropType:Im.Type.Num},u),o.allErrors||t.if((0,Qs.not)(u),()=>t.break())})}}Su.validateAdditionalItems=mF;Su.default=VA});var Tm=ve(Pu=>{"use strict";Object.defineProperty(Pu,"__esModule",{value:!0});Pu.validateTuple=void 0;var gF=vt(),Hd=xt(),WA=br(),JA={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(r){let{schema:e,it:t}=r;if(Array.isArray(e))return bF(r,"additionalItems",e);t.items=!0,!(0,Hd.alwaysValidSchema)(t,e)&&r.ok((0,WA.validateArray)(r))}};function bF(r,e,t=r.schema){let{gen:i,parentSchema:n,data:s,keyword:o,it:a}=r;c(n),a.opts.unevaluated&&t.length&&a.items!==!0&&(a.items=Hd.mergeEvaluated.items(i,t.length,a.items));let l=i.name("valid"),u=i.const("len",(0,gF._)`${s}.length`);t.forEach((d,h)=>{(0,Hd.alwaysValidSchema)(a,d)||(i.if((0,gF._)`${u} > ${h}`,()=>r.subschema({keyword:o,schemaProp:h,dataProp:h},l)),r.ok(l))});function c(d){let{opts:h,errSchemaPath:f}=a,m=t.length,p=m===d.minItems&&(m===d.maxItems||d[e]===!1);if(h.strictTuples&&!p){let g=`"${o}" is ${m}-tuple, but minItems or maxItems/${e} are not specified or different at path "${f}"`;(0,Hd.checkStrictMode)(a,g,h.strictTuples)}}}Pu.validateTuple=bF;Pu.default=JA});var yF=ve(Dm=>{"use strict";Object.defineProperty(Dm,"__esModule",{value:!0});var $A=Tm(),HA={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:r=>(0,$A.validateTuple)(r,"items")};Dm.default=HA});var wF=ve(Am=>{"use strict";Object.defineProperty(Am,"__esModule",{value:!0});var vF=vt(),qA=xt(),KA=br(),XA=xm(),ZA={message:({params:{len:r}})=>(0,vF.str)`must NOT have more than ${r} items`,params:({params:{len:r}})=>(0,vF._)`{limit: ${r}}`},YA={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:ZA,code(r){let{schema:e,parentSchema:t,it:i}=r,{prefixItems:n}=t;i.items=!0,!(0,qA.alwaysValidSchema)(i,e)&&(n?(0,XA.validateAdditionalItems)(r,n):r.ok((0,KA.validateArray)(r)))}};Am.default=YA});var _F=ve(Rm=>{"use strict";Object.defineProperty(Rm,"__esModule",{value:!0});var vr=vt(),qd=xt(),QA={message:({params:{min:r,max:e}})=>e===void 0?(0,vr.str)`must contain at least ${r} valid item(s)`:(0,vr.str)`must contain at least ${r} and no more than ${e} valid item(s)`,params:({params:{min:r,max:e}})=>e===void 0?(0,vr._)`{minContains: ${r}}`:(0,vr._)`{minContains: ${r}, maxContains: ${e}}`},e2={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:QA,code(r){let{gen:e,schema:t,parentSchema:i,data:n,it:s}=r,o,a,{minContains:l,maxContains:u}=i;s.opts.next?(o=l===void 0?1:l,a=u):o=1;let c=e.const("len",(0,vr._)`${n}.length`);if(r.setParams({min:o,max:a}),a===void 0&&o===0){(0,qd.checkStrictMode)(s,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(a!==void 0&&o>a){(0,qd.checkStrictMode)(s,'"minContains" > "maxContains" is always invalid'),r.fail();return}if((0,qd.alwaysValidSchema)(s,t)){let p=(0,vr._)`${c} >= ${o}`;a!==void 0&&(p=(0,vr._)`${p} && ${c} <= ${a}`),r.pass(p);return}s.items=!0;let d=e.name("valid");a===void 0&&o===1?f(d,()=>e.if(d,()=>e.break())):o===0?(e.let(d,!0),a!==void 0&&e.if((0,vr._)`${n}.length > 0`,h)):(e.let(d,!1),h()),r.result(d,()=>r.reset());function h(){let p=e.name("_valid"),g=e.let("count",0);f(p,()=>e.if(p,()=>m(g)))}function f(p,g){e.forRange("i",0,c,b=>{r.subschema({keyword:"contains",dataProp:b,dataPropType:qd.Type.Num,compositeRule:!0},p),g()})}function m(p){e.code((0,vr._)`${p}++`),a===void 0?e.if((0,vr._)`${p} >= ${o}`,()=>e.assign(d,!0).break()):(e.if((0,vr._)`${p} > ${a}`,()=>e.assign(d,!1).break()),o===1?e.assign(d,!0):e.if((0,vr._)`${p} >= ${o}`,()=>e.assign(d,!0)))}}};Rm.default=e2});var CF=ve(rn=>{"use strict";Object.defineProperty(rn,"__esModule",{value:!0});rn.validateSchemaDeps=rn.validatePropertyDeps=rn.error=void 0;var Bm=vt(),t2=xt(),Eu=br();rn.error={message:({params:{property:r,depsCount:e,deps:t}})=>{let i=e===1?"property":"properties";return(0,Bm.str)`must have ${i} ${t} when property ${r} is present`},params:({params:{property:r,depsCount:e,deps:t,missingProperty:i}})=>(0,Bm._)`{property: ${r},
    missingProperty: ${i},
    depsCount: ${e},
    deps: ${t}}`};var i2={keyword:"dependencies",type:"object",schemaType:"object",error:rn.error,code(r){let[e,t]=r2(r);FF(r,e),kF(r,t)}};function r2({schema:r}){let e={},t={};for(let i in r){if(i==="__proto__")continue;let n=Array.isArray(r[i])?e:t;n[i]=r[i]}return[e,t]}function FF(r,e=r.schema){let{gen:t,data:i,it:n}=r;if(Object.keys(e).length===0)return;let s=t.let("missing");for(let o in e){let a=e[o];if(a.length===0)continue;let l=(0,Eu.propertyInData)(t,i,o,n.opts.ownProperties);r.setParams({property:o,depsCount:a.length,deps:a.join(", ")}),n.allErrors?t.if(l,()=>{for(let u of a)(0,Eu.checkReportMissingProp)(r,u)}):(t.if((0,Bm._)`${l} && (${(0,Eu.checkMissingProp)(r,a,s)})`),(0,Eu.reportMissingProp)(r,s),t.else())}}rn.validatePropertyDeps=FF;function kF(r,e=r.schema){let{gen:t,data:i,keyword:n,it:s}=r,o=t.name("valid");for(let a in e)(0,t2.alwaysValidSchema)(s,e[a])||(t.if((0,Eu.propertyInData)(t,i,a,s.opts.ownProperties),()=>{let l=r.subschema({keyword:n,schemaProp:a},o);r.mergeValidEvaluated(l,o)},()=>t.var(o,!0)),r.ok(o))}rn.validateSchemaDeps=kF;rn.default=i2});var PF=ve(Lm=>{"use strict";Object.defineProperty(Lm,"__esModule",{value:!0});var SF=vt(),n2=xt(),s2={message:"property name must be valid",params:({params:r})=>(0,SF._)`{propertyName: ${r.propertyName}}`},o2={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:s2,code(r){let{gen:e,schema:t,data:i,it:n}=r;if((0,n2.alwaysValidSchema)(n,t))return;let s=e.name("valid");e.forIn("key",i,o=>{r.setParams({propertyName:o}),r.subschema({keyword:"propertyNames",data:o,dataTypes:["string"],propertyName:o,compositeRule:!0},s),e.if((0,SF.not)(s),()=>{r.error(!0),n.allErrors||e.break()})}),r.ok(s)}};Lm.default=o2});var Mm=ve(Om=>{"use strict";Object.defineProperty(Om,"__esModule",{value:!0});var Kd=br(),Lr=vt(),a2=kn(),Xd=xt(),l2={message:"must NOT have additional properties",params:({params:r})=>(0,Lr._)`{additionalProperty: ${r.additionalProperty}}`},u2={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:l2,code(r){let{gen:e,schema:t,parentSchema:i,data:n,errsCount:s,it:o}=r;if(!s)throw new Error("ajv implementation error");let{allErrors:a,opts:l}=o;if(o.props=!0,l.removeAdditional!=="all"&&(0,Xd.alwaysValidSchema)(o,t))return;let u=(0,Kd.allSchemaProperties)(i.properties),c=(0,Kd.allSchemaProperties)(i.patternProperties);d(),r.ok((0,Lr._)`${s} === ${a2.default.errors}`);function d(){e.forIn("key",n,g=>{!u.length&&!c.length?m(g):e.if(h(g),()=>m(g))})}function h(g){let b;if(u.length>8){let F=(0,Xd.schemaRefOrVal)(o,i.properties,"properties");b=(0,Kd.isOwnProperty)(e,F,g)}else u.length?b=(0,Lr.or)(...u.map(F=>(0,Lr._)`${g} === ${F}`)):b=Lr.nil;return c.length&&(b=(0,Lr.or)(b,...c.map(F=>(0,Lr._)`${(0,Kd.usePattern)(r,F)}.test(${g})`))),(0,Lr.not)(b)}function f(g){e.code((0,Lr._)`delete ${n}[${g}]`)}function m(g){if(l.removeAdditional==="all"||l.removeAdditional&&t===!1){f(g);return}if(t===!1){r.setParams({additionalProperty:g}),r.error(),a||e.break();return}if(typeof t=="object"&&!(0,Xd.alwaysValidSchema)(o,t)){let b=e.name("valid");l.removeAdditional==="failing"?(p(g,b,!1),e.if((0,Lr.not)(b),()=>{r.reset(),f(g)})):(p(g,b),a||e.if((0,Lr.not)(b),()=>e.break()))}}function p(g,b,F){let w={keyword:"additionalProperties",dataProp:g,dataPropType:Xd.Type.Str};F===!1&&Object.assign(w,{compositeRule:!0,createErrors:!1,allErrors:!1}),r.subschema(w,b)}}};Om.default=u2});var xF=ve(jm=>{"use strict";Object.defineProperty(jm,"__esModule",{value:!0});var c2=hu(),EF=br(),Nm=xt(),IF=Mm(),d2={keyword:"properties",type:"object",schemaType:"object",code(r){let{gen:e,schema:t,parentSchema:i,data:n,it:s}=r;s.opts.removeAdditional==="all"&&i.additionalProperties===void 0&&IF.default.code(new c2.KeywordCxt(s,IF.default,"additionalProperties"));let o=(0,EF.allSchemaProperties)(t);for(let d of o)s.definedProperties.add(d);s.opts.unevaluated&&o.length&&s.props!==!0&&(s.props=Nm.mergeEvaluated.props(e,(0,Nm.toHash)(o),s.props));let a=o.filter(d=>!(0,Nm.alwaysValidSchema)(s,t[d]));if(a.length===0)return;let l=e.name("valid");for(let d of a)u(d)?c(d):(e.if((0,EF.propertyInData)(e,n,d,s.opts.ownProperties)),c(d),s.allErrors||e.else().var(l,!0),e.endIf()),r.it.definedProperties.add(d),r.ok(l);function u(d){return s.opts.useDefaults&&!s.compositeRule&&t[d].default!==void 0}function c(d){r.subschema({keyword:"properties",schemaProp:d,dataProp:d},l)}}};jm.default=d2});var RF=ve(Um=>{"use strict";Object.defineProperty(Um,"__esModule",{value:!0});var TF=br(),Zd=vt(),DF=xt(),AF=xt(),f2={keyword:"patternProperties",type:"object",schemaType:"object",code(r){let{gen:e,schema:t,data:i,parentSchema:n,it:s}=r,{opts:o}=s,a=(0,TF.allSchemaProperties)(t),l=a.filter(p=>(0,DF.alwaysValidSchema)(s,t[p]));if(a.length===0||l.length===a.length&&(!s.opts.unevaluated||s.props===!0))return;let u=o.strictSchema&&!o.allowMatchingProperties&&n.properties,c=e.name("valid");s.props!==!0&&!(s.props instanceof Zd.Name)&&(s.props=(0,AF.evaluatedPropsToName)(e,s.props));let{props:d}=s;h();function h(){for(let p of a)u&&f(p),s.allErrors?m(p):(e.var(c,!0),m(p),e.if(c))}function f(p){for(let g in u)new RegExp(p).test(g)&&(0,DF.checkStrictMode)(s,`property ${g} matches pattern ${p} (use allowMatchingProperties)`)}function m(p){e.forIn("key",i,g=>{e.if((0,Zd._)`${(0,TF.usePattern)(r,p)}.test(${g})`,()=>{let b=l.includes(p);b||r.subschema({keyword:"patternProperties",schemaProp:p,dataProp:g,dataPropType:AF.Type.Str},c),s.opts.unevaluated&&d!==!0?e.assign((0,Zd._)`${d}[${g}]`,!0):!b&&!s.allErrors&&e.if((0,Zd.not)(c),()=>e.break())})})}}};Um.default=f2});var BF=ve(Gm=>{"use strict";Object.defineProperty(Gm,"__esModule",{value:!0});var h2=xt(),p2={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(r){let{gen:e,schema:t,it:i}=r;if((0,h2.alwaysValidSchema)(i,t)){r.fail();return}let n=e.name("valid");r.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},n),r.failResult(n,()=>r.reset(),()=>r.error())},error:{message:"must NOT be valid"}};Gm.default=p2});var LF=ve(zm=>{"use strict";Object.defineProperty(zm,"__esModule",{value:!0});var m2=br(),g2={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:m2.validateUnion,error:{message:"must match a schema in anyOf"}};zm.default=g2});var OF=ve(Vm=>{"use strict";Object.defineProperty(Vm,"__esModule",{value:!0});var Yd=vt(),b2=xt(),y2={message:"must match exactly one schema in oneOf",params:({params:r})=>(0,Yd._)`{passingSchemas: ${r.passing}}`},v2={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:y2,code(r){let{gen:e,schema:t,parentSchema:i,it:n}=r;if(!Array.isArray(t))throw new Error("ajv implementation error");if(n.opts.discriminator&&i.discriminator)return;let s=t,o=e.let("valid",!1),a=e.let("passing",null),l=e.name("_valid");r.setParams({passing:a}),e.block(u),r.result(o,()=>r.reset(),()=>r.error(!0));function u(){s.forEach((c,d)=>{let h;(0,b2.alwaysValidSchema)(n,c)?e.var(l,!0):h=r.subschema({keyword:"oneOf",schemaProp:d,compositeRule:!0},l),d>0&&e.if((0,Yd._)`${l} && ${o}`).assign(o,!1).assign(a,(0,Yd._)`[${a}, ${d}]`).else(),e.if(l,()=>{e.assign(o,!0),e.assign(a,d),h&&r.mergeEvaluated(h,Yd.Name)})})}}};Vm.default=v2});var MF=ve(Wm=>{"use strict";Object.defineProperty(Wm,"__esModule",{value:!0});var w2=xt(),_2={keyword:"allOf",schemaType:"array",code(r){let{gen:e,schema:t,it:i}=r;if(!Array.isArray(t))throw new Error("ajv implementation error");let n=e.name("valid");t.forEach((s,o)=>{if((0,w2.alwaysValidSchema)(i,s))return;let a=r.subschema({keyword:"allOf",schemaProp:o},n);r.ok(n),r.mergeEvaluated(a)})}};Wm.default=_2});var UF=ve(Jm=>{"use strict";Object.defineProperty(Jm,"__esModule",{value:!0});var Qd=vt(),jF=xt(),F2={message:({params:r})=>(0,Qd.str)`must match "${r.ifClause}" schema`,params:({params:r})=>(0,Qd._)`{failingKeyword: ${r.ifClause}}`},k2={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:F2,code(r){let{gen:e,parentSchema:t,it:i}=r;t.then===void 0&&t.else===void 0&&(0,jF.checkStrictMode)(i,'"if" without "then" and "else" is ignored');let n=NF(i,"then"),s=NF(i,"else");if(!n&&!s)return;let o=e.let("valid",!0),a=e.name("_valid");if(l(),r.reset(),n&&s){let c=e.let("ifClause");r.setParams({ifClause:c}),e.if(a,u("then",c),u("else",c))}else n?e.if(a,u("then")):e.if((0,Qd.not)(a),u("else"));r.pass(o,()=>r.error(!0));function l(){let c=r.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);r.mergeEvaluated(c)}function u(c,d){return()=>{let h=r.subschema({keyword:c},a);e.assign(o,a),r.mergeValidEvaluated(h,o),d?e.assign(d,(0,Qd._)`${c}`):r.setParams({ifClause:c})}}}};function NF(r,e){let t=r.schema[e];return t!==void 0&&!(0,jF.alwaysValidSchema)(r,t)}Jm.default=k2});var GF=ve($m=>{"use strict";Object.defineProperty($m,"__esModule",{value:!0});var C2=xt(),S2={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:r,parentSchema:e,it:t}){e.if===void 0&&(0,C2.checkStrictMode)(t,`"${r}" without "if" is ignored`)}};$m.default=S2});var zF=ve(Hm=>{"use strict";Object.defineProperty(Hm,"__esModule",{value:!0});var P2=xm(),E2=yF(),I2=Tm(),x2=wF(),T2=_F(),D2=CF(),A2=PF(),R2=Mm(),B2=xF(),L2=RF(),O2=BF(),M2=LF(),N2=OF(),j2=MF(),U2=UF(),G2=GF();function z2(r=!1){let e=[O2.default,M2.default,N2.default,j2.default,U2.default,G2.default,A2.default,R2.default,D2.default,B2.default,L2.default];return r?e.push(E2.default,x2.default):e.push(P2.default,I2.default),e.push(T2.default),e}Hm.default=z2});var VF=ve(qm=>{"use strict";Object.defineProperty(qm,"__esModule",{value:!0});var ii=vt(),V2={message:({schemaCode:r})=>(0,ii.str)`must match format "${r}"`,params:({schemaCode:r})=>(0,ii._)`{format: ${r}}`},W2={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:V2,code(r,e){let{gen:t,data:i,$data:n,schema:s,schemaCode:o,it:a}=r,{opts:l,errSchemaPath:u,schemaEnv:c,self:d}=a;if(!l.validateFormats)return;n?h():f();function h(){let m=t.scopeValue("formats",{ref:d.formats,code:l.code.formats}),p=t.const("fDef",(0,ii._)`${m}[${o}]`),g=t.let("fType"),b=t.let("format");t.if((0,ii._)`typeof ${p} == "object" && !(${p} instanceof RegExp)`,()=>t.assign(g,(0,ii._)`${p}.type || "string"`).assign(b,(0,ii._)`${p}.validate`),()=>t.assign(g,(0,ii._)`"string"`).assign(b,p)),r.fail$data((0,ii.or)(F(),w()));function F(){return l.strictSchema===!1?ii.nil:(0,ii._)`${o} && !${b}`}function w(){let _=c.$async?(0,ii._)`(${p}.async ? await ${b}(${i}) : ${b}(${i}))`:(0,ii._)`${b}(${i})`,I=(0,ii._)`(typeof ${b} == "function" ? ${_} : ${b}.test(${i}))`;return(0,ii._)`${b} && ${b} !== true && ${g} === ${e} && !${I}`}}function f(){let m=d.formats[s];if(!m){F();return}if(m===!0)return;let[p,g,b]=w(m);p===e&&r.pass(_());function F(){if(l.strictSchema===!1){d.logger.warn(I());return}throw new Error(I());function I(){return`unknown format "${s}" ignored in schema at path "${u}"`}}function w(I){let A=I instanceof RegExp?(0,ii.regexpCode)(I):l.code.formats?(0,ii._)`${l.code.formats}${(0,ii.getProperty)(s)}`:void 0,T=t.scopeValue("formats",{key:s,ref:I,code:A});return typeof I=="object"&&!(I instanceof RegExp)?[I.type||"string",I.validate,(0,ii._)`${T}.validate`]:["string",I,T]}function _(){if(typeof m=="object"&&!(m instanceof RegExp)&&m.async){if(!c.$async)throw new Error("async format in sync schema");return(0,ii._)`await ${b}(${i})`}return typeof g=="function"?(0,ii._)`${b}(${i})`:(0,ii._)`${b}.test(${i})`}}}};qm.default=W2});var WF=ve(Km=>{"use strict";Object.defineProperty(Km,"__esModule",{value:!0});var J2=VF(),$2=[J2.default];Km.default=$2});var JF=ve(Wo=>{"use strict";Object.defineProperty(Wo,"__esModule",{value:!0});Wo.contentVocabulary=Wo.metadataVocabulary=void 0;Wo.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];Wo.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]});var HF=ve(Xm=>{"use strict";Object.defineProperty(Xm,"__esModule",{value:!0});var H2=eF(),q2=pF(),K2=zF(),X2=WF(),$F=JF(),Z2=[H2.default,q2.default,(0,K2.default)(),X2.default,$F.metadataVocabulary,$F.contentVocabulary];Xm.default=Z2});var KF=ve(ef=>{"use strict";Object.defineProperty(ef,"__esModule",{value:!0});ef.DiscrError=void 0;var qF;(function(r){r.Tag="tag",r.Mapping="mapping"})(qF||(ef.DiscrError=qF={}))});var ZF=ve(Ym=>{"use strict";Object.defineProperty(Ym,"__esModule",{value:!0});var Jo=vt(),Zm=KF(),XF=Od(),Y2=pu(),Q2=xt(),eR={message:({params:{discrError:r,tagName:e}})=>r===Zm.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in oneOf`,params:({params:{discrError:r,tag:e,tagName:t}})=>(0,Jo._)`{error: ${r}, tag: ${t}, tagValue: ${e}}`},tR={keyword:"discriminator",type:"object",schemaType:"object",error:eR,code(r){let{gen:e,data:t,schema:i,parentSchema:n,it:s}=r,{oneOf:o}=n;if(!s.opts.discriminator)throw new Error("discriminator: requires discriminator option");let a=i.propertyName;if(typeof a!="string")throw new Error("discriminator: requires propertyName");if(i.mapping)throw new Error("discriminator: mapping is not supported");if(!o)throw new Error("discriminator: requires oneOf keyword");let l=e.let("valid",!1),u=e.const("tag",(0,Jo._)`${t}${(0,Jo.getProperty)(a)}`);e.if((0,Jo._)`typeof ${u} == "string"`,()=>c(),()=>r.error(!1,{discrError:Zm.DiscrError.Tag,tag:u,tagName:a})),r.ok(l);function c(){let f=h();e.if(!1);for(let m in f)e.elseIf((0,Jo._)`${u} === ${m}`),e.assign(l,d(f[m]));e.else(),r.error(!1,{discrError:Zm.DiscrError.Mapping,tag:u,tagName:a}),e.endIf()}function d(f){let m=e.name("valid"),p=r.subschema({keyword:"oneOf",schemaProp:f},m);return r.mergeEvaluated(p,Jo.Name),m}function h(){var f;let m={},p=b(n),g=!0;for(let _=0;_<o.length;_++){let I=o[_];if(I?.$ref&&!(0,Q2.schemaHasRulesButRef)(I,s.self.RULES)){let T=I.$ref;if(I=XF.resolveRef.call(s.self,s.schemaEnv.root,s.baseId,T),I instanceof XF.SchemaEnv&&(I=I.schema),I===void 0)throw new Y2.default(s.opts.uriResolver,s.baseId,T)}let A=(f=I?.properties)===null||f===void 0?void 0:f[a];if(typeof A!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);g=g&&(p||b(I)),F(A,_)}if(!g)throw new Error(`discriminator: "${a}" must be required`);return m;function b({required:_}){return Array.isArray(_)&&_.includes(a)}function F(_,I){if(_.const)w(_.const,I);else if(_.enum)for(let A of _.enum)w(A,I);else throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`)}function w(_,I){if(typeof _!="string"||_ in m)throw new Error(`discriminator: "${a}" values must be unique strings`);m[_]=I}}}};Ym.default=tR});var YF=ve(($q,iR)=>{iR.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var ek=ve((qt,Qm)=>{"use strict";Object.defineProperty(qt,"__esModule",{value:!0});qt.MissingRefError=qt.ValidationError=qt.CodeGen=qt.Name=qt.nil=qt.stringify=qt.str=qt._=qt.KeywordCxt=qt.Ajv=void 0;var rR=q_(),nR=HF(),sR=ZF(),QF=YF(),oR=["/properties"],tf="http://json-schema.org/draft-07/schema",$o=class extends rR.default{_addVocabularies(){super._addVocabularies(),nR.default.forEach(e=>this.addVocabulary(e)),this.opts.discriminator&&this.addKeyword(sR.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let e=this.opts.$data?this.$dataMetaSchema(QF,oR):QF;this.addMetaSchema(e,tf,!1),this.refs["http://json-schema.org/schema"]=tf}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(tf)?tf:void 0)}};qt.Ajv=$o;Qm.exports=qt=$o;Qm.exports.Ajv=$o;Object.defineProperty(qt,"__esModule",{value:!0});qt.default=$o;var aR=hu();Object.defineProperty(qt,"KeywordCxt",{enumerable:!0,get:function(){return aR.KeywordCxt}});var Ho=vt();Object.defineProperty(qt,"_",{enumerable:!0,get:function(){return Ho._}});Object.defineProperty(qt,"str",{enumerable:!0,get:function(){return Ho.str}});Object.defineProperty(qt,"stringify",{enumerable:!0,get:function(){return Ho.stringify}});Object.defineProperty(qt,"nil",{enumerable:!0,get:function(){return Ho.nil}});Object.defineProperty(qt,"Name",{enumerable:!0,get:function(){return Ho.Name}});Object.defineProperty(qt,"CodeGen",{enumerable:!0,get:function(){return Ho.CodeGen}});var lR=Bd();Object.defineProperty(qt,"ValidationError",{enumerable:!0,get:function(){return lR.default}});var uR=pu();Object.defineProperty(qt,"MissingRefError",{enumerable:!0,get:function(){return uR.default}})});var Uk=ve((qY,jk)=>{jk.exports=Nk;function Nk(r,e,t,i){if(typeof t!="function")throw new Error("method for before hook must be a function");return i||(i={}),Array.isArray(e)?e.reverse().reduce(function(n,s){return Nk.bind(null,r,s,n,i)},t)():Promise.resolve().then(function(){return r.registry[e]?r.registry[e].reduce(function(n,s){return s.hook.bind(null,n,i)},t)():t(i)})}});var zk=ve((KY,Gk)=>{Gk.exports=NR;function NR(r,e,t,i){var n=i;r.registry[t]||(r.registry[t]=[]),e==="before"&&(i=function(s,o){return Promise.resolve().then(n.bind(null,o)).then(s.bind(null,o))}),e==="after"&&(i=function(s,o){var a;return Promise.resolve().then(s.bind(null,o)).then(function(l){return a=l,n(a,o)}).then(function(){return a})}),e==="error"&&(i=function(s,o){return Promise.resolve().then(s.bind(null,o)).catch(function(a){return n(a,o)})}),r.registry[t].push({hook:i,orig:n})}});var Wk=ve((XY,Vk)=>{Vk.exports=jR;function jR(r,e,t){if(r.registry[e]){var i=r.registry[e].map(function(n){return n.orig}).indexOf(t);i!==-1&&r.registry[e].splice(i,1)}}});var Zk=ve((ZY,Qu)=>{var qk=Uk(),UR=zk(),GR=Wk(),Jk=Function.bind,$k=Jk.bind(Jk);function Kk(r,e,t){var i=$k(GR,null).apply(null,t?[e,t]:[e]);r.api={remove:i},r.remove=i,["before","error","after","wrap"].forEach(function(n){var s=t?[e,n,t]:[e,n];r[n]=r.api[n]=$k(UR,null).apply(null,s)})}function zR(){var r="h",e={registry:{}},t=qk.bind(null,e,r);return Kk(t,e,r),t}function Xk(){var r={registry:{}},e=qk.bind(null,r);return Kk(e,r),e}var Hk=!1;function ia(){return Hk||(console.warn('[before-after-hook]: "Hook()" repurposing warning, use "Hook.Collection()". Read more: https://git.io/upgrade-before-after-hook-to-1.4'),Hk=!0),Xk()}ia.Singular=zR.bind();ia.Collection=Xk.bind();Qu.exports=ia;Qu.exports.Hook=ia;Qu.exports.Singular=ia.Singular;Qu.exports.Collection=ia.Collection});var cC=ve((sa,uC)=>{"use strict";var tB=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof xn<"u")return xn;throw new Error("unable to locate global object")},xn=tB();uC.exports=sa=xn.fetch;xn.fetch&&(sa.default=xn.fetch.bind(xn));sa.Headers=xn.Headers;sa.Request=xn.Request;sa.Response=xn.Response});var hC=ve((nQ,fC)=>{fC.exports=dC;function dC(r,e){if(r&&e)return dC(r)(e);if(typeof r!="function")throw new TypeError("need wrapper function");return Object.keys(r).forEach(function(i){t[i]=r[i]}),t;function t(){for(var i=new Array(arguments.length),n=0;n<i.length;n++)i[n]=arguments[n];var s=r.apply(this,i),o=i[i.length-1];return typeof s=="function"&&s!==o&&Object.keys(o).forEach(function(a){s[a]=o[a]}),s}}});var gC=ve((sQ,Cg)=>{var pC=hC();Cg.exports=pC(kf);Cg.exports.strict=pC(mC);kf.proto=kf(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return kf(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return mC(this)},configurable:!0})});function kf(r){var e=function(){return e.called?e.value:(e.called=!0,e.value=r.apply(this,arguments))};return e.called=!1,e}function mC(r){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=r.apply(this,arguments)},t=r.name||"Function wrapped with `once`";return e.onceError=t+" shouldn't be called more than once",e.called=!1,e}});var Sf=ve((DC,Bg)=>{(function(r){if(typeof DC=="object"&&typeof Bg<"u")Bg.exports=r();else if(typeof define=="function"&&define.amd)define([],r);else{var e;typeof window<"u"?e=window:typeof global<"u"?e=global:typeof self<"u"?e=self:e=this,e.localforage=r()}})(function(){var r,e,t;return function i(n,s,o){function a(c,d){if(!s[c]){if(!n[c]){var h=typeof rr=="function"&&rr;if(!d&&h)return h(c,!0);if(l)return l(c,!0);var f=new Error("Cannot find module '"+c+"'");throw f.code="MODULE_NOT_FOUND",f}var m=s[c]={exports:{}};n[c][0].call(m.exports,function(p){var g=n[c][1][p];return a(g||p)},m,m.exports,i,n,s,o)}return s[c].exports}for(var l=typeof rr=="function"&&rr,u=0;u<o.length;u++)a(o[u]);return a}({1:[function(i,n,s){(function(o){"use strict";var a=o.MutationObserver||o.WebKitMutationObserver,l;if(a){var u=0,c=new a(p),d=o.document.createTextNode("");c.observe(d,{characterData:!0}),l=function(){d.data=u=++u%2}}else if(!o.setImmediate&&typeof o.MessageChannel<"u"){var h=new o.MessageChannel;h.port1.onmessage=p,l=function(){h.port2.postMessage(0)}}else"document"in o&&"onreadystatechange"in o.document.createElement("script")?l=function(){var b=o.document.createElement("script");b.onreadystatechange=function(){p(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},o.document.documentElement.appendChild(b)}:l=function(){setTimeout(p,0)};var f,m=[];function p(){f=!0;for(var b,F,w=m.length;w;){for(F=m,m=[],b=-1;++b<w;)F[b]();w=m.length}f=!1}n.exports=g;function g(b){m.push(b)===1&&!f&&l()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(i,n,s){"use strict";var o=i(1);function a(){}var l={},u=["REJECTED"],c=["FULFILLED"],d=["PENDING"];n.exports=h;function h(A){if(typeof A!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,A!==a&&g(this,A)}h.prototype.catch=function(A){return this.then(null,A)},h.prototype.then=function(A,T){if(typeof A!="function"&&this.state===c||typeof T!="function"&&this.state===u)return this;var E=new this.constructor(a);if(this.state!==d){var K=this.state===c?A:T;m(E,K,this.outcome)}else this.queue.push(new f(E,A,T));return E};function f(A,T,E){this.promise=A,typeof T=="function"&&(this.onFulfilled=T,this.callFulfilled=this.otherCallFulfilled),typeof E=="function"&&(this.onRejected=E,this.callRejected=this.otherCallRejected)}f.prototype.callFulfilled=function(A){l.resolve(this.promise,A)},f.prototype.otherCallFulfilled=function(A){m(this.promise,this.onFulfilled,A)},f.prototype.callRejected=function(A){l.reject(this.promise,A)},f.prototype.otherCallRejected=function(A){m(this.promise,this.onRejected,A)};function m(A,T,E){o(function(){var K;try{K=T(E)}catch(P){return l.reject(A,P)}K===A?l.reject(A,new TypeError("Cannot resolve promise with itself")):l.resolve(A,K)})}l.resolve=function(A,T){var E=b(p,T);if(E.status==="error")return l.reject(A,E.value);var K=E.value;if(K)g(A,K);else{A.state=c,A.outcome=T;for(var P=-1,G=A.queue.length;++P<G;)A.queue[P].callFulfilled(T)}return A},l.reject=function(A,T){A.state=u,A.outcome=T;for(var E=-1,K=A.queue.length;++E<K;)A.queue[E].callRejected(T);return A};function p(A){var T=A&&A.then;if(A&&(typeof A=="object"||typeof A=="function")&&typeof T=="function")return function(){T.apply(A,arguments)}}function g(A,T){var E=!1;function K(z){E||(E=!0,l.reject(A,z))}function P(z){E||(E=!0,l.resolve(A,z))}function G(){T(P,K)}var y=b(G);y.status==="error"&&K(y.value)}function b(A,T){var E={};try{E.value=A(T),E.status="success"}catch(K){E.status="error",E.value=K}return E}h.resolve=F;function F(A){return A instanceof this?A:l.resolve(new this(a),A)}h.reject=w;function w(A){var T=new this(a);return l.reject(T,A)}h.all=_;function _(A){var T=this;if(Object.prototype.toString.call(A)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=A.length,K=!1;if(!E)return this.resolve([]);for(var P=new Array(E),G=0,y=-1,z=new this(a);++y<E;)Fe(A[y],y);return z;function Fe(re,Re){T.resolve(re).then(pe,function(ze){K||(K=!0,l.reject(z,ze))});function pe(ze){P[Re]=ze,++G===E&&!K&&(K=!0,l.resolve(z,P))}}}h.race=I;function I(A){var T=this;if(Object.prototype.toString.call(A)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=A.length,K=!1;if(!E)return this.resolve([]);for(var P=-1,G=new this(a);++P<E;)y(A[P]);return G;function y(z){T.resolve(z).then(function(Fe){K||(K=!0,l.resolve(G,Fe))},function(Fe){K||(K=!0,l.reject(G,Fe))})}}},{1:1}],3:[function(i,n,s){(function(o){"use strict";typeof o.Promise!="function"&&(o.Promise=i(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(i,n,s){"use strict";var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k};function a(k,M){if(!(k instanceof M))throw new TypeError("Cannot call a class as a function")}function l(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var u=l();function c(){try{if(!u||!u.open)return!1;var k=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),M=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!k||M)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function d(k,M){k=k||[],M=M||{};try{return new Blob(k,M)}catch(W){if(W.name!=="TypeError")throw W;for(var x=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,L=new x,J=0;J<k.length;J+=1)L.append(k[J]);return L.getBlob(M.type)}}typeof Promise>"u"&&i(3);var h=Promise;function f(k,M){M&&k.then(function(x){M(null,x)},function(x){M(x)})}function m(k,M,x){typeof M=="function"&&k.then(M),typeof x=="function"&&k.catch(x)}function p(k){return typeof k!="string"&&(console.warn(k+" used as a key, but it is not a string."),k=String(k)),k}function g(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var b="local-forage-detect-blob-support",F=void 0,w={},_=Object.prototype.toString,I="readonly",A="readwrite";function T(k){for(var M=k.length,x=new ArrayBuffer(M),L=new Uint8Array(x),J=0;J<M;J++)L[J]=k.charCodeAt(J);return x}function E(k){return new h(function(M){var x=k.transaction(b,A),L=d([""]);x.objectStore(b).put(L,"key"),x.onabort=function(J){J.preventDefault(),J.stopPropagation(),M(!1)},x.oncomplete=function(){var J=navigator.userAgent.match(/Chrome\/(\d+)/),W=navigator.userAgent.match(/Edge\//);M(W||!J||parseInt(J[1],10)>=43)}}).catch(function(){return!1})}function K(k){return typeof F=="boolean"?h.resolve(F):E(k).then(function(M){return F=M,F})}function P(k){var M=w[k.name],x={};x.promise=new h(function(L,J){x.resolve=L,x.reject=J}),M.deferredOperations.push(x),M.dbReady?M.dbReady=M.dbReady.then(function(){return x.promise}):M.dbReady=x.promise}function G(k){var M=w[k.name],x=M.deferredOperations.pop();if(x)return x.resolve(),x.promise}function y(k,M){var x=w[k.name],L=x.deferredOperations.pop();if(L)return L.reject(M),L.promise}function z(k,M){return new h(function(x,L){if(w[k.name]=w[k.name]||me(),k.db)if(M)P(k),k.db.close();else return x(k.db);var J=[k.name];M&&J.push(k.version);var W=u.open.apply(u,J);M&&(W.onupgradeneeded=function(se){var fe=W.result;try{fe.createObjectStore(k.storeName),se.oldVersion<=1&&fe.createObjectStore(b)}catch(ye){if(ye.name==="ConstraintError")console.warn('The database "'+k.name+'" has been upgraded from version '+se.oldVersion+" to version "+se.newVersion+', but the storage "'+k.storeName+'" already exists.');else throw ye}}),W.onerror=function(se){se.preventDefault(),L(W.error)},W.onsuccess=function(){x(W.result),G(k)}})}function Fe(k){return z(k,!1)}function re(k){return z(k,!0)}function Re(k,M){if(!k.db)return!0;var x=!k.db.objectStoreNames.contains(k.storeName),L=k.version<k.db.version,J=k.version>k.db.version;if(L&&(k.version!==M&&console.warn('The database "'+k.name+`" can't be downgraded from version `+k.db.version+" to version "+k.version+"."),k.version=k.db.version),J||x){if(x){var W=k.db.version+1;W>k.version&&(k.version=W)}return!0}return!1}function pe(k){return new h(function(M,x){var L=new FileReader;L.onerror=x,L.onloadend=function(J){var W=btoa(J.target.result||"");M({__local_forage_encoded_blob:!0,data:W,type:k.type})},L.readAsBinaryString(k)})}function ze(k){var M=T(atob(k.data));return d([M],{type:k.type})}function ee(k){return k&&k.__local_forage_encoded_blob}function Y(k){var M=this,x=M._initReady().then(function(){var L=w[M._dbInfo.name];if(L&&L.dbReady)return L.dbReady});return m(x,k,k),x}function Ve(k){P(k);for(var M=w[k.name],x=M.forages,L=0;L<x.length;L++){var J=x[L];J._dbInfo.db&&(J._dbInfo.db.close(),J._dbInfo.db=null)}return k.db=null,Fe(k).then(function(W){return k.db=W,Re(k)?re(k):W}).then(function(W){k.db=M.db=W;for(var se=0;se<x.length;se++)x[se]._dbInfo.db=W}).catch(function(W){throw y(k,W),W})}function U(k,M,x,L){L===void 0&&(L=1);try{var J=k.db.transaction(k.storeName,M);x(null,J)}catch(W){if(L>0&&(!k.db||W.name==="InvalidStateError"||W.name==="NotFoundError"))return h.resolve().then(function(){if(!k.db||W.name==="NotFoundError"&&!k.db.objectStoreNames.contains(k.storeName)&&k.version<=k.db.version)return k.db&&(k.version=k.db.version+1),re(k)}).then(function(){return Ve(k).then(function(){U(k,M,x,L-1)})}).catch(x);x(W)}}function me(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Jt(k){var M=this,x={db:null};if(k)for(var L in k)x[L]=k[L];var J=w[x.name];J||(J=me(),w[x.name]=J),J.forages.push(M),M._initReady||(M._initReady=M.ready,M.ready=Y);var W=[];function se(){return h.resolve()}for(var fe=0;fe<J.forages.length;fe++){var ye=J.forages[fe];ye!==M&&W.push(ye._initReady().catch(se))}var _e=J.forages.slice(0);return h.all(W).then(function(){return x.db=J.db,Fe(x)}).then(function(Se){return x.db=Se,Re(x,M._defaultConfig.version)?re(x):Se}).then(function(Se){x.db=J.db=Se,M._dbInfo=x;for(var Ge=0;Ge<_e.length;Ge++){var bt=_e[Ge];bt!==M&&(bt._dbInfo.db=x.db,bt._dbInfo.version=x.version)}})}function Qt(k,M){var x=this;k=p(k);var L=new h(function(J,W){x.ready().then(function(){U(x._dbInfo,I,function(se,fe){if(se)return W(se);try{var ye=fe.objectStore(x._dbInfo.storeName),_e=ye.get(k);_e.onsuccess=function(){var Se=_e.result;Se===void 0&&(Se=null),ee(Se)&&(Se=ze(Se)),J(Se)},_e.onerror=function(){W(_e.error)}}catch(Se){W(Se)}})}).catch(W)});return f(L,M),L}function ut(k,M){var x=this,L=new h(function(J,W){x.ready().then(function(){U(x._dbInfo,I,function(se,fe){if(se)return W(se);try{var ye=fe.objectStore(x._dbInfo.storeName),_e=ye.openCursor(),Se=1;_e.onsuccess=function(){var Ge=_e.result;if(Ge){var bt=Ge.value;ee(bt)&&(bt=ze(bt));var Bt=k(bt,Ge.key,Se++);Bt!==void 0?J(Bt):Ge.continue()}else J()},_e.onerror=function(){W(_e.error)}}catch(Ge){W(Ge)}})}).catch(W)});return f(L,M),L}function Ze(k,M,x){var L=this;k=p(k);var J=new h(function(W,se){var fe;L.ready().then(function(){return fe=L._dbInfo,_.call(M)==="[object Blob]"?K(fe.db).then(function(ye){return ye?M:pe(M)}):M}).then(function(ye){U(L._dbInfo,A,function(_e,Se){if(_e)return se(_e);try{var Ge=Se.objectStore(L._dbInfo.storeName);ye===null&&(ye=void 0);var bt=Ge.put(ye,k);Se.oncomplete=function(){ye===void 0&&(ye=null),W(ye)},Se.onabort=Se.onerror=function(){var Bt=bt.error?bt.error:bt.transaction.error;se(Bt)}}catch(Bt){se(Bt)}})}).catch(se)});return f(J,x),J}function Xt(k,M){var x=this;k=p(k);var L=new h(function(J,W){x.ready().then(function(){U(x._dbInfo,A,function(se,fe){if(se)return W(se);try{var ye=fe.objectStore(x._dbInfo.storeName),_e=ye.delete(k);fe.oncomplete=function(){J()},fe.onerror=function(){W(_e.error)},fe.onabort=function(){var Se=_e.error?_e.error:_e.transaction.error;W(Se)}}catch(Se){W(Se)}})}).catch(W)});return f(L,M),L}function $t(k){var M=this,x=new h(function(L,J){M.ready().then(function(){U(M._dbInfo,A,function(W,se){if(W)return J(W);try{var fe=se.objectStore(M._dbInfo.storeName),ye=fe.clear();se.oncomplete=function(){L()},se.onabort=se.onerror=function(){var _e=ye.error?ye.error:ye.transaction.error;J(_e)}}catch(_e){J(_e)}})}).catch(J)});return f(x,k),x}function Hi(k){var M=this,x=new h(function(L,J){M.ready().then(function(){U(M._dbInfo,I,function(W,se){if(W)return J(W);try{var fe=se.objectStore(M._dbInfo.storeName),ye=fe.count();ye.onsuccess=function(){L(ye.result)},ye.onerror=function(){J(ye.error)}}catch(_e){J(_e)}})}).catch(J)});return f(x,k),x}function Bi(k,M){var x=this,L=new h(function(J,W){if(k<0){J(null);return}x.ready().then(function(){U(x._dbInfo,I,function(se,fe){if(se)return W(se);try{var ye=fe.objectStore(x._dbInfo.storeName),_e=!1,Se=ye.openKeyCursor();Se.onsuccess=function(){var Ge=Se.result;if(!Ge){J(null);return}k===0||_e?J(Ge.key):(_e=!0,Ge.advance(k))},Se.onerror=function(){W(Se.error)}}catch(Ge){W(Ge)}})}).catch(W)});return f(L,M),L}function v(k){var M=this,x=new h(function(L,J){M.ready().then(function(){U(M._dbInfo,I,function(W,se){if(W)return J(W);try{var fe=se.objectStore(M._dbInfo.storeName),ye=fe.openKeyCursor(),_e=[];ye.onsuccess=function(){var Se=ye.result;if(!Se){L(_e);return}_e.push(Se.key),Se.continue()},ye.onerror=function(){J(ye.error)}}catch(Se){J(Se)}})}).catch(J)});return f(x,k),x}function ae(k,M){M=g.apply(this,arguments);var x=this.config();k=typeof k!="function"&&k||{},k.name||(k.name=k.name||x.name,k.storeName=k.storeName||x.storeName);var L=this,J;if(!k.name)J=h.reject("Invalid arguments");else{var W=k.name===x.name&&L._dbInfo.db,se=W?h.resolve(L._dbInfo.db):Fe(k).then(function(fe){var ye=w[k.name],_e=ye.forages;ye.db=fe;for(var Se=0;Se<_e.length;Se++)_e[Se]._dbInfo.db=fe;return fe});k.storeName?J=se.then(function(fe){if(fe.objectStoreNames.contains(k.storeName)){var ye=fe.version+1;P(k);var _e=w[k.name],Se=_e.forages;fe.close();for(var Ge=0;Ge<Se.length;Ge++){var bt=Se[Ge];bt._dbInfo.db=null,bt._dbInfo.version=ye}var Bt=new h(function(Mt,pi){var si=u.open(k.name,ye);si.onerror=function(Mi){var ua=si.result;ua.close(),pi(Mi)},si.onupgradeneeded=function(){var Mi=si.result;Mi.deleteObjectStore(k.storeName)},si.onsuccess=function(){var Mi=si.result;Mi.close(),Mt(Mi)}});return Bt.then(function(Mt){_e.db=Mt;for(var pi=0;pi<Se.length;pi++){var si=Se[pi];si._dbInfo.db=Mt,G(si._dbInfo)}}).catch(function(Mt){throw(y(k,Mt)||h.resolve()).catch(function(){}),Mt})}}):J=se.then(function(fe){P(k);var ye=w[k.name],_e=ye.forages;fe.close();for(var Se=0;Se<_e.length;Se++){var Ge=_e[Se];Ge._dbInfo.db=null}var bt=new h(function(Bt,Mt){var pi=u.deleteDatabase(k.name);pi.onerror=pi.onblocked=function(si){var Mi=pi.result;Mi&&Mi.close(),Mt(si)},pi.onsuccess=function(){var si=pi.result;si&&si.close(),Bt(si)}});return bt.then(function(Bt){ye.db=Bt;for(var Mt=0;Mt<_e.length;Mt++){var pi=_e[Mt];G(pi._dbInfo)}}).catch(function(Bt){throw(y(k,Bt)||h.resolve()).catch(function(){}),Bt})})}return f(J,M),J}var ie={_driver:"asyncStorage",_initStorage:Jt,_support:c(),iterate:ut,getItem:Qt,setItem:Ze,removeItem:Xt,clear:$t,length:Hi,key:Bi,keys:v,dropInstance:ae};function O(){return typeof openDatabase=="function"}var D="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$="~~local_forage_type~",ue=/^~~local_forage_type~([^~]+)~/,ce="__lfsc__:",X=ce.length,ge="arbf",Ae="blob",Ce="si08",He="ui08",Dt="uic8",ft="si16",Fi="si32",Mr="ur16",Li="ui32",Nr="fl32",Gt="fl64",ln=X+ge.length,Dn=Object.prototype.toString;function qi(k){var M=k.length*.75,x=k.length,L,J=0,W,se,fe,ye;k[k.length-1]==="="&&(M--,k[k.length-2]==="="&&M--);var _e=new ArrayBuffer(M),Se=new Uint8Array(_e);for(L=0;L<x;L+=4)W=D.indexOf(k[L]),se=D.indexOf(k[L+1]),fe=D.indexOf(k[L+2]),ye=D.indexOf(k[L+3]),Se[J++]=W<<2|se>>4,Se[J++]=(se&15)<<4|fe>>2,Se[J++]=(fe&3)<<6|ye&63;return _e}function An(k){var M=new Uint8Array(k),x="",L;for(L=0;L<M.length;L+=3)x+=D[M[L]>>2],x+=D[(M[L]&3)<<4|M[L+1]>>4],x+=D[(M[L+1]&15)<<2|M[L+2]>>6],x+=D[M[L+2]&63];return M.length%3===2?x=x.substring(0,x.length-1)+"=":M.length%3===1&&(x=x.substring(0,x.length-2)+"=="),x}function _r(k,M){var x="";if(k&&(x=Dn.call(k)),k&&(x==="[object ArrayBuffer]"||k.buffer&&Dn.call(k.buffer)==="[object ArrayBuffer]")){var L,J=ce;k instanceof ArrayBuffer?(L=k,J+=ge):(L=k.buffer,x==="[object Int8Array]"?J+=Ce:x==="[object Uint8Array]"?J+=He:x==="[object Uint8ClampedArray]"?J+=Dt:x==="[object Int16Array]"?J+=ft:x==="[object Uint16Array]"?J+=Mr:x==="[object Int32Array]"?J+=Fi:x==="[object Uint32Array]"?J+=Li:x==="[object Float32Array]"?J+=Nr:x==="[object Float64Array]"?J+=Gt:M(new Error("Failed to get type for BinaryArray"))),M(J+An(L))}else if(x==="[object Blob]"){var W=new FileReader;W.onload=function(){var se=$+k.type+"~"+An(this.result);M(ce+Ae+se)},W.readAsArrayBuffer(k)}else try{M(JSON.stringify(k))}catch(se){console.error("Couldn't convert value into a JSON string: ",k),M(null,se)}}function Rn(k){if(k.substring(0,X)!==ce)return JSON.parse(k);var M=k.substring(ln),x=k.substring(X,ln),L;if(x===Ae&&ue.test(M)){var J=M.match(ue);L=J[1],M=M.substring(J[0].length)}var W=qi(M);switch(x){case ge:return W;case Ae:return d([W],{type:L});case Ce:return new Int8Array(W);case He:return new Uint8Array(W);case Dt:return new Uint8ClampedArray(W);case ft:return new Int16Array(W);case Mr:return new Uint16Array(W);case Fi:return new Int32Array(W);case Li:return new Uint32Array(W);case Nr:return new Float32Array(W);case Gt:return new Float64Array(W);default:throw new Error("Unkown type: "+x)}}var jr={serialize:_r,deserialize:Rn,stringToBuffer:qi,bufferToString:An};function Fr(k,M,x,L){k.executeSql("CREATE TABLE IF NOT EXISTS "+M.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],x,L)}function un(k){var M=this,x={db:null};if(k)for(var L in k)x[L]=typeof k[L]!="string"?k[L].toString():k[L];var J=new h(function(W,se){try{x.db=openDatabase(x.name,String(x.version),x.description,x.size)}catch(fe){return se(fe)}x.db.transaction(function(fe){Fr(fe,x,function(){M._dbInfo=x,W()},function(ye,_e){se(_e)})},se)});return x.serializer=jr,J}function Oi(k,M,x,L,J,W){k.executeSql(x,L,J,function(se,fe){fe.code===fe.SYNTAX_ERR?se.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[M.storeName],function(ye,_e){_e.rows.length?W(ye,fe):Fr(ye,M,function(){ye.executeSql(x,L,J,W)},W)},W):W(se,fe)},W)}function Pf(k,M){var x=this;k=p(k);var L=new h(function(J,W){x.ready().then(function(){var se=x._dbInfo;se.db.transaction(function(fe){Oi(fe,se,"SELECT * FROM "+se.storeName+" WHERE key = ? LIMIT 1",[k],function(ye,_e){var Se=_e.rows.length?_e.rows.item(0).value:null;Se&&(Se=se.serializer.deserialize(Se)),J(Se)},function(ye,_e){W(_e)})})}).catch(W)});return f(L,M),L}function N(k,M){var x=this,L=new h(function(J,W){x.ready().then(function(){var se=x._dbInfo;se.db.transaction(function(fe){Oi(fe,se,"SELECT * FROM "+se.storeName,[],function(ye,_e){for(var Se=_e.rows,Ge=Se.length,bt=0;bt<Ge;bt++){var Bt=Se.item(bt),Mt=Bt.value;if(Mt&&(Mt=se.serializer.deserialize(Mt)),Mt=k(Mt,Bt.key,bt+1),Mt!==void 0){J(Mt);return}}J()},function(ye,_e){W(_e)})})}).catch(W)});return f(L,M),L}function V(k,M,x,L){var J=this;k=p(k);var W=new h(function(se,fe){J.ready().then(function(){M===void 0&&(M=null);var ye=M,_e=J._dbInfo;_e.serializer.serialize(M,function(Se,Ge){Ge?fe(Ge):_e.db.transaction(function(bt){Oi(bt,_e,"INSERT OR REPLACE INTO "+_e.storeName+" (key, value) VALUES (?, ?)",[k,Se],function(){se(ye)},function(Bt,Mt){fe(Mt)})},function(bt){if(bt.code===bt.QUOTA_ERR){if(L>0){se(V.apply(J,[k,ye,x,L-1]));return}fe(bt)}})})}).catch(fe)});return f(W,x),W}function H(k,M,x){return V.apply(this,[k,M,x,1])}function de(k,M){var x=this;k=p(k);var L=new h(function(J,W){x.ready().then(function(){var se=x._dbInfo;se.db.transaction(function(fe){Oi(fe,se,"DELETE FROM "+se.storeName+" WHERE key = ?",[k],function(){J()},function(ye,_e){W(_e)})})}).catch(W)});return f(L,M),L}function ke(k){var M=this,x=new h(function(L,J){M.ready().then(function(){var W=M._dbInfo;W.db.transaction(function(se){Oi(se,W,"DELETE FROM "+W.storeName,[],function(){L()},function(fe,ye){J(ye)})})}).catch(J)});return f(x,k),x}function Te(k){var M=this,x=new h(function(L,J){M.ready().then(function(){var W=M._dbInfo;W.db.transaction(function(se){Oi(se,W,"SELECT COUNT(key) as c FROM "+W.storeName,[],function(fe,ye){var _e=ye.rows.item(0).c;L(_e)},function(fe,ye){J(ye)})})}).catch(J)});return f(x,k),x}function we(k,M){var x=this,L=new h(function(J,W){x.ready().then(function(){var se=x._dbInfo;se.db.transaction(function(fe){Oi(fe,se,"SELECT key FROM "+se.storeName+" WHERE id = ? LIMIT 1",[k+1],function(ye,_e){var Se=_e.rows.length?_e.rows.item(0).key:null;J(Se)},function(ye,_e){W(_e)})})}).catch(W)});return f(L,M),L}function Me(k){var M=this,x=new h(function(L,J){M.ready().then(function(){var W=M._dbInfo;W.db.transaction(function(se){Oi(se,W,"SELECT key FROM "+W.storeName,[],function(fe,ye){for(var _e=[],Se=0;Se<ye.rows.length;Se++)_e.push(ye.rows.item(Se).key);L(_e)},function(fe,ye){J(ye)})})}).catch(J)});return f(x,k),x}function he(k){return new h(function(M,x){k.transaction(function(L){L.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(J,W){for(var se=[],fe=0;fe<W.rows.length;fe++)se.push(W.rows.item(fe).name);M({db:k,storeNames:se})},function(J,W){x(W)})},function(L){x(L)})})}function We(k,M){M=g.apply(this,arguments);var x=this.config();k=typeof k!="function"&&k||{},k.name||(k.name=k.name||x.name,k.storeName=k.storeName||x.storeName);var L=this,J;return k.name?J=new h(function(W){var se;k.name===x.name?se=L._dbInfo.db:se=openDatabase(k.name,"","",0),k.storeName?W({db:se,storeNames:[k.storeName]}):W(he(se))}).then(function(W){return new h(function(se,fe){W.db.transaction(function(ye){function _e(Bt){return new h(function(Mt,pi){ye.executeSql("DROP TABLE IF EXISTS "+Bt,[],function(){Mt()},function(si,Mi){pi(Mi)})})}for(var Se=[],Ge=0,bt=W.storeNames.length;Ge<bt;Ge++)Se.push(_e(W.storeNames[Ge]));h.all(Se).then(function(){se()}).catch(function(Bt){fe(Bt)})},function(ye){fe(ye)})})}):J=h.reject("Invalid arguments"),f(J,M),J}var Xe={_driver:"webSQLStorage",_initStorage:un,_support:O(),iterate:N,getItem:Pf,setItem:H,removeItem:de,clear:ke,length:Te,key:we,keys:Me,dropInstance:We};function et(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function Pt(k,M){var x=k.name+"/";return k.storeName!==M.storeName&&(x+=k.storeName+"/"),x}function dt(){var k="_localforage_support_test";try{return localStorage.setItem(k,!0),localStorage.removeItem(k),!1}catch{return!0}}function st(){return!dt()||localStorage.length>0}function ni(k){var M=this,x={};if(k)for(var L in k)x[L]=k[L];return x.keyPrefix=Pt(k,M._defaultConfig),st()?(M._dbInfo=x,x.serializer=jr,h.resolve()):h.reject()}function Ie(k){var M=this,x=M.ready().then(function(){for(var L=M._dbInfo.keyPrefix,J=localStorage.length-1;J>=0;J--){var W=localStorage.key(J);W.indexOf(L)===0&&localStorage.removeItem(W)}});return f(x,k),x}function pt(k,M){var x=this;k=p(k);var L=x.ready().then(function(){var J=x._dbInfo,W=localStorage.getItem(J.keyPrefix+k);return W&&(W=J.serializer.deserialize(W)),W});return f(L,M),L}function mt(k,M){var x=this,L=x.ready().then(function(){for(var J=x._dbInfo,W=J.keyPrefix,se=W.length,fe=localStorage.length,ye=1,_e=0;_e<fe;_e++){var Se=localStorage.key(_e);if(Se.indexOf(W)===0){var Ge=localStorage.getItem(Se);if(Ge&&(Ge=J.serializer.deserialize(Ge)),Ge=k(Ge,Se.substring(se),ye++),Ge!==void 0)return Ge}}});return f(L,M),L}function Ee(k,M){var x=this,L=x.ready().then(function(){var J=x._dbInfo,W;try{W=localStorage.key(k)}catch{W=null}return W&&(W=W.substring(J.keyPrefix.length)),W});return f(L,M),L}function ne(k){var M=this,x=M.ready().then(function(){for(var L=M._dbInfo,J=localStorage.length,W=[],se=0;se<J;se++){var fe=localStorage.key(se);fe.indexOf(L.keyPrefix)===0&&W.push(fe.substring(L.keyPrefix.length))}return W});return f(x,k),x}function Q(k){var M=this,x=M.keys().then(function(L){return L.length});return f(x,k),x}function te(k,M){var x=this;k=p(k);var L=x.ready().then(function(){var J=x._dbInfo;localStorage.removeItem(J.keyPrefix+k)});return f(L,M),L}function Pe(k,M,x){var L=this;k=p(k);var J=L.ready().then(function(){M===void 0&&(M=null);var W=M;return new h(function(se,fe){var ye=L._dbInfo;ye.serializer.serialize(M,function(_e,Se){if(Se)fe(Se);else try{localStorage.setItem(ye.keyPrefix+k,_e),se(W)}catch(Ge){(Ge.name==="QuotaExceededError"||Ge.name==="NS_ERROR_DOM_QUOTA_REACHED")&&fe(Ge),fe(Ge)}})})});return f(J,x),J}function xe(k,M){if(M=g.apply(this,arguments),k=typeof k!="function"&&k||{},!k.name){var x=this.config();k.name=k.name||x.name,k.storeName=k.storeName||x.storeName}var L=this,J;return k.name?J=new h(function(W){k.storeName?W(Pt(k,L._defaultConfig)):W(k.name+"/")}).then(function(W){for(var se=localStorage.length-1;se>=0;se--){var fe=localStorage.key(se);fe.indexOf(W)===0&&localStorage.removeItem(fe)}}):J=h.reject("Invalid arguments"),f(J,M),J}var je={_driver:"localStorageWrapper",_initStorage:ni,_support:et(),iterate:mt,getItem:pt,setItem:Pe,removeItem:te,clear:Ie,length:Q,key:Ee,keys:ne,dropInstance:xe},Ke=function(M,x){return M===x||typeof M=="number"&&typeof x=="number"&&isNaN(M)&&isNaN(x)},R=function(M,x){for(var L=M.length,J=0;J<L;){if(Ke(M[J],x))return!0;J++}return!1},q=Array.isArray||function(k){return Object.prototype.toString.call(k)==="[object Array]"},be={},De={},Ue={INDEXEDDB:ie,WEBSQL:Xe,LOCALSTORAGE:je},ot=[Ue.INDEXEDDB._driver,Ue.WEBSQL._driver,Ue.LOCALSTORAGE._driver],Ye=["dropInstance"],at=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Ye),tt={description:"",driver:ot.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Qe(k,M){k[M]=function(){var x=arguments;return k.ready().then(function(){return k[M].apply(k,x)})}}function Ft(){for(var k=1;k<arguments.length;k++){var M=arguments[k];if(M)for(var x in M)M.hasOwnProperty(x)&&(q(M[x])?arguments[0][x]=M[x].slice():arguments[0][x]=M[x])}return arguments[0]}var gt=function(){function k(M){a(this,k);for(var x in Ue)if(Ue.hasOwnProperty(x)){var L=Ue[x],J=L._driver;this[x]=J,be[J]||this.defineDriver(L)}this._defaultConfig=Ft({},tt),this._config=Ft({},this._defaultConfig,M),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return k.prototype.config=function(x){if((typeof x>"u"?"undefined":o(x))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var L in x){if(L==="storeName"&&(x[L]=x[L].replace(/\W/g,"_")),L==="version"&&typeof x[L]!="number")return new Error("Database version must be a number.");this._config[L]=x[L]}return"driver"in x&&x.driver?this.setDriver(this._config.driver):!0}else return typeof x=="string"?this._config[x]:this._config},k.prototype.defineDriver=function(x,L,J){var W=new h(function(se,fe){try{var ye=x._driver,_e=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!x._driver){fe(_e);return}for(var Se=at.concat("_initStorage"),Ge=0,bt=Se.length;Ge<bt;Ge++){var Bt=Se[Ge],Mt=!R(Ye,Bt);if((Mt||x[Bt])&&typeof x[Bt]!="function"){fe(_e);return}}var pi=function(){for(var ua=function(LC){return function(){var OC=new Error("Method "+LC+" is not implemented by the current driver"),Og=h.reject(OC);return f(Og,arguments[arguments.length-1]),Og}},Ef=0,BC=Ye.length;Ef<BC;Ef++){var If=Ye[Ef];x[If]||(x[If]=ua(If))}};pi();var si=function(ua){be[ye]&&console.info("Redefining LocalForage driver: "+ye),be[ye]=x,De[ye]=ua,se()};"_support"in x?x._support&&typeof x._support=="function"?x._support().then(si,fe):si(!!x._support):si(!0)}catch(Mi){fe(Mi)}});return m(W,L,J),W},k.prototype.driver=function(){return this._driver||null},k.prototype.getDriver=function(x,L,J){var W=be[x]?h.resolve(be[x]):h.reject(new Error("Driver not found."));return m(W,L,J),W},k.prototype.getSerializer=function(x){var L=h.resolve(jr);return m(L,x),L},k.prototype.ready=function(x){var L=this,J=L._driverSet.then(function(){return L._ready===null&&(L._ready=L._initDriver()),L._ready});return m(J,x,x),J},k.prototype.setDriver=function(x,L,J){var W=this;q(x)||(x=[x]);var se=this._getSupportedDrivers(x);function fe(){W._config.driver=W.driver()}function ye(Ge){return W._extend(Ge),fe(),W._ready=W._initStorage(W._config),W._ready}function _e(Ge){return function(){var bt=0;function Bt(){for(;bt<Ge.length;){var Mt=Ge[bt];return bt++,W._dbInfo=null,W._ready=null,W.getDriver(Mt).then(ye).catch(Bt)}fe();var pi=new Error("No available storage method found.");return W._driverSet=h.reject(pi),W._driverSet}return Bt()}}var Se=this._driverSet!==null?this._driverSet.catch(function(){return h.resolve()}):h.resolve();return this._driverSet=Se.then(function(){var Ge=se[0];return W._dbInfo=null,W._ready=null,W.getDriver(Ge).then(function(bt){W._driver=bt._driver,fe(),W._wrapLibraryMethodsWithReady(),W._initDriver=_e(se)})}).catch(function(){fe();var Ge=new Error("No available storage method found.");return W._driverSet=h.reject(Ge),W._driverSet}),m(this._driverSet,L,J),this._driverSet},k.prototype.supports=function(x){return!!De[x]},k.prototype._extend=function(x){Ft(this,x)},k.prototype._getSupportedDrivers=function(x){for(var L=[],J=0,W=x.length;J<W;J++){var se=x[J];this.supports(se)&&L.push(se)}return L},k.prototype._wrapLibraryMethodsWithReady=function(){for(var x=0,L=at.length;x<L;x++)Qe(this,at[x])},k.prototype.createInstance=function(x){return new k(x)},k}(),_t=new gt;n.exports=_t},{3:3}]},{},[4])(4)})});function ho(r){let e=r.length;for(;--e>=0;)r[e]=0}var WC=0,_b=1,JC=2,$C=3,HC=258,qf=29,Ca=256,ga=Ca+1+qf,fo=30,Kf=19,Fb=2*ga+1,hs=15,Tf=16,qC=7,Xf=256,kb=16,Cb=17,Sb=18,Wf=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),_c=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),KC=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Pb=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),XC=512,dn=new Array((ga+2)*2);ho(dn);var ha=new Array(fo*2);ho(ha);var ba=new Array(XC);ho(ba);var ya=new Array(HC-$C+1);ho(ya);var Zf=new Array(qf);ho(Zf);var Sc=new Array(fo);ho(Sc);function Df(r,e,t,i,n){this.static_tree=r,this.extra_bits=e,this.extra_base=t,this.elems=i,this.max_length=n,this.has_stree=r&&r.length}var Eb,Ib,xb;function Af(r,e){this.dyn_tree=r,this.max_code=0,this.stat_desc=e}var Tb=r=>r<256?ba[r]:ba[256+(r>>>7)],va=(r,e)=>{r.pending_buf[r.pending++]=e&255,r.pending_buf[r.pending++]=e>>>8&255},Ki=(r,e,t)=>{r.bi_valid>Tf-t?(r.bi_buf|=e<<r.bi_valid&65535,va(r,r.bi_buf),r.bi_buf=e>>Tf-r.bi_valid,r.bi_valid+=t-Tf):(r.bi_buf|=e<<r.bi_valid&65535,r.bi_valid+=t)},Gr=(r,e,t)=>{Ki(r,t[e*2],t[e*2+1])},Db=(r,e)=>{let t=0;do t|=r&1,r>>>=1,t<<=1;while(--e>0);return t>>>1},ZC=r=>{r.bi_valid===16?(va(r,r.bi_buf),r.bi_buf=0,r.bi_valid=0):r.bi_valid>=8&&(r.pending_buf[r.pending++]=r.bi_buf&255,r.bi_buf>>=8,r.bi_valid-=8)},YC=(r,e)=>{let t=e.dyn_tree,i=e.max_code,n=e.stat_desc.static_tree,s=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,l=e.stat_desc.max_length,u,c,d,h,f,m,p=0;for(h=0;h<=hs;h++)r.bl_count[h]=0;for(t[r.heap[r.heap_max]*2+1]=0,u=r.heap_max+1;u<Fb;u++)c=r.heap[u],h=t[t[c*2+1]*2+1]+1,h>l&&(h=l,p++),t[c*2+1]=h,!(c>i)&&(r.bl_count[h]++,f=0,c>=a&&(f=o[c-a]),m=t[c*2],r.opt_len+=m*(h+f),s&&(r.static_len+=m*(n[c*2+1]+f)));if(p!==0){do{for(h=l-1;r.bl_count[h]===0;)h--;r.bl_count[h]--,r.bl_count[h+1]+=2,r.bl_count[l]--,p-=2}while(p>0);for(h=l;h!==0;h--)for(c=r.bl_count[h];c!==0;)d=r.heap[--u],!(d>i)&&(t[d*2+1]!==h&&(r.opt_len+=(h-t[d*2+1])*t[d*2],t[d*2+1]=h),c--)}},Ab=(r,e,t)=>{let i=new Array(hs+1),n=0,s,o;for(s=1;s<=hs;s++)i[s]=n=n+t[s-1]<<1;for(o=0;o<=e;o++){let a=r[o*2+1];a!==0&&(r[o*2]=Db(i[a]++,a))}},QC=()=>{let r,e,t,i,n,s=new Array(hs+1);for(t=0,i=0;i<qf-1;i++)for(Zf[i]=t,r=0;r<1<<Wf[i];r++)ya[t++]=i;for(ya[t-1]=i,n=0,i=0;i<16;i++)for(Sc[i]=n,r=0;r<1<<_c[i];r++)ba[n++]=i;for(n>>=7;i<fo;i++)for(Sc[i]=n<<7,r=0;r<1<<_c[i]-7;r++)ba[256+n++]=i;for(e=0;e<=hs;e++)s[e]=0;for(r=0;r<=143;)dn[r*2+1]=8,r++,s[8]++;for(;r<=255;)dn[r*2+1]=9,r++,s[9]++;for(;r<=279;)dn[r*2+1]=7,r++,s[7]++;for(;r<=287;)dn[r*2+1]=8,r++,s[8]++;for(Ab(dn,ga+1,s),r=0;r<fo;r++)ha[r*2+1]=5,ha[r*2]=Db(r,5);Eb=new Df(dn,Wf,Ca+1,ga,hs),Ib=new Df(ha,_c,0,fo,hs),xb=new Df(new Array(0),KC,0,Kf,qC)},Rb=r=>{let e;for(e=0;e<ga;e++)r.dyn_ltree[e*2]=0;for(e=0;e<fo;e++)r.dyn_dtree[e*2]=0;for(e=0;e<Kf;e++)r.bl_tree[e*2]=0;r.dyn_ltree[Xf*2]=1,r.opt_len=r.static_len=0,r.last_lit=r.matches=0},Bb=r=>{r.bi_valid>8?va(r,r.bi_buf):r.bi_valid>0&&(r.pending_buf[r.pending++]=r.bi_buf),r.bi_buf=0,r.bi_valid=0},eS=(r,e,t,i)=>{Bb(r),i&&(va(r,t),va(r,~t)),r.pending_buf.set(r.window.subarray(e,e+t),r.pending),r.pending+=t},Mg=(r,e,t,i)=>{let n=e*2,s=t*2;return r[n]<r[s]||r[n]===r[s]&&i[e]<=i[t]},Rf=(r,e,t)=>{let i=r.heap[t],n=t<<1;for(;n<=r.heap_len&&(n<r.heap_len&&Mg(e,r.heap[n+1],r.heap[n],r.depth)&&n++,!Mg(e,i,r.heap[n],r.depth));)r.heap[t]=r.heap[n],t=n,n<<=1;r.heap[t]=i},Ng=(r,e,t)=>{let i,n,s=0,o,a;if(r.last_lit!==0)do i=r.pending_buf[r.d_buf+s*2]<<8|r.pending_buf[r.d_buf+s*2+1],n=r.pending_buf[r.l_buf+s],s++,i===0?Gr(r,n,e):(o=ya[n],Gr(r,o+Ca+1,e),a=Wf[o],a!==0&&(n-=Zf[o],Ki(r,n,a)),i--,o=Tb(i),Gr(r,o,t),a=_c[o],a!==0&&(i-=Sc[o],Ki(r,i,a)));while(s<r.last_lit);Gr(r,Xf,e)},Jf=(r,e)=>{let t=e.dyn_tree,i=e.stat_desc.static_tree,n=e.stat_desc.has_stree,s=e.stat_desc.elems,o,a,l=-1,u;for(r.heap_len=0,r.heap_max=Fb,o=0;o<s;o++)t[o*2]!==0?(r.heap[++r.heap_len]=l=o,r.depth[o]=0):t[o*2+1]=0;for(;r.heap_len<2;)u=r.heap[++r.heap_len]=l<2?++l:0,t[u*2]=1,r.depth[u]=0,r.opt_len--,n&&(r.static_len-=i[u*2+1]);for(e.max_code=l,o=r.heap_len>>1;o>=1;o--)Rf(r,t,o);u=s;do o=r.heap[1],r.heap[1]=r.heap[r.heap_len--],Rf(r,t,1),a=r.heap[1],r.heap[--r.heap_max]=o,r.heap[--r.heap_max]=a,t[u*2]=t[o*2]+t[a*2],r.depth[u]=(r.depth[o]>=r.depth[a]?r.depth[o]:r.depth[a])+1,t[o*2+1]=t[a*2+1]=u,r.heap[1]=u++,Rf(r,t,1);while(r.heap_len>=2);r.heap[--r.heap_max]=r.heap[1],YC(r,e),Ab(t,l,r.bl_count)},jg=(r,e,t)=>{let i,n=-1,s,o=e[0*2+1],a=0,l=7,u=4;for(o===0&&(l=138,u=3),e[(t+1)*2+1]=65535,i=0;i<=t;i++)s=o,o=e[(i+1)*2+1],!(++a<l&&s===o)&&(a<u?r.bl_tree[s*2]+=a:s!==0?(s!==n&&r.bl_tree[s*2]++,r.bl_tree[kb*2]++):a<=10?r.bl_tree[Cb*2]++:r.bl_tree[Sb*2]++,a=0,n=s,o===0?(l=138,u=3):s===o?(l=6,u=3):(l=7,u=4))},Ug=(r,e,t)=>{let i,n=-1,s,o=e[0*2+1],a=0,l=7,u=4;for(o===0&&(l=138,u=3),i=0;i<=t;i++)if(s=o,o=e[(i+1)*2+1],!(++a<l&&s===o)){if(a<u)do Gr(r,s,r.bl_tree);while(--a!==0);else s!==0?(s!==n&&(Gr(r,s,r.bl_tree),a--),Gr(r,kb,r.bl_tree),Ki(r,a-3,2)):a<=10?(Gr(r,Cb,r.bl_tree),Ki(r,a-3,3)):(Gr(r,Sb,r.bl_tree),Ki(r,a-11,7));a=0,n=s,o===0?(l=138,u=3):s===o?(l=6,u=3):(l=7,u=4)}},tS=r=>{let e;for(jg(r,r.dyn_ltree,r.l_desc.max_code),jg(r,r.dyn_dtree,r.d_desc.max_code),Jf(r,r.bl_desc),e=Kf-1;e>=3&&r.bl_tree[Pb[e]*2+1]===0;e--);return r.opt_len+=3*(e+1)+5+5+4,e},iS=(r,e,t,i)=>{let n;for(Ki(r,e-257,5),Ki(r,t-1,5),Ki(r,i-4,4),n=0;n<i;n++)Ki(r,r.bl_tree[Pb[n]*2+1],3);Ug(r,r.dyn_ltree,e-1),Ug(r,r.dyn_dtree,t-1)},rS=r=>{let e=4093624447,t;for(t=0;t<=31;t++,e>>>=1)if(e&1&&r.dyn_ltree[t*2]!==0)return 0;if(r.dyn_ltree[9*2]!==0||r.dyn_ltree[10*2]!==0||r.dyn_ltree[13*2]!==0)return 1;for(t=32;t<Ca;t++)if(r.dyn_ltree[t*2]!==0)return 1;return 0},Gg=!1,nS=r=>{Gg||(QC(),Gg=!0),r.l_desc=new Af(r.dyn_ltree,Eb),r.d_desc=new Af(r.dyn_dtree,Ib),r.bl_desc=new Af(r.bl_tree,xb),r.bi_buf=0,r.bi_valid=0,Rb(r)},Lb=(r,e,t,i)=>{Ki(r,(WC<<1)+(i?1:0),3),eS(r,e,t,!0)},sS=r=>{Ki(r,_b<<1,3),Gr(r,Xf,dn),ZC(r)},oS=(r,e,t,i)=>{let n,s,o=0;r.level>0?(r.strm.data_type===2&&(r.strm.data_type=rS(r)),Jf(r,r.l_desc),Jf(r,r.d_desc),o=tS(r),n=r.opt_len+3+7>>>3,s=r.static_len+3+7>>>3,s<=n&&(n=s)):n=s=t+5,t+4<=n&&e!==-1?Lb(r,e,t,i):r.strategy===4||s===n?(Ki(r,(_b<<1)+(i?1:0),3),Ng(r,dn,ha)):(Ki(r,(JC<<1)+(i?1:0),3),iS(r,r.l_desc.max_code+1,r.d_desc.max_code+1,o+1),Ng(r,r.dyn_ltree,r.dyn_dtree)),Rb(r),i&&Bb(r)},aS=(r,e,t)=>(r.pending_buf[r.d_buf+r.last_lit*2]=e>>>8&255,r.pending_buf[r.d_buf+r.last_lit*2+1]=e&255,r.pending_buf[r.l_buf+r.last_lit]=t&255,r.last_lit++,e===0?r.dyn_ltree[t*2]++:(r.matches++,e--,r.dyn_ltree[(ya[t]+Ca+1)*2]++,r.dyn_dtree[Tb(e)*2]++),r.last_lit===r.lit_bufsize-1),lS=nS,uS=Lb,cS=oS,dS=aS,fS=sS,hS={_tr_init:lS,_tr_stored_block:uS,_tr_flush_block:cS,_tr_tally:dS,_tr_align:fS},pS=(r,e,t,i)=>{let n=r&65535|0,s=r>>>16&65535|0,o=0;for(;t!==0;){o=t>2e3?2e3:t,t-=o;do n=n+e[i++]|0,s=s+n|0;while(--o);n%=65521,s%=65521}return n|s<<16|0},wa=pS,mS=()=>{let r,e=[];for(var t=0;t<256;t++){r=t;for(var i=0;i<8;i++)r=r&1?3988292384^r>>>1:r>>>1;e[t]=r}return e},gS=new Uint32Array(mS()),bS=(r,e,t,i)=>{let n=gS,s=i+t;r^=-1;for(let o=i;o<s;o++)r=r>>>8^n[(r^e[o])&255];return r^-1},yi=bS,ms={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},po={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},{_tr_init:yS,_tr_stored_block:vS,_tr_flush_block:wS,_tr_tally:Nn,_tr_align:_S}=hS,{Z_NO_FLUSH:vs,Z_PARTIAL_FLUSH:FS,Z_FULL_FLUSH:kS,Z_FINISH:jn,Z_BLOCK:zg,Z_OK:zr,Z_STREAM_END:Vg,Z_STREAM_ERROR:ar,Z_DATA_ERROR:CS,Z_BUF_ERROR:Bf,Z_DEFAULT_COMPRESSION:SS,Z_FILTERED:PS,Z_HUFFMAN_ONLY:gc,Z_RLE:ES,Z_FIXED:IS,Z_DEFAULT_STRATEGY:xS,Z_UNKNOWN:TS,Z_DEFLATED:Ic}=po,DS=9,AS=15,RS=8,BS=29,LS=256,$f=LS+1+BS,OS=30,MS=19,NS=2*$f+1,jS=15,kt=3,On=258,kr=On+kt+1,US=32,xc=42,Hf=69,Fc=73,kc=91,Cc=103,ps=113,da=666,mi=1,Sa=2,gs=3,mo=4,GS=3,Mn=(r,e)=>(r.msg=ms[e],e),Wg=r=>(r<<1)-(r>4?9:0),Ln=r=>{let e=r.length;for(;--e>=0;)r[e]=0},zS=(r,e,t)=>(e<<r.hash_shift^t)&r.hash_mask,Un=zS,Bn=r=>{let e=r.state,t=e.pending;t>r.avail_out&&(t=r.avail_out),t!==0&&(r.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+t),r.next_out),r.next_out+=t,e.pending_out+=t,r.total_out+=t,r.avail_out-=t,e.pending-=t,e.pending===0&&(e.pending_out=0))},ki=(r,e)=>{wS(r,r.block_start>=0?r.block_start:-1,r.strstart-r.block_start,e),r.block_start=r.strstart,Bn(r.strm)},Tt=(r,e)=>{r.pending_buf[r.pending++]=e},ca=(r,e)=>{r.pending_buf[r.pending++]=e>>>8&255,r.pending_buf[r.pending++]=e&255},VS=(r,e,t,i)=>{let n=r.avail_in;return n>i&&(n=i),n===0?0:(r.avail_in-=n,e.set(r.input.subarray(r.next_in,r.next_in+n),t),r.state.wrap===1?r.adler=wa(r.adler,e,n,t):r.state.wrap===2&&(r.adler=yi(r.adler,e,n,t)),r.next_in+=n,r.total_in+=n,n)},Ob=(r,e)=>{let t=r.max_chain_length,i=r.strstart,n,s,o=r.prev_length,a=r.nice_match,l=r.strstart>r.w_size-kr?r.strstart-(r.w_size-kr):0,u=r.window,c=r.w_mask,d=r.prev,h=r.strstart+On,f=u[i+o-1],m=u[i+o];r.prev_length>=r.good_match&&(t>>=2),a>r.lookahead&&(a=r.lookahead);do if(n=e,!(u[n+o]!==m||u[n+o-1]!==f||u[n]!==u[i]||u[++n]!==u[i+1])){i+=2,n++;do;while(u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&i<h);if(s=On-(h-i),i=h-On,s>o){if(r.match_start=e,o=s,s>=a)break;f=u[i+o-1],m=u[i+o]}}while((e=d[e&c])>l&&--t!==0);return o<=r.lookahead?o:r.lookahead},bs=r=>{let e=r.w_size,t,i,n,s,o;do{if(s=r.window_size-r.lookahead-r.strstart,r.strstart>=e+(e-kr)){r.window.set(r.window.subarray(e,e+e),0),r.match_start-=e,r.strstart-=e,r.block_start-=e,i=r.hash_size,t=i;do n=r.head[--t],r.head[t]=n>=e?n-e:0;while(--i);i=e,t=i;do n=r.prev[--t],r.prev[t]=n>=e?n-e:0;while(--i);s+=e}if(r.strm.avail_in===0)break;if(i=VS(r.strm,r.window,r.strstart+r.lookahead,s),r.lookahead+=i,r.lookahead+r.insert>=kt)for(o=r.strstart-r.insert,r.ins_h=r.window[o],r.ins_h=Un(r,r.ins_h,r.window[o+1]);r.insert&&(r.ins_h=Un(r,r.ins_h,r.window[o+kt-1]),r.prev[o&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=o,o++,r.insert--,!(r.lookahead+r.insert<kt)););}while(r.lookahead<kr&&r.strm.avail_in!==0)},WS=(r,e)=>{let t=65535;for(t>r.pending_buf_size-5&&(t=r.pending_buf_size-5);;){if(r.lookahead<=1){if(bs(r),r.lookahead===0&&e===vs)return mi;if(r.lookahead===0)break}r.strstart+=r.lookahead,r.lookahead=0;let i=r.block_start+t;if((r.strstart===0||r.strstart>=i)&&(r.lookahead=r.strstart-i,r.strstart=i,ki(r,!1),r.strm.avail_out===0)||r.strstart-r.block_start>=r.w_size-kr&&(ki(r,!1),r.strm.avail_out===0))return mi}return r.insert=0,e===jn?(ki(r,!0),r.strm.avail_out===0?gs:mo):(r.strstart>r.block_start&&(ki(r,!1),r.strm.avail_out===0),mi)},Lf=(r,e)=>{let t,i;for(;;){if(r.lookahead<kr){if(bs(r),r.lookahead<kr&&e===vs)return mi;if(r.lookahead===0)break}if(t=0,r.lookahead>=kt&&(r.ins_h=Un(r,r.ins_h,r.window[r.strstart+kt-1]),t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),t!==0&&r.strstart-t<=r.w_size-kr&&(r.match_length=Ob(r,t)),r.match_length>=kt)if(i=Nn(r,r.strstart-r.match_start,r.match_length-kt),r.lookahead-=r.match_length,r.match_length<=r.max_lazy_match&&r.lookahead>=kt){r.match_length--;do r.strstart++,r.ins_h=Un(r,r.ins_h,r.window[r.strstart+kt-1]),t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart;while(--r.match_length!==0);r.strstart++}else r.strstart+=r.match_length,r.match_length=0,r.ins_h=r.window[r.strstart],r.ins_h=Un(r,r.ins_h,r.window[r.strstart+1]);else i=Nn(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++;if(i&&(ki(r,!1),r.strm.avail_out===0))return mi}return r.insert=r.strstart<kt-1?r.strstart:kt-1,e===jn?(ki(r,!0),r.strm.avail_out===0?gs:mo):r.last_lit&&(ki(r,!1),r.strm.avail_out===0)?mi:Sa},uo=(r,e)=>{let t,i,n;for(;;){if(r.lookahead<kr){if(bs(r),r.lookahead<kr&&e===vs)return mi;if(r.lookahead===0)break}if(t=0,r.lookahead>=kt&&(r.ins_h=Un(r,r.ins_h,r.window[r.strstart+kt-1]),t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),r.prev_length=r.match_length,r.prev_match=r.match_start,r.match_length=kt-1,t!==0&&r.prev_length<r.max_lazy_match&&r.strstart-t<=r.w_size-kr&&(r.match_length=Ob(r,t),r.match_length<=5&&(r.strategy===PS||r.match_length===kt&&r.strstart-r.match_start>4096)&&(r.match_length=kt-1)),r.prev_length>=kt&&r.match_length<=r.prev_length){n=r.strstart+r.lookahead-kt,i=Nn(r,r.strstart-1-r.prev_match,r.prev_length-kt),r.lookahead-=r.prev_length-1,r.prev_length-=2;do++r.strstart<=n&&(r.ins_h=Un(r,r.ins_h,r.window[r.strstart+kt-1]),t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart);while(--r.prev_length!==0);if(r.match_available=0,r.match_length=kt-1,r.strstart++,i&&(ki(r,!1),r.strm.avail_out===0))return mi}else if(r.match_available){if(i=Nn(r,0,r.window[r.strstart-1]),i&&ki(r,!1),r.strstart++,r.lookahead--,r.strm.avail_out===0)return mi}else r.match_available=1,r.strstart++,r.lookahead--}return r.match_available&&(i=Nn(r,0,r.window[r.strstart-1]),r.match_available=0),r.insert=r.strstart<kt-1?r.strstart:kt-1,e===jn?(ki(r,!0),r.strm.avail_out===0?gs:mo):r.last_lit&&(ki(r,!1),r.strm.avail_out===0)?mi:Sa},JS=(r,e)=>{let t,i,n,s,o=r.window;for(;;){if(r.lookahead<=On){if(bs(r),r.lookahead<=On&&e===vs)return mi;if(r.lookahead===0)break}if(r.match_length=0,r.lookahead>=kt&&r.strstart>0&&(n=r.strstart-1,i=o[n],i===o[++n]&&i===o[++n]&&i===o[++n])){s=r.strstart+On;do;while(i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&n<s);r.match_length=On-(s-n),r.match_length>r.lookahead&&(r.match_length=r.lookahead)}if(r.match_length>=kt?(t=Nn(r,1,r.match_length-kt),r.lookahead-=r.match_length,r.strstart+=r.match_length,r.match_length=0):(t=Nn(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++),t&&(ki(r,!1),r.strm.avail_out===0))return mi}return r.insert=0,e===jn?(ki(r,!0),r.strm.avail_out===0?gs:mo):r.last_lit&&(ki(r,!1),r.strm.avail_out===0)?mi:Sa},$S=(r,e)=>{let t;for(;;){if(r.lookahead===0&&(bs(r),r.lookahead===0)){if(e===vs)return mi;break}if(r.match_length=0,t=Nn(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++,t&&(ki(r,!1),r.strm.avail_out===0))return mi}return r.insert=0,e===jn?(ki(r,!0),r.strm.avail_out===0?gs:mo):r.last_lit&&(ki(r,!1),r.strm.avail_out===0)?mi:Sa};function Ur(r,e,t,i,n){this.good_length=r,this.max_lazy=e,this.nice_length=t,this.max_chain=i,this.func=n}var fa=[new Ur(0,0,0,0,WS),new Ur(4,4,8,4,Lf),new Ur(4,5,16,8,Lf),new Ur(4,6,32,32,Lf),new Ur(4,4,16,16,uo),new Ur(8,16,32,32,uo),new Ur(8,16,128,128,uo),new Ur(8,32,128,256,uo),new Ur(32,128,258,1024,uo),new Ur(32,258,258,4096,uo)],HS=r=>{r.window_size=2*r.w_size,Ln(r.head),r.max_lazy_match=fa[r.level].max_lazy,r.good_match=fa[r.level].good_length,r.nice_match=fa[r.level].nice_length,r.max_chain_length=fa[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=kt-1,r.match_available=0,r.ins_h=0};function qS(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Ic,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(NS*2),this.dyn_dtree=new Uint16Array((2*OS+1)*2),this.bl_tree=new Uint16Array((2*MS+1)*2),Ln(this.dyn_ltree),Ln(this.dyn_dtree),Ln(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(jS+1),this.heap=new Uint16Array(2*$f+1),Ln(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*$f+1),Ln(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var Mb=r=>{if(!r||!r.state)return Mn(r,ar);r.total_in=r.total_out=0,r.data_type=TS;let e=r.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?xc:ps,r.adler=e.wrap===2?0:1,e.last_flush=vs,yS(e),zr},Nb=r=>{let e=Mb(r);return e===zr&&HS(r.state),e},KS=(r,e)=>!r||!r.state||r.state.wrap!==2?ar:(r.state.gzhead=e,zr),jb=(r,e,t,i,n,s)=>{if(!r)return ar;let o=1;if(e===SS&&(e=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),n<1||n>DS||t!==Ic||i<8||i>15||e<0||e>9||s<0||s>IS)return Mn(r,ar);i===8&&(i=9);let a=new qS;return r.state=a,a.strm=r,a.wrap=o,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=n+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+kt-1)/kt),a.window=new Uint8Array(a.w_size*2),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<n+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new Uint8Array(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=e,a.strategy=s,a.method=t,Nb(r)},XS=(r,e)=>jb(r,e,Ic,AS,RS,xS),ZS=(r,e)=>{let t,i;if(!r||!r.state||e>zg||e<0)return r?Mn(r,ar):ar;let n=r.state;if(!r.output||!r.input&&r.avail_in!==0||n.status===da&&e!==jn)return Mn(r,r.avail_out===0?Bf:ar);n.strm=r;let s=n.last_flush;if(n.last_flush=e,n.status===xc)if(n.wrap===2)r.adler=0,Tt(n,31),Tt(n,139),Tt(n,8),n.gzhead?(Tt(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),Tt(n,n.gzhead.time&255),Tt(n,n.gzhead.time>>8&255),Tt(n,n.gzhead.time>>16&255),Tt(n,n.gzhead.time>>24&255),Tt(n,n.level===9?2:n.strategy>=gc||n.level<2?4:0),Tt(n,n.gzhead.os&255),n.gzhead.extra&&n.gzhead.extra.length&&(Tt(n,n.gzhead.extra.length&255),Tt(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(r.adler=yi(r.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=Hf):(Tt(n,0),Tt(n,0),Tt(n,0),Tt(n,0),Tt(n,0),Tt(n,n.level===9?2:n.strategy>=gc||n.level<2?4:0),Tt(n,GS),n.status=ps);else{let o=Ic+(n.w_bits-8<<4)<<8,a=-1;n.strategy>=gc||n.level<2?a=0:n.level<6?a=1:n.level===6?a=2:a=3,o|=a<<6,n.strstart!==0&&(o|=US),o+=31-o%31,n.status=ps,ca(n,o),n.strstart!==0&&(ca(n,r.adler>>>16),ca(n,r.adler&65535)),r.adler=1}if(n.status===Hf)if(n.gzhead.extra){for(t=n.pending;n.gzindex<(n.gzhead.extra.length&65535)&&!(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>t&&(r.adler=yi(r.adler,n.pending_buf,n.pending-t,t)),Bn(r),t=n.pending,n.pending===n.pending_buf_size));)Tt(n,n.gzhead.extra[n.gzindex]&255),n.gzindex++;n.gzhead.hcrc&&n.pending>t&&(r.adler=yi(r.adler,n.pending_buf,n.pending-t,t)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=Fc)}else n.status=Fc;if(n.status===Fc)if(n.gzhead.name){t=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>t&&(r.adler=yi(r.adler,n.pending_buf,n.pending-t,t)),Bn(r),t=n.pending,n.pending===n.pending_buf_size)){i=1;break}n.gzindex<n.gzhead.name.length?i=n.gzhead.name.charCodeAt(n.gzindex++)&255:i=0,Tt(n,i)}while(i!==0);n.gzhead.hcrc&&n.pending>t&&(r.adler=yi(r.adler,n.pending_buf,n.pending-t,t)),i===0&&(n.gzindex=0,n.status=kc)}else n.status=kc;if(n.status===kc)if(n.gzhead.comment){t=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>t&&(r.adler=yi(r.adler,n.pending_buf,n.pending-t,t)),Bn(r),t=n.pending,n.pending===n.pending_buf_size)){i=1;break}n.gzindex<n.gzhead.comment.length?i=n.gzhead.comment.charCodeAt(n.gzindex++)&255:i=0,Tt(n,i)}while(i!==0);n.gzhead.hcrc&&n.pending>t&&(r.adler=yi(r.adler,n.pending_buf,n.pending-t,t)),i===0&&(n.status=Cc)}else n.status=Cc;if(n.status===Cc&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&Bn(r),n.pending+2<=n.pending_buf_size&&(Tt(n,r.adler&255),Tt(n,r.adler>>8&255),r.adler=0,n.status=ps)):n.status=ps),n.pending!==0){if(Bn(r),r.avail_out===0)return n.last_flush=-1,zr}else if(r.avail_in===0&&Wg(e)<=Wg(s)&&e!==jn)return Mn(r,Bf);if(n.status===da&&r.avail_in!==0)return Mn(r,Bf);if(r.avail_in!==0||n.lookahead!==0||e!==vs&&n.status!==da){let o=n.strategy===gc?$S(n,e):n.strategy===ES?JS(n,e):fa[n.level].func(n,e);if((o===gs||o===mo)&&(n.status=da),o===mi||o===gs)return r.avail_out===0&&(n.last_flush=-1),zr;if(o===Sa&&(e===FS?_S(n):e!==zg&&(vS(n,0,0,!1),e===kS&&(Ln(n.head),n.lookahead===0&&(n.strstart=0,n.block_start=0,n.insert=0))),Bn(r),r.avail_out===0))return n.last_flush=-1,zr}return e!==jn?zr:n.wrap<=0?Vg:(n.wrap===2?(Tt(n,r.adler&255),Tt(n,r.adler>>8&255),Tt(n,r.adler>>16&255),Tt(n,r.adler>>24&255),Tt(n,r.total_in&255),Tt(n,r.total_in>>8&255),Tt(n,r.total_in>>16&255),Tt(n,r.total_in>>24&255)):(ca(n,r.adler>>>16),ca(n,r.adler&65535)),Bn(r),n.wrap>0&&(n.wrap=-n.wrap),n.pending!==0?zr:Vg)},YS=r=>{if(!r||!r.state)return ar;let e=r.state.status;return e!==xc&&e!==Hf&&e!==Fc&&e!==kc&&e!==Cc&&e!==ps&&e!==da?Mn(r,ar):(r.state=null,e===ps?Mn(r,CS):zr)},QS=(r,e)=>{let t=e.length;if(!r||!r.state)return ar;let i=r.state,n=i.wrap;if(n===2||n===1&&i.status!==xc||i.lookahead)return ar;if(n===1&&(r.adler=wa(r.adler,e,t,0)),i.wrap=0,t>=i.w_size){n===0&&(Ln(i.head),i.strstart=0,i.block_start=0,i.insert=0);let l=new Uint8Array(i.w_size);l.set(e.subarray(t-i.w_size,t),0),e=l,t=i.w_size}let s=r.avail_in,o=r.next_in,a=r.input;for(r.avail_in=t,r.next_in=0,r.input=e,bs(i);i.lookahead>=kt;){let l=i.strstart,u=i.lookahead-(kt-1);do i.ins_h=Un(i,i.ins_h,i.window[l+kt-1]),i.prev[l&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=l,l++;while(--u);i.strstart=l,i.lookahead=kt-1,bs(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=kt-1,i.match_available=0,r.next_in=o,r.input=a,r.avail_in=s,i.wrap=n,zr},eP=XS,tP=jb,iP=Nb,rP=Mb,nP=KS,sP=ZS,oP=YS,aP=QS,lP="pako deflate (from Nodeca project)",pa={deflateInit:eP,deflateInit2:tP,deflateReset:iP,deflateResetKeep:rP,deflateSetHeader:nP,deflate:sP,deflateEnd:oP,deflateSetDictionary:aP,deflateInfo:lP},uP=(r,e)=>Object.prototype.hasOwnProperty.call(r,e),cP=function(r){let e=Array.prototype.slice.call(arguments,1);for(;e.length;){let t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(let i in t)uP(t,i)&&(r[i]=t[i])}}return r},dP=r=>{let e=0;for(let i=0,n=r.length;i<n;i++)e+=r[i].length;let t=new Uint8Array(e);for(let i=0,n=0,s=r.length;i<s;i++){let o=r[i];t.set(o,n),n+=o.length}return t},Tc={assign:cP,flattenChunks:dP},Ub=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Ub=!1}var _a=new Uint8Array(256);for(let r=0;r<256;r++)_a[r]=r>=252?6:r>=248?5:r>=240?4:r>=224?3:r>=192?2:1;_a[254]=_a[254]=1;var fP=r=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(r);let e,t,i,n,s,o=r.length,a=0;for(n=0;n<o;n++)t=r.charCodeAt(n),(t&64512)===55296&&n+1<o&&(i=r.charCodeAt(n+1),(i&64512)===56320&&(t=65536+(t-55296<<10)+(i-56320),n++)),a+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(a),s=0,n=0;s<a;n++)t=r.charCodeAt(n),(t&64512)===55296&&n+1<o&&(i=r.charCodeAt(n+1),(i&64512)===56320&&(t=65536+(t-55296<<10)+(i-56320),n++)),t<128?e[s++]=t:t<2048?(e[s++]=192|t>>>6,e[s++]=128|t&63):t<65536?(e[s++]=224|t>>>12,e[s++]=128|t>>>6&63,e[s++]=128|t&63):(e[s++]=240|t>>>18,e[s++]=128|t>>>12&63,e[s++]=128|t>>>6&63,e[s++]=128|t&63);return e},hP=(r,e)=>{if(e<65534&&r.subarray&&Ub)return String.fromCharCode.apply(null,r.length===e?r:r.subarray(0,e));let t="";for(let i=0;i<e;i++)t+=String.fromCharCode(r[i]);return t},pP=(r,e)=>{let t=e||r.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(r.subarray(0,e));let i,n,s=new Array(t*2);for(n=0,i=0;i<t;){let o=r[i++];if(o<128){s[n++]=o;continue}let a=_a[o];if(a>4){s[n++]=65533,i+=a-1;continue}for(o&=a===2?31:a===3?15:7;a>1&&i<t;)o=o<<6|r[i++]&63,a--;if(a>1){s[n++]=65533;continue}o<65536?s[n++]=o:(o-=65536,s[n++]=55296|o>>10&1023,s[n++]=56320|o&1023)}return hP(s,n)},mP=(r,e)=>{e=e||r.length,e>r.length&&(e=r.length);let t=e-1;for(;t>=0&&(r[t]&192)===128;)t--;return t<0||t===0?e:t+_a[r[t]]>e?t:e},Fa={string2buf:fP,buf2string:pP,utf8border:mP};function gP(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Gb=gP,zb=Object.prototype.toString,{Z_NO_FLUSH:bP,Z_SYNC_FLUSH:yP,Z_FULL_FLUSH:vP,Z_FINISH:wP,Z_OK:Pc,Z_STREAM_END:_P,Z_DEFAULT_COMPRESSION:FP,Z_DEFAULT_STRATEGY:kP,Z_DEFLATED:CP}=po;function Pa(r){this.options=Tc.assign({level:FP,method:CP,chunkSize:16384,windowBits:15,memLevel:8,strategy:kP},r||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Gb,this.strm.avail_out=0;let t=pa.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(t!==Pc)throw new Error(ms[t]);if(e.header&&pa.deflateSetHeader(this.strm,e.header),e.dictionary){let i;if(typeof e.dictionary=="string"?i=Fa.string2buf(e.dictionary):zb.call(e.dictionary)==="[object ArrayBuffer]"?i=new Uint8Array(e.dictionary):i=e.dictionary,t=pa.deflateSetDictionary(this.strm,i),t!==Pc)throw new Error(ms[t]);this._dict_set=!0}}Pa.prototype.push=function(r,e){let t=this.strm,i=this.options.chunkSize,n,s;if(this.ended)return!1;for(e===~~e?s=e:s=e===!0?wP:bP,typeof r=="string"?t.input=Fa.string2buf(r):zb.call(r)==="[object ArrayBuffer]"?t.input=new Uint8Array(r):t.input=r,t.next_in=0,t.avail_in=t.input.length;;){if(t.avail_out===0&&(t.output=new Uint8Array(i),t.next_out=0,t.avail_out=i),(s===yP||s===vP)&&t.avail_out<=6){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(n=pa.deflate(t,s),n===_P)return t.next_out>0&&this.onData(t.output.subarray(0,t.next_out)),n=pa.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===Pc;if(t.avail_out===0){this.onData(t.output);continue}if(s>0&&t.next_out>0){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(t.avail_in===0)break}return!0};Pa.prototype.onData=function(r){this.chunks.push(r)};Pa.prototype.onEnd=function(r){r===Pc&&(this.result=Tc.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};function Yf(r,e){let t=new Pa(e);if(t.push(r,!0),t.err)throw t.msg||ms[t.err];return t.result}function SP(r,e){return e=e||{},e.raw=!0,Yf(r,e)}function PP(r,e){return e=e||{},e.gzip=!0,Yf(r,e)}var EP=Pa,IP=Yf,xP=SP,TP=PP,DP=po,AP={Deflate:EP,deflate:IP,deflateRaw:xP,gzip:TP,constants:DP},bc=30,RP=12,BP=function(e,t){let i,n,s,o,a,l,u,c,d,h,f,m,p,g,b,F,w,_,I,A,T,E,K,P,G=e.state;i=e.next_in,K=e.input,n=i+(e.avail_in-5),s=e.next_out,P=e.output,o=s-(t-e.avail_out),a=s+(e.avail_out-257),l=G.dmax,u=G.wsize,c=G.whave,d=G.wnext,h=G.window,f=G.hold,m=G.bits,p=G.lencode,g=G.distcode,b=(1<<G.lenbits)-1,F=(1<<G.distbits)-1;e:do{m<15&&(f+=K[i++]<<m,m+=8,f+=K[i++]<<m,m+=8),w=p[f&b];t:for(;;){if(_=w>>>24,f>>>=_,m-=_,_=w>>>16&255,_===0)P[s++]=w&65535;else if(_&16){I=w&65535,_&=15,_&&(m<_&&(f+=K[i++]<<m,m+=8),I+=f&(1<<_)-1,f>>>=_,m-=_),m<15&&(f+=K[i++]<<m,m+=8,f+=K[i++]<<m,m+=8),w=g[f&F];i:for(;;){if(_=w>>>24,f>>>=_,m-=_,_=w>>>16&255,_&16){if(A=w&65535,_&=15,m<_&&(f+=K[i++]<<m,m+=8,m<_&&(f+=K[i++]<<m,m+=8)),A+=f&(1<<_)-1,A>l){e.msg="invalid distance too far back",G.mode=bc;break e}if(f>>>=_,m-=_,_=s-o,A>_){if(_=A-_,_>c&&G.sane){e.msg="invalid distance too far back",G.mode=bc;break e}if(T=0,E=h,d===0){if(T+=u-_,_<I){I-=_;do P[s++]=h[T++];while(--_);T=s-A,E=P}}else if(d<_){if(T+=u+d-_,_-=d,_<I){I-=_;do P[s++]=h[T++];while(--_);if(T=0,d<I){_=d,I-=_;do P[s++]=h[T++];while(--_);T=s-A,E=P}}}else if(T+=d-_,_<I){I-=_;do P[s++]=h[T++];while(--_);T=s-A,E=P}for(;I>2;)P[s++]=E[T++],P[s++]=E[T++],P[s++]=E[T++],I-=3;I&&(P[s++]=E[T++],I>1&&(P[s++]=E[T++]))}else{T=s-A;do P[s++]=P[T++],P[s++]=P[T++],P[s++]=P[T++],I-=3;while(I>2);I&&(P[s++]=P[T++],I>1&&(P[s++]=P[T++]))}}else if((_&64)===0){w=g[(w&65535)+(f&(1<<_)-1)];continue i}else{e.msg="invalid distance code",G.mode=bc;break e}break}}else if((_&64)===0){w=p[(w&65535)+(f&(1<<_)-1)];continue t}else if(_&32){G.mode=RP;break e}else{e.msg="invalid literal/length code",G.mode=bc;break e}break}}while(i<n&&s<a);I=m>>3,i-=I,m-=I<<3,f&=(1<<m)-1,e.next_in=i,e.next_out=s,e.avail_in=i<n?5+(n-i):5-(i-n),e.avail_out=s<a?257+(a-s):257-(s-a),G.hold=f,G.bits=m},co=15,Jg=852,$g=592,Hg=0,Of=1,qg=2,LP=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),OP=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),MP=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),NP=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),jP=(r,e,t,i,n,s,o,a)=>{let l=a.bits,u=0,c=0,d=0,h=0,f=0,m=0,p=0,g=0,b=0,F=0,w,_,I,A,T,E=null,K=0,P,G=new Uint16Array(co+1),y=new Uint16Array(co+1),z=null,Fe=0,re,Re,pe;for(u=0;u<=co;u++)G[u]=0;for(c=0;c<i;c++)G[e[t+c]]++;for(f=l,h=co;h>=1&&G[h]===0;h--);if(f>h&&(f=h),h===0)return n[s++]=1<<24|64<<16|0,n[s++]=1<<24|64<<16|0,a.bits=1,0;for(d=1;d<h&&G[d]===0;d++);for(f<d&&(f=d),g=1,u=1;u<=co;u++)if(g<<=1,g-=G[u],g<0)return-1;if(g>0&&(r===Hg||h!==1))return-1;for(y[1]=0,u=1;u<co;u++)y[u+1]=y[u]+G[u];for(c=0;c<i;c++)e[t+c]!==0&&(o[y[e[t+c]]++]=c);if(r===Hg?(E=z=o,P=19):r===Of?(E=LP,K-=257,z=OP,Fe-=257,P=256):(E=MP,z=NP,P=-1),F=0,c=0,u=d,T=s,m=f,p=0,I=-1,b=1<<f,A=b-1,r===Of&&b>Jg||r===qg&&b>$g)return 1;for(;;){re=u-p,o[c]<P?(Re=0,pe=o[c]):o[c]>P?(Re=z[Fe+o[c]],pe=E[K+o[c]]):(Re=96,pe=0),w=1<<u-p,_=1<<m,d=_;do _-=w,n[T+(F>>p)+_]=re<<24|Re<<16|pe|0;while(_!==0);for(w=1<<u-1;F&w;)w>>=1;if(w!==0?(F&=w-1,F+=w):F=0,c++,--G[u]===0){if(u===h)break;u=e[t+o[c]]}if(u>f&&(F&A)!==I){for(p===0&&(p=f),T+=d,m=u-p,g=1<<m;m+p<h&&(g-=G[m+p],!(g<=0));)m++,g<<=1;if(b+=1<<m,r===Of&&b>Jg||r===qg&&b>$g)return 1;I=F&A,n[I]=f<<24|m<<16|T-s|0}}return F!==0&&(n[T+F]=u-p<<24|64<<16|0),a.bits=f,0},ma=jP,UP=0,Vb=1,Wb=2,{Z_FINISH:Kg,Z_BLOCK:GP,Z_TREES:yc,Z_OK:ys,Z_STREAM_END:zP,Z_NEED_DICT:VP,Z_STREAM_ERROR:lr,Z_DATA_ERROR:Jb,Z_MEM_ERROR:$b,Z_BUF_ERROR:WP,Z_DEFLATED:Xg}=po,Hb=1,Zg=2,Yg=3,Qg=4,eb=5,tb=6,ib=7,rb=8,nb=9,sb=10,Ec=11,cn=12,Mf=13,ob=14,Nf=15,ab=16,lb=17,ub=18,cb=19,vc=20,wc=21,db=22,fb=23,hb=24,pb=25,mb=26,jf=27,gb=28,bb=29,Kt=30,qb=31,JP=32,$P=852,HP=592,qP=15,KP=qP,yb=r=>(r>>>24&255)+(r>>>8&65280)+((r&65280)<<8)+((r&255)<<24);function XP(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var Kb=r=>{if(!r||!r.state)return lr;let e=r.state;return r.total_in=r.total_out=e.total=0,r.msg="",e.wrap&&(r.adler=e.wrap&1),e.mode=Hb,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array($P),e.distcode=e.distdyn=new Int32Array(HP),e.sane=1,e.back=-1,ys},Xb=r=>{if(!r||!r.state)return lr;let e=r.state;return e.wsize=0,e.whave=0,e.wnext=0,Kb(r)},Zb=(r,e)=>{let t;if(!r||!r.state)return lr;let i=r.state;return e<0?(t=0,e=-e):(t=(e>>4)+1,e<48&&(e&=15)),e&&(e<8||e>15)?lr:(i.window!==null&&i.wbits!==e&&(i.window=null),i.wrap=t,i.wbits=e,Xb(r))},Yb=(r,e)=>{if(!r)return lr;let t=new XP;r.state=t,t.window=null;let i=Zb(r,e);return i!==ys&&(r.state=null),i},ZP=r=>Yb(r,KP),vb=!0,Uf,Gf,YP=r=>{if(vb){Uf=new Int32Array(512),Gf=new Int32Array(32);let e=0;for(;e<144;)r.lens[e++]=8;for(;e<256;)r.lens[e++]=9;for(;e<280;)r.lens[e++]=7;for(;e<288;)r.lens[e++]=8;for(ma(Vb,r.lens,0,288,Uf,0,r.work,{bits:9}),e=0;e<32;)r.lens[e++]=5;ma(Wb,r.lens,0,32,Gf,0,r.work,{bits:5}),vb=!1}r.lencode=Uf,r.lenbits=9,r.distcode=Gf,r.distbits=5},Qb=(r,e,t,i)=>{let n,s=r.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),i>=s.wsize?(s.window.set(e.subarray(t-s.wsize,t),0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>i&&(n=i),s.window.set(e.subarray(t-i,t-i+n),s.wnext),i-=n,i?(s.window.set(e.subarray(t-i,t),0),s.wnext=i,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0},QP=(r,e)=>{let t,i,n,s,o,a,l,u,c,d,h,f,m,p,g=0,b,F,w,_,I,A,T,E,K=new Uint8Array(4),P,G,y=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!r||!r.state||!r.output||!r.input&&r.avail_in!==0)return lr;t=r.state,t.mode===cn&&(t.mode=Mf),o=r.next_out,n=r.output,l=r.avail_out,s=r.next_in,i=r.input,a=r.avail_in,u=t.hold,c=t.bits,d=a,h=l,E=ys;e:for(;;)switch(t.mode){case Hb:if(t.wrap===0){t.mode=Mf;break}for(;c<16;){if(a===0)break e;a--,u+=i[s++]<<c,c+=8}if(t.wrap&2&&u===35615){t.check=0,K[0]=u&255,K[1]=u>>>8&255,t.check=yi(t.check,K,2,0),u=0,c=0,t.mode=Zg;break}if(t.flags=0,t.head&&(t.head.done=!1),!(t.wrap&1)||(((u&255)<<8)+(u>>8))%31){r.msg="incorrect header check",t.mode=Kt;break}if((u&15)!==Xg){r.msg="unknown compression method",t.mode=Kt;break}if(u>>>=4,c-=4,T=(u&15)+8,t.wbits===0)t.wbits=T;else if(T>t.wbits){r.msg="invalid window size",t.mode=Kt;break}t.dmax=1<<t.wbits,r.adler=t.check=1,t.mode=u&512?sb:cn,u=0,c=0;break;case Zg:for(;c<16;){if(a===0)break e;a--,u+=i[s++]<<c,c+=8}if(t.flags=u,(t.flags&255)!==Xg){r.msg="unknown compression method",t.mode=Kt;break}if(t.flags&57344){r.msg="unknown header flags set",t.mode=Kt;break}t.head&&(t.head.text=u>>8&1),t.flags&512&&(K[0]=u&255,K[1]=u>>>8&255,t.check=yi(t.check,K,2,0)),u=0,c=0,t.mode=Yg;case Yg:for(;c<32;){if(a===0)break e;a--,u+=i[s++]<<c,c+=8}t.head&&(t.head.time=u),t.flags&512&&(K[0]=u&255,K[1]=u>>>8&255,K[2]=u>>>16&255,K[3]=u>>>24&255,t.check=yi(t.check,K,4,0)),u=0,c=0,t.mode=Qg;case Qg:for(;c<16;){if(a===0)break e;a--,u+=i[s++]<<c,c+=8}t.head&&(t.head.xflags=u&255,t.head.os=u>>8),t.flags&512&&(K[0]=u&255,K[1]=u>>>8&255,t.check=yi(t.check,K,2,0)),u=0,c=0,t.mode=eb;case eb:if(t.flags&1024){for(;c<16;){if(a===0)break e;a--,u+=i[s++]<<c,c+=8}t.length=u,t.head&&(t.head.extra_len=u),t.flags&512&&(K[0]=u&255,K[1]=u>>>8&255,t.check=yi(t.check,K,2,0)),u=0,c=0}else t.head&&(t.head.extra=null);t.mode=tb;case tb:if(t.flags&1024&&(f=t.length,f>a&&(f=a),f&&(t.head&&(T=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(i.subarray(s,s+f),T)),t.flags&512&&(t.check=yi(t.check,i,f,s)),a-=f,s+=f,t.length-=f),t.length))break e;t.length=0,t.mode=ib;case ib:if(t.flags&2048){if(a===0)break e;f=0;do T=i[s+f++],t.head&&T&&t.length<65536&&(t.head.name+=String.fromCharCode(T));while(T&&f<a);if(t.flags&512&&(t.check=yi(t.check,i,f,s)),a-=f,s+=f,T)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=rb;case rb:if(t.flags&4096){if(a===0)break e;f=0;do T=i[s+f++],t.head&&T&&t.length<65536&&(t.head.comment+=String.fromCharCode(T));while(T&&f<a);if(t.flags&512&&(t.check=yi(t.check,i,f,s)),a-=f,s+=f,T)break e}else t.head&&(t.head.comment=null);t.mode=nb;case nb:if(t.flags&512){for(;c<16;){if(a===0)break e;a--,u+=i[s++]<<c,c+=8}if(u!==(t.check&65535)){r.msg="header crc mismatch",t.mode=Kt;break}u=0,c=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),r.adler=t.check=0,t.mode=cn;break;case sb:for(;c<32;){if(a===0)break e;a--,u+=i[s++]<<c,c+=8}r.adler=t.check=yb(u),u=0,c=0,t.mode=Ec;case Ec:if(t.havedict===0)return r.next_out=o,r.avail_out=l,r.next_in=s,r.avail_in=a,t.hold=u,t.bits=c,VP;r.adler=t.check=1,t.mode=cn;case cn:if(e===GP||e===yc)break e;case Mf:if(t.last){u>>>=c&7,c-=c&7,t.mode=jf;break}for(;c<3;){if(a===0)break e;a--,u+=i[s++]<<c,c+=8}switch(t.last=u&1,u>>>=1,c-=1,u&3){case 0:t.mode=ob;break;case 1:if(YP(t),t.mode=vc,e===yc){u>>>=2,c-=2;break e}break;case 2:t.mode=lb;break;case 3:r.msg="invalid block type",t.mode=Kt}u>>>=2,c-=2;break;case ob:for(u>>>=c&7,c-=c&7;c<32;){if(a===0)break e;a--,u+=i[s++]<<c,c+=8}if((u&65535)!==(u>>>16^65535)){r.msg="invalid stored block lengths",t.mode=Kt;break}if(t.length=u&65535,u=0,c=0,t.mode=Nf,e===yc)break e;case Nf:t.mode=ab;case ab:if(f=t.length,f){if(f>a&&(f=a),f>l&&(f=l),f===0)break e;n.set(i.subarray(s,s+f),o),a-=f,s+=f,l-=f,o+=f,t.length-=f;break}t.mode=cn;break;case lb:for(;c<14;){if(a===0)break e;a--,u+=i[s++]<<c,c+=8}if(t.nlen=(u&31)+257,u>>>=5,c-=5,t.ndist=(u&31)+1,u>>>=5,c-=5,t.ncode=(u&15)+4,u>>>=4,c-=4,t.nlen>286||t.ndist>30){r.msg="too many length or distance symbols",t.mode=Kt;break}t.have=0,t.mode=ub;case ub:for(;t.have<t.ncode;){for(;c<3;){if(a===0)break e;a--,u+=i[s++]<<c,c+=8}t.lens[y[t.have++]]=u&7,u>>>=3,c-=3}for(;t.have<19;)t.lens[y[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,P={bits:t.lenbits},E=ma(UP,t.lens,0,19,t.lencode,0,t.work,P),t.lenbits=P.bits,E){r.msg="invalid code lengths set",t.mode=Kt;break}t.have=0,t.mode=cb;case cb:for(;t.have<t.nlen+t.ndist;){for(;g=t.lencode[u&(1<<t.lenbits)-1],b=g>>>24,F=g>>>16&255,w=g&65535,!(b<=c);){if(a===0)break e;a--,u+=i[s++]<<c,c+=8}if(w<16)u>>>=b,c-=b,t.lens[t.have++]=w;else{if(w===16){for(G=b+2;c<G;){if(a===0)break e;a--,u+=i[s++]<<c,c+=8}if(u>>>=b,c-=b,t.have===0){r.msg="invalid bit length repeat",t.mode=Kt;break}T=t.lens[t.have-1],f=3+(u&3),u>>>=2,c-=2}else if(w===17){for(G=b+3;c<G;){if(a===0)break e;a--,u+=i[s++]<<c,c+=8}u>>>=b,c-=b,T=0,f=3+(u&7),u>>>=3,c-=3}else{for(G=b+7;c<G;){if(a===0)break e;a--,u+=i[s++]<<c,c+=8}u>>>=b,c-=b,T=0,f=11+(u&127),u>>>=7,c-=7}if(t.have+f>t.nlen+t.ndist){r.msg="invalid bit length repeat",t.mode=Kt;break}for(;f--;)t.lens[t.have++]=T}}if(t.mode===Kt)break;if(t.lens[256]===0){r.msg="invalid code -- missing end-of-block",t.mode=Kt;break}if(t.lenbits=9,P={bits:t.lenbits},E=ma(Vb,t.lens,0,t.nlen,t.lencode,0,t.work,P),t.lenbits=P.bits,E){r.msg="invalid literal/lengths set",t.mode=Kt;break}if(t.distbits=6,t.distcode=t.distdyn,P={bits:t.distbits},E=ma(Wb,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,P),t.distbits=P.bits,E){r.msg="invalid distances set",t.mode=Kt;break}if(t.mode=vc,e===yc)break e;case vc:t.mode=wc;case wc:if(a>=6&&l>=258){r.next_out=o,r.avail_out=l,r.next_in=s,r.avail_in=a,t.hold=u,t.bits=c,BP(r,h),o=r.next_out,n=r.output,l=r.avail_out,s=r.next_in,i=r.input,a=r.avail_in,u=t.hold,c=t.bits,t.mode===cn&&(t.back=-1);break}for(t.back=0;g=t.lencode[u&(1<<t.lenbits)-1],b=g>>>24,F=g>>>16&255,w=g&65535,!(b<=c);){if(a===0)break e;a--,u+=i[s++]<<c,c+=8}if(F&&(F&240)===0){for(_=b,I=F,A=w;g=t.lencode[A+((u&(1<<_+I)-1)>>_)],b=g>>>24,F=g>>>16&255,w=g&65535,!(_+b<=c);){if(a===0)break e;a--,u+=i[s++]<<c,c+=8}u>>>=_,c-=_,t.back+=_}if(u>>>=b,c-=b,t.back+=b,t.length=w,F===0){t.mode=mb;break}if(F&32){t.back=-1,t.mode=cn;break}if(F&64){r.msg="invalid literal/length code",t.mode=Kt;break}t.extra=F&15,t.mode=db;case db:if(t.extra){for(G=t.extra;c<G;){if(a===0)break e;a--,u+=i[s++]<<c,c+=8}t.length+=u&(1<<t.extra)-1,u>>>=t.extra,c-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=fb;case fb:for(;g=t.distcode[u&(1<<t.distbits)-1],b=g>>>24,F=g>>>16&255,w=g&65535,!(b<=c);){if(a===0)break e;a--,u+=i[s++]<<c,c+=8}if((F&240)===0){for(_=b,I=F,A=w;g=t.distcode[A+((u&(1<<_+I)-1)>>_)],b=g>>>24,F=g>>>16&255,w=g&65535,!(_+b<=c);){if(a===0)break e;a--,u+=i[s++]<<c,c+=8}u>>>=_,c-=_,t.back+=_}if(u>>>=b,c-=b,t.back+=b,F&64){r.msg="invalid distance code",t.mode=Kt;break}t.offset=w,t.extra=F&15,t.mode=hb;case hb:if(t.extra){for(G=t.extra;c<G;){if(a===0)break e;a--,u+=i[s++]<<c,c+=8}t.offset+=u&(1<<t.extra)-1,u>>>=t.extra,c-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){r.msg="invalid distance too far back",t.mode=Kt;break}t.mode=pb;case pb:if(l===0)break e;if(f=h-l,t.offset>f){if(f=t.offset-f,f>t.whave&&t.sane){r.msg="invalid distance too far back",t.mode=Kt;break}f>t.wnext?(f-=t.wnext,m=t.wsize-f):m=t.wnext-f,f>t.length&&(f=t.length),p=t.window}else p=n,m=o-t.offset,f=t.length;f>l&&(f=l),l-=f,t.length-=f;do n[o++]=p[m++];while(--f);t.length===0&&(t.mode=wc);break;case mb:if(l===0)break e;n[o++]=t.length,l--,t.mode=wc;break;case jf:if(t.wrap){for(;c<32;){if(a===0)break e;a--,u|=i[s++]<<c,c+=8}if(h-=l,r.total_out+=h,t.total+=h,h&&(r.adler=t.check=t.flags?yi(t.check,n,h,o-h):wa(t.check,n,h,o-h)),h=l,(t.flags?u:yb(u))!==t.check){r.msg="incorrect data check",t.mode=Kt;break}u=0,c=0}t.mode=gb;case gb:if(t.wrap&&t.flags){for(;c<32;){if(a===0)break e;a--,u+=i[s++]<<c,c+=8}if(u!==(t.total&4294967295)){r.msg="incorrect length check",t.mode=Kt;break}u=0,c=0}t.mode=bb;case bb:E=zP;break e;case Kt:E=Jb;break e;case qb:return $b;case JP:default:return lr}return r.next_out=o,r.avail_out=l,r.next_in=s,r.avail_in=a,t.hold=u,t.bits=c,(t.wsize||h!==r.avail_out&&t.mode<Kt&&(t.mode<jf||e!==Kg))&&Qb(r,r.output,r.next_out,h-r.avail_out),d-=r.avail_in,h-=r.avail_out,r.total_in+=d,r.total_out+=h,t.total+=h,t.wrap&&h&&(r.adler=t.check=t.flags?yi(t.check,n,h,r.next_out-h):wa(t.check,n,h,r.next_out-h)),r.data_type=t.bits+(t.last?64:0)+(t.mode===cn?128:0)+(t.mode===vc||t.mode===Nf?256:0),(d===0&&h===0||e===Kg)&&E===ys&&(E=WP),E},eE=r=>{if(!r||!r.state)return lr;let e=r.state;return e.window&&(e.window=null),r.state=null,ys},tE=(r,e)=>{if(!r||!r.state)return lr;let t=r.state;return(t.wrap&2)===0?lr:(t.head=e,e.done=!1,ys)},iE=(r,e)=>{let t=e.length,i,n,s;return!r||!r.state||(i=r.state,i.wrap!==0&&i.mode!==Ec)?lr:i.mode===Ec&&(n=1,n=wa(n,e,t,0),n!==i.check)?Jb:(s=Qb(r,e,t,t),s?(i.mode=qb,$b):(i.havedict=1,ys))},rE=Xb,nE=Zb,sE=Kb,oE=ZP,aE=Yb,lE=QP,uE=eE,cE=tE,dE=iE,fE="pako inflate (from Nodeca project)",fn={inflateReset:rE,inflateReset2:nE,inflateResetKeep:sE,inflateInit:oE,inflateInit2:aE,inflate:lE,inflateEnd:uE,inflateGetHeader:cE,inflateSetDictionary:dE,inflateInfo:fE};function hE(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var pE=hE,ey=Object.prototype.toString,{Z_NO_FLUSH:mE,Z_FINISH:gE,Z_OK:ka,Z_STREAM_END:zf,Z_NEED_DICT:Vf,Z_STREAM_ERROR:bE,Z_DATA_ERROR:wb,Z_MEM_ERROR:yE}=po;function Ea(r){this.options=Tc.assign({chunkSize:1024*64,windowBits:15,to:""},r||{});let e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(r&&r.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Gb,this.strm.avail_out=0;let t=fn.inflateInit2(this.strm,e.windowBits);if(t!==ka)throw new Error(ms[t]);if(this.header=new pE,fn.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Fa.string2buf(e.dictionary):ey.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=fn.inflateSetDictionary(this.strm,e.dictionary),t!==ka)))throw new Error(ms[t])}Ea.prototype.push=function(r,e){let t=this.strm,i=this.options.chunkSize,n=this.options.dictionary,s,o,a;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?gE:mE,ey.call(r)==="[object ArrayBuffer]"?t.input=new Uint8Array(r):t.input=r,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(i),t.next_out=0,t.avail_out=i),s=fn.inflate(t,o),s===Vf&&n&&(s=fn.inflateSetDictionary(t,n),s===ka?s=fn.inflate(t,o):s===wb&&(s=Vf));t.avail_in>0&&s===zf&&t.state.wrap>0&&r[t.next_in]!==0;)fn.inflateReset(t),s=fn.inflate(t,o);switch(s){case bE:case wb:case Vf:case yE:return this.onEnd(s),this.ended=!0,!1}if(a=t.avail_out,t.next_out&&(t.avail_out===0||s===zf))if(this.options.to==="string"){let l=Fa.utf8border(t.output,t.next_out),u=t.next_out-l,c=Fa.buf2string(t.output,l);t.next_out=u,t.avail_out=i-u,u&&t.output.set(t.output.subarray(l,l+u),0),this.onData(c)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(s===ka&&a===0)){if(s===zf)return s=fn.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};Ea.prototype.onData=function(r){this.chunks.push(r)};Ea.prototype.onEnd=function(r){r===ka&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Tc.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};function Qf(r,e){let t=new Ea(e);if(t.push(r),t.err)throw t.msg||ms[t.err];return t.result}function vE(r,e){return e=e||{},e.raw=!0,Qf(r,e)}var wE=Ea,_E=Qf,FE=vE,kE=Qf,CE=po,SE={Inflate:wE,inflate:_E,inflateRaw:FE,ungzip:kE,constants:CE},{Deflate:DB,deflate:AB,deflateRaw:RB,gzip:BB}=AP,{Inflate:LB,inflate:PE,inflateRaw:OB,ungzip:MB}=SE;var Ia=PE;var Gn=128;var Vl=Le(Je());var wy=Le(py());var gy=Le(my());var Cr=class{constructor(){this.isDisposed=!1;this.#e=null;this.modified=null,this.modifiedAtLoad=null,this.lastLoadedOrSaved=null,this._content=null}#e;get fileContainerStorage(){return this.#e}set fileContainerStorage(e){this.#e=e}get isString(){return this._content!==null&&typeof this._content=="string"}get isBinary(){return this._content===void 0?!1:this._content instanceof Uint8Array}get content(){return this._content}get latestModified(){return this.modified==null?this.modifiedAtLoad:this.modifiedAtLoad==null?null:this.modified.getTime()>this.modifiedAtLoad.getTime()?this.modified:this.modifiedAtLoad}get type(){return S.getTypeFromName(this.name)}get needsSave(){return this.isDisposed&&C.throwIsDisposed(),this.modified!=null&&(this.lastLoadedOrSaved==null||this.modified>=this.lastLoadedOrSaved)}get fullPath(){return this.storageRelativePath}get extendedPath(){let e="";return this.parentFolder.storage.storagePath&&(e=this.parentFolder.storage.storagePath),e+this.fullPath}get storageRelativePath(){return this.parentFolder.storageRelativePath+this.name}getRootRelativePath(){return this.isDisposed&&C.throwIsDisposed(),this.getFolderRelativePath(this.parentFolder.storage.rootFolder)}getFolderRelativePath(e){this.isDisposed&&C.throwIsDisposed();let t=this.parentFolder.getFolderRelativePath(e);if(t!==void 0)return t+this.name}get coreContentLength(){return this.content?this.isBinary||typeof this.content!="string"?this.content.length:this.content.replace(/\s/g,"").length:0}contentWasModified(){this.isDisposed&&C.throwIsDisposed(),this.modified=new Date,this.parentFolder.storage&&this.parentFolder.storage.notifyFileContentsUpdated(this)}async getHash(){if(await this.loadContent(!1),!(this._content===void 0||this._content===null))return gy.default.base64(this._content)}unload(){this._content=null,this.lastLoadedOrSaved=null}dispose(){this.manager=void 0,this._content=null,this.lastLoadedOrSaved=null,this.isDisposed=!0}async exists(){return this.isDisposed&&C.throwIsDisposed(),await this.loadContent(!1),this._content!==null}getRelativePathFor(e){if(e.parentFolder.storage!==this.parentFolder.storage)return;let t={},i=e.parentFolder;for(;i;)t[i.storageRelativePath]=i,i=i.parentFolder;let n=this.parentFolder,s="."+n.storage.folderDelimiter;for(;n&&t[n.storageRelativePath]===void 0;)s+=".."+n.storage.folderDelimiter,n=n.parentFolder;if(!n)return;let o=e.getFolderRelativePath(n);if(o)return s+S.ensureNotStartsWithDelimiter(o)}};var bo=class extends Cr{get name(){return this._name}get fullPath(){return S.ensureEndsWithDelimiter(this._parentFolder.fullPath)+this.name}get parentFolder(){return this._parentFolder}get isContentLoaded(){return this.lastLoadedOrSaved!=null||this.modified!=null}updateZipNativeFile(e){this._jszipo=e}constructor(e,t,i){super(),this._jszipo=i,this._parentFolder=e,this._name=t,this.modified=null,this.lastLoadedOrSaved=null}async deleteThisFile(e){throw new Error("Not implemented.")}async moveTo(e){throw new Error("Not implemented.")}async loadContent(e,t){return(e||!this.lastLoadedOrSaved)&&(this._jszipo!==null&&((t??S.getEncodingByFileName(this.name))===0?(this._content=await this._jszipo.async("uint8array"),C.assert(this._content!==null,"Unexpectedly could not load content.")):this._content=await this._jszipo.async("string")),this.lastLoadedOrSaved=new Date),this.lastLoadedOrSaved}setContent(e){S.contentsAreEqual(this._content,e)||(this.lastLoadedOrSaved||(this.lastLoadedOrSaved=new Date,this.lastLoadedOrSaved=new Date(this.lastLoadedOrSaved.getTime()-1)),this._content=e,this.contentWasModified(),this._parentFolder.storage.modified=this.modified)}async saveContent(e){if(this.parentFolder.storage.readOnly)throw new Error("Can't save read-only file.");return(this.needsSave||e===!0)&&(this.lastLoadedOrSaved=new Date,this.content!==null&&(this._parentFolder.storage.modified=this.modified,this._parentFolder.zip=this._parentFolder.zip.file(this.name,this.content))),this.lastLoadedOrSaved===null&&(this.lastLoadedOrSaved=new Date),this.lastLoadedOrSaved}};var gh=Symbol("singleComment"),yy=Symbol("multiComment"),B=class r{static{this.defaultEncoding="UTF-8"}static{this.replacementChar=65533}static async sleep(e){return new Promise(t=>{setTimeout(t,e)})}static get isPreview(){return!1}static get isAppSim(){return!1}static get isDebug(){return r._isDebug===void 0&&(r._isDebug=!1),r._isDebug}static removeItemInArray(e,t){let i=[];for(let n of t)n!==e&&i.push(n);return i}static isArrayNonNegative(e){for(let t of e)if(t<0)return!1;return!0}static arrayHasNegativeAndIsNumeric(e){let t=!1;for(let i of e){if(typeof i!="number")return!1;i<0&&(t=!0)}return t}static encodeObjectWithSequentialRunLengthEncodeUsingNegative(e){for(let t in e){let i=e[t];if(i!==void 0){if(typeof i=="object"&&!Array.isArray(i))this.encodeObjectWithSequentialRunLengthEncodeUsingNegative(i);else if(Array.isArray(i)){let n=!0;for(let s of i)if(typeof s!="number"){n=!1;break}n&&(e[t]=this.encodeSequentialRunLengthUsingNegative(i))}}}}static decodeSequentialRunLengthUsingNegative(e){if(this.isArrayNonNegative(e))return e;let t=[];t.push(e[0]);for(let i=1;i<e.length;i++)if(e[i]<0){let n=e[i-1];for(let s=0;s<Math.abs(e[i]);s++)n++,t.push(n)}else t.push(e[i]);return t}static encodeSequentialRunLengthUsingNegative(e){if(!this.isArrayNonNegative(e))return e;e.sort();let t=[];t.push(e[0]);let i=-1;for(let n=1;n<e.length;n++)e[n]===e[n-1]+1?i<1?i=1:i++:(i>=1&&(t.push(-i),i=-1),t.push(e[n]));return i>=1&&(t.push(-i),i=-1),t}static trimEllipsis(e,t){return e.length>t&&(e=e.substring(0,t-1)+"\u2026"),e}static makeHashFileSafe(e){return e=e.replace(/\//gi,"-S"),e=e.replace(/\+/gi,"-P"),e=e.replace(/\\/gi,"-B"),e=e.replace(/=/gi,"-E"),e=e.replace(/,/gi,"-C"),e}static getSimpleNumeric(e){return e===void 0?"":e<1e3?e.toString():e<1e3?Math.floor(e/100)/10+"k":e>1e6?Math.floor(e/1e5)/10+"m":Math.floor(e/1e3)+"k"}static humanifyJsName(e){if(typeof e=="boolean"||typeof e=="number")return e.toString();let t="";for(let i=0;i<e.length;i++)i===0?t+=e[i].toUpperCase():(e[i]>="A"&&e[i]<="Z"&&(t+=" "),t+=e[i]);return t=t.replace("Java Script","JavaScript"),t}static humanifyObject(e){return typeof e=="object"?e=JSON.stringify(e,void 0,2):e=e.toString(),e=e.trim(),e.startsWith("[")&&e.endsWith("]")&&(e=e.substring(1,e.length-1),e=e.replace(/"/gi,"")),e.startsWith("{")&&e.endsWith("}")&&(e=e.substring(1,e.length-1)),e}static ensureLooksLikeSentence(e){return e.length>1&&e[0]>="a"&&e[0]<="z"&&(e=e[0].toUpperCase()+e.substring(1,e.length)),e.endsWith(".")||(e=e+"."),e}static humanifyMinecraftName(e){if(typeof e=="boolean"||typeof e=="number")return e.toString();e.endsWith(".behavior")?e=e.substring(0,e.length-9):e.endsWith(".geo")?e=e.substring(0,e.length-4):e.endsWith(".entity")&&(e=e.substring(0,e.length-7));let t=e.indexOf(":");t>=0&&e.substring(0,t)==="minecraft"&&(e=e.substring(t+1));let i=e.indexOf("["),n=e.indexOf("]");i>=0&&n>i&&(e=e.substring(0,i)+e.substring(n+1)),e.endsWith(".")&&(e=e.substring(0,e.length-1)),e=e.replace(/[_]/gi," "),e.endsWith("_bit")&&(e=e.substring(0,e.length-4)),e=e.replace(/::/gi," "),e=e.replace(/:/gi," ");let s=e.indexOf(".");s>=4&&(e=e.substring(s+1)+" "+e.substring(0,s));let o=!1;for(let a=0;a<e.length;a++)e[a]===" "?o=!0:((o||a===0)&&e[a]>="a"&&e[a]<="z"&&(e=e.substring(0,a)+e[a].toUpperCase()+e.substring(a+1)),o=!1);return e}static stringFormat(e,...t){var i=arguments;return arguments[0].replace(/{(\d+)}/g,function(n,s){try{let o=parseInt(s);if(!isNaN(o))return i[o+1]!==void 0?i[o+1]:n}catch{}return n})}static convertToHexString(e){return Array.from(e,function(t){return("0"+(t&255).toString(16)).slice(-2)}).join("")}static countSignificantLines(e){if(e.length<=0)return 0;let t=1,i=0,n=e.indexOf(`
`);for(;n>=i;)e.substring(i,n).trim().length>1&&t++,i=n+1,n=e.indexOf(`
`,i);return t}static stripLinesContaining(e,t){let i=e.indexOf(t);for(;i>=0;){let n=e.lastIndexOf(`
`,i);n<0&&(n=0);let s=e.indexOf(`
`,i);s<0&&(s=e.length),e=e.substring(0,n)+e.substring(s,e.length),i=e.indexOf(t)}return e}static{this.stripWithoutWhitespace=()=>""}static{this.stripWithWhitespace=(e,t,i)=>e.slice(t,i).replace(/\S/g," ")}static replaceJsonValue(e,t,i){let n=e.indexOf('"'+t+'":');for(;n>=0;){let s=e.indexOf('"',n+t.length+3);if(s>n+t.length+2&&s<n+t.length+7){let o=e.indexOf('"',s+1);o>s&&(e=e.substring(0,s+1)+i+e.substring(o))}n=e.indexOf('"'+t+'":',n+t.length+2)}return e}static makeJsonVersionAgnostic(e){return e=r.replaceJsonValue(e,"generatorVersion","TESTSUB"),e=r.replaceJsonValue(e,"uuid","TESTSUB"),e}static isEscaped(e,t){let i=t-1,n=0;for(;e[i]==="\\";)i-=1,n+=1;return!!(n%2)}static fixJsonContent(e,{whitespace:t=!0,trailingCommas:i=!1}={}){if(typeof e!="string")throw new TypeError(`Expected argument \`jsonString\` to be a \`string\`, got \`${typeof e}\``);let n=t?r.stripWithWhitespace:r.stripWithoutWhitespace,s=!1,o=!1,a=0,l="",u="",c=-1;for(let h=0;h<e.length;h++){let f=e[h],m=e[h+1];if(!o&&f==='"'&&(r.isEscaped(e,h)||(s=!s)),s){(f==="\r"||f===`
`||f==="	")&&(e=e.substring(0,h)+" "+e.substring(h+1));continue}if(!o&&f+m==="//")l+=e.slice(a,h),a=h,o=gh,h++;else if(o===gh&&f+m===`\r
`){h++,o=!1,l+=n(e,a,h),a=h;continue}else if(o===gh&&f===`
`)o=!1,l+=n(e,a,h),a=h;else if(!o&&f+m==="/*"){l+=e.slice(a,h),a=h,o=yy,h++;continue}else if(o===yy&&f+m==="*/"){h++,o=!1,l+=n(e,a,h+1),a=h+1;continue}else i&&!o&&(c!==-1?f==="}"||f==="]"?(l+=e.slice(a,h),u+=n(l,0,1)+l.slice(1),l="",a=h,c=-1):f!==" "&&f!=="	"&&f!=="\r"&&f!==`
`&&(l+=e.slice(a,h),a=h,c=-1):f===","&&(u+=l+e.slice(a,h),l="",a=h,c=h))}let d=u+l+(o?n(e.slice(a),void 0,void 0):e.slice(a));return d=d.replace(/,(\s*)]/g,"]"),d=d.replace(/,(\s*)}/g,"}"),d}static setIsDebug(e){r._isDebug=e}static getBaseUrl(e){if(e.length<8)return e;let t=e.indexOf("/",9);return t<0?e:e.substring(0,t)}static getDateStr(e){let t=r.frontPadToLength(e.getFullYear(),4,"0");return t+=r.frontPadToLength(e.getMonth()+1,2,"0"),t+=r.frontPadToLength(e.getDate(),2,"0"),t+=r.frontPadToLength(e.getHours(),2,"0"),t+=r.frontPadToLength(e.getMinutes(),2,"0"),t+=r.frontPadToLength(e.getSeconds(),2,"0"),t}static getDateFromStr(e){if(!r.isNumeric(e)||e.length!==14)throw new Error("Improperly formatted date string: "+e);let t=parseInt(e.substring(0,4)),i=parseInt(e.substring(4,6)),n=parseInt(e.substring(6,8)),s=parseInt(e.substring(8,10)),o=parseInt(e.substring(10,12)),a=parseInt(e.substring(12,14));return C.assert(t>=2022,"Invalid year: "+e),C.assert(i>=1&&i<=12,"Invalid month: "+e),C.assert(n>=0&&n<=31,"Invalid day: "+e),C.assert(s>=0&&s<=23,"Invalid hours: "+e),C.assert(o>=0&&o<=59,"Invalid minutes: "+e),C.assert(a>=0&&a<=59,"Invalid seconds: "+e),new Date(t,i-1,n,s,o,a)}static{this.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"]}static{this.monthShortNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}static lengthOfDictionary(e){let t=0;for(let i in e)i&&++t;return t}static makeSafeForJson(e){return e=e.replace(/\\/g,"/"),e=e.replace(/"/gi,"'"),e}static isAlphaNumeric(e){for(let t=0;t<e.length;t++){let i=e[t];if(!(i>="0"&&i<="9"||i>="a"&&i<="z"||i>="A"&&i<="Z"))return!1}return!0}static getJsonObject(e){let t;e=r.fixJsonContent(e);try{t=JSON.parse(e)}catch(i){C.fail("Could not parse JSON: "+i.message)}return t}static appendErrors(e,t,i){if(t.isInErrorState&&(e.isInErrorState=!0,t.errorMessages)){e.errorMessages===void 0&&(e.errorMessages=[]);for(let n of t.errorMessages){let s;i?s=n.context?i+": "+n.context:i:s=n.context,e.errorMessages.push({message:n.message,context:s})}}}static isNumeric(e){for(let t=0;t<e.length;t++){let i=e[t];if((i<"0"||i>"9")&&i!=="."&&(t>0||i!=="-"))return!1}return!0}static isNumericIsh(e){for(let t=0;t<e.length;t++){let i=e[t];if((i<"0"||i>"9")&&i!=="e"&&i!=="+"&&i!==","&&i!=="."&&i!=="-")return!1}return!0}static removeQuotes(e){return e=e.trim(),e.startsWith('"')?e=e.substring(1):e.startsWith('"')&&(e=e.substring(0,e.length-1)),e}static normalizeVersionString(e){return e=e.replace(/v/gi,"").trim(),e=e.trim(),e.startsWith(".")&&(e="0"+e),e.endsWith(".")&&(e=e.substring(0,e.length-1)),e}static isVersionString(e){for(let t=0;t<e.length;t++){let i=e[t];if((i<"0"||i>"9")&&i!=="."&&i!=="v")return!1}return!0}static isAlpha(e){for(let t=0;t<e.length;t++){let i=e[t];if(!(i>="a"&&i<="z"||i>="A"&&i<="Z"))return!1}return!0}static shallowCloneArray(e){let t=new Array(e.length);for(let i=0;i<e.length;i++)t[i]=e[i];return t}static uint8ArrayToBase64(e){let t="",i=e.byteLength;for(var n=0;n<i;n++)t+=String.fromCharCode(e[n]);return Ne.isWeb||Ne.hostType===5||Ne.hostType===6?btoa(t):Buffer.from(t).toString("base64")}static arrayBufferToBase64(e){let t="",i=new Uint8Array(e),n=i.byteLength;for(var s=0;s<n;s++)t+=String.fromCharCode(i[s]);return Ne.isWeb||Ne.hostType===5||Ne.hostType===6?btoa(t):Buffer.from(t).toString("base64")}static base64ToArrayBuffer(e){let t=e.indexOf(";base64,");t>0&&t<50&&(e=e.substring(t+8));let i=atob(e),n=new ArrayBuffer(i.length),s=new Uint8Array(n),o=i.length;for(var a=0;a<o;a++)s[a]=i.charCodeAt(a);return n}static base64ToUint8Array(e){let t=e.indexOf(";base64,");t>0&&t<50&&(e=e.substring(t+8));let i=atob(e),n=new ArrayBuffer(i.length),s=new Uint8Array(n),o=i.length;for(var a=0;a<o;a++)s[a]=i.charCodeAt(a);return s}static{this._utf8ReadChar=function(e,t,i,n){let s=t.getUint8(i);if(e.bytesRead=1,e.charVal=0,s&128){for(var o=0,a=s;a&128;)o++,a<<=1;if(o===1){e.charVal=r.replacementChar;return}if(o>n){e.charVal=r.replacementChar;return}e.charVal=s&255>>o+1;for(var l=1;l<o;l++){if(a=t.getUint8(i+l),(a&192)!==128){console.error("UTF-8 read - attempted to read "+o+" byte character, found non-continuation at byte "+l),e.charVal=r.replacementChar,e.bytesRead=1;return}if(e.charVal<<=6,e.charVal|=a&63,l===1){let u=8-(o+1)-1;if(e.charVal>>u===0){e.charVal=r.replacementChar,e.bytesRead=1;return}}e.bytesRead++}if(e.charVal>1114111){console.error("UTF-8 read - found illegally high code point "+e.charVal),e.charVal=r.replacementChar,e.bytesRead=1;return}}else e.charVal=s}}static canonicalizeId(e){return e.toLowerCase()}static readStringUTF8(e,t,i){let n=typeof i>"u";var s=t||0;if(!n&&s+i>e.byteLength)throw new Error("Attempted to read "+(s+i-e.byteLength)+" bytes past end of buffer");var o="";let a={bytesRead:0,charVal:0};for(;s<e.byteLength&&(n||i>s-t)&&(r._utf8ReadChar(a,e,s,n?e.byteLength-(s+t):i-(s-t)),s+=a.bytesRead,!(n&&!a.charVal));)o+=String.fromCharCode(a.charVal);return{str:o,byteLength:s-t}}static readStringASCII(e,t,i){var n="",s=0;t=t||0;var o=!1;typeof i>"u"&&(o=!0,i=e.byteLength-e.byteOffset);for(var a,l=0;l<i&&(a=e.getUint8(l+t),!(a===0&&o));l++)n+=String.fromCharCode(a),s++;return{str:n,byteLength:s+(o?1:0)}}static readStringASCIIBuffer(e,t,i){var n="";t=t||0;var s=!1;typeof i>"u"&&(s=!0,i=e.byteLength-e.byteOffset);for(var o,a=0;a<i&&(o=e[a+t],!(o===0&&s));a++)n+=String.fromCharCode(o);return n}static _createUtf8Char(e,t){if(e<128)t.push(e);else{let s=[127,2047,65535,2097151],o=0;for(;;){if(o++,o===s.length){r._createUtf8Char(r.replacementChar,t);return}if(e<=s[o]){o+=1;var i=0,n;for(n=0;n<o;n++)i<<=1,i|=1;for(i<<=8-o,i|=e>>6*(o-1),t.push(i),n=1;n<o;n++)i=128,i|=e>>6*(o-(n+1))&191,t.push(i);return}}}}static convertStringToBytes(e,t){if(t==="UTF-8"){let i=[];for(let n=0;n<e.length;n++)r._createUtf8Char(e.charCodeAt(n),i);return i}else if(t==="ASCII"){let i=[];for(let n=0;n<e.length;n++){let s=e.charCodeAt(n);s>255&&(s=63),i.push(s)}return i}throw new Error}static ensureNotStartsWithSlash(e){for(;e.startsWith("/");)e=e.substring(1);return e}static ensureStartsWithSlash(e){return e.startsWith("/")||(e="/"+e),e}static ensureEndsWithSlash(e){return e.endsWith("/")||(e+="/"),e}static ensureNotEndsWithSlash(e){for(;e.length>0&&e.endsWith("/");)e=e.substring(0,e.length-1);return e}static ensureStartsWithBackSlash(e){return e.startsWith("\\")||(e="\\"+e),e}static ensureEndsWithBackSlash(e){return e.endsWith("\\")||(e+="\\"),e}static replaceAll(e,t,i){let n=e.indexOf(t);for(;n>=0;)e=e.substring(0,n)+i+e.substring(n+t.length),n=e.indexOf(t,n+i.length);return e}static replaceAllExceptInLines(e,t,i,n){let s=e.indexOf(t);for(;s>=0;){let o=!0,a=e.lastIndexOf(`
`,s);if(a>=0){let l=e.lastIndexOf(`
`,a-1);l>=0&&(a=l);let u=e.substring(a,s);for(let c of n)u.indexOf(c)>0&&(o=!1)}o?(e=e.substring(0,s)+i+e.substring(s+t.length),s=e.indexOf(t,s+i.length)):s=e.indexOf(t,s+1)}return e}static createRandomId(e){let t="";for(let i=0;i<e;i++){let n=Math.random()*6;n<1?t+=String.fromCharCode(Math.floor(Math.random()*10)+48):n<4?t+=String.fromCharCode(Math.floor(Math.random()*26)+65):t+=String.fromCharCode(Math.floor(Math.random()*26)+97)}return t}static canonicalizeUuid(e){return e.trim().toLowerCase()}static isValidUuid(e){return e.length===36}static uuidEqual(e,t){return r.canonicalizeId(e)===r.canonicalizeId(t)}static createUuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let i=Ne.generateCryptoRandomNumber(16)|0;return(e==="x"?i:i&3|8).toString(16)})}static uint8ArraysAreEqual(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}static throwIfUint8ArraysNotEqual(e,t){if(e.length!==t.length)throw new Error("Arrays are of mismatched length.");for(let i=0;i<e.length;i++)if(e[i]!==t[i])throw new Error("Mismatch at position "+i+" value A: "+e[i]+" value B:"+t[i])}static getString(e,t,i,n){if(n==="UTF8"||n===void 0){let s=r.readStringUTF8(e,t,i);return C.assert(s.byteLength===i,"UTGS"),s.str}else if(n==="ASCII")return r.readStringASCII(e,t,i).str}static getSimpleString(e){return e=e.trim(),e=e.replace(/ /gi,""),e=e.replace(/=/gi,""),e=e.replace(/\?/gi,""),e}static getAsciiString(e,t,i,n){return r.readStringASCII(e,t,i).str}static getAsciiStringFromBytes(e){let t="";for(let i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);return t}static getAsciiStringFromUint8Array(e){let t="";for(let i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);return t}static writeString(e,t,i,n){let s=r.convertStringToBytes(i,n);if(s===void 0)return t;let o=0;for(o=0;o<s.length&&t+o<e.byteLength;o++)e.setUint8(t+o,s[o]);return t+o}static frontPadToLength(e,t,i){for(e=e+"";e.length<t;)e=i+e;return e}static getShortYear(e){let t=e+"";return t.length===4&&(t=t.substring(2,4)),t}static getFriendlySummary(e){(e===void 0||!(e instanceof Date))&&C.fail("Empty/wrong-typed date passed in.");let t=this.monthShortNames[e.getMonth()]+" "+r.frontPadToLength(e.getDate(),2,"0"),i=new Date;if(e.getFullYear()!==i.getFullYear())t+=" "+this.getShortYear(e.getFullYear());else{let n=e.getHours()%12;n===0&&(n=12),t+=" "+r.frontPadToLength(n,2,"0")+":"+r.frontPadToLength(e.getMinutes(),2,"0")}return t}static getFriendlySummarySeconds(e){return(e===void 0||!(e instanceof Date))&&C.fail("Empty/wrong-typed date passed in."),this.monthShortNames[e.getMonth()]+" "+r.frontPadToLength(e.getDate(),2,"0")+" "+this.getShortYear(e.getFullYear())+" "+r.frontPadToLength(e.getHours(),2,"0")+r.frontPadToLength(e.getMinutes(),2,"0")+"."+r.frontPadToLength(e.getSeconds(),2,"0")}static getFileFriendlySummarySeconds(e){return(e===void 0||!(e instanceof Date))&&C.fail("Empty/wrong-typed date passed in."),r.frontPadToLength(e.getMonth()+1,2,"0")+"-"+r.frontPadToLength(e.getDate(),2,"0")+"-"+r.frontPadToLength(e.getHours(),2,"0")+r.frontPadToLength(e.getMinutes(),2,"0")+r.frontPadToLength(e.getSeconds(),2,"0")}static getDateSummary(e){return e.getMonth()+1+"."+e.getDate()+"."+(e.getFullYear()-2e3)+"."+e.getHours()+"."+e.getMinutes()+"."+e.getSeconds()}static countChar(e,t){let i=0,n=e.indexOf(t);for(;n>=0;)i++,n=e.indexOf(t,n+t.length);return i}static isString(e){return typeof e=="string"}static isNullOrUndefined(e){return e==null}};var xa=class{constructor(e){this.folderStack=[];this.folderFileIndices=[];this.folderFolderIndices=[];this.currentDepth=0;this.folderStack[0]=e,this.folderFileIndices[0]=0,this.folderFolderIndices[0]=0}async next(){for(;this.currentDepth>=0;)if(this.folderFileIndices[this.currentDepth]===0&&this.folderFolderIndices[this.currentDepth]===0&&await this.folderStack[this.currentDepth].load(!1),this.folderFileIndices[this.currentDepth]<this.folderStack[this.currentDepth].fileCount){let e=this.getNthFile(this.folderStack[this.currentDepth],this.folderFileIndices[this.currentDepth]);if(e)return this.folderFileIndices[this.currentDepth]++,{value:e,done:!1};throw new Error}else if(this.folderFolderIndices[this.currentDepth]<this.folderStack[this.currentDepth].folderCount){let e=this.getNthFolder(this.folderStack[this.currentDepth],this.folderFolderIndices[this.currentDepth]);if(this.folderFolderIndices[this.currentDepth]++,this.currentDepth++,e)this.folderFileIndices[this.currentDepth]=0,this.folderFolderIndices[this.currentDepth]=0,this.folderStack[this.currentDepth]=e;else throw new Error}else this.currentDepth--;return{value:void 0,done:!0}}getNthFile(e,t){let i=0;for(let n in e.files){if(i===t)return e.files[n];i++}}getNthFolder(e,t){let i=0;for(let n in e.folders){if(i===t)return e.folders[n];i++}}};var yh=Le(Je()),Sr=class{constructor(){this.isDisposed=!1;this.#r=new yh.EventDispatcher;this.#i=new yh.EventDispatcher;this.#e=null}get ensuredName(){return this.name}#e;#r;#i;get onFolderMoved(){return this.#r.asEvent()}get onChildFolderMoved(){return this.#i.asEvent()}get isLoaded(){return this.#e!==null}get allFiles(){let e=this;return{[Symbol.asyncIterator](){return new xa(e)}}}get folderCount(){let e=0;for(let t in this.folders)e++;return e}get fileCount(){let e=0;for(let t in this.files)e++;return e}get storageRelativePath(){return this.parentFolder===null?"/":this.parentFolder.storageRelativePath+this.name+"/"}get lastLoadedOrSaved(){return this.#e}get fullPath(){return this.storageRelativePath}get extendedPath(){let e="";this.storage.storagePath&&(e=this.storage.storagePath);let t=e+this.fullPath;return t.endsWith(this.storage.folderDelimiter)||(t+=this.storage.folderDelimiter),t}updateLastLoadedOrSaved(){this.#e=new Date}getFolderRelativePath(e){if(e.storage!==this.storage&&this.storage.storagePath){let t=e.storageRelativePath;return t&&this.extendedPath&&this.extendedPath.startsWith(t)&&S.ensureEndsWithDelimiter(t)?this.extendedPath.substring(t.length-1):this.extendedPath}else{if(this===e)return"/";if(this.parentFolder===null)return;{let t=this.parentFolder.getFolderRelativePath(e);return t===void 0?void 0:t+this.name+"/"}}}dispose(){if(this.manager=void 0,this.folders)for(let e in this.folders){let t=this.folders[e];t&&(t.dispose(),this.folders[e]=void 0)}if(this.files)for(let e in this.files){let t=this.files[e];t&&(t.dispose(),this.files[e]=void 0)}this.isDisposed=!0}async setStructureFromFileList(e){this.updateLastLoadedOrSaved();for(let t of e){let i=S.getFolderPath(t);if(i){if(i=S.ensureEndsDelimited(i),i.length>2){let n=await this.ensureFolderFromRelativePath(i,!0);n.updateLastLoadedOrSaved();let s=n.parentFolder;for(;s&&s!==this;)s.updateLastLoadedOrSaved(),s=s.parentFolder}await this.ensureFileFromRelativePath(t,!0)}}}isSameFolder(e){return S.canonicalizePath(e)===S.canonicalizePath(this.storageRelativePath)}_addExistingFolder(e){let t=S.canonicalizeName(e.name);this.folders[t]=e}_clearExistingFolder(e){let t=S.canonicalizeName(e.name);this.folders[t]=void 0}folderExists(e){this.isDisposed&&C.throwIsDisposed();let t=S.canonicalizeName(e);return!B.isNullOrUndefined(this.folders[t])}fileExists(e){this.isDisposed&&C.throwIsDisposed();let t=S.canonicalizeName(e);return!B.isNullOrUndefined(this.files[t])}async deleteFileFromRelativePath(e){e=this.canonicalizePath(e);let t=await this.getFileFromRelativePath(e);return t!==void 0?await t.deleteThisFile():!1}canonicalizePath(e){return e.replace(/\\/g,"/")}async getFileFromRelativePath(e){if(this.isDisposed&&C.throwIsDisposed(),e.length<2)throw Error("Path is too short.");if(e=this.canonicalizePath(e),e[0]!=="/")throw Error("Storage relative path '"+e+"' is not in the right format.");await this.ensureExists(),await this.load(!1);let t=e.indexOf("/",1);if(t<0){let i=e.substring(1,e.length);return this.files[S.canonicalizeName(i)]}else{let i=e.substring(1,t),n=this.folders[S.canonicalizeName(i)];return n?.getFileFromRelativePath(e.substring(t,e.length))}}clearAllManagers(){this.manager&&(this.manager=void 0);for(let e in this.files){let t=this.files[e];t&&(t.manager=void 0)}for(let e in this.folders){let t=this.folders[e];t&&t.clearAllManagers()}}async getFolderFromRelativePath(e){if(this.isDisposed&&C.throwIsDisposed(),e==="/"||e==="\\")return this;if(e.length<2)throw Error("Path is too short.");if(e=this.canonicalizePath(e),e[0]!=="/")throw Error("Storage relative path '"+e+"' is not in the right format.");await this.ensureExists(),await this.load(!1);let t=e.indexOf("/",1);if(t<0){let i=e.substring(1,e.length);return this.folders[S.canonicalizeName(i)]}else{let i=e.substring(1,t);i=S.canonicalizeName(i);let n=this.folders[i];if(n==null)return;let s=e.substring(t,e.length);return s==="/"||s==="\\"?n:await n.getFolderFromRelativePath(s)}}getFolderByIndex(e){let t=0;for(let i in this.folders){let n=this.folders[i];if(n&&t===e)return n;n&&t++}}getSummary(){let e="P: "+this.fullPath+" FO:";for(let t in this.folders)e+=" "+t;e+=" FI:";for(let t in this.files)e+=" "+t;return e}getFolderFromRelativePathLocal(e){if(this.isDisposed&&C.throwIsDisposed(),e==="/"||e==="\\")return this;if(e.length<2)throw Error("Path is too short.");if(e=this.canonicalizePath(e),e[0]!=="/")throw Error("Storage relative path '"+e+"' is not in the right format.");let t=e.indexOf("/",1);if(t<0){let i=e.substring(1,e.length);return this.folders[S.canonicalizeName(i)]}else{let i=e.substring(1,t),n=this.folders[S.canonicalizeName(i)];if(n==null){if(i.endsWith("#")){let o=this.files[S.canonicalizeName(i.substring(0,i.length-1))];o&&o.fileContainerStorage&&(n=o.fileContainerStorage.rootFolder)}if(n==null)return}let s=e.substring(t,e.length);return s==="/"||s==="\\"?n:n.getFolderFromRelativePathLocal(s)}}async saveAll(e){this.isDisposed&&C.throwIsDisposed();for(let t in this.files){let i=this.files[t];i!==void 0&&(i.needsSave||e)&&await i.saveContent(e)}for(let t in this.folders){let i=this.folders[t];i!==void 0&&!i.errorStatus&&await i.saveAll(e)}return!0}async ensureFolderFromRelativePath(e,t){if(this.isDisposed&&C.throwIsDisposed(),e==="/"||e==="\\")return this;if(e.startsWith("./")&&(e=e.substring(1)),e=this.canonicalizePath(e),e[e.length-1]!=="/"&&(e=e+"/"),e[0]!=="/")throw Error("Storage relative path '"+e+"' is not in the right format.");t||(await this.ensureExists(),await this.load(!1));let i=e.indexOf("/",1);if(i<0)throw new Error("Unexpected path format error");{let n=e.substring(1,i),s=this.ensureFolder(n);return i===e.length-1?s:s.ensureFolderFromRelativePath(e.substring(i,e.length),t)}}async ensureFileFromRelativePath(e,t){if(this.isDisposed&&C.throwIsDisposed(),e.length<2)throw Error("Path is too short.");if(e=this.canonicalizePath(e),e[0]!=="/")throw Error("Storage relative path '"+e+"' is not in the right format.");await this.ensureExists(),t||await this.load(!1);let i=e.indexOf("/",1);if(i<0)return this.ensureFile(e.substring(1,e.length));{let n=e.substring(1,i);return await this.ensureFolder(n).ensureFileFromRelativePath(e.substring(i,e.length),t)}}async deleteFile(e){let t=S.canonicalizeName(e),i=this.files[t];return i!==void 0?await i.deleteThisFile():(this.files[t]=void 0,!1)}removeFolder(e){let t=S.canonicalizeName(e),i=this.folders[t]!==void 0;return this.folders[t]=void 0,i}async rename(e){let t=e;return this.parentFolder!==null&&(t=this.storage.joinPath(this.parentFolder.storageRelativePath,t)),await this.moveTo(t)}async recursiveDeleteThisFolder(){let e=await this.recursiveDeleteContentsOfThisFolder();return this.removeMeFromParent(),e}async recursiveDeleteContentsOfThisFolder(){let e=!0;await this.load(!0);for(let t in this.folders){let i=this.folders[t];i&&(await i.deleteThisFolder()||(e=!1))}for(let t in this.files){let i=this.files[t];i&&(await i.deleteThisFile(!0)||(e=!1))}return e}notifyFolderMoved(e){this.#r.dispatch(this,e),this.parentFolder&&this.parentFolder.notifyChildFolderMoved(e),this.storage.notifyFolderMoved(e)}notifyChildFolderMoved(e){this.#i.dispatch(this,e),this.parentFolder&&this.parentFolder.notifyChildFolderMoved(e)}removeMeFromParent(){this.parentFolder&&this.parentFolder.removeFolder(this.name)}};var Ta=class r extends Sr{get ensuredName(){if(this.name.length>0)return this.name;if(this.storage.name){let e=this.storage.name,t=e.lastIndexOf(".");return t>0&&(e=e.substring(0,t)),e}return"folder"}get zip(){return this._jsz}set zip(e){this._jsz=e}get storage(){return this._storage}get parentFolder(){return this._parentFolder}get name(){return this._name}get fullPath(){return this.parentFolder?S.ensureEndsWithDelimiter(this._parentPath)+this.name:"/"}constructor(e,t,i,n,s){super(),this._jsz=t,this._storage=e,this._parentFolder=i,this._parentPath=n,this._name=s,this.folders={},this.files={}}async exists(){return!0}async ensureExists(){return!0}ensureFile(e){let t=S.canonicalizeName(e),i=this.files[t];if(i==null){let n=this._jsz.file(e);i=new bo(this,e,n),this.files[t]=i}return i}async moveTo(e){throw new Error("Not implemented.")}ensureFolder(e){let t=S.canonicalizeName(e),i=this.folders[t];if(!i){let n=this._jsz.folder(e);if(n==null)throw new Error("unexpected inability to create a zip file folder");i=new r(this._storage,n,this,this.fullPath,e),this.folders[t]=i}return i}async deleteFile(e){throw new Error("Deletion of file not supported")}async deleteThisFolder(){throw new Error("Deletion of this folder "+this.fullPath+" is not supported.")}async deleteAllFolderContents(){throw new Error("Deletion of all folder contents at "+this.fullPath+" is not supported.")}async createFile(e){return this.ensureFile(e)}async load(e){return this.lastLoadedOrSaved!=null&&!e?this.lastLoadedOrSaved:(this.updateLastLoadedOrSaved(),this._jsz.forEach((t,i)=>{t=t.replace(/\\/gi,yt.slashFolderDelimiter);let n=B.countChar(t,yt.slashFolderDelimiter);if(n===0){let s=S.canonicalizeName(t),o=this.files[s];o==null&&S.isUsableFile(S.getLeafName(t))&&(o=new bo(this,t,i),this.files[s]=o)}else if(n>=1){let s=this,o=t;o.startsWith("/")&&(o=o.substring(1));let a=o.indexOf(yt.slashFolderDelimiter);for(;a>0;)s=s.ensureFolder(o.substring(0,a)),o=o.substring(a+1),a=o.indexOf(yt.slashFolderDelimiter);o.length>0&&i&&(C.assert(!i.dir,"Unexpected non directory file."),s.ensureFile(o).updateZipNativeFile(i))}}),this.lastLoadedOrSaved)}};var Da=Le(Je()),Ni=class r{constructor(){this.isContentUpdated=!1;this.readOnly=!1;this.#e=new Da.EventDispatcher;this.#r=new Da.EventDispatcher;this.#i=new Da.EventDispatcher;this.#_=new Da.EventDispatcher}static{this.slashFolderDelimiter="/"}get folderDelimiter(){return r.slashFolderDelimiter}#e;#r;#i;#_;#C;get storagePath(){return this.#C}set storagePath(e){this.#C=e}resetContentUpdated(){this.isContentUpdated=!1}get onFileAdded(){return this.#e.asEvent()}get onFileRemoved(){return this.#r.asEvent()}get onFileContentsUpdated(){return this.#i.asEvent()}get onFolderMoved(){return this.#_.asEvent()}async ensureFolderFromStorageRelativePath(e){return e.startsWith("/"+this.rootFolder.name+"/")&&(e=e.substring(this.rootFolder.name.length+1)),this.rootFolder.ensureFolderFromRelativePath(e)}notifyFileAdded(e){this.#e.dispatch(this,e)}notifyFileContentsUpdated(e){this.isContentUpdated=!0,this.#i.dispatch(this,e)}notifyFolderMoved(e){this.isContentUpdated=!0,this.#_.dispatch(this,e)}notifyFileRemoved(e){this.#r.dispatch(this,e)}joinPath(e,t){let i=e;return i.endsWith(r.slashFolderDelimiter)||(i+=r.slashFolderDelimiter),i+=t,i}static getParentFolderPath(e){let t=e.lastIndexOf(r.slashFolderDelimiter);return t<0?e:e.substring(0,t)}};var yt=class _ZipStorage extends Ni{constructor(){super();this.modified=null;this.lastLoadedOrSaved=null;_ZipStorage.zipFixup(),this._jsz=new wy.default,this.rootFolder=new Ta(this,this._jsz,null,"","")}get updatedSinceLoad(){return this.modified===null||this.lastLoadedOrSaved===null&&this.modified===null?!1:this.lastLoadedOrSaved===null?!0:this.modified>this.lastLoadedOrSaved}static zipFixup(){(Ne.hostType===2||Ne.hostType===1)&&eval("jszip_1.default = jszip_1")}static fromJsObject(e){let t=new _ZipStorage,i=t.rootFolder.ensureFile("d.json"),n;return n=JSON.stringify(e),i.setContent(n),i.saveContent(),t}static async toJsObject(e){let t=e.rootFolder.ensureFile("d.json");return await t.loadContent(),S.getJsonObject(t)}updateLastLoadedOrSaved(){this.lastLoadedOrSaved=new Date}async loadFromBase64(e,t){try{await this._jsz.loadAsync(e,{base64:!0,checkCRC32:!0})}catch(i){this.errorMessage=i.toString(),this.errorStatus=1}this.name=t,this.updateLastLoadedOrSaved(),await this.rootFolder.load(!0)}async loadFromUint8Array(e,t){try{await this._jsz.loadAsync(e,{base64:!1})}catch(i){this.errorMessage=i.toString(),this.errorStatus=1}this.name=t,this.updateLastLoadedOrSaved(),await this.rootFolder.load(!0)}joinPath(e,t){let i=e;return i.endsWith(Ni.slashFolderDelimiter)||(i+=Ni.slashFolderDelimiter),i+=t,i}async generateUint8ArrayAsync(){return await this._jsz.generateAsync({type:"uint8array"})}async generateCompressedBase64Async(){return await this._jsz.generateAsync({type:"base64",compression:"DEFLATE",compressionOptions:{level:9}})}async generateCompressedUint8ArrayAsync(){return await this._jsz.generateAsync({type:"uint8array",compression:"DEFLATE",compressionOptions:{level:9}})}async generateBlobAsync(){let e="blob";return Ne.isLocalNode&&(e="nodebuffer"),await this._jsz.generateAsync({type:e})}};var Aa=class{constructor(){this.fileDifferences=[];this.folderDifferences=[]}async getZip(){let e=new yt;for(let t=0;t<this.fileDifferences.length;t++){let i=this.fileDifferences[t];if((i.type===2||i.type===1)&&i.updated){let n=await e.rootFolder.ensureFileFromRelativePath(i.path);i.updated.content&&n.setContent(i.updated.content)}}return e.rootFolder.saveAll(),e}getHasDeletions(){for(let e=0;e<this.fileDifferences.length;e++)if(this.fileDifferences[e].type===3)return!0;for(let e=0;e<this.folderDifferences.length;e++)if(this.folderDifferences[e].type===8)return!0;return!1}hasFileOnlyOfExtension(...e){for(let t=0;t<this.fileDifferences.length;t++){let i=S.getTypeFromName(this.fileDifferences[t].path);if(!e.includes(i))return!1}return!0}hasFileOfExtension(...e){for(let t=0;t<this.fileDifferences.length;t++){let i=S.getTypeFromName(this.fileDifferences[t].path);if(e.includes(i))return!0}return!1}async copyFileUpdatesAndAdds(e){for(let t=0;t<this.fileDifferences.length;t++){let i=this.fileDifferences[t];(i.type===2||i.type===1)&&i.updated&&i.updated.content!==null&&(await e.rootFolder.ensureFileFromRelativePath(i.path)).setContent(i.updated.content)}}};var HE=["js","ts","json","md","png","css","woff","ttf","woff2","jpg","gitignore","jpeg","gif","lang","fsb","map","yml","ico","ogg","nojekyll","mjs","env","wav","tga","old","mc","","zip","mcstructure","mcworld","mcproject","material","vertex","geometry","fragment","map","js.map","mctemplate","mcfunction","mcaddon","mcpack","html","dat","dat_old","txt","ldb","log"],qE=["behavior_packs","resource_packs","worlds","world","world_template","skin_pack","scripts","content","marketing art","store art","db","texts","animation_controllers","blocks","structures","entities","functions","items","dialogue","animations","entity","materials","models","textures","fogs","materials","particles","ui"];var S=class r{static{this.standardFolderDelimiter="/"}static isUsableFile(e){let t=r.getTypeFromName(e);return HE.includes(t)}static getEncodingByFileName(e){let t=this.getTypeFromName(e),i=e.toLowerCase();switch(t){case"mcstructure":case"zip":case"dat":case"dat_old":case"ldb":case"ico":case"tga":case"ogg":case"wav":case"gif":case"jpeg":case"jpg":case"png":case"mp3":case"fsb":case"woff":case"woff2":case"ttf":case"pdb":case"exe":case"nbt":case"mcworld":case"mcproject":case"mctemplate":case"mcpack":case"mcaddon":return 0}return t===""&&i.startsWith("manifest-")||i.startsWith("0")&&t==="log"?0:1}static absolutize(e){return e.startsWith(r.standardFolderDelimiter)||(e=r.standardFolderDelimiter+e),e}static getUniqueChildFolderName(e,t){let i=1,n=e,s=!1;for(;!s;){s=!0;for(let o in t.folders)r.canonicalizeName(o)===r.canonicalizeName(n)&&(s=!1);s||(n=e+" "+i,i++)}return n}static ensureEndsDelimited(e){return e.endsWith(r.standardFolderDelimiter)||(e=e+r.standardFolderDelimiter),e.startsWith("."+r.standardFolderDelimiter)?e=e.substring(1):e.startsWith(r.standardFolderDelimiter)||(e=r.standardFolderDelimiter+e),e}static ensureEndsWithDelimiter(e){return e.endsWith(r.standardFolderDelimiter)||(e=e+r.standardFolderDelimiter),e}static ensureStartsWithDelimiter(e){return e.startsWith(r.standardFolderDelimiter)||(e=r.standardFolderDelimiter+e),e}static ensureNotStartsWithDelimiter(e){return e.startsWith(r.standardFolderDelimiter)&&(e=e.substring(1)),e}static joinPath(e,t){let i=e;return i.endsWith(r.standardFolderDelimiter)||(i+=r.standardFolderDelimiter),t.startsWith("/")?i+=t.substring(1,t.length):i+=t,i}static getMimeType(e){switch(r.getTypeFromName(e.name)){case"js":return"application/javascript";case"ts":return"application/typescript";case"json":return"application/json";case"mcworld":case"mctemplate":case"mcproject":case"mcaddon":case"mcpack":case"zip":return"application/zip";case"mcstucture":return"application/octet-stream";case"mcfunction":case"material":case"env":case"lang":return"text/plain";case"wav":return"audio/wav";case"mp3":return"audio/mp3";case"ogg":return"audio/ogg";case"jpg":case"jpeg":return"image/jpg";case"png":return"image/png";case"tiff":case"tga":return"image/tiff";default:return"application/octet-stream"}}static getContentAsString(e){if(typeof e.content=="string")return e.content;if(e.content instanceof Uint8Array)return"data:"+r.getMimeType(e)+";base64,"+B.uint8ArrayToBase64(e.content)}static async getFileStorageFolder(e){let t=e.fileContainerStorage;if(!t){if(await e.loadContent(),!e.content||!(e.content instanceof Uint8Array))return;t=new yt,await t.loadFromUint8Array(e.content,e.name),e.fileContainerStorage=t,e.fileContainerStorage.storagePath=e.storageRelativePath+"#"}return t.rootFolder}static getContaineredFileLeafPath(e){if(!e)return;let t=e.lastIndexOf("#");return t>=0&&(e=e.substring(t+1)),e}static isMinecraftInternalFolder(e){let t=e.name.toLowerCase();return qE.includes(t)}static isContainerFile(e){let t=r.getTypeFromName(e);return t==="zip"||t==="mcworld"||t==="mcproject"||t==="mctemplate"||t==="mcpack"||t==="mcaddon"}static isFileStorageItem(e){return this.isContainerFile(e.name)}static canonicalizeName(e){return e=e.trim(),(e.startsWith("/")||e.startsWith("\\"))&&(e=e.substring(1,e.length)),(e.endsWith("/")||e.endsWith("\\"))&&(e=e.substring(0,e.length-1)),e==="constructor"&&(e="__constructor"),e=e.replace(/%20/g," "),e=e.replace(/%28/g,"("),e=e.replace(/%29/g,")"),e}static isPathEqual(e,t){return r.canonicalizePath(e)===r.canonicalizePath(t)}static canonicalizePath(e){return e=e.trim(),e=e.replace(/\\/g,"/"),e=e.replace(/%20/g," "),e=e.replace(/%28/g,"("),e=e.replace(/%29/g,")"),e}static canonicalizePathAsFileName(e){let t=e.trim().toLowerCase();return e=e.replace(/%20/g," "),e=e.replace(/%28/g,"("),e=e.replace(/%29/g,")"),t=t.replace(/:/g,"_"),t=t.replace(/\//g,"-"),t=t.replace(/\\/g,"-"),t=t.replace(/%/g,"-"),t=t.replace(/--/g,"-"),t=t.replace(/--/g,"-"),t=t.replace(/\?/g,"-"),t=t.replace(/\|/g,"-"),t}static ensureFileNameIsSafe(e){let t=e.trim().toLowerCase();return e=e.replace(/%20/g," "),e=e.replace(/%28/g,"("),e=e.replace(/%29/g,")"),t=t.replace(/:/g,"_"),t=t.replace(/\//g,"-"),t=t.replace(/\\/g,"-"),t=t.replace(/%/g,"-"),t=t.replace(/--/g,"-"),t=t.replace(/`/g,"-"),t=t.replace(/'/g,"-"),t=t.replace(//g,"-"),t}static hasPathSeparator(e){if(!e)return!1;let t=e.lastIndexOf("/",e.length-1);return t>=0||(t=e.lastIndexOf("\\",e.length-1),t>=0)}static getLeafName(e){let t=e;t.endsWith("/")&&(t=t.substring(0,t.length-1)),t.endsWith("\\")&&(t=t.substring(0,t.length-1));let i=t.lastIndexOf("/",e.length-1);return i>=0&&(t=t.substring(i+1,t.length)),i=t.lastIndexOf("\\",t.length-1),i>=0&&(t=t.substring(i+1,t.length)),t}static getFolderPath(e){let t=e.lastIndexOf("/",e.length-1);return t>=0&&t<e.length-1?e=e.substring(0,t+1):(t=e.lastIndexOf("\\",e.length-1),t>=0&&t<e.length-1&&(e=e.substring(0,t+1))),e}static getParentFolderNameFromPath(e){let t=e.lastIndexOf("/",e.length-1);if(t>=0&&t<e.length-1){let i=e.lastIndexOf("/",t-1);return e.substring(i+1,t)}else if(t=e.lastIndexOf("\\",e.length-1),t>=0&&t<e.length-1){let i=e.lastIndexOf("/",t-1);return e.substring(i+1,t)}}static removeContainerExtension(e){let t=e.trim();return t.endsWith(".zip")&&(t=t.substring(0,t.length-4)),t}static getBaseFromName(e){let t=e.trim(),i=t.lastIndexOf(".");return i<0?e:t.substring(0,i)}static getTypeFromName(e){let t=e.trim().toLowerCase(),i=t.lastIndexOf(".");return i<0?"":t.substring(i+1,t.length)}static async folderContentsEqual(e,t,i,n,s){if(e===void 0&&t===void 0)return{result:!0,reason:"Both folders are undefined."};if(e===void 0)return{result:!1,reason:"First folder is undefined."};if(t===void 0)return{result:!1,reason:"Second folder is undefined."};if(await e.load(!1),await t.load(!1),e.fileCount!==t.fileCount)return{result:!1,reason:"Folder '"+e.fullPath+"' has "+e.fileCount+" files; folder '"+t.fullPath+"' has "+t.fileCount+" files."};for(let o in e.files){let a=e.files[o],l=t.files[o];if(a===void 0)return{result:!1,reason:"Unexpected file '"+o+"' undefined."};if(l===void 0)return{result:!1,reason:"File '"+o+"' does not exist in '"+t.fullPath+"'"};if((!i||!i.includes(a.name))&&!await r.fileContentsEqual(a,l,n,s))return{result:!1,reason:"File '"+a.fullPath+"' (size: "+a.content?.length+(a.isBinary?"B":"C")+") contents does not match '"+l.fullPath+"' (size: "+l.content?.length+(l.isBinary?"B":"C")+")"}}for(let o in e.folders){let a=e.folders[o],l=t.folders[o];if(a===void 0)return{result:!1,reason:"Unexpected folder undefined. "};if(l===void 0)return{result:!1,reason:"Folder '"+o+"' does not exist in '"+t.fullPath+"'"};let u=await r.folderContentsEqual(a,l,i,n,s);if(!u.result)return u}return{result:!0,reason:"Folders are equal"}}static async fileContentsEqual(e,t,i,n){if(e===void 0&&t===void 0)return!0;if(e===void 0||t===void 0)return!1;let s=await e.exists();if(!s)return!1;let o=await t.exists();if(s&&!o)return!1;if(await e.loadContent(!1),await t.loadContent(!1),e.content===void 0&&t.content===void 0)return!0;let a=r.getTypeFromName(e.name),l=r.getTypeFromName(t.name),u=e.content,c=t.content;if(u===null&&c===null)return!0;if(u===null||c===null)return!1;if(n&&typeof u=="string"&&typeof c=="string")for(let d of n)u=B.stripLinesContaining(u,d),c=B.stripLinesContaining(c,d);return a==="json"&&l==="json"&&typeof u=="string"&&typeof c=="string"?this.jsonContentsAreEqualIgnoreWhitespace(u,c):i?r.contentsAreEqualIgnoreWhitespace(u,c):r.contentsAreEqual(u,c)}static jsonContentsAreEqualIgnoreWhitespace(e,t){return e=this.stripWhitespace(e),t=this.stripWhitespace(t),e===t}static stripWhitespace(e){return e=e.trim(),e=e.replace(/ /gi,""),e=e.replace(/\r/gi,""),e=e.replace(/\n/gi,""),e=e.replace(/\t/gi,""),e}static contentsAreEqual(e,t){return e===null&&t===null?!0:typeof e=="string"&&typeof t=="string"?e===t:e instanceof Uint8Array&&t instanceof Uint8Array?B.uint8ArraysAreEqual(e,t):!1}static contentsAreEqualIgnoreWhitespace(e,t){return e===null&&t===null?!0:typeof e=="string"&&typeof t=="string"?this.stripWhitespace(e)===this.stripWhitespace(t):e instanceof Uint8Array&&t instanceof Uint8Array?B.uint8ArraysAreEqual(e,t):!1}static async getDifferences(e,t,i){let n=new Aa;return await this.addDifferences(n,e,t,i),n}static shouldProcessFile(e){e=e.toLowerCase();let t=r.getTypeFromName(e);return!(t!=="ts"&&t!=="js"&&t!=="json"||e.startsWith(".")||e.startsWith("just.config")||e.endsWith(".config.ts")||e.endsWith(".config.js")||e.startsWith("manifest")&&e.endsWith("json")||e.startsWith("package")&&e.endsWith("json"))}static shouldProcessFolder(e){return!(e.startsWith(".")||e==="lib"||e==="node_modules"||e===".git"||e==="dist"||e==="build")}static async addDifferences(e,t,i,n){await t.load(!1),await i.load(!1);let s=0,o={},a={};for(let l in i.files)r.shouldProcessFile(l)&&(o[l]=!0);for(let l in i.folders)r.shouldProcessFolder(l)&&(a[l]=!0);for(let l in t.files)if(r.shouldProcessFile(l)){let u=t.files[l];if(u!==void 0)if(o[l]=!1,i.fileExists(l)){let c=i.files[l];await r.fileContentsEqual(u,c)||((s&1)===0&&(s+=1),e.fileDifferences.push({type:1,path:u.storageRelativePath,original:u,updated:c}))}else n&&((s&2)===0&&(s+=2),e.fileDifferences.push({type:3,path:u.storageRelativePath,original:u}))}for(let l in t.folders)if(r.shouldProcessFolder(l)){let u=t.folders[l];if(u!==void 0)if(a[l]=!1,i.folderExists(l)){let c=i.folders[l];if(c!==void 0){let d=await r.addDifferences(e,u,c,n);d!==0&&(s=s|d)}}else n&&((s&8)===0&&(s+=8),this.addDifferencesAsFolderDelete(e,u))}for(let l in o)if(o[l]===!0){let u=i.files[l];u!==void 0&&((s&2)===0&&(s+=2),u.content!==void 0&&u.content!==null&&e.fileDifferences.push({type:2,path:r.relativizePathToOriginal(t,i,u.storageRelativePath),updated:u}))}for(let l in a)if(a[l]===!0){let u=i.folders[l];u!==void 0&&((s&4)===0&&(s+=4),this.addDifferencesAsFolderAdd(e,u,t,i))}return s!==0&&e.folderDifferences.push({type:s,path:t.storageRelativePath,original:t,updated:i}),s}static relativizePathToOriginal(e,t,i){let n=e.storageRelativePath.length,s=t.storageRelativePath.length;return s>n&&(i=i.substring(s-n,i.length)),i}static async addDifferencesAsFolderAdd(e,t,i,n){await t.load(!1),e.folderDifferences.push({type:4,path:r.relativizePathToOriginal(i,n,t.storageRelativePath),updated:t});for(let s in t.files){let o=t.files[s];o!==void 0&&e.fileDifferences.push({type:2,path:r.relativizePathToOriginal(i,n,o.storageRelativePath),updated:o})}for(let s in t.folders){let o=t.folders[s];o!==void 0&&this.addDifferencesAsFolderAdd(e,o,i,n)}}static async addDifferencesAsFolderDelete(e,t){await t.load(!1),e.folderDifferences.push({type:8,path:t.storageRelativePath,updated:t});for(let i in t.files){let n=t.files[i];n!==void 0&&e.fileDifferences.push({type:3,path:n.storageRelativePath,original:n})}for(let i in t.folders){let n=t.folders[i];n!==void 0&&this.addDifferencesAsFolderDelete(e,n)}}static isPathRiskyForDelete(e){return e=e.toLowerCase().trim(),e.indexOf("system32")>=0||e.indexOf("program files")>=0||e.indexOf("programdata")>=0?!0:B.countChar(e,"/")+B.countChar(e,"\\")<4}static getJsonObject(e){if(!e.content||typeof e.content!="string")return;let t,i=e.content;i=B.fixJsonContent(i);try{t=JSON.parse(i)}catch(n){C.fail("Could not parse JSON from '"+e.fullPath+"': "+n.message)}return t}static isIgnorableFolder(e){return e.startsWith(".")&&!e.toLowerCase().startsWith(".vscode")}static async getUniqueFileName(e,t,i){let n=e+"."+t,s=i.fileExists(n),o=0;for(;s&&o<99;)o++,n=e+" "+String(o)+"."+t,s=i.fileExists(n);return n}static async syncFolderTo(e,t,i,n,s,o,a,l,u){let c=0;if(r.isIgnorableFolder(e.name))return 0;await e.load(i),await t.load(i);let d={},h={};for(let f in t.files)t.files[f]!==void 0&&(d[f]=!0);for(let f in t.folders)t.folders[f]!==void 0&&!r.isIgnorableFolder(f)&&(h[f]=!0);for(let f in e.files){let m=e.files[f],p=!0;if(o!==void 0&&r.matchesList(f,o)&&(p=!1),a!==void 0&&!r.matchesList(f,a)&&(p=!1),m!==void 0&&p){d[f]=!1;let g=t.ensureFile(m.name),b=!0;u&&await g.exists()&&(b=!1,l&&l("Not updating '"+g.fullPath+"' as it already exists.")),b&&await this.syncFileTo(m,g,n,l)&&c++}}for(let f in e.folders)if(!r.isIgnorableFolder(f)){let m=e.folders[f],p=!0;if(o!==void 0&&r.matchesList("/"+f,o)&&(p=!1),m!==void 0&&p){h[f]=!1;let g=t.ensureFolder(m.name);await g.ensureExists();let b=await this.syncFolderTo(m,g,i,n,s,o,a,l,u);c+=b}}if(s)for(let f in d)!0&&d[f]===!0&&(l&&await l("Removing file '"+t.fullPath+"' ("+f+")"),await t.deleteFile(f),c++);return c}static matchesList(e,t){e=r.canonicalizeName(e);let i=e;i.startsWith("/")&&(i=i.substring(1,i.length));for(let n=0;n<t.length;n++){let s=r.canonicalizeName(t[n]);if(e===s||!s.startsWith("/")&&i===s)return!0;if(s.length>2&&s.startsWith("*")&&s.endsWith("*")){if(e.indexOf(s.substring(1,s.length-1))>=0)return!0}else if(s.length>2&&s.startsWith("*")&&!s.endsWith("*")){if(e.endsWith(s.substring(1)))return!0}else if(s.length>2&&!s.startsWith("*")&&s.endsWith("*")&&e.startsWith(s.substring(0,s.length-1)))return!0}return!1}static sanitizePath(e){if(B.isAlphaNumeric(e))return e;let t=new TextEncoder;return B.arrayBufferToBase64(t.encode(e)).replace(/\//gi," ").replace(/=/gi,"_")}static async syncFileTo(e,t,i,n){if(await e.loadContent(!0),e.content==null){C.debug("No content for file "+e.storageRelativePath);return}if(!(!i&&await t.exists()&&(await t.loadContent(!1),r.contentsAreEqual(e.content,t.content)))){if(n){let s=t.fullPath;s=s.replace("fs.mctprojects/root/","");let o="Updating file: "+s;e.content&&(o+=" (size: "+e.content.length+")"),await n(o)}return t.setContent(e.content),!0}}};var zl=Le(Je());var ws=class{static getClassName(e){return e.length<2?"untitled":(e=e[0].toUpperCase()+e.substring(1,e.length),e=e.replace(/:/gi,""),e)}static getInstanceName(e){return e.length<2?"untitled":(e=e[0].toLowerCase()+e.substring(1,e.length),e)}};var $c=Le(Je());var Fy=Le(Je()),ei=class{constructor(e,t){this._onPropertyChanged=new Fy.EventDispatcher;this._data=t,this.id=e}get onPropertyChanged(){return this._onPropertyChanged.asEvent()}getData(){return this._data}getProperty(e){if(this._data)return this._data[e]}setProperty(e,t){typeof this._data=="string"&&(this.id==="minecraft:geometry"?this._data={identifier:this._data}:this._data={value:this._data}),this._data&&typeof this._data!="string"&&(this._data[e]=t)}};var _s=class{constructor(e,t){this._onComponentAdded=new $c.EventDispatcher;this._onComponentRemoved=new $c.EventDispatcher;this._onComponentChanged=new $c.EventDispatcher;this._data=e,this._managed={},this.id=t}get onComponentAdded(){return this._onComponentAdded.asEvent()}get onComponentRemoved(){return this._onComponentRemoved.asEvent()}get onComponentChanged(){return this._onComponentChanged.asEvent()}addComponent(e,t){this._data||(this._data={}),this._managed||(this._managed={}),this._data[t.id]=t.getData(),this._managed[t.id]=t}removeComponent(e){this._data&&(this._data[e]=void 0)}getComponent(e){if(this._data){if(this._managed||(this._managed={}),!this._managed[e]){let t=this._data[e];t&&(this._managed[e]=new ei(e,t))}return this._managed[e]}}getAllComponents(){return this.getComponents()}getComponents(){if(!this._data)return[];this._managed||(this._managed={});let e=[];for(let t in this._data){let i=this._data[t];!this._managed[t]&&i&&(this._managed[t]=new ei(t,i));let n=this._managed[t];n&&e.push(n)}return e}notifyComponentUpdated(e){if(!this._managed)return;let t=this._managed[e];t&&this._onComponentChanged.dispatch(this,t)}};function Ra(r,e){return function(){return r.apply(e,arguments)}}var{toString:KE}=Object.prototype,{getPrototypeOf:_h}=Object,qc=(r=>e=>{let t=KE.call(e);return r[t]||(r[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Pr=r=>(r=r.toLowerCase(),e=>qc(e)===r),Kc=r=>e=>typeof e===r,{isArray:yo}=Array,Ba=Kc("undefined");function XE(r){return r!==null&&!Ba(r)&&r.constructor!==null&&!Ba(r.constructor)&&nr(r.constructor.isBuffer)&&r.constructor.isBuffer(r)}var Sy=Pr("ArrayBuffer");function ZE(r){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(r):e=r&&r.buffer&&Sy(r.buffer),e}var YE=Kc("string"),nr=Kc("function"),Py=Kc("number"),Xc=r=>r!==null&&typeof r=="object",QE=r=>r===!0||r===!1,Hc=r=>{if(qc(r)!=="object")return!1;let e=_h(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},eI=Pr("Date"),tI=Pr("File"),iI=Pr("Blob"),rI=Pr("FileList"),nI=r=>Xc(r)&&nr(r.pipe),sI=r=>{let e;return r&&(typeof FormData=="function"&&r instanceof FormData||nr(r.append)&&((e=qc(r))==="formdata"||e==="object"&&nr(r.toString)&&r.toString()==="[object FormData]"))},oI=Pr("URLSearchParams"),[aI,lI,uI,cI]=["ReadableStream","Request","Response","Headers"].map(Pr),dI=r=>r.trim?r.trim():r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function La(r,e,{allOwnKeys:t=!1}={}){if(r===null||typeof r>"u")return;let i,n;if(typeof r!="object"&&(r=[r]),yo(r))for(i=0,n=r.length;i<n;i++)e.call(null,r[i],i,r);else{let s=t?Object.getOwnPropertyNames(r):Object.keys(r),o=s.length,a;for(i=0;i<o;i++)a=s[i],e.call(null,r[a],a,r)}}function Ey(r,e){e=e.toLowerCase();let t=Object.keys(r),i=t.length,n;for(;i-- >0;)if(n=t[i],e===n.toLowerCase())return n;return null}var Fs=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Iy=r=>!Ba(r)&&r!==Fs;function wh(){let{caseless:r}=Iy(this)&&this||{},e={},t=(i,n)=>{let s=r&&Ey(e,n)||n;Hc(e[s])&&Hc(i)?e[s]=wh(e[s],i):Hc(i)?e[s]=wh({},i):yo(i)?e[s]=i.slice():e[s]=i};for(let i=0,n=arguments.length;i<n;i++)arguments[i]&&La(arguments[i],t);return e}var fI=(r,e,t,{allOwnKeys:i}={})=>(La(e,(n,s)=>{t&&nr(n)?r[s]=Ra(n,t):r[s]=n},{allOwnKeys:i}),r),hI=r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),pI=(r,e,t,i)=>{r.prototype=Object.create(e.prototype,i),r.prototype.constructor=r,Object.defineProperty(r,"super",{value:e.prototype}),t&&Object.assign(r.prototype,t)},mI=(r,e,t,i)=>{let n,s,o,a={};if(e=e||{},r==null)return e;do{for(n=Object.getOwnPropertyNames(r),s=n.length;s-- >0;)o=n[s],(!i||i(o,r,e))&&!a[o]&&(e[o]=r[o],a[o]=!0);r=t!==!1&&_h(r)}while(r&&(!t||t(r,e))&&r!==Object.prototype);return e},gI=(r,e,t)=>{r=String(r),(t===void 0||t>r.length)&&(t=r.length),t-=e.length;let i=r.indexOf(e,t);return i!==-1&&i===t},bI=r=>{if(!r)return null;if(yo(r))return r;let e=r.length;if(!Py(e))return null;let t=new Array(e);for(;e-- >0;)t[e]=r[e];return t},yI=(r=>e=>r&&e instanceof r)(typeof Uint8Array<"u"&&_h(Uint8Array)),vI=(r,e)=>{let i=(r&&r[Symbol.iterator]).call(r),n;for(;(n=i.next())&&!n.done;){let s=n.value;e.call(r,s[0],s[1])}},wI=(r,e)=>{let t,i=[];for(;(t=r.exec(e))!==null;)i.push(t);return i},_I=Pr("HTMLFormElement"),FI=r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,i,n){return i.toUpperCase()+n}),ky=(({hasOwnProperty:r})=>(e,t)=>r.call(e,t))(Object.prototype),kI=Pr("RegExp"),xy=(r,e)=>{let t=Object.getOwnPropertyDescriptors(r),i={};La(t,(n,s)=>{let o;(o=e(n,s,r))!==!1&&(i[s]=o||n)}),Object.defineProperties(r,i)},CI=r=>{xy(r,(e,t)=>{if(nr(r)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;let i=r[t];if(nr(i)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},SI=(r,e)=>{let t={},i=n=>{n.forEach(s=>{t[s]=!0})};return yo(r)?i(r):i(String(r).split(e)),t},PI=()=>{},EI=(r,e)=>r!=null&&Number.isFinite(r=+r)?r:e,vh="abcdefghijklmnopqrstuvwxyz",Cy="0123456789",Ty={DIGIT:Cy,ALPHA:vh,ALPHA_DIGIT:vh+vh.toUpperCase()+Cy},II=(r=16,e=Ty.ALPHA_DIGIT)=>{let t="",{length:i}=e;for(;r--;)t+=e[Math.random()*i|0];return t};function xI(r){return!!(r&&nr(r.append)&&r[Symbol.toStringTag]==="FormData"&&r[Symbol.iterator])}var TI=r=>{let e=new Array(10),t=(i,n)=>{if(Xc(i)){if(e.indexOf(i)>=0)return;if(!("toJSON"in i)){e[n]=i;let s=yo(i)?[]:{};return La(i,(o,a)=>{let l=t(o,n+1);!Ba(l)&&(s[a]=l)}),e[n]=void 0,s}}return i};return t(r,0)},DI=Pr("AsyncFunction"),AI=r=>r&&(Xc(r)||nr(r))&&nr(r.then)&&nr(r.catch),Dy=((r,e)=>r?setImmediate:e?((t,i)=>(Fs.addEventListener("message",({source:n,data:s})=>{n===Fs&&s===t&&i.length&&i.shift()()},!1),n=>{i.push(n),Fs.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",nr(Fs.postMessage)),RI=typeof queueMicrotask<"u"?queueMicrotask.bind(Fs):typeof process<"u"&&process.nextTick||Dy,Z={isArray:yo,isArrayBuffer:Sy,isBuffer:XE,isFormData:sI,isArrayBufferView:ZE,isString:YE,isNumber:Py,isBoolean:QE,isObject:Xc,isPlainObject:Hc,isReadableStream:aI,isRequest:lI,isResponse:uI,isHeaders:cI,isUndefined:Ba,isDate:eI,isFile:tI,isBlob:iI,isRegExp:kI,isFunction:nr,isStream:nI,isURLSearchParams:oI,isTypedArray:yI,isFileList:rI,forEach:La,merge:wh,extend:fI,trim:dI,stripBOM:hI,inherits:pI,toFlatObject:mI,kindOf:qc,kindOfTest:Pr,endsWith:gI,toArray:bI,forEachEntry:vI,matchAll:wI,isHTMLForm:_I,hasOwnProperty:ky,hasOwnProp:ky,reduceDescriptors:xy,freezeMethods:CI,toObjectSet:SI,toCamelCase:FI,noop:PI,toFiniteNumber:EI,findKey:Ey,global:Fs,isContextDefined:Iy,ALPHABET:Ty,generateString:II,isSpecCompliantForm:xI,toJSONObject:TI,isAsyncFn:DI,isThenable:AI,setImmediate:Dy,asap:RI};function vo(r,e,t,i,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=r,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),i&&(this.request=i),n&&(this.response=n)}Z.inherits(vo,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Z.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var Ay=vo.prototype,Ry={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(r=>{Ry[r]={value:r}});Object.defineProperties(vo,Ry);Object.defineProperty(Ay,"isAxiosError",{value:!0});vo.from=(r,e,t,i,n,s)=>{let o=Object.create(Ay);return Z.toFlatObject(r,o,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),vo.call(o,r.message,e,t,i,n),o.cause=r,o.name=r.name,s&&Object.assign(o,s),o};var rt=vo;var Zc=null;function Fh(r){return Z.isPlainObject(r)||Z.isArray(r)}function Ly(r){return Z.endsWith(r,"[]")?r.slice(0,-2):r}function By(r,e,t){return r?r.concat(e).map(function(n,s){return n=Ly(n),!t&&s?"["+n+"]":n}).join(t?".":""):e}function BI(r){return Z.isArray(r)&&!r.some(Fh)}var LI=Z.toFlatObject(Z,{},null,function(e){return/^is[A-Z]/.test(e)});function OI(r,e,t){if(!Z.isObject(r))throw new TypeError("target must be an object");e=e||new(Zc||FormData),t=Z.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(p,g){return!Z.isUndefined(g[p])});let i=t.metaTokens,n=t.visitor||c,s=t.dots,o=t.indexes,l=(t.Blob||typeof Blob<"u"&&Blob)&&Z.isSpecCompliantForm(e);if(!Z.isFunction(n))throw new TypeError("visitor must be a function");function u(m){if(m===null)return"";if(Z.isDate(m))return m.toISOString();if(!l&&Z.isBlob(m))throw new rt("Blob is not supported. Use a Buffer instead.");return Z.isArrayBuffer(m)||Z.isTypedArray(m)?l&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function c(m,p,g){let b=m;if(m&&!g&&typeof m=="object"){if(Z.endsWith(p,"{}"))p=i?p:p.slice(0,-2),m=JSON.stringify(m);else if(Z.isArray(m)&&BI(m)||(Z.isFileList(m)||Z.endsWith(p,"[]"))&&(b=Z.toArray(m)))return p=Ly(p),b.forEach(function(w,_){!(Z.isUndefined(w)||w===null)&&e.append(o===!0?By([p],_,s):o===null?p:p+"[]",u(w))}),!1}return Fh(m)?!0:(e.append(By(g,p,s),u(m)),!1)}let d=[],h=Object.assign(LI,{defaultVisitor:c,convertValue:u,isVisitable:Fh});function f(m,p){if(!Z.isUndefined(m)){if(d.indexOf(m)!==-1)throw Error("Circular reference detected in "+p.join("."));d.push(m),Z.forEach(m,function(b,F){(!(Z.isUndefined(b)||b===null)&&n.call(e,b,Z.isString(F)?F.trim():F,p,h))===!0&&f(b,p?p.concat(F):[F])}),d.pop()}}if(!Z.isObject(r))throw new TypeError("data must be an object");return f(r),e}var zn=OI;function Oy(r){let e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(i){return e[i]})}function My(r,e){this._pairs=[],r&&zn(r,this,e)}var Ny=My.prototype;Ny.append=function(e,t){this._pairs.push([e,t])};Ny.toString=function(e){let t=e?function(i){return e.call(this,i,Oy)}:Oy;return this._pairs.map(function(n){return t(n[0])+"="+t(n[1])},"").join("&")};var Yc=My;function MI(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Oa(r,e,t){if(!e)return r;let i=t&&t.encode||MI,n=t&&t.serialize,s;if(n?s=n(e,t):s=Z.isURLSearchParams(e)?e.toString():new Yc(e,t).toString(i),s){let o=r.indexOf("#");o!==-1&&(r=r.slice(0,o)),r+=(r.indexOf("?")===-1?"?":"&")+s}return r}var kh=class{constructor(){this.handlers=[]}use(e,t,i){return this.handlers.push({fulfilled:e,rejected:t,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Z.forEach(this.handlers,function(i){i!==null&&e(i)})}},Ch=kh;var Qc={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1};var jy=typeof URLSearchParams<"u"?URLSearchParams:Yc;var Uy=typeof FormData<"u"?FormData:null;var Gy=typeof Blob<"u"?Blob:null;var zy={isBrowser:!0,classes:{URLSearchParams:jy,FormData:Uy,Blob:Gy},protocols:["http","https","file","blob","url","data"]};var Ph={};zC(Ph,{hasBrowserEnv:()=>Sh,hasStandardBrowserEnv:()=>NI,hasStandardBrowserWebWorkerEnv:()=>jI,origin:()=>UI});var Sh=typeof window<"u"&&typeof document<"u",NI=(r=>Sh&&["ReactNative","NativeScript","NS"].indexOf(r)<0)(typeof navigator<"u"&&navigator.product),jI=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",UI=Sh&&window.location.href||"http://localhost";var vi={...Ph,...zy};function Eh(r,e){return zn(r,new vi.classes.URLSearchParams,Object.assign({visitor:function(t,i,n,s){return vi.isNode&&Z.isBuffer(t)?(this.append(i,t.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},e))}function GI(r){return Z.matchAll(/\w+|\[(\w*)]/g,r).map(e=>e[0]==="[]"?"":e[1]||e[0])}function zI(r){let e={},t=Object.keys(r),i,n=t.length,s;for(i=0;i<n;i++)s=t[i],e[s]=r[s];return e}function VI(r){function e(t,i,n,s){let o=t[s++];if(o==="__proto__")return!0;let a=Number.isFinite(+o),l=s>=t.length;return o=!o&&Z.isArray(n)?n.length:o,l?(Z.hasOwnProp(n,o)?n[o]=[n[o],i]:n[o]=i,!a):((!n[o]||!Z.isObject(n[o]))&&(n[o]=[]),e(t,i,n[o],s)&&Z.isArray(n[o])&&(n[o]=zI(n[o])),!a)}if(Z.isFormData(r)&&Z.isFunction(r.entries)){let t={};return Z.forEachEntry(r,(i,n)=>{e(GI(i),n,t,0)}),t}return null}var ed=VI;function WI(r,e,t){if(Z.isString(r))try{return(e||JSON.parse)(r),Z.trim(r)}catch(i){if(i.name!=="SyntaxError")throw i}return(t||JSON.stringify)(r)}var Ih={transitional:Qc,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){let i=t.getContentType()||"",n=i.indexOf("application/json")>-1,s=Z.isObject(e);if(s&&Z.isHTMLForm(e)&&(e=new FormData(e)),Z.isFormData(e))return n?JSON.stringify(ed(e)):e;if(Z.isArrayBuffer(e)||Z.isBuffer(e)||Z.isStream(e)||Z.isFile(e)||Z.isBlob(e)||Z.isReadableStream(e))return e;if(Z.isArrayBufferView(e))return e.buffer;if(Z.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(s){if(i.indexOf("application/x-www-form-urlencoded")>-1)return Eh(e,this.formSerializer).toString();if((a=Z.isFileList(e))||i.indexOf("multipart/form-data")>-1){let l=this.env&&this.env.FormData;return zn(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return s||n?(t.setContentType("application/json",!1),WI(e)):e}],transformResponse:[function(e){let t=this.transitional||Ih.transitional,i=t&&t.forcedJSONParsing,n=this.responseType==="json";if(Z.isResponse(e)||Z.isReadableStream(e))return e;if(e&&Z.isString(e)&&(i&&!this.responseType||n)){let o=!(t&&t.silentJSONParsing)&&n;try{return JSON.parse(e)}catch(a){if(o)throw a.name==="SyntaxError"?rt.from(a,rt.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:vi.classes.FormData,Blob:vi.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Z.forEach(["delete","get","head","post","put","patch"],r=>{Ih.headers[r]={}});var wo=Ih;var JI=Z.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Vy=r=>{let e={},t,i,n;return r&&r.split(`
`).forEach(function(o){n=o.indexOf(":"),t=o.substring(0,n).trim().toLowerCase(),i=o.substring(n+1).trim(),!(!t||e[t]&&JI[t])&&(t==="set-cookie"?e[t]?e[t].push(i):e[t]=[i]:e[t]=e[t]?e[t]+", "+i:i)}),e};var Wy=Symbol("internals");function Ma(r){return r&&String(r).trim().toLowerCase()}function td(r){return r===!1||r==null?r:Z.isArray(r)?r.map(td):String(r)}function $I(r){let e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g,i;for(;i=t.exec(r);)e[i[1]]=i[2];return e}var HI=r=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(r.trim());function xh(r,e,t,i,n){if(Z.isFunction(i))return i.call(this,e,t);if(n&&(e=t),!!Z.isString(e)){if(Z.isString(i))return e.indexOf(i)!==-1;if(Z.isRegExp(i))return i.test(e)}}function qI(r){return r.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,i)=>t.toUpperCase()+i)}function KI(r,e){let t=Z.toCamelCase(" "+e);["get","set","has"].forEach(i=>{Object.defineProperty(r,i+t,{value:function(n,s,o){return this[i].call(this,e,n,s,o)},configurable:!0})})}var _o=class{constructor(e){e&&this.set(e)}set(e,t,i){let n=this;function s(a,l,u){let c=Ma(l);if(!c)throw new Error("header name must be a non-empty string");let d=Z.findKey(n,c);(!d||n[d]===void 0||u===!0||u===void 0&&n[d]!==!1)&&(n[d||l]=td(a))}let o=(a,l)=>Z.forEach(a,(u,c)=>s(u,c,l));if(Z.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(Z.isString(e)&&(e=e.trim())&&!HI(e))o(Vy(e),t);else if(Z.isHeaders(e))for(let[a,l]of e.entries())s(l,a,i);else e!=null&&s(t,e,i);return this}get(e,t){if(e=Ma(e),e){let i=Z.findKey(this,e);if(i){let n=this[i];if(!t)return n;if(t===!0)return $I(n);if(Z.isFunction(t))return t.call(this,n,i);if(Z.isRegExp(t))return t.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Ma(e),e){let i=Z.findKey(this,e);return!!(i&&this[i]!==void 0&&(!t||xh(this,this[i],i,t)))}return!1}delete(e,t){let i=this,n=!1;function s(o){if(o=Ma(o),o){let a=Z.findKey(i,o);a&&(!t||xh(i,i[a],a,t))&&(delete i[a],n=!0)}}return Z.isArray(e)?e.forEach(s):s(e),n}clear(e){let t=Object.keys(this),i=t.length,n=!1;for(;i--;){let s=t[i];(!e||xh(this,this[s],s,e,!0))&&(delete this[s],n=!0)}return n}normalize(e){let t=this,i={};return Z.forEach(this,(n,s)=>{let o=Z.findKey(i,s);if(o){t[o]=td(n),delete t[s];return}let a=e?qI(s):String(s).trim();a!==s&&delete t[s],t[a]=td(n),i[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){let t=Object.create(null);return Z.forEach(this,(i,n)=>{i!=null&&i!==!1&&(t[n]=e&&Z.isArray(i)?i.join(", "):i)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){let i=new this(e);return t.forEach(n=>i.set(n)),i}static accessor(e){let i=(this[Wy]=this[Wy]={accessors:{}}).accessors,n=this.prototype;function s(o){let a=Ma(o);i[a]||(KI(n,o),i[a]=!0)}return Z.isArray(e)?e.forEach(s):s(e),this}};_o.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Z.reduceDescriptors(_o.prototype,({value:r},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>r,set(i){this[t]=i}}});Z.freezeMethods(_o);var gi=_o;function Na(r,e){let t=this||wo,i=e||t,n=gi.from(i.headers),s=i.data;return Z.forEach(r,function(a){s=a.call(t,s,n.normalize(),e?e.status:void 0)}),n.normalize(),s}function ja(r){return!!(r&&r.__CANCEL__)}function Jy(r,e,t){rt.call(this,r??"canceled",rt.ERR_CANCELED,e,t),this.name="CanceledError"}Z.inherits(Jy,rt,{__CANCEL__:!0});var Wr=Jy;function Ua(r,e,t){let i=t.config.validateStatus;!t.status||!i||i(t.status)?r(t):e(new rt("Request failed with status code "+t.status,[rt.ERR_BAD_REQUEST,rt.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function Th(r){let e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(r);return e&&e[1]||""}function XI(r,e){r=r||10;let t=new Array(r),i=new Array(r),n=0,s=0,o;return e=e!==void 0?e:1e3,function(l){let u=Date.now(),c=i[s];o||(o=u),t[n]=l,i[n]=u;let d=s,h=0;for(;d!==n;)h+=t[d++],d=d%r;if(n=(n+1)%r,n===s&&(s=(s+1)%r),u-o<e)return;let f=c&&u-c;return f?Math.round(h*1e3/f):void 0}}var $y=XI;function ZI(r,e){let t=0,i=1e3/e,n,s,o=(u,c=Date.now())=>{t=c,n=null,s&&(clearTimeout(s),s=null),r.apply(null,u)};return[(...u)=>{let c=Date.now(),d=c-t;d>=i?o(u,c):(n=u,s||(s=setTimeout(()=>{s=null,o(n)},i-d)))},()=>n&&o(n)]}var Hy=ZI;var Fo=(r,e,t=3)=>{let i=0,n=$y(50,250);return Hy(s=>{let o=s.loaded,a=s.lengthComputable?s.total:void 0,l=o-i,u=n(l),c=o<=a;i=o;let d={loaded:o,total:a,progress:a?o/a:void 0,bytes:l,rate:u||void 0,estimated:u&&a&&c?(a-o)/u:void 0,event:s,lengthComputable:a!=null,[e?"download":"upload"]:!0};r(d)},t)},Dh=(r,e)=>{let t=r!=null;return[i=>e[0]({lengthComputable:t,total:r,loaded:i}),e[1]]},Ah=r=>(...e)=>Z.asap(()=>r(...e));var qy=vi.hasStandardBrowserEnv?function(){let e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a"),i;function n(s){let o=s;return e&&(t.setAttribute("href",o),o=t.href),t.setAttribute("href",o),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:t.pathname.charAt(0)==="/"?t.pathname:"/"+t.pathname}}return i=n(window.location.href),function(o){let a=Z.isString(o)?n(o):o;return a.protocol===i.protocol&&a.host===i.host}}():function(){return function(){return!0}}();var Ky=vi.hasStandardBrowserEnv?{write(r,e,t,i,n,s){let o=[r+"="+encodeURIComponent(e)];Z.isNumber(t)&&o.push("expires="+new Date(t).toGMTString()),Z.isString(i)&&o.push("path="+i),Z.isString(n)&&o.push("domain="+n),s===!0&&o.push("secure"),document.cookie=o.join("; ")},read(r){let e=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(r){this.write(r,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Rh(r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}function Bh(r,e){return e?r.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):r}function Ga(r,e){return r&&!Rh(e)?Bh(r,e):e}var Xy=r=>r instanceof gi?{...r}:r;function Er(r,e){e=e||{};let t={};function i(u,c,d){return Z.isPlainObject(u)&&Z.isPlainObject(c)?Z.merge.call({caseless:d},u,c):Z.isPlainObject(c)?Z.merge({},c):Z.isArray(c)?c.slice():c}function n(u,c,d){if(Z.isUndefined(c)){if(!Z.isUndefined(u))return i(void 0,u,d)}else return i(u,c,d)}function s(u,c){if(!Z.isUndefined(c))return i(void 0,c)}function o(u,c){if(Z.isUndefined(c)){if(!Z.isUndefined(u))return i(void 0,u)}else return i(void 0,c)}function a(u,c,d){if(d in e)return i(u,c);if(d in r)return i(void 0,u)}let l={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(u,c)=>n(Xy(u),Xy(c),!0)};return Z.forEach(Object.keys(Object.assign({},r,e)),function(c){let d=l[c]||n,h=d(r[c],e[c],c);Z.isUndefined(h)&&d!==a||(t[c]=h)}),t}var id=r=>{let e=Er({},r),{data:t,withXSRFToken:i,xsrfHeaderName:n,xsrfCookieName:s,headers:o,auth:a}=e;e.headers=o=gi.from(o),e.url=Oa(Ga(e.baseURL,e.url),r.params,r.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let l;if(Z.isFormData(t)){if(vi.hasStandardBrowserEnv||vi.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((l=o.getContentType())!==!1){let[u,...c]=l?l.split(";").map(d=>d.trim()).filter(Boolean):[];o.setContentType([u||"multipart/form-data",...c].join("; "))}}if(vi.hasStandardBrowserEnv&&(i&&Z.isFunction(i)&&(i=i(e)),i||i!==!1&&qy(e.url))){let u=n&&s&&Ky.read(s);u&&o.set(n,u)}return e};var YI=typeof XMLHttpRequest<"u",Zy=YI&&function(r){return new Promise(function(t,i){let n=id(r),s=n.data,o=gi.from(n.headers).normalize(),{responseType:a,onUploadProgress:l,onDownloadProgress:u}=n,c,d,h,f,m;function p(){f&&f(),m&&m(),n.cancelToken&&n.cancelToken.unsubscribe(c),n.signal&&n.signal.removeEventListener("abort",c)}let g=new XMLHttpRequest;g.open(n.method.toUpperCase(),n.url,!0),g.timeout=n.timeout;function b(){if(!g)return;let w=gi.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),I={data:!a||a==="text"||a==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:w,config:r,request:g};Ua(function(T){t(T),p()},function(T){i(T),p()},I),g=null}"onloadend"in g?g.onloadend=b:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(b)},g.onabort=function(){g&&(i(new rt("Request aborted",rt.ECONNABORTED,r,g)),g=null)},g.onerror=function(){i(new rt("Network Error",rt.ERR_NETWORK,r,g)),g=null},g.ontimeout=function(){let _=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded",I=n.transitional||Qc;n.timeoutErrorMessage&&(_=n.timeoutErrorMessage),i(new rt(_,I.clarifyTimeoutError?rt.ETIMEDOUT:rt.ECONNABORTED,r,g)),g=null},s===void 0&&o.setContentType(null),"setRequestHeader"in g&&Z.forEach(o.toJSON(),function(_,I){g.setRequestHeader(I,_)}),Z.isUndefined(n.withCredentials)||(g.withCredentials=!!n.withCredentials),a&&a!=="json"&&(g.responseType=n.responseType),u&&([h,m]=Fo(u,!0),g.addEventListener("progress",h)),l&&g.upload&&([d,f]=Fo(l),g.upload.addEventListener("progress",d),g.upload.addEventListener("loadend",f)),(n.cancelToken||n.signal)&&(c=w=>{g&&(i(!w||w.type?new Wr(null,r,g):w),g.abort(),g=null)},n.cancelToken&&n.cancelToken.subscribe(c),n.signal&&(n.signal.aborted?c():n.signal.addEventListener("abort",c)));let F=Th(n.url);if(F&&vi.protocols.indexOf(F)===-1){i(new rt("Unsupported protocol "+F+":",rt.ERR_BAD_REQUEST,r));return}g.send(s||null)})};var QI=(r,e)=>{let t=new AbortController,i,n=function(l){if(!i){i=!0,o();let u=l instanceof Error?l:this.reason;t.abort(u instanceof rt?u:new Wr(u instanceof Error?u.message:u))}},s=e&&setTimeout(()=>{n(new rt(`timeout ${e} of ms exceeded`,rt.ETIMEDOUT))},e),o=()=>{r&&(s&&clearTimeout(s),s=null,r.forEach(l=>{l&&(l.removeEventListener?l.removeEventListener("abort",n):l.unsubscribe(n))}),r=null)};r.forEach(l=>l&&l.addEventListener&&l.addEventListener("abort",n));let{signal:a}=t;return a.unsubscribe=o,[a,()=>{s&&clearTimeout(s),s=null}]},Yy=QI;var ex=function*(r,e){let t=r.byteLength;if(!e||t<e){yield r;return}let i=0,n;for(;i<t;)n=i+e,yield r.slice(i,n),i=n},tx=async function*(r,e,t){for await(let i of r)yield*ex(ArrayBuffer.isView(i)?i:await t(String(i)),e)},Lh=(r,e,t,i,n)=>{let s=tx(r,e,n),o=0,a,l=u=>{a||(a=!0,i&&i(u))};return new ReadableStream({async pull(u){try{let{done:c,value:d}=await s.next();if(c){l(),u.close();return}let h=d.byteLength;if(t){let f=o+=h;t(f)}u.enqueue(new Uint8Array(d))}catch(c){throw l(c),c}},cancel(u){return l(u),s.return()}},{highWaterMark:2})};var nd=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",ev=nd&&typeof ReadableStream=="function",Oh=nd&&(typeof TextEncoder=="function"?(r=>e=>r.encode(e))(new TextEncoder):async r=>new Uint8Array(await new Response(r).arrayBuffer())),tv=(r,...e)=>{try{return!!r(...e)}catch{return!1}},ix=ev&&tv(()=>{let r=!1,e=new Request(vi.origin,{body:new ReadableStream,method:"POST",get duplex(){return r=!0,"half"}}).headers.has("Content-Type");return r&&!e}),Qy=64*1024,Mh=ev&&tv(()=>Z.isReadableStream(new Response("").body)),rd={stream:Mh&&(r=>r.body)};nd&&(r=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!rd[e]&&(rd[e]=Z.isFunction(r[e])?t=>t[e]():(t,i)=>{throw new rt(`Response type '${e}' is not supported`,rt.ERR_NOT_SUPPORT,i)})})})(new Response);var rx=async r=>{if(r==null)return 0;if(Z.isBlob(r))return r.size;if(Z.isSpecCompliantForm(r))return(await new Request(r).arrayBuffer()).byteLength;if(Z.isArrayBufferView(r)||Z.isArrayBuffer(r))return r.byteLength;if(Z.isURLSearchParams(r)&&(r=r+""),Z.isString(r))return(await Oh(r)).byteLength},nx=async(r,e)=>{let t=Z.toFiniteNumber(r.getContentLength());return t??rx(e)},iv=nd&&(async r=>{let{url:e,method:t,data:i,signal:n,cancelToken:s,timeout:o,onDownloadProgress:a,onUploadProgress:l,responseType:u,headers:c,withCredentials:d="same-origin",fetchOptions:h}=id(r);u=u?(u+"").toLowerCase():"text";let[f,m]=n||s||o?Yy([n,s],o):[],p,g,b=()=>{!p&&setTimeout(()=>{f&&f.unsubscribe()}),p=!0},F;try{if(l&&ix&&t!=="get"&&t!=="head"&&(F=await nx(c,i))!==0){let A=new Request(e,{method:"POST",body:i,duplex:"half"}),T;if(Z.isFormData(i)&&(T=A.headers.get("content-type"))&&c.setContentType(T),A.body){let[E,K]=Dh(F,Fo(Ah(l)));i=Lh(A.body,Qy,E,K,Oh)}}Z.isString(d)||(d=d?"include":"omit"),g=new Request(e,{...h,signal:f,method:t.toUpperCase(),headers:c.normalize().toJSON(),body:i,duplex:"half",credentials:d});let w=await fetch(g),_=Mh&&(u==="stream"||u==="response");if(Mh&&(a||_)){let A={};["status","statusText","headers"].forEach(P=>{A[P]=w[P]});let T=Z.toFiniteNumber(w.headers.get("content-length")),[E,K]=a&&Dh(T,Fo(Ah(a),!0))||[];w=new Response(Lh(w.body,Qy,E,()=>{K&&K(),_&&b()},Oh),A)}u=u||"text";let I=await rd[Z.findKey(rd,u)||"text"](w,r);return!_&&b(),m&&m(),await new Promise((A,T)=>{Ua(A,T,{data:I,headers:gi.from(w.headers),status:w.status,statusText:w.statusText,config:r,request:g})})}catch(w){throw b(),w&&w.name==="TypeError"&&/fetch/i.test(w.message)?Object.assign(new rt("Network Error",rt.ERR_NETWORK,r,g),{cause:w.cause||w}):rt.from(w,w&&w.code,r,g)}});var Nh={http:Zc,xhr:Zy,fetch:iv};Z.forEach(Nh,(r,e)=>{if(r){try{Object.defineProperty(r,"name",{value:e})}catch{}Object.defineProperty(r,"adapterName",{value:e})}});var rv=r=>`- ${r}`,sx=r=>Z.isFunction(r)||r===null||r===!1,sd={getAdapter:r=>{r=Z.isArray(r)?r:[r];let{length:e}=r,t,i,n={};for(let s=0;s<e;s++){t=r[s];let o;if(i=t,!sx(t)&&(i=Nh[(o=String(t)).toLowerCase()],i===void 0))throw new rt(`Unknown adapter '${o}'`);if(i)break;n[o||"#"+s]=i}if(!i){let s=Object.entries(n).map(([a,l])=>`adapter ${a} `+(l===!1?"is not supported by the environment":"is not available in the build")),o=e?s.length>1?`since :
`+s.map(rv).join(`
`):" "+rv(s[0]):"as no adapter specified";throw new rt("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return i},adapters:Nh};function jh(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new Wr(null,r)}function od(r){return jh(r),r.headers=gi.from(r.headers),r.data=Na.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),sd.getAdapter(r.adapter||wo.adapter)(r).then(function(i){return jh(r),i.data=Na.call(r,r.transformResponse,i),i.headers=gi.from(i.headers),i},function(i){return ja(i)||(jh(r),i&&i.response&&(i.response.data=Na.call(r,r.transformResponse,i.response),i.response.headers=gi.from(i.response.headers))),Promise.reject(i)})}var ad="1.7.4";var Uh={};["object","boolean","number","function","string","symbol"].forEach((r,e)=>{Uh[r]=function(i){return typeof i===r||"a"+(e<1?"n ":" ")+r}});var nv={};Uh.transitional=function(e,t,i){function n(s,o){return"[Axios v"+ad+"] Transitional option '"+s+"'"+o+(i?". "+i:"")}return(s,o,a)=>{if(e===!1)throw new rt(n(o," has been removed"+(t?" in "+t:"")),rt.ERR_DEPRECATED);return t&&!nv[o]&&(nv[o]=!0,console.warn(n(o," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(s,o,a):!0}};function ox(r,e,t){if(typeof r!="object")throw new rt("options must be an object",rt.ERR_BAD_OPTION_VALUE);let i=Object.keys(r),n=i.length;for(;n-- >0;){let s=i[n],o=e[s];if(o){let a=r[s],l=a===void 0||o(a,s,r);if(l!==!0)throw new rt("option "+s+" must be "+l,rt.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new rt("Unknown option "+s,rt.ERR_BAD_OPTION)}}var ld={assertOptions:ox,validators:Uh};var Vn=ld.validators,ko=class{constructor(e){this.defaults=e,this.interceptors={request:new Ch,response:new Ch}}async request(e,t){try{return await this._request(e,t)}catch(i){if(i instanceof Error){let n;Error.captureStackTrace?Error.captureStackTrace(n={}):n=new Error;let s=n.stack?n.stack.replace(/^.+\n/,""):"";try{i.stack?s&&!String(i.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+s):i.stack=s}catch{}}throw i}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=Er(this.defaults,t);let{transitional:i,paramsSerializer:n,headers:s}=t;i!==void 0&&ld.assertOptions(i,{silentJSONParsing:Vn.transitional(Vn.boolean),forcedJSONParsing:Vn.transitional(Vn.boolean),clarifyTimeoutError:Vn.transitional(Vn.boolean)},!1),n!=null&&(Z.isFunction(n)?t.paramsSerializer={serialize:n}:ld.assertOptions(n,{encode:Vn.function,serialize:Vn.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=s&&Z.merge(s.common,s[t.method]);s&&Z.forEach(["delete","get","head","post","put","patch","common"],m=>{delete s[m]}),t.headers=gi.concat(o,s);let a=[],l=!0;this.interceptors.request.forEach(function(p){typeof p.runWhen=="function"&&p.runWhen(t)===!1||(l=l&&p.synchronous,a.unshift(p.fulfilled,p.rejected))});let u=[];this.interceptors.response.forEach(function(p){u.push(p.fulfilled,p.rejected)});let c,d=0,h;if(!l){let m=[od.bind(this),void 0];for(m.unshift.apply(m,a),m.push.apply(m,u),h=m.length,c=Promise.resolve(t);d<h;)c=c.then(m[d++],m[d++]);return c}h=a.length;let f=t;for(d=0;d<h;){let m=a[d++],p=a[d++];try{f=m(f)}catch(g){p.call(this,g);break}}try{c=od.call(this,f)}catch(m){return Promise.reject(m)}for(d=0,h=u.length;d<h;)c=c.then(u[d++],u[d++]);return c}getUri(e){e=Er(this.defaults,e);let t=Ga(e.baseURL,e.url);return Oa(t,e.params,e.paramsSerializer)}};Z.forEach(["delete","get","head","options"],function(e){ko.prototype[e]=function(t,i){return this.request(Er(i||{},{method:e,url:t,data:(i||{}).data}))}});Z.forEach(["post","put","patch"],function(e){function t(i){return function(s,o,a){return this.request(Er(a||{},{method:e,headers:i?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}ko.prototype[e]=t(),ko.prototype[e+"Form"]=t(!0)});var za=ko;var Gh=class r{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(s){t=s});let i=this;this.promise.then(n=>{if(!i._listeners)return;let s=i._listeners.length;for(;s-- >0;)i._listeners[s](n);i._listeners=null}),this.promise.then=n=>{let s,o=new Promise(a=>{i.subscribe(a),s=a}).then(n);return o.cancel=function(){i.unsubscribe(s)},o},e(function(s,o,a){i.reason||(i.reason=new Wr(s,o,a),t(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;let t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}static source(){let e;return{token:new r(function(n){e=n}),cancel:e}}},sv=Gh;function zh(r){return function(t){return r.apply(null,t)}}function Vh(r){return Z.isObject(r)&&r.isAxiosError===!0}var Wh={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Wh).forEach(([r,e])=>{Wh[e]=r});var ov=Wh;function av(r){let e=new za(r),t=Ra(za.prototype.request,e);return Z.extend(t,za.prototype,e,{allOwnKeys:!0}),Z.extend(t,e,null,{allOwnKeys:!0}),t.create=function(n){return av(Er(r,n))},t}var ai=av(wo);ai.Axios=za;ai.CanceledError=Wr;ai.CancelToken=sv;ai.isCancel=ja;ai.VERSION=ad;ai.toFormData=zn;ai.AxiosError=rt;ai.Cancel=ai.CanceledError;ai.all=function(e){return Promise.all(e)};ai.spread=zh;ai.isAxiosError=Vh;ai.mergeConfig=Er;ai.AxiosHeaders=gi;ai.formToJSON=r=>ed(Z.isHTMLForm(r)?new FormData(r):r);ai.getAdapter=sd.getAdapter;ai.HttpStatusCode=ov;ai.default=ai;var zt=ai;var{Axios:ij,AxiosError:rj,CanceledError:nj,isCancel:sj,CancelToken:oj,VERSION:aj,all:lj,Cancel:uj,isAxiosError:cj,spread:dj,toFormData:fj,AxiosHeaders:hj,HttpStatusCode:pj,formToJSON:mj,getAdapter:gj,mergeConfig:bj}=zt;var Be=class{static isReloadableSetOfChanges(e){return e.hasFileOnlyOfExtension("js","ts","map")&&!e.getHasDeletions()}static getIsBuiltIn(e){return e==="minecraft:entity_spawned"||e==="minecraft:entity_born"||e==="minecraft:transformed"||e==="minecraft:on_prime"}static getAfterPackPath(e){let t=e.indexOf("#");return t>=0&&(e=e.substring(t+1)),e}static pathLooksLikeSkinPackContainerName(e){let t=e.toLowerCase();return t=t.replace(/\\/gi,"/"),t=t.replace(/ /gi,"_"),t=B.ensureEndsWithSlash(B.ensureStartsWithSlash(t)),!!(t.indexOf("skin_packs")>=0||t.indexOf("_sps")>=0||t.indexOf("/sps_")>=0||t.endsWith("sps/")||t==="/sps/"||t==="/sp/")}static pathLooksLikeBehaviorPackContainerName(e){let t=e.toLowerCase();return t=t.replace(/\\/gi,"/"),t=t.replace(/ /gi,"_"),t=B.ensureEndsWithSlash(B.ensureStartsWithSlash(t)),!!(t.indexOf("behavior_packs")>=0||t.indexOf("_bps")>=0||t.indexOf("/bps_")>=0||t.endsWith("bps/")||t==="/bps/"||t==="/bp/")}static pathLooksLikeResourcePackContainerName(e){let t=e.toLowerCase();return t=t.replace(/\\/gi,"/"),t=t.replace(/ /gi,"_"),t=B.ensureEndsWithSlash(B.ensureStartsWithSlash(t)),!!(t.indexOf("resource_packs")>=0||t.indexOf("_rps")>=0||t.indexOf("/rps_")>=0||t.endsWith("rps/")||t==="/rps/"||t==="/rp/")}static pathLooksLikePackContainerName(e){return this.pathLooksLikeBehaviorPackContainerName(e)||this.pathLooksLikeResourcePackContainerName(e)||this.pathLooksLikeSkinPackContainerName(e)}static pathLooksLikeBehaviorPackName(e){let t=e.toLowerCase();return t=t.replace(/\\/gi,"/"),t=t.replace(/ /gi,"_"),t=B.ensureEndsWithSlash(B.ensureStartsWithSlash(t)),t.indexOf("/behavior")>=0||t.indexOf("behavior_pack")>=0||t.indexOf("_bp")>=0||t.indexOf("/bp_")>=0||t.indexOf("/bp/")>=0}static shortenFilterDescription(e){return e=e.replace("Returns true if ",""),e=e.replace("True if ",""),e=e.replace("Returns true when ",""),e=e.replace("Tests the ",""),e=e.replace("Tests if ",""),e=e.replace("Tests whether ",""),e=e.replace("Tests for ",""),e=e.replace("Returns ",""),e.startsWith("the ")&&(e=e.substring(4)),e=B.ensureLooksLikeSentence(e),e}static pathLooksLikeResourcePackName(e){let t=e.toLowerCase();return t=t.replace(/\\/gi,"/"),t=t.replace(/ /gi,"_"),t=B.ensureEndsWithSlash(B.ensureStartsWithSlash(t)),t.indexOf("/resource")>=0||t.indexOf("resource_pack")>=0||t.indexOf("_rp")>=0||t.indexOf("/rp_")>=0||t.indexOf("/rp/")>=0}static pathLooksLikeSkinPackName(e){let t=e.toLowerCase();return t=t.replace(/\\/gi,"/"),t=t.replace(/ /gi,"_"),t=B.ensureEndsWithSlash(B.ensureStartsWithSlash(t)),t.indexOf("/skin")>=0||t.indexOf("skin_pack")>=0}static pathLooksLikePersonaPackName(e){let t=e.toLowerCase();return t=t.replace(/\\/gi,"/"),t=t.replace(/ /gi,"_"),t=B.ensureEndsWithSlash(B.ensureStartsWithSlash(t)),t.indexOf("/persona/")>=0}static pathLooksLikeWorldFolderName(e){let t=e.toLowerCase();return t=t.replace(/\\/gi,"/"),t=t.replace(/ /gi,"_"),t=B.ensureEndsWithSlash(B.ensureStartsWithSlash(t)),t.indexOf("/world")>=0}static pathLooksLikeSubPacksFolderName(e){let t=e.toLowerCase();return t=t.replace(/\\/gi,"/"),t=t.replace(/ /gi,"_"),t=B.ensureEndsWithSlash(B.ensureStartsWithSlash(t)),t.indexOf("/subpacks")>=0}static pathLooksLikePackName(e){return this.pathLooksLikeBehaviorPackName(e)||this.pathLooksLikeResourcePackName(e)||this.pathLooksLikeSkinPackName(e)}static replaceMinecraftPathTokens(e){return e.startsWith("<RPME>")?e+=".geo.json":e.startsWith("<BPE>")||e.startsWith("<BPLE>")||e.startsWith("<BPSR>")?e+=".json":e.startsWith("<RPE>")?e+=".entity.json":e.startsWith("<RPAC>")?e+=".animation_controllers.json":e.startsWith("<RPRC>")?e+=".render_controllers.json":e.startsWith("<RPA>")?e+=".animation.json":e.startsWith("<RPTE>")&&e.indexOf(".")<0&&(e+=".png"),e=e.replace(/<RPTE>/gi,"/resource_pack/textures/entity/"),e=e.replace(/<RPME>/gi,"/resource_pack/models/entity/"),e=e.replace(/<RPAC>/gi,"/resource_pack/animation_controllers/"),e=e.replace(/<RPRC>/gi,"/resource_pack/render_controllers/"),e=e.replace(/<RPA>/gi,"/resource_pack/animations/"),e=e.replace(/<RPE>/gi,"/resource_pack/entity/"),e=e.replace(/<BPE>/gi,"/behavior_pack/entities/"),e=e.replace(/<BPLE>/gi,"/behavior_pack/loot_tables/entities/"),e=e.replace(/<BPSR>/gi,"/behavior_pack/spawn_rules/"),e}static makeNameScriptSafe(e){for(e=e.replace(/[^a-z0-9]/gi,"-").replace(/\s+/g,"-");e.length>1&&!B.isAlpha(e.substring(0,1));)e=e.substring(1);return B.isAlpha(e.substring(0,1))||(e="a"+e),e}static makeNameFolderSafe(e){return e=B.replaceAll(e," ","-").toLowerCase(),e.length>16&&(e=e.substring(0,16)),e}static getVersionArrayFrom(e){if(typeof e=="number")return Math.floor(e)!==e?[Math.floor(e),Math.floor((e-Math.floor(e))*10),0]:[e,0,0];if(e===void 0)return[0,0,0];if(typeof e=="string"){let t=e.split("."),i=[];for(let n=0;n<t.length;n++)try{let s=parseInt(t[n]);if(isNaN(s))return[0,0,0];i.push(s)}catch{}for(;i.length<3;)i.push(0);return i}return e}static cleanUpScriptDescription(e){return e=B.replaceAll(e,"/*",""),e=B.replaceAll(e,`*/
`,""),e=B.replaceAll(e,`*
`,""),e=B.replaceAll(e,"*/",""),e=B.replaceAll(e,"*",""),e=B.replaceAll(e,"@beta",""),e=e.trim(),e}static getIdsAndVersions(e){let t=[],i=e.split(",");for(let n of i){let s=n.split("@"),o=!1;if(s.length===2){let a=s[1].split(".");if(a.length===3){let l=[];for(let u=0;u<a.length;u++){let c;try{c=parseInt(a[u])}catch{}c!==void 0&&l.push(c)}l.length===3&&this.isValidUuid(s[0])&&(t.push({uuid:s[0],version:l}),o=!0)}}o||C.fail("UUID/version is not in a good form (uuid@x.y.z) - is '"+n+"'")}return t}static isValidUuid(e){if(e.length===36){let t=e.split("-");if(t.length===5&&t[0].length===8&&t[1].length===4&&t[2].length===4&&t[3].length===4&&t[4].length===12){for(let i=0;i<t.length;i++)for(let n=0;n<t[i].length;n++)if(!B.isAlphaNumeric(t[i][n]))return!1}}return!1}static fixupJson(e){return e=e.replace(/([, ;}\]])0b([, ;}\]])/gi,"$1false$2"),e=e.replace(/([, ;}\]])1b([, ;}\]])/gi,"$1true$2"),e=e.replace(/(\d)b([, ;\]])/gi,"$1$2"),e=e.replace(/(\d)d([, ;\]])/gi,"$1$2"),e=e.replace(/(\d)f([, ;\]])/gi,"$1$2"),e=e.replace(/(\d)s([, ;\]])/gi,"$1$2"),e=e.replace(/\[I;/gi,"["),e=e.replace(//gi,""),e}static canonicalizeName(e){let t=e.toLowerCase().trim();return t.startsWith("minecraft:")&&(t=t.substring(10,t.length)),t}static canonicalizeFullName(e){let t=e.toLowerCase().trim();return t.indexOf(":")<0&&(t="minecraft:"+t),t}};var Va=Le(Je());var ax=["bone","cobblestone","stone","andesite","bedrock","blackstone","basalt","acacia","oak","gold","jungle","birch","big_oak","spruce","bamboo","chiseled_nether_bricks","chiseled_polished_blackstone_brick","cracked_netherbricks","cracked_polishedblackstone_bricks","end_brick","wood","purpur","brick","blue","black","brown","cyan","gray","light_blue","lime","magenta","orange","pink","purple","red","silver","white","yellow","fern","grass","paeonia","rose","rose_blue","sunflower","syringa","allium","blue_orchid","cornflower","dandelion","houstonia","lily_of_the_valley","oxeye_daisy","orange_tulip","pink_tulip","red_tulip","white_tulip","dark_oak","blue_ice","frosted_ice","ice"],Wa=class{constructor(e){this._typeId="";this._baseTypeId="";this._material="";this._isCustom=!1;this._behaviorPackData=null;this._isLoaded=!1;this._managed={};this._onLoaded=new Va.EventDispatcher;this._onComponentAdded=new Va.EventDispatcher;this._onComponentRemoved=new Va.EventDispatcher;this._onComponentChanged=new Va.EventDispatcher;this.renderType=0;this._typeId=e,this.javaData=null,this.data={name:e},e.indexOf(":")>=0&&!e.startsWith("minecraft:")&&(this._isCustom=!0);let t=Be.canonicalizeName(e);for(let i of ax)if(t.indexOf(i)>=0){this._material=i;break}}get numericId(){return this.data.id}get baseTypeId(){return this._baseTypeId}get mapColor(){return this.data.mapColor}get isCustom(){return this._isCustom}get baseType(){return this._baseType!==void 0?this._baseType:oe.defaultBlockBaseType}set baseType(e){this._baseType=e,this._baseTypeId=e.name}get material(){return this._material}get icon(){let e=this.data.icon;return e===void 0&&this.baseType!==void 0&&(e=this.baseType.icon),e}get typeId(){return this._typeId}get shortTypeName(){let e=this._typeId,t=e.indexOf(":");return t>=0&&(e=e.substring(t+1,e.length)),e}get title(){let e=this.shortTypeName;return B.humanifyMinecraftName(e)}getIcon(){let e=this.icon;if(e===void 0)return this.shortTypeName;let t=Be.canonicalizeName(this.shortTypeName),i=t.lastIndexOf("_"),n=t;switch(i>=0&&(n=n.substring(0,i)),e){case"st_":return"stone_"+n;case"le_":return"leaves_acacia_carried";case"pl_":return"planks_"+n;case"_car":return n+"_carried";case"plant_":return t+"_fern_carried";case"_":return t;case"_t":return n+"_top";case"_br":return n+"_bricks";case"_carr":return t+"_carried";case"_bl":return n+"_block";case"_n":return n+"_normal";case"_blt":return n+"_block_top";case"mshblk":return"mushroom_block_skin_"+n.split("_")[0];case"ml_sm":let o=n.split("_");return o[o.length-2]+"_"+o[o.length-1]+"_smooth";case"l_blt":let a=n.split("_");return a[a.length-1]+"_block_top";case"|":return n;case"|s":return n+"s";case"l":let l=n.split("_");return l[l.length-1];case"sb_":return"stonebricks_"+n.split("_")[0];case"st_l_sm":let c=n.split("_");return"stone_"+c[c.length-1]+"_smooth";case"|rv":let d="",h=n.split("_");for(let b=h.length-1;b>0;b--)d.length>0&&(d+="_"),d+=h[b];return d;case"2rv":let f="",m=t.split("_");if(m.length>=2){f=m[m.length-2]+"_"+m[m.length-1];for(let b=0;b<m.length-2;b++)f+="_"+m[b]}else f=t;return f;case"rv":let p="",g=t.split("_");for(let b=g.length-1;b>=0;b--)p.length>0&&(p+="_"),p+=g[b];return p}return this.icon!==void 0?this.icon:this.shortTypeName}get id(){return this.behaviorPackBlockTypeDef&&this.behaviorPackBlockTypeDef.description?this.behaviorPackBlockTypeDef.description.identifier:this._id}set id(e){this._id=e,this.behaviorPackBlockTypeDef&&this.behaviorPackBlockTypeDef.description&&e&&(this.behaviorPackBlockTypeDef.description.identifier=e)}get onComponentAdded(){return this._onComponentAdded.asEvent()}get onComponentRemoved(){return this._onComponentRemoved.asEvent()}get onComponentChanged(){return this._onComponentChanged.asEvent()}get isLoaded(){return this._isLoaded}get behaviorPackFile(){return this._behaviorPackFile}get onLoaded(){return this._onLoaded.asEvent()}set behaviorPackFile(e){this._behaviorPackFile=e}get shortId(){if(this._id!==void 0)return this._id.startsWith("minecraft:")?this._id.substring(10,this._id.length):this._id}getComponent(e){if(this.behaviorPackBlockTypeDef!==void 0){if(!this._managed[e]){let t=this.behaviorPackBlockTypeDef.components[e];t&&(this._managed[e]=new ei(e,t))}return this._managed[e]}}notifyComponentUpdated(e){let t=this.getComponent(e);t===void 0?C.unexpectedUndefined("BTNCU"):this._onComponentChanged.dispatch(this,t)}getAllComponents(){return this.getComponents()}getComponents(){let e=[];if(this.behaviorPackBlockTypeDef!==void 0)for(let t in this.behaviorPackBlockTypeDef.components){let i=this.getComponent(t);i!==void 0&&e.push(i)}return e}addComponent(e,t){this._ensureBehaviorPackDataInitialized();let i=this.behaviorPackBlockTypeDef;i.components[e]=t.getData(),this._managed[e]=t,this._onComponentAdded.dispatch(this,t)}removeComponent(e){if(this.behaviorPackBlockTypeDef===void 0)return;let t={},i={};for(let n in this.behaviorPackBlockTypeDef.components)if(n!==e){let s=this.behaviorPackBlockTypeDef.components[n];t[n]=s}for(let n in this._managed)n!==e&&(i[n]=this._managed[n]);this.behaviorPackBlockTypeDef.components=t,this._managed=i}_ensureBehaviorPackDataInitialized(){this.behaviorPackBlockTypeDef===void 0&&(this.behaviorPackBlockTypeDef={description:{identifier:"unknown"},components:{},events:{}})}persist(){if(this._behaviorPackFile===void 0)return;let e=JSON.stringify(this._behaviorPackData,null,2);this._behaviorPackFile.setContent(e)}async load(){if(this._behaviorPackFile===void 0||this._isLoaded||(await this._behaviorPackFile.loadContent(),!this._behaviorPackFile.content||this._behaviorPackFile.content instanceof Uint8Array))return;let e={},t=S.getJsonObject(this._behaviorPackFile);t&&(e=t),this._behaviorPackData=e;let i=e["minecraft:block"];i.description&&(this.id=i.description.identifier),this.behaviorPackBlockTypeDef=i,this._onLoaded.dispatch(this,this),this._isLoaded=!0}};var Co=class{constructor(e){this._name="";this._name=e,this.data={name:e}}get icon(){return this.data.icon}getProperty(e){if(this.data.properties!==void 0){for(let t=0;t<this.data.properties.length;t++)if(this.data.properties[t].name===e)return this.data.properties[t];throw new Error}}get isOpaque(){return this.data.isOpaque===void 0?!1:this.data.isOpaque}get shape(){return this.data.shape===void 0?!1:this.data.shape}get name(){return this._name}};var Ja=class extends Cr{constructor(t,i){super();this._pendingLoadRequests=[];this._isLoading=!1;this._parentFolder=t,this._name=i}get name(){return this._name}get isContentLoaded(){return!0}get parentFolder(){return this._parentFolder}get fullPath(){return this._parentFolder.fullPath+this.name}async exists(){return await this.loadContent(!1),this._content!==null}async loadContent(t){if(t||!this.lastLoadedOrSaved)if(this._isLoading){let i=this._pendingLoadRequests,n=(s,o)=>{i.push(s)};if(await new Promise(n),this.lastLoadedOrSaved===null)throw new Error;return this.lastLoadedOrSaved}else{this._content=null;let i=this.fullPath;if(S.getEncodingByFileName(this.name)===0)try{let s=await zt.get(i,{responseType:"arraybuffer",headers:{}});this._content=new Uint8Array(s.data)}catch{}else{let s=null;try{let o=await zt.get(i,{headers:{}});if(s=o.data,typeof s=="object")try{s=JSON.stringify(s,void 0,2)}catch{C.fail("Could not convert file to JSON")}o.status!==200&&C.verbose("Could not retrieve file from '"+i+"' - response code is "+o.status),(s===null||s==="null")&&C.verbose("Could not retrieve file from '"+i+"' - result is null.")}catch(o){C.verbose("Could not retrieve file from '"+i+"' - "+o)}this._content=s}this.lastLoadedOrSaved=new Date,this._isLoading=!1;let n=this._pendingLoadRequests;this._pendingLoadRequests=[];for(let s of n)s(void 0)}return this.lastLoadedOrSaved}async deleteThisFile(t){throw new Error("HttpFile is read-only.")}async moveTo(t){throw new Error("HttpFile is read-only.")}setContent(t){throw new Error("HttpFile is read-only.")}async saveContent(){throw new Error("HttpFile is read-only.")}};var $a=class r extends Sr{constructor(t,i,n){super();this._pendingLoadRequests=[];this._isLoading=!1;this._storage=t,this._parentFolder=i,this._name=n,this.folders={},this.files={}}get storage(){return this._storage}get parentFolder(){return this._parentFolder}get name(){return this._name}get fullPath(){return this._parentFolder===null?this._storage.baseUrl:this._parentFolder.fullPath+this.name+li.slashFolderDelimiter}async exists(){return!0}async ensureExists(){return!0}ensureFile(t){let i=S.canonicalizeName(t),n=this.files[i];return n===void 0&&(n=new Ja(this,t),this.files[i]=n),n}async moveTo(t){throw new Error("Not implemented.")}_removeFile(t){let i=S.canonicalizeName(t.name),n=this.files[i];C.assert(n===t,"Files don't match."),this.files[i]=void 0}_addExistingFile(t){let i=S.canonicalizeName(t.name);this.files[i]=t}ensureFolder(t){let i=S.canonicalizeName(t),n=this.folders[i];return n||(n=new r(this._storage,this,t),this.folders[i]=n),n}async deleteFile(t){throw new Error("Deletion of file not supported")}async createFile(t){throw new Error("Deletion of file not supported")}async deleteThisFolder(){throw new Error("Deletion of this folder "+this.fullPath+" is not supported.")}async deleteAllFolderContents(){throw new Error("Deletion of all folder contents at "+this.fullPath+" is not supported.")}async load(t){if(this.lastLoadedOrSaved!=null&&!t)return this.lastLoadedOrSaved;if(this._isLoading){let i=this._pendingLoadRequests,n=(s,o)=>{i.push(s)};if(await new Promise(n),this.lastLoadedOrSaved===null)throw new Error;return this.lastLoadedOrSaved}else{let i;try{i=await zt.get(this.fullPath+"index.json")}catch(s){C.debug(s)}if(i){let s=i.data;if(s.files!==null&&s.files!==void 0)for(let o=0;o<s.files.length;o++){let a=s.files[o];S.isUsableFile(a)&&this.ensureFile(a)}if(s.folders!==null&&s.folders!==void 0)for(let o=0;o<s.folders.length;o++){let a=s.folders[o];this.ensureFolder(a)}}this.updateLastLoadedOrSaved(),this._isLoading=!1;let n=this._pendingLoadRequests;this._pendingLoadRequests=[];for(let s of n)s(void 0)}return this.lastLoadedOrSaved}};var li=class extends Ni{constructor(e){super(),this.baseUrl=e,this.baseUrl.endsWith(Ni.slashFolderDelimiter)||(this.baseUrl+=Ni.slashFolderDelimiter),this.rootFolder=new $a(this,null,"")}};var Ha=class{constructor(e){if(this.packument=e,this.packument["dist-tags"]&&(this.latest=this.packument["dist-tags"].latest,this.beta=this.packument["dist-tags"].beta),this.beta){let t=this.beta.indexOf("-beta.");if(t>0){this.betaVersion=this.beta.substring(0,t),this.betaProductVersion=this.beta.substring(t+6);let i=this.betaProductVersion.indexOf("-");if(i>=0){this.latestPreviewVersion=this.betaProductVersion.substring(i);let n=this.latestPreviewVersion.split(".");n.length===3&&(n[2]==="0"?this.latestRetailVersion=n[0]+"."+(parseInt(n[1])-1).toString()+".0":this.latestRetailVersion=n[0]+"."+n[1]+"."+(parseInt(n[2])-10).toString())}}}}};var lx=Object.defineProperty,ux=(r,e)=>{for(var t in e)lx(r,t,{get:e[t],enumerable:!0})},mv=(r=>(r.AssignmentExpression="AssignmentExpression",r.AssignmentPattern="AssignmentPattern",r.ArrayExpression="ArrayExpression",r.ArrayPattern="ArrayPattern",r.ArrowFunctionExpression="ArrowFunctionExpression",r.AwaitExpression="AwaitExpression",r.BlockStatement="BlockStatement",r.BinaryExpression="BinaryExpression",r.BreakStatement="BreakStatement",r.CallExpression="CallExpression",r.CatchClause="CatchClause",r.ChainExpression="ChainExpression",r.ClassBody="ClassBody",r.ClassDeclaration="ClassDeclaration",r.ClassExpression="ClassExpression",r.ConditionalExpression="ConditionalExpression",r.ContinueStatement="ContinueStatement",r.Decorator="Decorator",r.DoWhileStatement="DoWhileStatement",r.DebuggerStatement="DebuggerStatement",r.EmptyStatement="EmptyStatement",r.ExportAllDeclaration="ExportAllDeclaration",r.ExportDefaultDeclaration="ExportDefaultDeclaration",r.ExportNamedDeclaration="ExportNamedDeclaration",r.ExportSpecifier="ExportSpecifier",r.ExpressionStatement="ExpressionStatement",r.ForStatement="ForStatement",r.ForOfStatement="ForOfStatement",r.ForInStatement="ForInStatement",r.FunctionDeclaration="FunctionDeclaration",r.FunctionExpression="FunctionExpression",r.Identifier="Identifier",r.IfStatement="IfStatement",r.ImportAttribute="ImportAttribute",r.ImportExpression="ImportExpression",r.ImportDeclaration="ImportDeclaration",r.ImportDefaultSpecifier="ImportDefaultSpecifier",r.ImportNamespaceSpecifier="ImportNamespaceSpecifier",r.ImportSpecifier="ImportSpecifier",r.Literal="Literal",r.LabeledStatement="LabeledStatement",r.LogicalExpression="LogicalExpression",r.MemberExpression="MemberExpression",r.MetaProperty="MetaProperty",r.MethodDefinition="MethodDefinition",r.NewExpression="NewExpression",r.ObjectExpression="ObjectExpression",r.ObjectPattern="ObjectPattern",r.Program="Program",r.Property="Property",r.PrivateIdentifier="PrivateIdentifier",r.RestElement="RestElement",r.ReturnStatement="ReturnStatement",r.SequenceExpression="SequenceExpression",r.SpreadElement="SpreadElement",r.StaticBlock="StaticBlock",r.Super="Super",r.SwitchCase="SwitchCase",r.SwitchStatement="SwitchStatement",r.TaggedTemplateExpression="TaggedTemplateExpression",r.TemplateElement="TemplateElement",r.TemplateLiteral="TemplateLiteral",r.ThisExpression="ThisExpression",r.ThrowStatement="ThrowStatement",r.TryStatement="TryStatement",r.UnaryExpression="UnaryExpression",r.UpdateExpression="UpdateExpression",r.VariableDeclaration="VariableDeclaration",r.VariableDeclarator="VariableDeclarator",r.WhileStatement="WhileStatement",r.WithStatement="WithStatement",r.YieldExpression="YieldExpression",r))(mv||{}),cx=class{attach;comments;stack;leading;trailing;constructor(){this.attach=!1,this.comments=[],this.stack=[],this.leading=[],this.trailing=[]}insertInnerComments(r,e){if(r.type==="BlockStatement"&&r.body.length===0){let t=[];for(let i=this.leading.length-1;i>=0;--i){let n=this.leading[i];e.end.offset>=n.start&&(t.unshift(n.comment),this.leading.splice(i,1),this.trailing.splice(i,1))}t.length&&(r.innerComments=t)}}findTrailingComments(r){let e=[];if(this.trailing.length>0){for(let i=this.trailing.length-1;i>=0;--i){let n=this.trailing[i];n.start>=r.end.offset&&e.unshift(n.comment)}return this.trailing.length=0,e}let t=this.stack[this.stack.length-1];if(t&&t.node.trailingComments){let i=t.node.trailingComments[0];i&&i.range[0]>=r.end.offset&&(e=t.node.trailingComments,delete t.node.trailingComments)}return e}findLeadingComments(r){let e=[],t;for(;this.stack.length>0;){let i=this.stack[this.stack.length-1];if(i&&i.start>=r.start.offset)t=i.node,this.stack.pop();else break}if(t){let i=t.leadingComments?t.leadingComments.length:0;for(let n=i-1;n>=0;--n){let s=t.leadingComments[n];s.range[1]<=r.start.offset&&(e.unshift(s),t.leadingComments.splice(n,1))}return t.leadingComments&&t.leadingComments.length===0&&delete t.leadingComments,e}for(let i=this.leading.length-1;i>=0;--i){let n=this.leading[i];n.start<=r.start.offset&&(e.unshift(n.comment),this.leading.splice(i,1))}return e}visitNode(r,e){if(r.type==="Program"&&r.body.length>0)return;this.insertInnerComments(r,e);let t=this.findTrailingComments(e),i=this.findLeadingComments(e);i.length>0&&(r.leadingComments=i),t.length>0&&(r.trailingComments=t),this.stack.push({node:r,start:e.start.offset})}visitComment(r,e){let t=r.type[0]==="L"?"Line":"Block",i={type:t,value:r.value};if(r.range&&(i.range=r.range),r.loc&&(i.loc=r.loc),this.comments.push(i),this.attach){let n={comment:{type:t,value:r.value,range:[e.start.offset,e.end.offset]},start:e.start.offset};r.loc&&(n.comment.loc=r.loc),r.type=t,this.leading.push(n),this.trailing.push(n)}}visit(r,e){r.type==="LineComment"?this.visitComment(r,e):r.type==="BlockComment"?this.visitComment(r,e):this.attach&&this.visitNode(r,e)}},uv={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEF\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7C6\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB67\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDEC0-\uDEEB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]/,NonAsciiIdentifierPart:/[\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05EF-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u07FD\u0800-\u082D\u0840-\u085B\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u08D3-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u09FE\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1878\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CD0-\u1CD2\u1CD4-\u1CFA\u1D00-\u1DF9\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEF\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7C6\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB67\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD27\uDD30-\uDD39\uDF00-\uDF1C\uDF27\uDF30-\uDF50\uDFE0-\uDFF6]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD44-\uDD46\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDC9-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3B-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC5E\uDC5F\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDC00-\uDC3A\uDCA0-\uDCE9\uDCFF\uDDA0-\uDDA7\uDDAA-\uDDD7\uDDDA-\uDDE1\uDDE3\uDDE4\uDE00-\uDE3E\uDE47\uDE50-\uDE99\uDE9D\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD8E\uDD90\uDD91\uDD93-\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF6]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF4F-\uDF87\uDF8F-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A\uDD00-\uDD2C\uDD30-\uDD3D\uDD40-\uDD49\uDD4E\uDEC0-\uDEF9]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4B\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/},qe={fromCodePoint(r){return r<65536?String.fromCharCode(r):String.fromCharCode(55296+(r-65536>>10))+String.fromCharCode(56320+(r-65536&1023))},isStringWellFormedUnicode(r){for(let e=0;e<r.length;e++){let t=r.charCodeAt(e);if(t>=55296&&t<=56319){if(e===r.length-1||(e++,t=r.charCodeAt(e),t<56320&&t>57343))return!1}else if(t>=56320&&t<=57343)return!1}return!0},isWhiteSpace(r){return r===32||r===9||r===11||r===12||r===160||r>=5760&&[5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(r)>=0},isLineTerminator(r){return r===10||r===13||r===8232||r===8233},isIdentifierStart(r){return r===36||r===95||r>=65&&r<=90||r>=97&&r<=122||r===92||r>=128&&uv.NonAsciiIdentifierStart.test(qe.fromCodePoint(r))},isIdentifierPart(r){return r===36||r===95||r>=65&&r<=90||r>=97&&r<=122||r>=48&&r<=57||r===92||r>=128&&uv.NonAsciiIdentifierPart.test(qe.fromCodePoint(r))},isDecimalDigit(r){return r>=48&&r<=57},isDecimalDigitChar(r){return r.length===1&&qe.isDecimalDigit(r.charCodeAt(0))},isHexDigit(r){return r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102},isHexDigitChar(r){return r.length===1&&qe.isHexDigit(r.charCodeAt(0))},isOctalDigit(r){return r>=48&&r<=55},isOctalDigitChar(r){return r.length===1&&qe.isOctalDigit(r.charCodeAt(0))}},dx=class{type;name;constructor(r){this.type="JSXClosingElement",this.name=r}},fx=class{type;constructor(){this.type="JSXClosingFragment"}},Jh=class{type;openingElement;children;closingElement;constructor(r,e,t){this.type="JSXElement",this.openingElement=r,this.children=e,this.closingElement=t}},hx=class{type;constructor(){this.type="JSXEmptyExpression"}},cv=class{type;expression;constructor(r){this.type="JSXExpressionContainer",this.expression=r}},px=class{type;name;constructor(r){this.type="JSXIdentifier",this.name=r}},mx=class{type;object;property;constructor(r,e){this.type="JSXMemberExpression",this.object=r,this.property=e}},gx=class{type;name;value;constructor(r,e){this.type="JSXAttribute",this.name=r,this.value=e}},dv=class{type;namespace;name;constructor(r,e){this.type="JSXNamespacedName",this.namespace=r,this.name=e}},fv=class{type;name;selfClosing;attributes;constructor(r,e,t){this.type="JSXOpeningElement",this.name=r,this.selfClosing=e,this.attributes=t}},bx=class{type;selfClosing;constructor(r){this.type="JSXOpeningFragment",this.selfClosing=r}},yx=class{type;argument;constructor(r){this.type="JSXSpreadAttribute",this.argument=r}},vx=class{type;value;raw;constructor(r,e){this.type="JSXText",this.value=r,this.raw=e}},wx={};ux(wx,{ArrayExpression:()=>gv,ArrayPattern:()=>bv,ArrowFunctionExpression:()=>yv,AssignmentExpression:()=>vv,AssignmentPattern:()=>ud,AsyncFunctionDeclaration:()=>wv,AwaitExpression:()=>_v,BigIntLiteral:()=>Hh,BinaryExpression:()=>cd,BlockStatement:()=>qh,BreakStatement:()=>Fv,CallExpression:()=>kv,CatchClause:()=>Cv,ChainExpression:()=>Kh,ClassBody:()=>Sv,ClassDeclaration:()=>Pv,ClassExpression:()=>Ev,ConditionalExpression:()=>Iv,ContinueStatement:()=>xv,DebuggerStatement:()=>Tv,Decorator:()=>Dv,Directive:()=>Av,DoWhileStatement:()=>Rv,EmptyStatement:()=>So,ExportAllDeclaration:()=>Bv,ExportDefaultDeclaration:()=>qa,ExportNamedDeclaration:()=>dd,ExportSpecifier:()=>Lv,ExpressionStatement:()=>fd,ForInStatement:()=>Ov,ForOfStatement:()=>Mv,ForStatement:()=>Nv,FunctionDeclaration:()=>jv,FunctionExpression:()=>ks,Identifier:()=>ur,IfStatement:()=>Uv,ImportAttribute:()=>Gv,ImportDeclaration:()=>Vv,ImportDefaultSpecifier:()=>Wv,ImportExpression:()=>zv,ImportNamespaceSpecifier:()=>Jv,ImportSpecifier:()=>$v,LabeledStatement:()=>Hv,Literal:()=>Wn,LogicalExpression:()=>Xh,MemberExpression:()=>Ka,MetaProperty:()=>Zh,MethodDefinition:()=>qv,Module:()=>Kv,NewExpression:()=>Xv,ObjectExpression:()=>Zv,ObjectPattern:()=>Yv,PrivateIdentifier:()=>Xa,Program:()=>_x,Property:()=>Yh,PropertyDefinition:()=>Qv,RegexLiteral:()=>ew,RestElement:()=>Za,ReturnStatement:()=>tw,Script:()=>iw,SequenceExpression:()=>hd,SpreadElement:()=>rw,StaticBlock:()=>nw,Super:()=>Qh,SwitchCase:()=>sw,SwitchStatement:()=>ow,TaggedTemplateExpression:()=>ep,TemplateElement:()=>tp,TemplateLiteral:()=>aw,ThisExpression:()=>lw,ThrowStatement:()=>uw,TryStatement:()=>cw,UnaryExpression:()=>dw,UpdateExpression:()=>ip,VariableDeclaration:()=>hn,VariableDeclarator:()=>rp,WhileStatement:()=>fw,WithStatement:()=>hw,YieldExpression:()=>pw});var gv=class{type;elements;constructor(r){this.type="ArrayExpression",this.elements=r}},bv=class{type;elements;constructor(r){this.type="ArrayPattern",this.elements=r}},yv=class{type;id;params;body;generator;expression;async;constructor(r,e,t,i){this.type="ArrowFunctionExpression",this.id=null,this.params=r,this.body=e,this.generator=!1,this.expression=t,this.async=i}},vv=class{type;operator;left;right;constructor(r,e,t){this.type="AssignmentExpression",this.operator=r,this.left=e,this.right=t}},ud=class{type;left;right;constructor(r,e){this.type="AssignmentPattern",this.left=r,this.right=e}},wv=class{type;id;params;body;generator;expression;async;constructor(r,e,t,i){this.type="FunctionDeclaration",this.id=r,this.params=e,this.body=t,this.generator=i,this.expression=!1,this.async=!0}},_v=class{type;argument;constructor(r){this.type="AwaitExpression",this.argument=r}},Hh=class{type;value;raw;bigint;constructor(r,e,t){this.type="Literal",this.value=r,this.raw=e,this.bigint=t}},cd=class{type;operator;left;right;constructor(r,e,t){this.type="BinaryExpression",this.operator=r,this.left=e,this.right=t}},qh=class{type;body;constructor(r){this.type="BlockStatement",this.body=r}},Fv=class{type;label;constructor(r){this.type="BreakStatement",this.label=r}},kv=class{type;callee;arguments;optional;constructor(r,e,t){this.type="CallExpression",this.callee=r,this.arguments=e,this.optional=t}},Cv=class{type;param;body;constructor(r,e){this.type="CatchClause",this.param=r,this.body=e}},Kh=class{type;expression;constructor(r){this.type="ChainExpression",this.expression=r}},Sv=class{type;body;constructor(r){this.type="ClassBody",this.body=r}},Pv=class{type;id;superClass;body;decorators;constructor(r,e,t,i){this.type="ClassDeclaration",this.id=r,this.superClass=e,this.body=t,this.decorators=i}},Ev=class{type;id;superClass;body;decorators;constructor(r,e,t,i){this.type="ClassExpression",this.id=r,this.superClass=e,this.body=t,this.decorators=i}},Iv=class{type;test;consequent;alternate;constructor(r,e,t){this.type="ConditionalExpression",this.test=r,this.consequent=e,this.alternate=t}},xv=class{type;label;constructor(r){this.type="ContinueStatement",this.label=r}},Tv=class{type;constructor(){this.type="DebuggerStatement"}},Dv=class{type;expression;constructor(r){this.type="Decorator",this.expression=r}},Av=class{type;expression;directive;constructor(r,e){this.type="ExpressionStatement",this.expression=r,this.directive=e}},Rv=class{type;body;test;constructor(r,e){this.type="DoWhileStatement",this.body=r,this.test=e}},So=class{type;constructor(){this.type="EmptyStatement"}},Bv=class{type;source;exported;assertions;constructor(r,e,t){this.type="ExportAllDeclaration",this.source=r,this.exported=e,this.assertions=t}},qa=class{type;declaration;constructor(r){this.type="ExportDefaultDeclaration",this.declaration=r}},dd=class{type;declaration;specifiers;source;assertions;constructor(r,e,t,i){this.type="ExportNamedDeclaration",this.declaration=r,this.specifiers=e,this.source=t,this.assertions=i}},Lv=class{type;exported;local;constructor(r,e){this.type="ExportSpecifier",this.exported=e,this.local=r}},fd=class{type;expression;constructor(r){this.type="ExpressionStatement",this.expression=r}},Ov=class{type;left;right;body;each;constructor(r,e,t){this.type="ForInStatement",this.left=r,this.right=e,this.body=t,this.each=!1}},Mv=class{type;await;left;right;body;constructor(r,e,t,i){this.type="ForOfStatement",this.await=i,this.left=r,this.right=e,this.body=t}},Nv=class{type;init;test;update;body;constructor(r,e,t,i){this.type="ForStatement",this.init=r,this.test=e,this.update=t,this.body=i}},jv=class{type;id;params;body;generator;expression;async;constructor(r,e,t,i){this.type="FunctionDeclaration",this.id=r,this.params=e,this.body=t,this.generator=i,this.expression=!1,this.async=!1}},ks=class{type;id;params;body;generator;expression;async;constructor(r,e,t,i,n){this.type="FunctionExpression",this.id=r,this.params=e,this.body=t,this.generator=i,this.expression=!1,this.async=n}},ur=class{type;name;constructor(r){this.type="Identifier",this.name=r}},Uv=class{type;test;consequent;alternate;constructor(r,e,t){this.type="IfStatement",this.test=r,this.consequent=e,this.alternate=t}},Gv=class{type;key;value;constructor(r,e){this.type="ImportAttribute",this.key=r,this.value=e}},zv=class{type;source;attributes;constructor(r,e){this.type="ImportExpression",this.source=r,this.attributes=e}},Vv=class{type;specifiers;source;assertions;constructor(r,e,t){this.type="ImportDeclaration",this.specifiers=r,this.source=e,this.assertions=t}},Wv=class{type;local;constructor(r){this.type="ImportDefaultSpecifier",this.local=r}},Jv=class{type;local;constructor(r){this.type="ImportNamespaceSpecifier",this.local=r}},$v=class{type;local;imported;constructor(r,e){this.type="ImportSpecifier",this.local=r,this.imported=e}},Hv=class{type;label;body;constructor(r,e){this.type="LabeledStatement",this.label=r,this.body=e}},Wn=class{type;value;raw;constructor(r,e){this.type="Literal",this.value=r,this.raw=e}},Xh=class{type;operator;left;right;constructor(r,e,t){this.type="LogicalExpression",this.operator=r,this.left=e,this.right=t}},Ka=class{type;computed;object;property;optional;constructor(r,e,t,i){this.type="MemberExpression",this.computed=r,this.object=e,this.property=t,this.optional=i}},Zh=class{type;meta;property;constructor(r,e){this.type="MetaProperty",this.meta=r,this.property=e}},qv=class{type;key;computed;value;kind;static;decorators;constructor(r,e,t,i,n,s){this.type="MethodDefinition",this.key=r,this.computed=e,this.value=t,this.kind=i,this.static=n,this.decorators=s}},Kv=class{type;body;sourceType;constructor(r){this.type="Program",this.body=r,this.sourceType="module"}},Xv=class{type;callee;arguments;constructor(r,e){this.type="NewExpression",this.callee=r,this.arguments=e}},Zv=class{type;properties;constructor(r){this.type="ObjectExpression",this.properties=r}},Yv=class{type;properties;constructor(r){this.type="ObjectPattern",this.properties=r}},Xa=class{type;name;constructor(r){this.type="PrivateIdentifier",this.name=r}},_x=class{type;body;sourceType;constructor(r,e){this.type="Program",this.sourceType=r,this.body=e}},Yh=class{type;key;computed;value;kind;method;shorthand;constructor(r,e,t,i,n,s){this.type="Property",this.key=e,this.computed=t,this.value=i,this.kind=r,this.method=n,this.shorthand=s}},Qv=class{type;key;computed;value;static;decorators;constructor(r,e,t,i,n){this.type="Property",this.key=r,this.computed=e,this.value=t,this.static=i,this.decorators=n}},ew=class{type;value;raw;regex;constructor(r,e,t,i){this.type="Literal",this.value=r,this.raw=e,this.regex={pattern:t,flags:i}}},Za=class{type;argument;constructor(r){this.type="RestElement",this.argument=r}},tw=class{type;argument;constructor(r){this.type="ReturnStatement",this.argument=r}},iw=class{type;body;sourceType;constructor(r){this.type="Program",this.body=r,this.sourceType="script"}},hd=class{type;expressions;constructor(r){this.type="SequenceExpression",this.expressions=r}},rw=class{type;argument;constructor(r){this.type="SpreadElement",this.argument=r}},nw=class{type;body;constructor(r){this.type="StaticBlock",this.body=r}},Qh=class{type;constructor(){this.type="Super"}},sw=class{type;test;consequent;constructor(r,e){this.type="SwitchCase",this.test=r,this.consequent=e}},ow=class{type;discriminant;cases;constructor(r,e){this.type="SwitchStatement",this.discriminant=r,this.cases=e}},ep=class{type;tag;quasi;constructor(r,e){this.type="TaggedTemplateExpression",this.tag=r,this.quasi=e}},tp=class{type;value;tail;constructor(r,e){this.type="TemplateElement",this.value=r,this.tail=e}},aw=class{type;quasis;expressions;constructor(r,e){this.type="TemplateLiteral",this.quasis=r,this.expressions=e}},lw=class{type;constructor(){this.type="ThisExpression"}},uw=class{type;argument;constructor(r){this.type="ThrowStatement",this.argument=r}},cw=class{type;block;handler;finalizer;constructor(r,e,t){this.type="TryStatement",this.block=r,this.handler=e,this.finalizer=t}},dw=class{type;operator;argument;prefix;constructor(r,e){this.type="UnaryExpression",this.operator=r,this.argument=e,this.prefix=!0}},ip=class{type;operator;argument;prefix;constructor(r,e,t){this.type="UpdateExpression",this.operator=r,this.argument=e,this.prefix=t}},hn=class{type;declarations;kind;constructor(r,e){this.type="VariableDeclaration",this.declarations=r,this.kind=e}},rp=class{type;id;init;constructor(r,e){this.type="VariableDeclarator",this.id=r,this.init=e}},fw=class{type;test;body;constructor(r,e){this.type="WhileStatement",this.test=r,this.body=e}},hw=class{type;object;body;constructor(r,e){this.type="WithStatement",this.object=r,this.body=e}},pw=class{type;argument;delegate;constructor(r,e){this.type="YieldExpression",this.argument=r,this.delegate=e}};function pn(r,e){if(!r)throw new Error("ASSERT: "+e)}var mw=class{errors;tolerant;constructor(){this.errors=[],this.tolerant=!1}recordError(r){this.errors.push(r)}tolerate(r){if(this.tolerant)this.recordError(r);else throw r}constructError(r,e){let t=new Error(r);try{throw t}catch(i){Object.create&&Object.defineProperty&&(t=Object.create(i),Object.defineProperty(t,"column",{value:e}))}return t}createError(r,e,t,i){let n="Line "+e+": "+i,s=this.constructError(n,t);return s.index=r,s.lineNumber=e,s.description=i,s}throwError(r,e,t,i){throw this.createError(r,e,t,i)}tolerateError(r,e,t,i){let n=this.createError(r,e,t,i);if(this.tolerant)this.recordError(n);else throw n}},le={AsyncFunctionInSingleStatementContext:"Async functions can only be declared at the top level or inside a block.",BadImportCallArity:"Unexpected token",BadGetterArity:"Getter must not have any formal parameters",BadSetterArity:"Setter must have exactly one formal parameter",BadSetterRestParameter:"Setter function argument must not be a rest parameter",CannotUseImportMetaOutsideAModule:"Cannot use 'import.meta' outside a module",ConstructorIsAsync:"Class constructor may not be an async method",ConstructorIsPrivate:"Class constructor may not be a private method",ConstructorSpecialMethod:"Class constructor may not be an accessor",DeclarationMissingInitializer:"Missing initializer in %0 declaration",DefaultRestParameter:"Unexpected token =",DefaultRestProperty:"Unexpected token =",DuplicateBinding:"Duplicate binding %0",DuplicateConstructor:"A class may only have one constructor",DuplicateParameter:"Duplicate parameter name not allowed in this context",DuplicateProtoProperty:"Duplicate __proto__ fields are not allowed in object literals",ForInOfLoopInitializer:"%0 loop variable declaration may not have an initializer",GeneratorInLegacyContext:"Generator declarations are not allowed in legacy contexts",IllegalBreak:"Illegal break statement",IllegalContinue:"Illegal continue statement",IllegalExportDeclaration:"Unexpected token",IllegalImportDeclaration:"Unexpected token",IllegalLanguageModeDirective:"Illegal 'use strict' directive in function with non-simple parameter list",IllegalReturn:"Illegal return statement",InvalidEscapedReservedWord:"Keyword must not contain escaped characters",InvalidHexEscapeSequence:"Invalid hexadecimal escape sequence",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",InvalidLHSInForLoop:"Invalid left-hand side in for-loop",InvalidModuleSpecifier:"Unexpected token",InvalidRegExp:"Invalid regular expression",InvalidTaggedTemplateOnOptionalChain:"Invalid tagged template on optional chain",InvalidUnicodeEscapeSequence:"Invalid Unicode escape sequence",LetInLexicalBinding:"let is disallowed as a lexically bound name",MissingFromClause:"Unexpected token",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NewlineAfterThrow:"Illegal newline after throw",NoAsAfterImportNamespace:"Unexpected token",NoAsAndFromEscapeSequences:"The `as` and `from` contextual keywords must not contain Unicode escape sequences.",NoCatchOrFinally:"Missing catch or finally after try",NoSemicolonAfterDecorator:"Decorators must not be followed by a semicolon.",NumericSeperatorOneUnderscore:"Numeric separator must be exactly one underscore",NumericSeperatorNotAllowedHere:"Numeric separator is not allowed here",ParameterAfterRestParameter:"Rest parameter must be last formal parameter",PropertyAfterRestProperty:"Unexpected token",Redeclaration:"%0 '%1' has already been declared",StaticPrototype:"Classes may not have static property named prototype",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictFunction:"In strict mode code, functions can only be declared at top level or inside a block",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictModeWith:"Strict mode code may not include a with statement",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictReservedWord:"Use of future reserved word in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",TemplateOctalLiteral:"Octal literals are not allowed in template strings.",TemplateEscape89:"\\8 and \\9 are not allowed in template strings.",UnexpectedEOS:"Unexpected end of input",UnexpectedIdentifier:"Unexpected identifier",UnexpectedNumber:"Unexpected number",UnexpectedReserved:"Unexpected reserved word",UnexpectedString:"Unexpected string",UnexpectedSuper:"'super' keyword unexpected here",UnexpectedTemplate:"Unexpected quasi %0",UnexpectedToken:"Unexpected token %0",UnexpectedTokenIllegal:"Unexpected token ILLEGAL",UnknownLabel:"Undefined label '%0'",UnterminatedRegExp:"Invalid regular expression: missing /"},Xi={};Xi[1]="Boolean";Xi[2]="<end>";Xi[3]="Identifier";Xi[4]="Keyword";Xi[5]="Null";Xi[6]="Numeric";Xi[7]="Punctuator";Xi[8]="String";Xi[9]="RegularExpression";Xi[10]="Template";function hv(r){return"0123456789abcdef".indexOf(r.toLowerCase())}function $h(r){return"01234567".indexOf(r)}var gw=class{source;errorHandler;trackComment;isModule;index;lineNumber;lineStart;curlyStack;length;constructor(r,e){this.source=r,this.errorHandler=e,this.trackComment=!1,this.isModule=!1,this.length=r.length,this.index=0,this.lineNumber=r.length>0?1:0,this.lineStart=0,this.curlyStack=[]}saveState(){return{index:this.index,lineNumber:this.lineNumber,lineStart:this.lineStart,curlyStack:this.curlyStack.slice()}}restoreState(r){this.index=r.index,this.lineNumber=r.lineNumber,this.lineStart=r.lineStart,this.curlyStack=r.curlyStack}eof(){return this.index>=this.length}throwUnexpectedToken(r=le.UnexpectedTokenIllegal){return this.errorHandler.throwError(this.index,this.lineNumber,this.index-this.lineStart+1,r)}tolerateUnexpectedToken(r=le.UnexpectedTokenIllegal){this.errorHandler.tolerateError(this.index,this.lineNumber,this.index-this.lineStart+1,r)}skipSingleLineComment(r){let e=[],t,i;for(this.trackComment&&(e=[],t=this.index-r,i={start:{line:this.lineNumber,column:this.index-this.lineStart-r},end:{}});!this.eof();){let n=this.source.charCodeAt(this.index);if(++this.index,qe.isLineTerminator(n)){if(this.trackComment){i.end={line:this.lineNumber,column:this.index-this.lineStart-1};let s={multiLine:!1,slice:[t+r,this.index-1],range:[t,this.index-1],loc:i};e.push(s)}return n===13&&this.source.charCodeAt(this.index)===10&&++this.index,++this.lineNumber,this.lineStart=this.index,e}}if(this.trackComment){i.end={line:this.lineNumber,column:this.index-this.lineStart};let n={multiLine:!1,slice:[t+r,this.index],range:[t,this.index],loc:i};e.push(n)}return e}skipMultiLineComment(){let r=[],e,t;for(this.trackComment&&(r=[],e=this.index-2,t={start:{line:this.lineNumber,column:this.index-this.lineStart-2},end:{}});!this.eof();){let i=this.source.charCodeAt(this.index);if(qe.isLineTerminator(i))i===13&&this.source.charCodeAt(this.index+1)===10&&++this.index,++this.lineNumber,++this.index,this.lineStart=this.index;else if(i===42){if(this.source.charCodeAt(this.index+1)===47){if(this.index+=2,this.trackComment){t.end={line:this.lineNumber,column:this.index-this.lineStart};let n={multiLine:!0,slice:[e+2,this.index-2],range:[e,this.index],loc:t};r.push(n)}return r}++this.index}else++this.index}if(this.trackComment){t.end={line:this.lineNumber,column:this.index-this.lineStart};let i={multiLine:!0,slice:[e+2,this.index],range:[e,this.index],loc:t};r.push(i)}return this.tolerateUnexpectedToken(),r}scanComments(){let r;this.trackComment&&(r=[]);let e=this.index===0;for(;!this.eof();){let t=this.source.charCodeAt(this.index);if(qe.isWhiteSpace(t))++this.index;else if(qe.isLineTerminator(t))++this.index,t===13&&this.source.charCodeAt(this.index)===10&&++this.index,++this.lineNumber,this.lineStart=this.index,e=!0;else if(t===47)if(t=this.source.charCodeAt(this.index+1),t===47){this.index+=2;let i=this.skipSingleLineComment(2);this.trackComment&&(r=r.concat(i)),e=!0}else if(t===42){this.index+=2;let i=this.skipMultiLineComment();this.trackComment&&(r=r.concat(i))}else break;else if(e&&t===45)if(this.source.charCodeAt(this.index+1)===45&&this.source.charCodeAt(this.index+2)===62){this.index+=3;let i=this.skipSingleLineComment(3);this.trackComment&&(r=r.concat(i))}else break;else if(t===60&&!this.isModule)if(this.source.slice(this.index+1,this.index+4)==="!--"){this.index+=4;let i=this.skipSingleLineComment(4);this.trackComment&&(r=r.concat(i))}else break;else break}return r}isFutureReservedWord(r){switch(r){case"enum":case"export":case"import":case"super":return!0;default:return!1}}isStrictModeReservedWord(r){switch(r){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return!0;default:return!1}}isRestrictedWord(r){return r==="eval"||r==="arguments"}isKeyword(r){switch(r.length){case 2:return r==="if"||r==="in"||r==="do";case 3:return r==="var"||r==="for"||r==="new"||r==="try"||r==="let";case 4:return r==="this"||r==="else"||r==="case"||r==="void"||r==="with"||r==="enum";case 5:return r==="while"||r==="break"||r==="catch"||r==="throw"||r==="const"||r==="yield"||r==="class"||r==="super";case 6:return r==="return"||r==="typeof"||r==="delete"||r==="switch"||r==="export"||r==="import";case 7:return r==="default"||r==="finally"||r==="extends";case 8:return r==="function"||r==="continue"||r==="debugger";case 10:return r==="instanceof";default:return!1}}codePointAt(r){let e=this.source.charCodeAt(r);if(e>=55296&&e<=56319){let t=this.source.charCodeAt(r+1);t>=56320&&t<=57343&&(e=(e-55296)*1024+t-56320+65536)}return e}scanHexEscape(r){let e=r==="u"?4:2,t=0;for(let i=0;i<e;++i)if(!this.eof()&&qe.isHexDigit(this.source.charCodeAt(this.index)))t=t*16+hv(this.source[this.index++]);else return null;return String.fromCharCode(t)}tryToScanUnicodeCodePointEscape(){let r=this.source[this.index],e=0;if(r==="}")return null;for(;!this.eof()&&(r=this.source[this.index++],!!qe.isHexDigit(r.charCodeAt(0)));)e=e*16+hv(r);return e>1114111||r!=="}"?null:qe.fromCodePoint(e)}scanUnicodeCodePointEscape(){let r=this.tryToScanUnicodeCodePointEscape();return r===null?this.throwUnexpectedToken():r}getIdentifier(){let r=this.index++;for(;!this.eof();){let e=this.source.charCodeAt(this.index);if(e===92)return this.index=r,this.getComplexIdentifier();if(e>=55296&&e<57343)return this.index=r,this.getComplexIdentifier();if(qe.isIdentifierPart(e))++this.index;else break}return this.source.slice(r,this.index)}getComplexIdentifier(){let r=this.codePointAt(this.index),e=qe.fromCodePoint(r);this.index+=e.length;let t;for(r===92&&(this.source.charCodeAt(this.index)!==117&&this.throwUnexpectedToken(),++this.index,this.source[this.index]==="{"?(++this.index,t=this.scanUnicodeCodePointEscape()):(t=this.scanHexEscape("u"),(t===null||t==="\\"||!qe.isIdentifierStart(t.charCodeAt(0)))&&this.throwUnexpectedToken()),e=t);!this.eof()&&(r=this.codePointAt(this.index),!!qe.isIdentifierPart(r));)t=qe.fromCodePoint(r),e+=t,this.index+=t.length,r===92&&(e=e.substr(0,e.length-1),this.source.charCodeAt(this.index)!==117&&this.throwUnexpectedToken(),++this.index,this.source[this.index]==="{"?(++this.index,t=this.scanUnicodeCodePointEscape()):(t=this.scanHexEscape("u"),(t===null||t==="\\"||!qe.isIdentifierPart(t.charCodeAt(0)))&&this.throwUnexpectedToken()),e+=t);return e}octalToDecimal(r){let e=r!=="0",t=$h(r);return!this.eof()&&qe.isOctalDigit(this.source.charCodeAt(this.index))&&(e=!0,t=t*8+$h(this.source[this.index++]),"0123".indexOf(r)>=0&&!this.eof()&&qe.isOctalDigit(this.source.charCodeAt(this.index))&&(t=t*8+$h(this.source[this.index++]))),{code:t,octal:e}}scanIdentifier(){let r,e=this.index,t=this.source.charCodeAt(e)===92,i=t?this.getComplexIdentifier():this.getIdentifier();if(i.length===1?r=3:this.isKeyword(i)?r=4:i==="null"?r=5:i==="true"||i==="false"?r=1:r=3,r!==3&&e+i.length!==this.index){let n=this.index;this.index=e,this.tolerateUnexpectedToken(le.InvalidEscapedReservedWord),this.index=n}return{type:r,value:i,lineNumber:this.lineNumber,lineStart:this.lineStart,start:e,end:this.index,escaped:t}}scanPunctuator(){let r=this.index,e=this.source[this.index];switch(e){case"(":case"{":e==="{"&&this.curlyStack.push("{"),++this.index;break;case".":++this.index,this.source[this.index]==="."&&this.source[this.index+1]==="."&&(this.index+=2,e="...");break;case"}":++this.index,this.curlyStack.pop();break;case"?":++this.index,this.source[this.index]==="?"&&(++this.index,this.source[this.index]==="="?(++this.index,e="??="):e="??"),this.source[this.index]==="."&&!/^\d$/.test(this.source[this.index+1])&&(++this.index,e="?.");break;case"#":case")":case";":case",":case"[":case"]":case":":case"~":case"@":++this.index;break;default:e=this.source.substr(this.index,4),e===">>>="?this.index+=4:(e=e.substr(0,3),e==="==="||e==="!=="||e===">>>"||e==="<<="||e===">>="||e==="**="||e==="&&="||e==="||="?this.index+=3:(e=e.substr(0,2),e==="&&"||e==="||"||e==="=="||e==="!="||e==="+="||e==="-="||e==="*="||e==="/="||e==="++"||e==="--"||e==="<<"||e===">>"||e==="&="||e==="|="||e==="^="||e==="%="||e==="<="||e===">="||e==="=>"||e==="**"?this.index+=2:(e=this.source[this.index],"<>=!+-*%&|^/".indexOf(e)>=0&&++this.index)))}return this.index===r&&this.throwUnexpectedToken(),{type:7,value:e,lineNumber:this.lineNumber,lineStart:this.lineStart,start:r,end:this.index}}scanHexLiteral(r){let e=this.scanLiteralPart(qe.isHexDigitChar);return e.length===0&&this.throwUnexpectedToken(),this.source[this.index]==="n"?(this.index++,{type:6,value:BigInt("0x"+e),lineNumber:this.lineNumber,lineStart:this.lineStart,start:r,end:this.index}):(qe.isIdentifierStart(this.source.charCodeAt(this.index))&&this.throwUnexpectedToken(),{type:6,value:parseInt("0x"+e,16),lineNumber:this.lineNumber,lineStart:this.lineStart,start:r,end:this.index})}scanBinaryLiteral(r){let e,t=this.scanLiteralPart(i=>i==="0"||i==="1");return t.length===0&&this.throwUnexpectedToken(),this.source[this.index]==="n"?(this.index++,{type:6,value:BigInt("0b"+t),lineNumber:this.lineNumber,lineStart:this.lineStart,start:r,end:this.index}):(this.eof()||(e=this.source.charCodeAt(this.index),(qe.isIdentifierStart(e)||qe.isDecimalDigit(e))&&this.throwUnexpectedToken()),{type:6,value:parseInt(t,2),lineNumber:this.lineNumber,lineStart:this.lineStart,start:r,end:this.index})}scanOctalLiteral(r,e){let t="",i=!1;return qe.isOctalDigit(r.charCodeAt(0))?(i=!0,t="0"+this.source[this.index++]):++this.index,t+=this.scanLiteralPart(qe.isOctalDigitChar),!i&&t.length===0&&this.throwUnexpectedToken(),this.source[this.index]==="n"?(this.index++,{type:6,value:BigInt("0o"+t),lineNumber:this.lineNumber,lineStart:this.lineStart,start:e,end:this.index}):((qe.isIdentifierStart(this.source.charCodeAt(this.index))||qe.isDecimalDigit(this.source.charCodeAt(this.index)))&&this.throwUnexpectedToken(),{type:6,value:parseInt(t,8),octal:i,lineNumber:this.lineNumber,lineStart:this.lineStart,start:e,end:this.index})}isImplicitOctalLiteral(){for(let r=this.index+1;r<this.length;++r){let e=this.source[r];if(e==="8"||e==="9"||e==="n")return!1;if(!qe.isOctalDigit(e.charCodeAt(0)))return!0}return!0}scanLiteralPart(r){let e="";for(this.source[this.index]==="_"&&this.throwUnexpectedToken(le.NumericSeperatorNotAllowedHere);this.source[this.index]&&(r(this.source[this.index])||this.source[this.index]==="_");)this.source[this.index]!=="_"&&(e+=this.source[this.index]),this.index++,this.source[this.index-1]==="_"&&this.source[this.index]==="_"&&this.throwUnexpectedToken(le.NumericSeperatorOneUnderscore);return this.source[this.index-1]==="_"&&this.throwUnexpectedToken(le.NumericSeperatorNotAllowedHere),e}scanNumericLiteral(){let r=this.index,e=this.source[r];pn(qe.isDecimalDigit(e.charCodeAt(0))||e===".","Numeric literal must start with a decimal digit or a decimal point");let t="";if(e!=="."){if(t=this.source[this.index++],e=this.source[this.index],t==="0"){if(e==="x"||e==="X")return++this.index,this.scanHexLiteral(r);if(e==="b"||e==="B")return++this.index,this.scanBinaryLiteral(r);if(e==="o"||e==="O")return this.scanOctalLiteral(e,r);if(e&&qe.isOctalDigit(e.charCodeAt(0))&&this.isImplicitOctalLiteral())return this.scanOctalLiteral(e,r)}this.index--,t=this.scanLiteralPart(qe.isDecimalDigitChar),e=this.source[this.index]}if(e==="."&&(t+=this.source[this.index++],t+=this.scanLiteralPart(qe.isDecimalDigitChar),e=this.source[this.index]),e==="e"||e==="E")t+=this.source[this.index++],e=this.source[this.index],(e==="+"||e==="-")&&(t+=this.source[this.index++]),qe.isDecimalDigit(this.source.charCodeAt(this.index))?t+=this.scanLiteralPart(qe.isDecimalDigitChar):this.throwUnexpectedToken();else if(e==="n")return t.length>1&&t[0]==="0"&&this.throwUnexpectedToken(),this.index++,{type:6,value:BigInt(t),lineNumber:this.lineNumber,lineStart:this.lineStart,start:r,end:this.index};return qe.isIdentifierStart(this.source.charCodeAt(this.index))&&this.throwUnexpectedToken(),{type:6,value:parseFloat(t),lineNumber:this.lineNumber,lineStart:this.lineStart,start:r,end:this.index}}scanStringLiteral(){let r=this.index,e=this.source[r];pn(e==="'"||e==='"',"String literal must starts with a quote"),++this.index;let t=!1,i="";for(;!this.eof();){let n=this.source[this.index++];if(n===e){e="";break}else if(n==="\\")if(n=this.source[this.index++],!n||!qe.isLineTerminator(n.charCodeAt(0)))switch(n){case"u":if(this.source[this.index]==="{")++this.index,i+=this.scanUnicodeCodePointEscape();else{let o=this.scanHexEscape(n);o===null&&this.throwUnexpectedToken(),i+=o}break;case"x":let s=this.scanHexEscape(n);s===null&&this.throwUnexpectedToken(le.InvalidHexEscapeSequence),i+=s;break;case"n":i+=`
`;break;case"r":i+="\r";break;case"t":i+="	";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;case"8":case"9":i+=n,this.tolerateUnexpectedToken();break;default:if(n&&qe.isOctalDigit(n.charCodeAt(0))){let o=this.octalToDecimal(n);t=o.octal||t,i+=String.fromCharCode(o.code)}else i+=n;break}else++this.lineNumber,n==="\r"&&this.source[this.index]===`
`&&++this.index,this.lineStart=this.index;else{if(qe.isLineTerminator(n.charCodeAt(0)))break;i+=n}}return e!==""&&(this.index=r,this.throwUnexpectedToken()),{type:8,value:i,octal:t,lineNumber:this.lineNumber,lineStart:this.lineStart,start:r,end:this.index}}scanTemplate(){let r="",e=!1,t=this.index,i=this.source[t]==="`",n=!1,s=null,o=2;for(++this.index;!this.eof();){let a=this.source[this.index++];if(a==="`"){o=1,n=!0,e=!0;break}else if(a==="$"){if(this.source[this.index]==="{"){this.curlyStack.push("${"),++this.index,e=!0;break}r+=a}else{if(s!==null)continue;if(a==="\\")if(a=this.source[this.index++],qe.isLineTerminator(a.charCodeAt(0)))++this.lineNumber,a==="\r"&&this.source[this.index]===`
`&&++this.index,this.lineStart=this.index;else switch(a){case"n":r+=`
`;break;case"r":r+="\r";break;case"t":r+="	";break;case"u":if(this.source[this.index]==="{"){++this.index;let u=this.tryToScanUnicodeCodePointEscape();u===null?s="u":r+=u}else{let u=this.scanHexEscape(a);u===null?s="u":r+=u}break;case"x":let l=this.scanHexEscape(a);l===null?s="x":r+=l;break;case"b":r+="\b";break;case"f":r+="\f";break;case"v":r+="\v";break;default:a==="0"?qe.isDecimalDigit(this.source.charCodeAt(this.index))?s="0":r+="\0":qe.isDecimalDigitChar(a)?s=a:r+=a;break}else qe.isLineTerminator(a.charCodeAt(0))?(++this.lineNumber,a==="\r"&&this.source[this.index]===`
`&&++this.index,this.lineStart=this.index,r+=`
`):r+=a}}return e||this.throwUnexpectedToken(),i||this.curlyStack.pop(),{type:10,value:this.source.slice(t+1,this.index-o),cooked:s===null?r:null,head:i,tail:n,notEscapeSequenceHead:s,lineNumber:this.lineNumber,lineStart:this.lineStart,start:t,end:this.index}}testRegExp(r,e){let t="\uFFFF",i=r;e.indexOf("u")>=0&&(i=i.replace(/\\u\{([0-9a-fA-F]+)\}|\\u([a-fA-F0-9]{4})/g,(n,s,o)=>{let a=parseInt(s||o,16);return a>1114111&&this.throwUnexpectedToken(le.InvalidRegExp),a<=65535?String.fromCharCode(a):t}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,t));try{RegExp(i)}catch{this.throwUnexpectedToken(le.InvalidRegExp)}try{return new RegExp(r,e)}catch{return null}}scanRegExpBody(){let r=this.source[this.index];pn(r==="/","Regular expression literal must start with a slash");let e=this.source[this.index++],t=!1,i=!1;for(;!this.eof();)if(r=this.source[this.index++],e+=r,r==="\\")r=this.source[this.index++],qe.isLineTerminator(r.charCodeAt(0))&&this.throwUnexpectedToken(le.UnterminatedRegExp),e+=r;else if(qe.isLineTerminator(r.charCodeAt(0)))this.throwUnexpectedToken(le.UnterminatedRegExp);else if(t)r==="]"&&(t=!1);else if(r==="/"){i=!0;break}else r==="["&&(t=!0);return i||this.throwUnexpectedToken(le.UnterminatedRegExp),e.substr(1,e.length-2)}scanRegExpFlags(){let r="",e="";for(;!this.eof();){let t=this.source[this.index];if(!qe.isIdentifierPart(t.charCodeAt(0)))break;if(++this.index,t==="\\"&&!this.eof())if(t=this.source[this.index],t==="u"){++this.index;let i=this.index,n=this.scanHexEscape("u");if(n!==null)for(e+=n,r+="\\u";i<this.index;++i)r+=this.source[i];else this.index=i,e+="u",r+="\\u";this.tolerateUnexpectedToken()}else r+="\\",this.tolerateUnexpectedToken();else e+=t,r+=t}return e}scanRegExp(){let r=this.index,e=this.scanRegExpBody(),t=this.scanRegExpFlags(),i=this.testRegExp(e,t);return{type:9,value:"",pattern:e,flags:t,regex:i,lineNumber:this.lineNumber,lineStart:this.lineStart,start:r,end:this.index}}lex(){if(this.eof())return{type:2,value:"",lineNumber:this.lineNumber,lineStart:this.lineStart,start:this.index,end:this.index};let r=this.source.charCodeAt(this.index);return qe.isIdentifierStart(r)?this.scanIdentifier():r===40||r===41||r===59?this.scanPunctuator():r===39||r===34?this.scanStringLiteral():r===46?qe.isDecimalDigit(this.source.charCodeAt(this.index+1))?this.scanNumericLiteral():this.scanPunctuator():qe.isDecimalDigit(r)?this.scanNumericLiteral():r===96||r===125&&this.curlyStack[this.curlyStack.length-1]==="${"?this.scanTemplate():r>=55296&&r<57343&&qe.isIdentifierStart(this.codePointAt(this.index))?this.scanIdentifier():this.scanPunctuator()}},Jr="ArrowParameterPlaceHolder",bw=class{config;delegate;errorHandler;scanner;operatorPrecedence;lookahead;hasLineTerminator;context;tokens;startMarker;lastMarker;constructor(r,e={},t){this.config={range:typeof e.range=="boolean"&&e.range,loc:typeof e.loc=="boolean"&&e.loc,source:null,tokens:typeof e.tokens=="boolean"&&e.tokens,comment:typeof e.comment=="boolean"&&e.comment,tolerant:typeof e.tolerant=="boolean"&&e.tolerant},this.config.loc&&e.source&&e.source!==null&&(this.config.source=String(e.source)),this.delegate=t,this.errorHandler=new mw,this.errorHandler.tolerant=this.config.tolerant==!0,this.scanner=new gw(r,this.errorHandler),this.scanner.trackComment=this.config.comment==!0,this.operatorPrecedence={")":0,";":0,",":0,"=":0,"]":0,"??":5,"||":6,"&&":7,"|":8,"^":9,"&":10,"==":11,"!=":11,"===":11,"!==":11,"<":12,">":12,"<=":12,">=":12,"<<":13,">>":13,">>>":13,"+":14,"-":14,"*":15,"/":15,"%":15},this.lookahead={type:2,value:"",lineNumber:this.scanner.lineNumber,lineStart:0,start:0,end:0},this.hasLineTerminator=!1,this.context={isModule:!1,isAsync:!1,allowIn:!0,allowStrictDirective:!0,allowSuper:!1,allowYield:!0,firstCoverInitializedNameError:null,isAssignmentTarget:!1,isBindingElement:!1,inConstructor:!1,inFunctionBody:!1,inIteration:!1,inSwitch:!1,inClassConstructor:!1,labelSet:{},strict:!1,decorators:null},this.tokens=[],this.startMarker={index:0,line:this.scanner.lineNumber,column:0},this.lastMarker={index:0,line:this.scanner.lineNumber,column:0},this.nextToken(),this.lastMarker={index:this.scanner.index,line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}}throwError(r,...e){let t=e.slice(),i=r.replace(/%(\d)/g,(a,l)=>(pn(l<t.length,"Message reference must be in range"),t[l])),n=this.lastMarker.index,s=this.lastMarker.line,o=this.lastMarker.column+1;throw this.errorHandler.createError(n,s,o,i)}tolerateError(r,...e){let t=e.slice(),i=r.replace(/%(\d)/g,(a,l)=>(pn(l<t.length,"Message reference must be in range"),t[l])),n=this.lastMarker.index,s=this.scanner.lineNumber,o=this.lastMarker.column+1;this.errorHandler.tolerateError(n,s,o,i)}unexpectedTokenError(r,e){let t=e||le.UnexpectedToken,i;if(r?(e||(t=r.type===2?le.UnexpectedEOS:r.type===3?le.UnexpectedIdentifier:r.type===6?le.UnexpectedNumber:r.type===8?le.UnexpectedString:r.type===10?le.UnexpectedTemplate:le.UnexpectedToken,r.type===4&&(this.scanner.isFutureReservedWord(r.value)?t=le.UnexpectedReserved:this.context.strict&&this.scanner.isStrictModeReservedWord(r.value)&&(t=le.StrictReservedWord))),i=r.value):i="ILLEGAL",t=t.replace("%0",i),r&&typeof r.lineNumber=="number"){let n=r.start,s=r.lineNumber,o=this.lastMarker.index-this.lastMarker.column,a=r.start-o+1;return this.errorHandler.createError(n,s,a,t)}else{let n=this.lastMarker.index,s=this.lastMarker.line,o=this.lastMarker.column+1;return this.errorHandler.createError(n,s,o,t)}}throwUnexpectedToken(r,e){throw this.unexpectedTokenError(r,e)}tolerateUnexpectedToken(r,e){this.errorHandler.tolerate(this.unexpectedTokenError(r,e))}tolerateInvalidLoopStatement(){(this.matchKeyword("class")||this.matchKeyword("function"))&&this.tolerateError(le.UnexpectedToken,this.lookahead)}collectComments(){if(!this.config.comment)this.scanner.scanComments();else{let r=this.scanner.scanComments();if(r.length>0&&this.delegate)for(let e=0;e<r.length;++e){let t=r[e],i={type:t.multiLine?"BlockComment":"LineComment",value:this.scanner.source.slice(t.slice[0],t.slice[1])};this.config.range&&(i.range=t.range),this.config.loc&&(i.loc=t.loc);let n={start:{line:t.loc.start.line,column:t.loc.start.column,offset:t.range[0]},end:{line:t.loc.end.line,column:t.loc.end.column,offset:t.range[1]}};this.delegate(i,n)}}}getTokenRaw(r){return this.scanner.source.slice(r.start,r.end)}convertToken(r){let e={type:Xi[r.type],value:this.getTokenRaw(r)};if(this.config.range&&(e.range=[r.start,r.end]),this.config.loc&&(e.loc={start:{line:this.startMarker.line,column:this.startMarker.column},end:{line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}}),r.type===9){let t=r.pattern,i=r.flags;e.regex={pattern:t,flags:i}}return e}nextToken(){let r=this.lookahead;this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart,this.collectComments(),this.scanner.index!==this.startMarker.index&&(this.startMarker.index=this.scanner.index,this.startMarker.line=this.scanner.lineNumber,this.startMarker.column=this.scanner.index-this.scanner.lineStart);let e=this.scanner.lex();return this.hasLineTerminator=r.lineNumber!==e.lineNumber,e&&this.context.strict&&e.type===3&&this.scanner.isStrictModeReservedWord(e.value)&&(e.type=4),this.lookahead=e,this.config.tokens&&e.type!==2&&this.tokens.push(this.convertToken(e)),r}nextRegexToken(){this.collectComments();let r=this.scanner.scanRegExp();return this.config.tokens&&(this.tokens.pop(),this.tokens.push(this.convertToken(r))),this.lookahead=r,this.nextToken(),r}createNode(){return{index:this.startMarker.index,line:this.startMarker.line,column:this.startMarker.column}}startNode(r,e=0){let t=r.start-r.lineStart,i=r.lineNumber;return t<0&&(t+=e,i--),{index:r.start,line:i,column:t}}finalize(r,e){if(this.config.range&&(e.range=[r.index,this.lastMarker.index]),this.config.loc&&(e.loc={start:{line:r.line,column:r.column},end:{line:this.lastMarker.line,column:this.lastMarker.column}},this.config.source&&(e.loc.source=this.config.source)),this.delegate){let t={start:{line:r.line,column:r.column,offset:r.index},end:{line:this.lastMarker.line,column:this.lastMarker.column,offset:this.lastMarker.index}};this.delegate(e,t)}return e}expect(r){let e=this.nextToken();(e.type!==7||e.value!==r)&&this.throwUnexpectedToken(e)}expectCommaSeparator(){if(this.config.tolerant){let r=this.lookahead;r.type===7&&r.value===","?this.nextToken():r.type===7&&r.value===";"?(this.nextToken(),this.tolerateUnexpectedToken(r)):this.tolerateUnexpectedToken(r,le.UnexpectedToken)}else this.expect(",")}expectKeyword(r){let e=this.nextToken();(e.type!==4||e.value!==r)&&this.throwUnexpectedToken(e)}match(r){return this.lookahead.type===7&&this.lookahead.value===r}matchKeyword(r){return this.lookahead.type===4&&this.lookahead.value===r}matchContextualKeyword(r){return this.lookahead.type===3&&this.lookahead.value===r}matchAssign(){if(this.lookahead.type!==7)return!1;let r=this.lookahead.value;return r==="="||r==="*="||r==="**="||r==="/="||r==="%="||r==="+="||r==="-="||r==="<<="||r===">>="||r===">>>="||r==="&="||r==="^="||r==="|="||r==="&&="||r==="||="||r==="??="}isolateCoverGrammar(r){let e=this.context.isBindingElement,t=this.context.isAssignmentTarget,i=this.context.firstCoverInitializedNameError;this.context.isBindingElement=!0,this.context.isAssignmentTarget=!0,this.context.firstCoverInitializedNameError=null;let n=r.call(this);return this.context.firstCoverInitializedNameError!==null&&this.throwUnexpectedToken(this.context.firstCoverInitializedNameError),this.context.isBindingElement=e,this.context.isAssignmentTarget=t,this.context.firstCoverInitializedNameError=i,n}inheritCoverGrammar(r){let e=this.context.isBindingElement,t=this.context.isAssignmentTarget,i=this.context.firstCoverInitializedNameError;this.context.isBindingElement=!0,this.context.isAssignmentTarget=!0,this.context.firstCoverInitializedNameError=null;let n=r.call(this);return this.context.isBindingElement=this.context.isBindingElement&&e,this.context.isAssignmentTarget=this.context.isAssignmentTarget&&t,this.context.firstCoverInitializedNameError=i||this.context.firstCoverInitializedNameError,n}consumeSemicolon(){this.match(";")?this.nextToken():this.hasLineTerminator||(this.lookahead.type!==2&&!this.match("}")&&this.throwUnexpectedToken(this.lookahead),this.lastMarker.index=this.startMarker.index,this.lastMarker.line=this.startMarker.line,this.lastMarker.column=this.startMarker.column)}parsePrimaryExpression(){let r=this.createNode(),e,t,i;switch(this.lookahead.type){case 3:(this.context.isModule||this.context.isAsync)&&this.lookahead.value==="await"&&this.tolerateUnexpectedToken(this.lookahead),e=this.matchAsyncFunction()?this.parseFunctionExpression():this.finalize(r,new ur(this.nextToken().value));break;case 6:case 8:this.context.strict&&this.lookahead.octal&&this.tolerateUnexpectedToken(this.lookahead,le.StrictOctalLiteral),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,t=this.nextToken(),i=this.getTokenRaw(t),typeof t.value=="bigint"?e=this.finalize(r,new Hh(t.value,i,t.value.toString())):e=this.finalize(r,new Wn(t.value,i));break;case 1:this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,t=this.nextToken(),i=this.getTokenRaw(t),e=this.finalize(r,new Wn(t.value==="true",i));break;case 5:this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,t=this.nextToken(),i=this.getTokenRaw(t),e=this.finalize(r,new Wn(null,i));break;case 10:e=this.parseTemplateLiteral({isTagged:!1});break;case 7:switch(this.lookahead.value){case"(":this.context.isBindingElement=!1,e=this.inheritCoverGrammar(this.parseGroupExpression);break;case"[":e=this.inheritCoverGrammar(this.parseArrayInitializer);break;case"{":e=this.inheritCoverGrammar(this.parseObjectInitializer);break;case"/":case"/=":this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,this.scanner.index=this.startMarker.index,t=this.nextRegexToken(),i=this.getTokenRaw(t),e=this.finalize(r,new ew(t.regex,i,t.pattern,t.flags));break;case"#":this.nextToken(),e=this.finalize(r,new Xa(this.nextToken().value));break;case"@":let n=this.parseDecorators();this.context.decorators=n;let s=this.parsePrimaryExpression();this.context.decorators=null,e=this.finalize(r,new Xa(this.nextToken().value));break;default:e=this.throwUnexpectedToken(this.nextToken())}break;case 4:!this.context.strict&&this.context.allowYield&&this.matchKeyword("yield")?e=this.parseIdentifierName():!this.context.strict&&this.matchKeyword("let")?e=this.finalize(r,new ur(this.nextToken().value)):(this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,this.matchKeyword("function")?e=this.parseFunctionExpression():this.matchKeyword("this")?(this.nextToken(),e=this.finalize(r,new lw)):this.matchKeyword("class")?e=this.parseClassExpression():this.matchKeyword("new")?e=this.parseNewExpression():this.matchImportCall()?e=this.parseImportCall():this.matchImportMeta()?(this.context.isModule||this.tolerateUnexpectedToken(this.lookahead,le.CannotUseImportMetaOutsideAModule),e=this.parseImportMeta()):e=this.throwUnexpectedToken(this.nextToken()));break;default:e=this.throwUnexpectedToken(this.nextToken())}return e}parseSpreadElement(){let r=this.createNode();this.expect("...");let e=this.inheritCoverGrammar(this.parseAssignmentExpression);return this.finalize(r,new rw(e))}parseArrayInitializer(){let r=this.createNode(),e=[];for(this.expect("[");!this.match("]");)if(this.match(","))this.nextToken(),e.push(null);else if(this.match("...")){let t=this.parseSpreadElement();this.match("]")||(this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,this.expect(",")),e.push(t)}else e.push(this.inheritCoverGrammar(this.parseAssignmentExpression)),this.match("]")||this.expect(",");return this.expect("]"),this.finalize(r,new gv(e))}parsePropertyMethod(r){this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;let e=this.context.strict,t=this.context.allowStrictDirective;this.context.allowStrictDirective=r.simple;let i=this.isolateCoverGrammar(this.parseFunctionSourceElements);return this.context.strict&&r.firstRestricted&&this.tolerateUnexpectedToken(r.firstRestricted,r.message),this.context.strict&&r.stricted&&this.tolerateUnexpectedToken(r.stricted,r.message),this.context.strict=e,this.context.allowStrictDirective=t,i}parsePropertyMethodFunction(r){let e=this.createNode(),t=this.context.allowYield;this.context.allowYield=!0;let i=this.parseFormalParameters(),n=this.parsePropertyMethod(i);return this.context.allowYield=t,this.finalize(e,new ks(null,i.params,n,r,!1))}parsePropertyMethodAsyncFunction(r){let e=this.createNode(),t=this.context.allowYield,i=this.context.isAsync;this.context.allowYield=!1,this.context.isAsync=!0;let n=this.parseFormalParameters(),s=this.parsePropertyMethod(n);return this.context.allowYield=t,this.context.isAsync=i,this.finalize(e,new ks(null,n.params,s,r,!0))}parseObjectPropertyKey(r=!1){let e=this.createNode(),t=this.nextToken(),i;switch(t.type){case 8:case 6:this.context.strict&&t.octal&&this.tolerateUnexpectedToken(t,le.StrictOctalLiteral);let n=this.getTokenRaw(t);typeof t.value=="bigint"?i=this.finalize(e,new Hh(t.value,n,t.value.toString())):i=this.finalize(e,new Wn(t.value,n));break;case 3:case 1:case 5:case 4:i=this.finalize(e,r?new Xa(t.value):new ur(t.value));break;case 7:t.value==="["?(i=this.isolateCoverGrammar(this.parseAssignmentExpression),this.expect("]")):i=this.throwUnexpectedToken(t);break;default:i=this.throwUnexpectedToken(t)}return i}isPropertyKey(r,e){return r.type==="Identifier"&&r.name===e||r.type==="Literal"&&r.value===e}parseObjectProperty(r){let e=this.createNode(),t=this.lookahead,i,n=null,s=null,o=!1,a=!1,l=!1,u=!1,c=!1;if(t.type===3){let h=t.value;this.nextToken(),o=this.match("["),u=!this.hasLineTerminator&&h==="async"&&!this.match(":")&&!this.match("(")&&!this.match(","),c=this.match("*"),c&&this.nextToken(),n=u?this.parseObjectPropertyKey():this.finalize(e,new ur(h))}else this.match("*")?this.nextToken():(o=this.match("["),n=this.parseObjectPropertyKey());let d=this.qualifiedPropertyName(this.lookahead);if(t.type===3&&!u&&t.value==="get"&&d)i="get",o=this.match("["),n=this.parseObjectPropertyKey(),this.context.allowYield=!1,s=this.parseGetterMethod();else if(t.type===3&&!u&&t.value==="set"&&d)i="set",o=this.match("["),n=this.parseObjectPropertyKey(),s=this.parseSetterMethod();else if(t.type===7&&t.value==="*"&&d)i="init",o=this.match("["),n=this.parseObjectPropertyKey(),s=this.parseGeneratorMethod(!1),a=!0;else if(n||this.throwUnexpectedToken(this.lookahead),i="init",this.match(":")&&!u)!o&&this.isPropertyKey(n,"__proto__")&&(r.value&&this.tolerateError(le.DuplicateProtoProperty),r.value=!0),this.nextToken(),s=this.inheritCoverGrammar(this.parseAssignmentExpression);else if(this.match("("))s=u?this.parsePropertyMethodAsyncFunction(c):this.parsePropertyMethodFunction(c),a=!0;else if(t.type===3){let h=this.finalize(e,new ur(t.value));if(this.match("=")){this.context.firstCoverInitializedNameError=this.lookahead,this.nextToken(),l=!0;let f=this.isolateCoverGrammar(this.parseAssignmentExpression);s=this.finalize(e,new ud(h,f))}else l=!0,s=h}else this.throwUnexpectedToken(this.nextToken());return this.finalize(e,new Yh(i,n,o,s,a,l))}parseObjectInitializer(){let r=this.createNode();this.expect("{");let e=[],t={value:!1};for(;!this.match("}");){let i=this.match("...")?this.parseSpreadElement():this.parseObjectProperty(t);e.push(i),!this.match("}")&&(!i.method||this.match(","))&&this.expectCommaSeparator()}return this.expect("}"),this.finalize(r,new Zv(e))}throwTemplateLiteralEarlyErrors(r){switch(r.notEscapeSequenceHead){case"u":return this.throwUnexpectedToken(r,le.InvalidUnicodeEscapeSequence);case"x":return this.throwUnexpectedToken(r,le.InvalidHexEscapeSequence);case"8":case"9":return this.throwUnexpectedToken(r,le.TemplateEscape89);default:return this.throwUnexpectedToken(r,le.TemplateOctalLiteral)}}parseTemplateHead(r){pn(this.lookahead.head,"Template literal must start with a template head");let e=this.createNode(),t=this.nextToken();!r.isTagged&&t.notEscapeSequenceHead!==null&&this.throwTemplateLiteralEarlyErrors(t);let i=t.value,n=t.cooked;return this.finalize(e,new tp({raw:i,cooked:n},t.tail))}parseTemplateElement(r){this.lookahead.type!==10&&this.throwUnexpectedToken();let e=this.createNode(),t=this.nextToken();!r.isTagged&&t.notEscapeSequenceHead!==null&&this.throwTemplateLiteralEarlyErrors(t);let i=t.value,n=t.cooked;return this.finalize(e,new tp({raw:i,cooked:n},t.tail))}parseTemplateLiteral(r){let e=this.createNode(),t=[],i=[],n=this.parseTemplateHead(r);for(i.push(n);!n.tail;)t.push(this.parseExpression()),n=this.parseTemplateElement(r),i.push(n);return this.finalize(e,new aw(i,t))}reinterpretExpressionAsPattern(r){switch(r.type){case"Identifier":case"MemberExpression":case"RestElement":case"AssignmentPattern":break;case"SpreadElement":r.type="RestElement",this.reinterpretExpressionAsPattern(r.argument);break;case"ArrayExpression":r.type="ArrayPattern";for(let e=0;e<r.elements.length;e++)r.elements[e]!==null&&this.reinterpretExpressionAsPattern(r.elements[e]);break;case"ObjectExpression":r.type="ObjectPattern";for(let e=0;e<r.properties.length;e++){let t=r.properties[e];this.reinterpretExpressionAsPattern(t.type==="SpreadElement"?t:t.value)}break;case"AssignmentExpression":r.type="AssignmentPattern",delete r.operator,this.reinterpretExpressionAsPattern(r.left);break;default:break}}parseGroupExpression(){let r;if(this.expect("("),this.match(")"))this.nextToken(),this.match("=>")||this.expect("=>"),r={type:Jr,params:[],async:!1};else{let e=this.lookahead,t=[];if(this.match("..."))r=this.parseRestElement(t),this.expect(")"),this.match("=>")||this.expect("=>"),r={type:Jr,params:[r],async:!1};else{let i=!1;if(this.context.isBindingElement=!0,r=this.inheritCoverGrammar(this.parseAssignmentExpression),this.match(",")){let n=[];for(this.context.isAssignmentTarget=!1,n.push(r);this.lookahead.type!==2&&this.match(",");){if(this.nextToken(),this.match(")")){this.nextToken();for(let s=0;s<n.length;s++)this.reinterpretExpressionAsPattern(n[s]);i=!0,r={type:Jr,params:n,async:!1}}else if(this.match("...")){this.context.isBindingElement||this.throwUnexpectedToken(this.lookahead),n.push(this.parseRestElement(t)),this.expect(")"),this.match("=>")||this.expect("=>"),this.context.isBindingElement=!1;for(let s=0;s<n.length;s++)this.reinterpretExpressionAsPattern(n[s]);i=!0,r={type:Jr,params:n,async:!1}}else n.push(this.inheritCoverGrammar(this.parseAssignmentExpression));if(i)break}i||(r=this.finalize(this.startNode(e),new hd(n)))}if(!i){if(this.expect(")"),this.match("=>")&&(r.type==="Identifier"&&r.name==="yield"&&(i=!0,r={type:Jr,params:[r],async:!1}),!i)){if(this.context.isBindingElement||this.throwUnexpectedToken(this.lookahead),r.type==="SequenceExpression")for(let s=0;s<r.expressions.length;s++)this.reinterpretExpressionAsPattern(r.expressions[s]);else this.reinterpretExpressionAsPattern(r);let n=r.type==="SequenceExpression"?r.expressions:[r];r={type:Jr,params:n,async:!1}}this.context.isBindingElement=!1}}}return r}parseArguments(){this.expect("(");let r=[];if(!this.match(")"))for(;;){let e=this.match("...")?this.parseSpreadElement():this.isolateCoverGrammar(this.parseAssignmentExpression);if(r.push(e),this.match(")")||(this.expectCommaSeparator(),this.match(")")))break}return this.expect(")"),r}isIdentifierName(r){return r.type===3||r.type===4||r.type===1||r.type===5}parseIdentifierName(r=!1){let e=!1,t=this.createNode(),i=this.nextToken();return i.value==="#"&&r&&(i=this.nextToken(),e=!0),this.isIdentifierName(i)||this.throwUnexpectedToken(i),this.finalize(t,e?new Xa(i.value):new ur(i.value))}parseNewExpression(){let r=this.createNode(),e=this.parseIdentifierName();pn(e.name==="new","New expression must start with `new`");let t;if(this.match("."))if(this.nextToken(),this.lookahead.type===3&&this.context.inFunctionBody&&this.lookahead.value==="target"){let i=this.parseIdentifierName();t=new Zh(e,i)}else this.throwUnexpectedToken(this.lookahead);else if(this.matchKeyword("import"))this.throwUnexpectedToken(this.lookahead);else{let i=this.isolateCoverGrammar(this.parseLeftHandSideExpression),n=this.match("(")?this.parseArguments():[];t=new Xv(i,n),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}return this.finalize(r,t)}parseAsyncArgument(){let r=this.parseAssignmentExpression();return this.context.firstCoverInitializedNameError=null,r}parseAsyncArguments(){this.expect("(");let r=[];if(!this.match(")"))for(;;){let e=this.match("...")?this.parseSpreadElement():this.isolateCoverGrammar(this.parseAsyncArgument);if(r.push(e),this.match(")")||(this.expectCommaSeparator(),this.match(")")))break}return this.expect(")"),r}matchImportCall(){let r=this.matchKeyword("import");if(r){let e=this.scanner.saveState();this.scanner.scanComments();let t=this.scanner.lex();this.scanner.restoreState(e),r=t.type===7&&t.value==="("}return r}parseImportCall(){let r=this.createNode();this.expectKeyword("import"),this.expect("(");var e=this.context.isAssignmentTarget;this.context.isAssignmentTarget=!0;let t=this.parseAssignmentExpression(),i=null;return this.match(",")&&(this.nextToken(),this.match(")")||(i=this.parseAssignmentExpression())),this.context.isAssignmentTarget=e,this.match(")")?this.nextToken():(this.match(",")&&this.nextToken(),this.expect(")")),this.finalize(r,new zv(t,i))}matchImportMeta(){let r=this.matchKeyword("import");if(r){let e=this.scanner.saveState();this.scanner.scanComments();let t=this.scanner.lex();if(t.type===7&&t.value==="."){this.scanner.scanComments();let i=this.scanner.lex();r=i.type===3&&i.value==="meta",r&&i.end-i.start!==4&&this.tolerateUnexpectedToken(i,le.InvalidEscapedReservedWord)}else r=!1;this.scanner.restoreState(e)}return r}parseImportMeta(){let r=this.createNode(),e=this.parseIdentifierName();this.expect(".");let t=this.parseIdentifierName();return this.context.isAssignmentTarget=!1,this.finalize(r,new Zh(e,t))}parseLeftHandSideExpressionAllowCall(){let r=this.lookahead,e=this.matchContextualKeyword("async"),t=this.context.allowIn;this.context.allowIn=!0;let i,n=this.matchKeyword("super");n&&this.context.inFunctionBody?(i=this.createNode(),this.nextToken(),i=this.finalize(i,new Qh),!this.match("(")&&!this.match(".")&&!this.match("[")&&this.throwUnexpectedToken(this.lookahead)):i=this.inheritCoverGrammar(this.matchKeyword("new")?this.parseNewExpression:this.parsePrimaryExpression),n&&this.match("(")&&(!this.context.inClassConstructor||!this.context.allowSuper)&&this.tolerateError(le.UnexpectedSuper);let s=!1;for(;;){let o=!1;if(this.match("?.")&&(o=!0,s=!0,this.expect("?.")),this.match("(")){let a=e&&r.lineNumber===this.lookahead.lineNumber;this.context.isBindingElement=!1,this.context.isAssignmentTarget=!1;let l=a?this.parseAsyncArguments():this.parseArguments();if(i.type==="ImportExpression"&&l.length!==1&&this.tolerateError(le.BadImportCallArity),i=this.finalize(this.startNode(r),new kv(i,l,o)),a&&this.match("=>")){for(let u=0;u<l.length;++u)this.reinterpretExpressionAsPattern(l[u]);i={type:Jr,params:l,async:!0}}}else if(this.match("[")){this.context.isBindingElement=!1,this.context.isAssignmentTarget=!o,this.expect("[");let a=this.isolateCoverGrammar(this.parseExpression);this.expect("]"),i=this.finalize(this.startNode(r),new Ka(!0,i,a,o))}else if(this.lookahead.type===10&&this.lookahead.head){o&&this.throwUnexpectedToken(this.lookahead),s&&this.throwError(le.InvalidTaggedTemplateOnOptionalChain);let a=this.parseTemplateLiteral({isTagged:!0});i=this.finalize(this.startNode(r),new ep(i,a))}else if(this.match(".")||o){this.context.isBindingElement=!1,this.context.isAssignmentTarget=!o,o||this.expect(".");let a=this.parseIdentifierName(!0);i=this.finalize(this.startNode(r),new Ka(!1,i,a,o))}else break}return this.context.allowIn=t,s&&(i=this.finalize(this.startNode(r),new Kh(i))),i}parseSuper(){let r=this.createNode();return this.expectKeyword("super"),!this.match("[")&&!this.match(".")&&this.throwUnexpectedToken(this.lookahead),this.finalize(r,new Qh)}parseLeftHandSideExpression(){pn(this.context.allowIn,"callee of new expression always allow in keyword.");let r=this.startNode(this.lookahead),e=this.matchKeyword("super")&&this.context.inFunctionBody?this.parseSuper():this.inheritCoverGrammar(this.matchKeyword("new")?this.parseNewExpression:this.parsePrimaryExpression),t=!1;for(;;){let i=!1;if(this.match("?.")&&(i=!0,t=!0,this.expect("?.")),this.match("[")){this.context.isBindingElement=!1,this.context.isAssignmentTarget=!i,this.expect("[");let n=this.isolateCoverGrammar(this.parseExpression);this.expect("]"),e=this.finalize(r,new Ka(!0,e,n,i))}else if(this.lookahead.type===10&&this.lookahead.head){i&&this.throwUnexpectedToken(this.lookahead),t&&this.throwError(le.InvalidTaggedTemplateOnOptionalChain);let n=this.parseTemplateLiteral({isTagged:!0});e=this.finalize(r,new ep(e,n))}else if(this.match(".")||i){this.context.isBindingElement=!1,this.context.isAssignmentTarget=!i,i||this.expect(".");let n=this.parseIdentifierName();e=this.finalize(r,new Ka(!1,e,n,i))}else break}return t&&(e=this.finalize(r,new Kh(e))),e}parseUpdateExpression(){let r,e=this.lookahead;if(this.match("++")||this.match("--")){let t=this.startNode(e),i=this.nextToken();r=this.inheritCoverGrammar(this.parseUnaryExpression),this.context.strict&&r.type==="Identifier"&&this.scanner.isRestrictedWord(r.name)&&this.tolerateError(le.StrictLHSPrefix),this.context.isAssignmentTarget||this.tolerateError(le.InvalidLHSInAssignment);let n=!0;r=this.finalize(t,new ip(i.value,r,n)),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}else if(r=this.inheritCoverGrammar(this.parseLeftHandSideExpressionAllowCall),!this.hasLineTerminator&&this.lookahead.type===7&&(this.match("++")||this.match("--"))){this.context.strict&&r.type==="Identifier"&&this.scanner.isRestrictedWord(r.name)&&this.tolerateError(le.StrictLHSPostfix),this.context.isAssignmentTarget||this.tolerateError(le.InvalidLHSInAssignment),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;let t=this.nextToken().value,i=!1;r=this.finalize(this.startNode(e),new ip(t,r,i))}return r}parseAwaitExpression(){let r=this.createNode();this.nextToken();let e=this.parseUnaryExpression();return this.finalize(r,new _v(e))}parseUnaryExpression(){let r;if(this.match("+")||this.match("-")||this.match("~")||this.match("!")||this.matchKeyword("delete")||this.matchKeyword("void")||this.matchKeyword("typeof")){let e=this.startNode(this.lookahead),t=this.nextToken();r=this.inheritCoverGrammar(this.parseUnaryExpression),r=this.finalize(e,new dw(t.value,r)),this.context.strict&&r.operator==="delete"&&r.argument.type==="Identifier"&&this.tolerateError(le.StrictDelete),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}else(this.context.isModule&&!this.context.inFunctionBody||this.context.isAsync)&&this.matchContextualKeyword("await")?r=this.parseAwaitExpression():r=this.parseUpdateExpression();return r}parseExponentiationExpression(){let r=this.lookahead,e=this.match("("),t=this.inheritCoverGrammar(this.parseUnaryExpression);if((t.type!=="UnaryExpression"||e)&&this.match("**")){this.nextToken(),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;let n=t,s=this.isolateCoverGrammar(this.parseExponentiationExpression);t=this.finalize(this.startNode(r),new cd("**",n,s))}return t}binaryPrecedence(r){let e=r.value,t;return r.type===7?t=this.operatorPrecedence[e]||0:r.type===4?t=e==="instanceof"||this.context.allowIn&&e==="in"?12:0:t=0,t}parseBinaryExpression(){let r=this.lookahead,e=this.inheritCoverGrammar(this.parseExponentiationExpression),t=!0,i=!0,n=a=>{(a.value==="&&"||a.value==="||")&&(i=!1),a.value==="??"&&(t=!1)},s=this.lookahead,o=this.binaryPrecedence(s);if(o>0){n(s),this.nextToken(),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;let a=[r,this.lookahead],l=e,u=this.isolateCoverGrammar(this.parseExponentiationExpression),c=[l,s.value,u],d=[o];for(;o=this.binaryPrecedence(this.lookahead),!(o<=0);){for((!t&&(this.lookahead.value==="&&"||this.lookahead.value==="||")||!i&&this.lookahead.value==="??")&&this.throwUnexpectedToken(this.lookahead),n(this.lookahead);c.length>2&&o<=d[d.length-1];){u=c.pop();let m=c.pop();d.pop(),l=c.pop(),a.pop();let p=a[a.length-1],g=this.startNode(p,p.lineStart),b=m==="||"||m==="&&"||m==="??";c.push(this.finalize(g,b?new Xh(m,l,u):new cd(m,l,u)))}c.push(this.nextToken().value),d.push(o),a.push(this.lookahead),c.push(this.isolateCoverGrammar(this.parseExponentiationExpression))}let h=c.length-1;e=c[h];let f=a.pop();for(;h>1;){let m=a.pop(),p=f&&f.lineStart,g=this.startNode(m,p),b=c[h-1],F=b==="||"||b==="&&"||b==="??";e=this.finalize(g,F?new Xh(b,c[h-2],e):new cd(b,c[h-2],e)),h-=2,f=m}}return e}parseConditionalExpression(){let r=this.lookahead,e=this.inheritCoverGrammar(this.parseBinaryExpression);if(this.match("?")){this.nextToken();let t=this.context.allowIn;this.context.allowIn=!0;let i=this.isolateCoverGrammar(this.parseAssignmentExpression);this.context.allowIn=t,this.expect(":");let n=this.isolateCoverGrammar(this.parseAssignmentExpression);e=this.finalize(this.startNode(r),new Iv(e,i,n)),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}return e}checkPatternParam(r,e){switch(e.type){case"Identifier":this.validateParam(r,e,e.name);break;case"RestElement":this.checkPatternParam(r,e.argument);break;case"AssignmentPattern":this.checkPatternParam(r,e.left);break;case"ArrayPattern":for(let t=0;t<e.elements.length;t++)e.elements[t]!==null&&this.checkPatternParam(r,e.elements[t]);break;case"ObjectPattern":for(let t=0;t<e.properties.length;t++){let i=e.properties[t];this.checkPatternParam(r,i.type==="RestElement"?i:i.value)}break;default:break}r.simple=r.simple&&e instanceof ur}reinterpretAsCoverFormalsList(r){let e=[r],t={simple:!0,paramSet:{}},i=!1;switch(r.type){case"Identifier":break;case Jr:e=r.params,i=r.async;break;default:return null}for(let n=0;n<e.length;++n){let s=e[n];s.type==="AssignmentPattern"?s.right.type==="YieldExpression"&&(s.right.argument&&this.throwUnexpectedToken(this.lookahead),s.right.type="Identifier",s.right.name="yield",delete s.right.argument,delete s.right.delegate):i&&s.type==="Identifier"&&s.name==="await"&&this.throwUnexpectedToken(this.lookahead),this.checkPatternParam(t,s),e[n]=s}if(this.context.strict||!this.context.allowYield)for(let n=0;n<e.length;++n)e[n].type==="YieldExpression"&&this.throwUnexpectedToken(this.lookahead);if(t.hasDuplicateParameterNames){let n=this.context.strict?t.stricted:t.firstRestricted;this.throwUnexpectedToken(n,le.DuplicateParameter)}return{simple:t.simple,params:e,stricted:t.stricted,firstRestricted:t.firstRestricted,message:t.message}}parseAssignmentExpression(){let r;if(!this.context.allowYield&&this.matchKeyword("yield"))r=this.parseYieldExpression();else{let e=this.lookahead,t=e;if(r=this.parseConditionalExpression(),t.type===3&&t.lineNumber===this.lookahead.lineNumber&&t.value==="async"&&(this.lookahead.type===3||this.matchKeyword("yield"))){let i=this.parsePrimaryExpression();this.reinterpretExpressionAsPattern(i),r={type:Jr,params:[i],async:!0}}if(r.type===Jr||this.match("=>")){this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;let i=r.async,n=this.reinterpretAsCoverFormalsList(r);if(n){this.hasLineTerminator&&this.tolerateUnexpectedToken(this.lookahead),this.context.firstCoverInitializedNameError=null;let s=this.context.strict,o=this.context.allowStrictDirective;this.context.allowStrictDirective=n.simple;let a=this.context.allowYield,l=this.context.isAsync;this.context.allowYield=!0,this.context.isAsync=i;let u=this.startNode(e);this.expect("=>");let c;if(this.match("{")){let h=this.context.allowIn;this.context.allowIn=!0,c=this.parseFunctionSourceElements(),this.context.allowIn=h}else c=this.isolateCoverGrammar(this.parseAssignmentExpression);let d=c.type!=="BlockStatement";this.context.strict&&n.firstRestricted&&this.throwUnexpectedToken(n.firstRestricted,n.message),this.context.strict&&n.stricted&&this.tolerateUnexpectedToken(n.stricted,n.message),r=this.finalize(u,new yv(n.params,c,d,i)),this.context.strict=s,this.context.allowStrictDirective=o,this.context.allowYield=a,this.context.isAsync=l}}else if(this.matchAssign()){if(this.context.isAssignmentTarget||this.tolerateError(le.InvalidLHSInAssignment),this.context.strict&&r.type==="Identifier"){let s=r;this.scanner.isRestrictedWord(s.name)&&this.tolerateUnexpectedToken(t,le.StrictLHSAssignment),this.scanner.isStrictModeReservedWord(s.name)&&this.tolerateUnexpectedToken(t,le.StrictReservedWord)}this.match("=")?this.reinterpretExpressionAsPattern(r):(this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1),t=this.nextToken();let i=t.value,n=this.isolateCoverGrammar(this.parseAssignmentExpression);r=this.finalize(this.startNode(e),new vv(i,r,n)),this.context.firstCoverInitializedNameError=null}}return r}parseExpression(){let r=this.lookahead,e=this.isolateCoverGrammar(this.parseAssignmentExpression);if(this.match(",")){let t=[];for(t.push(e);this.lookahead.type!==2&&this.match(",");)this.nextToken(),t.push(this.isolateCoverGrammar(this.parseAssignmentExpression));e=this.finalize(this.startNode(r),new hd(t))}return e}parseStatementListItem(){let r;if(this.context.isAssignmentTarget=!0,this.context.isBindingElement=!0,this.lookahead.type===4)switch(this.lookahead.value){case"export":this.context.isModule||this.tolerateUnexpectedToken(this.lookahead,le.IllegalExportDeclaration),r=this.parseExportDeclaration();break;case"import":this.matchImportCall()?r=this.parseExpressionStatement():this.matchImportMeta()?r=this.parseStatement():(this.context.isModule||this.tolerateUnexpectedToken(this.lookahead,le.IllegalImportDeclaration),r=this.parseImportDeclaration());break;case"const":r=this.parseLexicalDeclaration({inFor:!1});break;case"function":r=this.parseFunctionDeclaration();break;case"class":r=this.parseClassDeclaration();break;case"let":r=this.isLexicalDeclaration()?this.parseLexicalDeclaration({inFor:!1}):this.parseStatement();break;default:r=this.parseStatement();break}else r=this.parseStatement();return r}parseBlock(){let r=this.createNode();this.expect("{");let e=[];for(;!this.match("}");)e.push(this.parseStatementListItem());return this.expect("}"),this.finalize(r,new qh(e))}parseLexicalBinding(r,e){let t=this.createNode(),i=[],n=this.parsePattern(i,r);this.context.strict&&n.type==="Identifier"&&this.scanner.isRestrictedWord(n.name)&&this.tolerateError(le.StrictVarName);let s=null;return r==="const"?!this.matchKeyword("in")&&!this.matchContextualKeyword("of")&&(this.match("=")?(this.nextToken(),s=this.isolateCoverGrammar(this.parseAssignmentExpression)):this.throwError(le.DeclarationMissingInitializer,"const")):(!e.inFor&&n.type!=="Identifier"||this.match("="))&&(this.expect("="),s=this.isolateCoverGrammar(this.parseAssignmentExpression)),this.finalize(t,new rp(n,s))}parseBindingList(r,e){let t=[this.parseLexicalBinding(r,e)];for(;this.match(",");)this.nextToken(),t.push(this.parseLexicalBinding(r,e));return t}isLexicalDeclaration(){let r=this.scanner.saveState();this.scanner.scanComments();let e=this.scanner.lex();return this.scanner.restoreState(r),e.type===3||e.type===7&&e.value==="["||e.type===7&&e.value==="{"||e.type===4&&e.value==="let"||e.type===4&&e.value==="yield"}parseLexicalDeclaration(r){let e=this.createNode(),t=this.nextToken().value;pn(t==="let"||t==="const","Lexical declaration must be either let or const");let i=this.parseBindingList(t,r);return this.consumeSemicolon(),this.finalize(e,new hn(i,t))}isInitializedProperty(){let r=this.scanner.saveState();this.scanner.scanComments();let e=this.scanner.lex();return this.scanner.restoreState(r),this.lookahead.type===3&&e.value==="="}isDeclaredProperty(){let r=this.scanner.saveState();this.scanner.scanComments();let e=this.scanner.lex();return this.scanner.restoreState(r),this.lookahead.type===3&&e.value===";"||this.lookahead.type===3&&e.lineNumber!==this.startMarker.line}parseBindingRestElement(r,e){let t=this.createNode();this.expect("...");let i=this.parsePattern(r,e);return this.finalize(t,new Za(i))}parseArrayPattern(r,e){let t=this.createNode();this.expect("[");let i=[];for(;!this.match("]");)if(this.match(","))this.nextToken(),i.push(null);else{if(this.match("...")){i.push(this.parseBindingRestElement(r,e));break}else i.push(this.parsePatternWithDefault(r,e));this.match("]")||this.expect(",")}return this.expect("]"),this.finalize(t,new bv(i))}parsePropertyPattern(r,e){let t=this.createNode(),i=!1,n=!1,s=!1,o,a;if(this.lookahead.type===3){let l=this.lookahead;o=this.parseVariableIdentifier();let u=this.finalize(t,new ur(l.value));if(this.match("=")){r.push(l),n=!0,this.nextToken();let c=this.parseAssignmentExpression();a=this.finalize(this.startNode(l),new ud(u,c))}else this.match(":")?(this.expect(":"),a=this.parsePatternWithDefault(r,e)):(r.push(l),n=!0,a=u)}else i=this.match("["),o=this.parseObjectPropertyKey(),this.expect(":"),a=this.parsePatternWithDefault(r,e);return this.finalize(t,new Yh("init",o,i,a,s,n))}parseRestProperty(r){let e=this.createNode();this.expect("...");let t=this.parsePattern(r);return this.match("=")&&this.throwError(le.DefaultRestProperty),this.match("}")||this.throwError(le.PropertyAfterRestProperty),this.finalize(e,new Za(t))}parseObjectPattern(r,e){let t=this.createNode(),i=[];for(this.expect("{");!this.match("}");)i.push(this.match("...")?this.parseRestProperty(r):this.parsePropertyPattern(r,e)),this.match("}")||this.expect(",");return this.expect("}"),this.finalize(t,new Yv(i))}parsePattern(r,e){let t;return this.match("[")?t=this.parseArrayPattern(r,e):this.match("{")?t=this.parseObjectPattern(r,e):(this.matchKeyword("let")&&(e==="const"||e==="let")&&this.tolerateUnexpectedToken(this.lookahead,le.LetInLexicalBinding),r.push(this.lookahead),t=this.parseVariableIdentifier(e)),t}parsePatternWithDefault(r,e){let t=this.lookahead,i=this.parsePattern(r,e);if(this.match("=")){this.nextToken();let n=this.context.allowYield;this.context.allowYield=!0;let s=this.isolateCoverGrammar(this.parseAssignmentExpression);this.context.allowYield=n,i=this.finalize(this.startNode(t),new ud(i,s))}return i}parseVariableIdentifier(r){let e=this.createNode(),t=this.nextToken();return t.type===4&&t.value==="yield"?this.context.strict?this.tolerateUnexpectedToken(t,le.StrictReservedWord):this.context.allowYield||this.throwUnexpectedToken(t):t.type!==3?this.context.strict&&t.type===4&&this.scanner.isStrictModeReservedWord(t.value)?this.tolerateUnexpectedToken(t,le.StrictReservedWord):(this.context.strict||t.value!=="let"||r!=="var")&&this.throwUnexpectedToken(t):(this.context.isModule||this.context.isAsync)&&t.type===3&&t.value==="await"&&this.tolerateUnexpectedToken(t),this.finalize(e,new ur(t.value))}parseVariableDeclaration(r){let e=this.createNode(),t=[],i=this.parsePattern(t,"var");this.context.strict&&i.type==="Identifier"&&this.scanner.isRestrictedWord(i.name)&&this.tolerateError(le.StrictVarName);let n=null;return this.match("=")?(this.nextToken(),n=this.isolateCoverGrammar(this.parseAssignmentExpression)):i.type!=="Identifier"&&!r.inFor&&this.expect("="),this.finalize(e,new rp(i,n))}parseVariableDeclarationList(r){let e={inFor:r.inFor},t=[];for(t.push(this.parseVariableDeclaration(e));this.match(",");)this.nextToken(),t.push(this.parseVariableDeclaration(e));return t}parseVariableStatement(){let r=this.createNode();this.expectKeyword("var");let e=this.parseVariableDeclarationList({inFor:!1});return this.consumeSemicolon(),this.finalize(r,new hn(e,"var"))}parseEmptyStatement(){let r=this.createNode();return this.expect(";"),this.finalize(r,new So)}parseExpressionStatement(){let r=this.createNode(),e=this.parseExpression();return this.consumeSemicolon(),this.finalize(r,new fd(e))}parseIfClause(){return this.context.strict&&this.matchKeyword("function")&&this.tolerateError(le.StrictFunction),this.parseStatement()}parseIfStatement(){let r=this.createNode(),e,t=null;this.expectKeyword("if"),this.expect("(");let i=this.parseExpression();return!this.match(")")&&this.config.tolerant?(this.tolerateUnexpectedToken(this.nextToken()),e=this.finalize(this.createNode(),new So)):(this.expect(")"),e=this.parseIfClause(),this.matchKeyword("else")&&(this.nextToken(),t=this.parseIfClause())),this.finalize(r,new Uv(i,e,t))}parseDoWhileStatement(){let r=this.createNode();this.expectKeyword("do"),this.tolerateInvalidLoopStatement();let e=this.context.inIteration;this.context.inIteration=!0;let t=this.parseStatement();this.context.inIteration=e,this.expectKeyword("while"),this.expect("(");let i=this.parseExpression();return!this.match(")")&&this.config.tolerant?this.tolerateUnexpectedToken(this.nextToken()):(this.expect(")"),this.match(";")&&this.nextToken()),this.finalize(r,new Rv(t,i))}parseWhileStatement(){let r=this.createNode(),e;this.expectKeyword("while"),this.expect("(");let t=this.parseExpression();if(!this.match(")")&&this.config.tolerant)this.tolerateUnexpectedToken(this.nextToken()),e=this.finalize(this.createNode(),new So);else{this.expect(")");let i=this.context.inIteration;this.context.inIteration=!0,e=this.parseStatement(),this.context.inIteration=i}return this.finalize(r,new fw(t,e))}parseForStatement(){let r=null,e=null,t=null,i=!0,n,s,o=!1,a=this.createNode();if(this.expectKeyword("for"),this.matchContextualKeyword("await")&&(this.context.isAsync||this.tolerateUnexpectedToken(this.lookahead),o=!0,this.nextToken()),this.expect("("),this.match(";"))this.nextToken();else if(this.matchKeyword("var")){r=this.createNode(),this.nextToken();let u=this.context.allowIn;this.context.allowIn=!1;let c=this.parseVariableDeclarationList({inFor:!0});if(this.context.allowIn=u,!o&&c.length===1&&this.matchKeyword("in")){let d=c[0];d.init&&(d.id.type==="ArrayPattern"||d.id.type==="ObjectPattern"||this.context.strict)&&this.tolerateError(le.ForInOfLoopInitializer,"for-in"),r=this.finalize(r,new hn(c,"var")),this.nextToken(),n=r,s=this.parseExpression(),r=null}else c.length===1&&c[0].init===null&&this.matchContextualKeyword("of")?(r=this.finalize(r,new hn(c,"var")),this.nextToken(),n=r,s=this.parseAssignmentExpression(),r=null,i=!1):(r=this.finalize(r,new hn(c,"var")),this.expect(";"))}else if(this.matchKeyword("const")||this.matchKeyword("let")){r=this.createNode();let u=this.nextToken().value;if(!this.context.strict&&this.lookahead.value==="in")r=this.finalize(r,new ur(u)),this.nextToken(),n=r,s=this.parseExpression(),r=null;else{let c=this.context.allowIn;this.context.allowIn=!1;let d=this.parseBindingList(u,{inFor:!0});this.context.allowIn=c,d.length===1&&d[0].init===null&&this.matchKeyword("in")?(r=this.finalize(r,new hn(d,u)),this.nextToken(),n=r,s=this.parseExpression(),r=null):d.length===1&&d[0].init===null&&this.matchContextualKeyword("of")?(r=this.finalize(r,new hn(d,u)),this.nextToken(),n=r,s=this.parseAssignmentExpression(),r=null,i=!1):(this.consumeSemicolon(),r=this.finalize(r,new hn(d,u)))}}else{let u=this.lookahead,c=this.context.isBindingElement,d=this.context.isAssignmentTarget,h=this.context.firstCoverInitializedNameError,f=this.context.allowIn;if(this.context.allowIn=!1,r=this.inheritCoverGrammar(this.parseAssignmentExpression),this.context.allowIn=f,this.matchKeyword("in"))(!this.context.isAssignmentTarget||r.type==="AssignmentExpression")&&this.tolerateError(le.InvalidLHSInForIn),this.nextToken(),this.reinterpretExpressionAsPattern(r),n=r,s=this.parseExpression(),r=null;else if(this.matchContextualKeyword("of"))(!this.context.isAssignmentTarget||r.type==="AssignmentExpression")&&this.tolerateError(le.InvalidLHSInForLoop),this.nextToken(),this.reinterpretExpressionAsPattern(r),n=r,s=this.parseAssignmentExpression(),r=null,i=!1;else{if(this.context.isBindingElement=c,this.context.isAssignmentTarget=d,this.context.firstCoverInitializedNameError=h,this.match(",")){let m=[r];for(;this.match(",");)this.nextToken(),m.push(this.isolateCoverGrammar(this.parseAssignmentExpression));r=this.finalize(this.startNode(u),new hd(m))}this.expect(";")}}typeof n>"u"&&(this.match(";")||(e=this.isolateCoverGrammar(this.parseExpression)),this.expect(";"),this.match(")")||(t=this.isolateCoverGrammar(this.parseExpression)));let l;if(!this.match(")")&&this.config.tolerant)this.tolerateUnexpectedToken(this.nextToken()),l=this.finalize(this.createNode(),new So);else{this.expect(")"),this.tolerateInvalidLoopStatement();let u=this.context.inIteration;this.context.inIteration=!0,l=this.isolateCoverGrammar(this.parseStatement),this.context.inIteration=u}return typeof n>"u"?this.finalize(a,new Nv(r,e,t,l)):i?this.finalize(a,new Ov(n,s,l)):this.finalize(a,new Mv(n,s,l,o))}parseContinueStatement(){let r=this.createNode();this.expectKeyword("continue");let e=null;if(this.lookahead.type===3&&!this.hasLineTerminator){let t=this.parseVariableIdentifier();e=t;let i="$"+t.name;Object.prototype.hasOwnProperty.call(this.context.labelSet,i)||this.throwError(le.UnknownLabel,t.name)}return this.consumeSemicolon(),e===null&&!this.context.inIteration&&this.throwError(le.IllegalContinue),this.finalize(r,new xv(e))}parseBreakStatement(){let r=this.createNode();this.expectKeyword("break");let e=null;if(this.lookahead.type===3&&!this.hasLineTerminator){let t=this.parseVariableIdentifier(),i="$"+t.name;Object.prototype.hasOwnProperty.call(this.context.labelSet,i)||this.throwError(le.UnknownLabel,t.name),e=t}return this.consumeSemicolon(),e===null&&!this.context.inIteration&&!this.context.inSwitch&&this.throwError(le.IllegalBreak),this.finalize(r,new Fv(e))}parseReturnStatement(){this.context.inFunctionBody||this.tolerateError(le.IllegalReturn);let r=this.createNode();this.expectKeyword("return");let t=!this.match(";")&&!this.match("}")&&!this.hasLineTerminator&&this.lookahead.type!==2||this.lookahead.type===8||this.lookahead.type===10?this.parseExpression():null;return this.consumeSemicolon(),this.finalize(r,new tw(t))}parseWithStatement(){this.context.strict&&this.tolerateError(le.StrictModeWith);let r=this.createNode(),e;this.expectKeyword("with"),this.expect("(");let t=this.parseExpression();return!this.match(")")&&this.config.tolerant?(this.tolerateUnexpectedToken(this.nextToken()),e=this.finalize(this.createNode(),new So)):(this.expect(")"),e=this.parseStatement()),this.finalize(r,new hw(t,e))}parseSwitchCase(){let r=this.createNode(),e;this.matchKeyword("default")?(this.nextToken(),e=null):(this.expectKeyword("case"),e=this.parseExpression()),this.expect(":");let t=[];for(;!(this.match("}")||this.matchKeyword("default")||this.matchKeyword("case"));)t.push(this.parseStatementListItem());return this.finalize(r,new sw(e,t))}parseSwitchStatement(){let r=this.createNode();this.expectKeyword("switch"),this.expect("(");let e=this.parseExpression();this.expect(")");let t=this.context.inSwitch;this.context.inSwitch=!0;let i=[],n=!1;for(this.expect("{");!this.match("}");){let s=this.parseSwitchCase();s.test===null&&(n&&this.throwError(le.MultipleDefaultsInSwitch),n=!0),i.push(s)}return this.expect("}"),this.context.inSwitch=t,this.finalize(r,new ow(e,i))}parseLabelledStatement(){let r=this.createNode(),e=this.parseExpression(),t;if(e.type==="Identifier"&&this.match(":")){this.nextToken();let i=e,n="$"+i.name;Object.prototype.hasOwnProperty.call(this.context.labelSet,n)&&this.throwError(le.Redeclaration,"Label",i.name),this.context.labelSet[n]=!0;let s;if(this.matchKeyword("class"))this.tolerateUnexpectedToken(this.lookahead),s=this.parseClassDeclaration();else if(this.matchKeyword("function")){let o=this.lookahead,a=this.parseFunctionDeclaration();this.context.strict?this.tolerateUnexpectedToken(o,le.StrictFunction):a.generator&&this.tolerateUnexpectedToken(o,le.GeneratorInLegacyContext),s=a}else s=this.parseStatement();delete this.context.labelSet[n],t=new Hv(i,s)}else this.consumeSemicolon(),t=new fd(e);return this.finalize(r,t)}parseThrowStatement(){let r=this.createNode();this.expectKeyword("throw"),this.hasLineTerminator&&this.throwError(le.NewlineAfterThrow);let e=this.parseExpression();return this.consumeSemicolon(),this.finalize(r,new uw(e))}parseCatchClause(){let r=this.createNode();this.expectKeyword("catch");let e=null;if(this.match("(")){this.expect("("),this.match(")")&&this.throwUnexpectedToken(this.lookahead);let i=[];e=this.parsePattern(i);let n={};for(let s=0;s<i.length;s++){let o="$"+i[s].value;Object.prototype.hasOwnProperty.call(n,o)&&this.tolerateError(le.DuplicateBinding,i[s].value),n[o]=!0}this.context.strict&&e.type==="Identifier"&&this.scanner.isRestrictedWord(e.name)&&this.tolerateError(le.StrictCatchVariable),this.expect(")")}let t=this.parseBlock();return this.finalize(r,new Cv(e,t))}parseFinallyClause(){return this.expectKeyword("finally"),this.parseBlock()}parseTryStatement(){let r=this.createNode();this.expectKeyword("try");let e=this.parseBlock(),t=this.matchKeyword("catch")?this.parseCatchClause():null,i=this.matchKeyword("finally")?this.parseFinallyClause():null;return!t&&!i&&this.throwError(le.NoCatchOrFinally),this.finalize(r,new cw(e,t,i))}parseDebuggerStatement(){let r=this.createNode();return this.expectKeyword("debugger"),this.consumeSemicolon(),this.finalize(r,new Tv)}parseStatement(){let r;switch(this.lookahead.type){case 1:case 5:case 6:case 8:case 10:case 9:r=this.parseExpressionStatement();break;case 7:let e=this.lookahead.value;e==="{"?r=this.parseBlock():e==="("?r=this.parseExpressionStatement():e===";"?r=this.parseEmptyStatement():r=this.parseExpressionStatement();break;case 3:r=this.matchAsyncFunction()?this.parseFunctionDeclaration():this.parseLabelledStatement();break;case 4:switch(this.lookahead.value){case"break":r=this.parseBreakStatement();break;case"continue":r=this.parseContinueStatement();break;case"debugger":r=this.parseDebuggerStatement();break;case"do":r=this.parseDoWhileStatement();break;case"for":r=this.parseForStatement();break;case"function":r=this.parseFunctionDeclaration();break;case"if":r=this.parseIfStatement();break;case"return":r=this.parseReturnStatement();break;case"switch":r=this.parseSwitchStatement();break;case"throw":r=this.parseThrowStatement();break;case"try":r=this.parseTryStatement();break;case"var":r=this.parseVariableStatement();break;case"while":r=this.parseWhileStatement();break;case"with":r=this.parseWithStatement();break;default:r=this.parseExpressionStatement();break}break;default:r=this.throwUnexpectedToken(this.lookahead)}return r}parseFunctionSourceElements(){let r=this.createNode();this.expect("{");let e=this.parseDirectivePrologues(),t=this.context.labelSet,i=this.context.inIteration,n=this.context.inSwitch,s=this.context.inFunctionBody;for(this.context.labelSet={},this.context.inIteration=!1,this.context.inSwitch=!1,this.context.inFunctionBody=!0;this.lookahead.type!==2&&!this.match("}");)e.push(this.parseStatementListItem());return this.expect("}"),this.context.labelSet=t,this.context.inIteration=i,this.context.inSwitch=n,this.context.inFunctionBody=s,this.finalize(r,new qh(e))}validateParam(r,e,t){let i="$"+t;this.context.strict?(this.scanner.isRestrictedWord(t)&&(r.stricted=e,r.message=le.StrictParamName),Object.prototype.hasOwnProperty.call(r.paramSet,i)&&(r.stricted=e,r.hasDuplicateParameterNames=!0)):r.firstRestricted||(this.scanner.isRestrictedWord(t)?(r.firstRestricted=e,r.message=le.StrictParamName):this.scanner.isStrictModeReservedWord(t)?(r.firstRestricted=e,r.message=le.StrictReservedWord):Object.prototype.hasOwnProperty.call(r.paramSet,i)&&(r.stricted=e,r.hasDuplicateParameterNames=!0)),typeof Object.defineProperty=="function"?Object.defineProperty(r.paramSet,i,{value:!0,enumerable:!0,writable:!0,configurable:!0}):r.paramSet[i]=!0}parseRestElement(r){let e=this.createNode();this.expect("...");let t=this.parsePattern(r);return this.match("=")&&this.throwError(le.DefaultRestParameter),this.match(")")||this.throwError(le.ParameterAfterRestParameter),this.finalize(e,new Za(t))}parseFormalParameter(r){let e=[],t=this.match("...")?this.parseRestElement(e):this.parsePatternWithDefault(e);for(let i=0;i<e.length;i++)this.validateParam(r,e[i],e[i].value);r.simple=r.simple&&t instanceof ur,r.params.push(t)}parseFormalParameters(r){let e={simple:!0,hasDuplicateParameterNames:!1,params:[],firstRestricted:r};if(this.expect("("),!this.match(")"))for(e.paramSet={};this.lookahead.type!==2&&(this.parseFormalParameter(e),!(this.match(")")||(this.expect(","),this.match(")")))););return this.expect(")"),e.hasDuplicateParameterNames&&(this.context.strict||this.context.isAsync||!e.simple)&&this.throwError(le.DuplicateParameter),{simple:e.simple,params:e.params,stricted:e.stricted,firstRestricted:e.firstRestricted,message:e.message}}matchAsyncFunction(){let r=this.matchContextualKeyword("async");if(r){let e=this.scanner.saveState();this.scanner.scanComments();let t=this.scanner.lex();this.scanner.restoreState(e),r=e.lineNumber===t.lineNumber&&t.type===4&&t.value==="function"}return r}parseFunctionDeclaration(r){let e=this.createNode(),t=this.matchContextualKeyword("async");t&&(this.context.inIteration&&this.tolerateError(le.AsyncFunctionInSingleStatementContext),this.nextToken()),this.expectKeyword("function");let i=this.match("*");i&&this.nextToken();let n,s=null,o=null;if(!r||!this.match("(")){let p=this.lookahead;s=this.parseVariableIdentifier(),this.context.strict?this.scanner.isRestrictedWord(p.value)&&this.tolerateUnexpectedToken(p,le.StrictFunctionName):this.scanner.isRestrictedWord(p.value)?(o=p,n=le.StrictFunctionName):this.scanner.isStrictModeReservedWord(p.value)&&(o=p,n=le.StrictReservedWord)}let a=this.context.isAsync,l=this.context.allowYield;this.context.isAsync=t,this.context.allowYield=!i;let u=this.parseFormalParameters(o),c=u.params,d=u.stricted;o=u.firstRestricted,u.message&&(n=u.message);let h=this.context.strict,f=this.context.allowStrictDirective;this.context.allowStrictDirective=u.simple;let m=this.parseFunctionSourceElements();return this.context.strict&&o&&this.throwUnexpectedToken(o,n),this.context.strict&&d&&this.tolerateUnexpectedToken(d,n),this.context.strict=h,this.context.allowStrictDirective=f,this.context.isAsync=a,this.context.allowYield=l,t?this.finalize(e,new wv(s,c,m,i)):this.finalize(e,new jv(s,c,m,i))}parseFunctionExpression(){let r=this.createNode(),e=this.matchContextualKeyword("async");e&&this.nextToken(),this.expectKeyword("function");let t=this.match("*");t&&this.nextToken();let i,n=null,s,o=this.context.isAsync,a=this.context.allowYield;if(this.context.isAsync=e,this.context.allowYield=!t,!this.match("(")){let m=this.lookahead;n=!this.context.strict&&!t&&this.matchKeyword("yield")?this.parseIdentifierName():this.parseVariableIdentifier(),this.context.strict?this.scanner.isRestrictedWord(m.value)&&this.tolerateUnexpectedToken(m,le.StrictFunctionName):this.scanner.isRestrictedWord(m.value)?(s=m,i=le.StrictFunctionName):this.scanner.isStrictModeReservedWord(m.value)&&(s=m,i=le.StrictReservedWord)}let l=this.parseFormalParameters(s),u=l.params,c=l.stricted;s=l.firstRestricted,l.message&&(i=l.message);let d=this.context.strict,h=this.context.allowStrictDirective;this.context.allowStrictDirective=l.simple;let f=this.parseFunctionSourceElements();return this.context.strict&&s&&this.throwUnexpectedToken(s,i),this.context.strict&&c&&this.tolerateUnexpectedToken(c,i),this.context.strict=d,this.context.allowStrictDirective=h,this.context.isAsync=o,this.context.allowYield=a,this.finalize(r,new ks(n,u,f,t,e))}parseDirective(){let r=this.lookahead,e=this.createNode(),t=this.parseExpression(),i=t.type==="Literal"?this.getTokenRaw(r).slice(1,-1):null;return this.consumeSemicolon(),this.finalize(e,i?new Av(t,i):new fd(t))}parseDirectivePrologues(){let r=null,e=[];for(;;){let t=this.lookahead;if(t.type!==8)break;let i=this.parseDirective();e.push(i);let n=i.directive;if(typeof n!="string")break;n==="use strict"?(this.context.strict=!0,r&&this.tolerateUnexpectedToken(r,le.StrictOctalLiteral),this.context.allowStrictDirective||this.tolerateUnexpectedToken(t,le.IllegalLanguageModeDirective)):!r&&t.octal&&(r=t)}return e}qualifiedPropertyName(r){switch(r.type){case 3:case 8:case 1:case 5:case 6:case 4:return!0;case 7:return r.value==="["||r.value==="#";default:break}return!1}parseGetterMethod(){let r=this.createNode(),e=!1,t=this.context.allowYield;this.context.allowYield=!e;let i=this.parseFormalParameters();i.params.length>0&&this.tolerateError(le.BadGetterArity);let n=this.parsePropertyMethod(i);return this.context.allowYield=t,this.finalize(r,new ks(null,i.params,n,e,!1))}parseSetterMethod(){let r=this.createNode(),e=!1,t=this.context.allowYield;this.context.allowYield=!e;let i=this.parseFormalParameters();i.params.length!==1?this.tolerateError(le.BadSetterArity):i.params[0]instanceof Za&&this.tolerateError(le.BadSetterRestParameter);let n=this.parsePropertyMethod(i);return this.context.allowYield=t,this.finalize(r,new ks(null,i.params,n,e,!1))}parseGeneratorMethod(r){let e=this.createNode(),t=!0,i=this.context.allowYield;this.context.allowYield=!0;let n=this.parseFormalParameters();this.context.allowYield=!1;let s=this.parsePropertyMethod(n);return this.context.allowYield=i,this.finalize(e,new ks(null,n.params,s,t,r))}isStartOfExpression(){let r=!0,e=this.lookahead.value;switch(this.lookahead.type){case 7:r=e==="["||e==="("||e==="{"||e==="+"||e==="-"||e==="!"||e==="~"||e==="++"||e==="--"||e==="/"||e==="/=";break;case 4:r=e==="class"||e==="delete"||e==="function"||e==="let"||e==="new"||e==="super"||e==="this"||e==="typeof"||e==="void"||e==="yield";break;default:break}return r}parseYieldExpression(){let r=this.createNode();this.expectKeyword("yield");let e=null,t=!1;if(!this.hasLineTerminator){let i=this.context.allowYield;this.context.allowYield=!1,t=this.match("*"),t?(this.nextToken(),e=this.parseAssignmentExpression()):this.isStartOfExpression()&&(e=this.parseAssignmentExpression()),this.context.allowYield=i}return this.finalize(r,new pw(e,t))}parseStaticBlock(){let r=this.createNode();this.expect("{");let e=[];for(;!this.match("}");)e.push(this.parseStatementListItem());return this.expect("}"),this.finalize(r,new nw(e))}parseDecorator(){let r=this.createNode();this.expect("@");let e=this.context.strict,t=this.context.allowYield,i=this.context.isAsync;this.context.strict=!1,this.context.allowYield=!0,this.context.isAsync=!1;let n=this.isolateCoverGrammar(this.parseLeftHandSideExpressionAllowCall);return this.context.strict=e,this.context.allowYield=t,this.context.isAsync=i,this.match(";")&&this.throwError(le.NoSemicolonAfterDecorator),this.finalize(r,new Dv(n))}parseDecorators(){let r=null;for(;this.match("@");)r==null&&(r=[]),r.push(this.parseDecorator());return r}parseClassElement(r){let e=this.lookahead,t=this.createNode(),i=this.context.inConstructor,n="",s=null,o=null,a=!1,l=!1,u=!1,c=!1,d=!1,h=!1,f=this.parseDecorators();if(f&&(e=this.lookahead),this.match("*"))this.nextToken();else{a=this.match("["),this.match("#")&&(h=!0,this.nextToken(),e=this.lookahead),s=this.parseObjectPropertyKey(h);let p=s;if(this.context.inConstructor=e.type===3&&e.value==="constructor",p.name==="static"&&(this.qualifiedPropertyName(this.lookahead)||this.match("*"))&&(e=this.lookahead,u=!0,a=this.match("["),this.match("*")?(this.nextToken(),this.match("#")&&(h=!0,this.nextToken(),e=this.lookahead)):(this.match("#")&&(h=!0,this.nextToken(),e=this.lookahead),s=this.parseObjectPropertyKey(h))),p.name==="static"&&this.match("{"))return this.parseStaticBlock();if(e.type===3&&!this.hasLineTerminator&&e.value==="async"){let g=this.lookahead.value;g!==":"&&g!=="("&&(c=!0,d=this.match("*"),d&&this.nextToken(),e=this.lookahead,a=this.match("["),this.match("*")?(this.nextToken(),this.match("#")&&(h=!0,this.nextToken())):(this.match("#")&&(h=!0,this.nextToken(),e=this.lookahead),s=this.parseObjectPropertyKey(h)),e.type===3&&e.value==="constructor"&&!u&&this.tolerateUnexpectedToken(e,le.ConstructorIsAsync))}}e.type===3&&e.value==="constructor"&&h&&this.tolerateUnexpectedToken(e,le.ConstructorIsPrivate);let m=this.qualifiedPropertyName(this.lookahead);if(e.type===3||e.type===8?e.value==="get"&&m?(n="get",this.match("#")&&(h=!0,this.nextToken(),e=this.lookahead),a=this.match("["),s=this.parseObjectPropertyKey(h),this.context.allowYield=!1,o=this.parseGetterMethod()):e.value==="set"&&m?(n="set",this.match("#")&&(h=!0,this.nextToken(),e=this.lookahead),a=this.match("["),s=this.parseObjectPropertyKey(h),o=this.parseSetterMethod()):this.match("(")||(n="property",a=!1,this.match("=")&&(this.nextToken(),o=this.isolateCoverGrammar(this.parseAssignmentExpression))):e.type===7&&e.value==="*"&&m?(n="init",a=this.match("["),s=this.parseObjectPropertyKey(h),o=this.parseGeneratorMethod(c),l=!0):e.type===7&&e.value==="["&&!this.match("(")&&(n="property",a=!0,this.match("=")&&(this.nextToken(),o=this.isolateCoverGrammar(this.parseAssignmentExpression))),!n&&s&&this.match("(")){let p=this.context.inClassConstructor;this.context.inClassConstructor=e.value==="constructor",n="init",o=c?this.parsePropertyMethodAsyncFunction(d):this.parsePropertyMethodFunction(d),this.context.inClassConstructor=p,l=!0}return n||this.throwUnexpectedToken(this.lookahead),n==="init"&&(n="method"),a||(u&&this.isPropertyKey(s,"prototype")&&this.throwUnexpectedToken(e,le.StaticPrototype),!u&&this.isPropertyKey(s,"constructor")&&((n!=="method"||!l||o&&o.generator)&&this.throwUnexpectedToken(e,le.ConstructorSpecialMethod),r.value?this.throwUnexpectedToken(e,le.DuplicateConstructor):r.value=!0,n="constructor")),this.context.inConstructor=i,n==="property"?(this.consumeSemicolon(),this.finalize(t,new Qv(s,a,o,u,f))):this.finalize(t,new qv(s,a,o,n,u,f))}parseClassElementList(){let r=[],e={value:!1};for(this.expect("{");!this.match("}");)this.match(";")?this.nextToken():r.push(this.parseClassElement(e));return this.expect("}"),r}parseClassBody(){let r=this.createNode(),e=this.parseClassElementList();return this.finalize(r,new Sv(e))}parseClassDeclaration(r){let e=this.createNode(),t=this.context.strict,i=this.context.allowSuper;this.context.strict=!0,this.expectKeyword("class");let n=r&&this.lookahead.type!==3?null:this.parseVariableIdentifier(),s=null;this.matchKeyword("extends")&&(this.nextToken(),s=this.isolateCoverGrammar(this.parseLeftHandSideExpressionAllowCall),this.context.allowSuper=!0);let o=this.parseClassBody();return this.context.allowSuper=i,this.context.strict=t,this.finalize(e,new Pv(n,s,o,this.context.decorators))}parseClassExpression(){let r=this.createNode(),e=this.context.strict;this.context.strict=!0,this.expectKeyword("class");let t=this.lookahead.type===3?this.parseVariableIdentifier():null,i=null;this.matchKeyword("extends")&&(this.nextToken(),i=this.isolateCoverGrammar(this.parseLeftHandSideExpressionAllowCall),this.context.allowSuper=!0);let n=this.parseClassBody();return this.context.strict=e,this.finalize(r,new Ev(t,i,n,this.context.decorators))}parseModule(){this.context.strict=!0,this.context.isModule=!0,this.scanner.isModule=!0;let r=this.createNode(),e=this.parseDirectivePrologues();for(;this.lookahead.type!==2;)e.push(this.parseStatementListItem());return this.finalize(r,new Kv(e))}parseScript(){let r=this.createNode(),e=this.parseDirectivePrologues();for(;this.lookahead.type!==2;)e.push(this.parseStatementListItem());return this.finalize(r,new iw(e))}parseImportAttributes(){if(this.lookahead.value==="assert"){this.nextToken(),this.expect("{");let r=[];for(;!this.match("}");)r.push(this.parseImportAttribute()),this.match("}")||this.expectCommaSeparator();return this.expect("}"),r}return null}parseImportAttribute(){let r=this.createNode();this.lookahead.type!==3&&this.throwUnexpectedToken(this.nextToken());let e=this.parseIdentifierName();this.match(":")||this.throwUnexpectedToken(this.nextToken()),this.nextToken();let t=this.nextToken(),i=this.getTokenRaw(t),n=this.finalize(r,new Wn(t.value,i));return this.finalize(r,new Gv(e,n))}parseModuleSpecifier(){let r=this.createNode();this.lookahead.type!==8&&this.throwError(le.InvalidModuleSpecifier);let e=this.nextToken(),t=this.getTokenRaw(e);return qe.isStringWellFormedUnicode(e.value)||this.throwError(le.InvalidModuleSpecifier),this.finalize(r,new Wn(e.value,t))}parseImportSpecifier(){let r=this.createNode(),e,t;return this.lookahead.type===3?(e=this.parseVariableIdentifier(),t=e,this.matchContextualKeyword("as")&&(this.nextToken(),t=this.parseVariableIdentifier())):(e=this.lookahead.type==8?this.parseModuleSpecifier():this.parseIdentifierName(),t=e,this.matchContextualKeyword("as")?(this.nextToken(),t=this.parseVariableIdentifier()):this.throwUnexpectedToken(this.nextToken())),this.finalize(r,new $v(t,e))}parseNamedImports(){this.expect("{");let r=[];for(;!this.match("}");)r.push(this.parseImportSpecifier()),this.match("}")||this.expect(",");return this.expect("}"),r}parseImportDefaultSpecifier(){let r=this.createNode(),e=this.parseIdentifierName();return this.finalize(r,new Wv(e))}parseImportNamespaceSpecifier(){let r=this.createNode();this.expect("*"),this.matchContextualKeyword("as")||this.throwError(le.NoAsAfterImportNamespace),this.lookahead.escaped&&this.throwError(le.NoAsAndFromEscapeSequences),this.nextToken();let e=this.parseIdentifierName();return this.finalize(r,new Jv(e))}parseImportDeclaration(){this.context.inFunctionBody&&this.throwError(le.IllegalImportDeclaration);let r=this.createNode();this.expectKeyword("import");let e,t=[];if(this.lookahead.type===8)e=this.parseModuleSpecifier();else{if(this.match("{")?t=t.concat(this.parseNamedImports()):this.match("*")?t.push(this.parseImportNamespaceSpecifier()):this.isIdentifierName(this.lookahead)&&!this.matchKeyword("default")?(t.push(this.parseImportDefaultSpecifier()),this.match(",")&&(this.nextToken(),this.match("*")?t.push(this.parseImportNamespaceSpecifier()):this.match("{")?t=t.concat(this.parseNamedImports()):this.throwUnexpectedToken(this.lookahead))):this.throwUnexpectedToken(this.nextToken()),!this.matchContextualKeyword("from")){let n=this.lookahead.value?le.UnexpectedToken:le.MissingFromClause;this.throwError(n,this.lookahead.value)}this.nextToken(),e=this.parseModuleSpecifier()}let i=this.parseImportAttributes();return this.consumeSemicolon(),this.finalize(r,new Vv(t,e,i))}parseExportSpecifier(){let r=this.createNode(),e=this.lookahead.type==8?this.parseModuleSpecifier():this.parseIdentifierName(),t=e;return this.matchContextualKeyword("as")&&(this.lookahead.escaped&&this.throwError(le.NoAsAndFromEscapeSequences),this.nextToken(),t=this.lookahead.type==8?this.parseModuleSpecifier():this.parseIdentifierName()),this.finalize(r,new Lv(e,t))}parseExportDeclaration(){this.context.inFunctionBody&&this.throwError(le.IllegalExportDeclaration);let r=this.createNode();this.expectKeyword("export");let e;if(this.matchKeyword("default"))if(this.nextToken(),this.matchKeyword("function")){let t=this.parseFunctionDeclaration(!0);e=this.finalize(r,new qa(t))}else if(this.matchKeyword("class")){let t=this.parseClassDeclaration(!0);e=this.finalize(r,new qa(t))}else if(this.matchContextualKeyword("async")){let t=this.matchAsyncFunction()?this.parseFunctionDeclaration(!0):this.parseAssignmentExpression();e=this.finalize(r,new qa(t))}else{this.matchContextualKeyword("from")&&this.throwError(le.UnexpectedToken,this.lookahead.value);let t=this.match("{")?this.parseObjectInitializer():this.match("[")?this.parseArrayInitializer():this.parseAssignmentExpression();this.consumeSemicolon(),e=this.finalize(r,new qa(t))}else if(this.match("*")){this.nextToken();let t=null;if(this.matchContextualKeyword("as")&&(this.lookahead.escaped&&this.throwError(le.NoAsAndFromEscapeSequences),this.nextToken(),t=this.lookahead.type==8?this.parseModuleSpecifier():this.parseIdentifierName()),!this.matchContextualKeyword("from")){let s=this.lookahead.value?le.UnexpectedToken:le.MissingFromClause;this.throwError(s,this.lookahead.value)}this.lookahead.escaped&&this.throwError(le.NoAsAndFromEscapeSequences),this.nextToken();let i=this.parseModuleSpecifier(),n=this.parseImportAttributes();this.consumeSemicolon(),e=this.finalize(r,new Bv(i,t,n))}else if(this.lookahead.type===4){let t;switch(this.lookahead.value){case"let":case"const":t=this.parseLexicalDeclaration({inFor:!1});break;case"var":case"class":case"function":t=this.parseStatementListItem();break;default:this.throwUnexpectedToken(this.lookahead)}e=this.finalize(r,new dd(t,[],null,null))}else if(this.matchAsyncFunction()){let t=this.parseFunctionDeclaration();e=this.finalize(r,new dd(t,[],null,null))}else{let t=[],i=null,n=!1,s=null;for(this.expect("{");!this.match("}");)n=n||this.matchKeyword("default"),t.push(this.parseExportSpecifier()),this.match("}")||this.expect(",");if(this.expect("}"),this.matchContextualKeyword("from"))this.lookahead.escaped&&this.throwError(le.NoAsAndFromEscapeSequences),this.nextToken(),i=this.parseModuleSpecifier(),s=this.parseImportAttributes(),this.consumeSemicolon();else if(n){let o=this.lookahead.value?le.UnexpectedToken:le.MissingFromClause;this.throwError(o,this.lookahead.value)}else s=this.parseImportAttributes(),this.consumeSemicolon();e=this.finalize(r,new dd(null,t,i,s))}return e}},pv={quot:'"',amp:"&",apos:"'",gt:">",nbsp:"\xA0",iexcl:"\xA1",cent:"\xA2",pound:"\xA3",curren:"\xA4",yen:"\xA5",brvbar:"\xA6",sect:"\xA7",uml:"\xA8",copy:"\xA9",ordf:"\xAA",laquo:"\xAB",not:"\xAC",shy:"\xAD",reg:"\xAE",macr:"\xAF",deg:"\xB0",plusmn:"\xB1",sup2:"\xB2",sup3:"\xB3",acute:"\xB4",micro:"\xB5",para:"\xB6",middot:"\xB7",cedil:"\xB8",sup1:"\xB9",ordm:"\xBA",raquo:"\xBB",frac14:"\xBC",frac12:"\xBD",frac34:"\xBE",iquest:"\xBF",Agrave:"\xC0",Aacute:"\xC1",Acirc:"\xC2",Atilde:"\xC3",Auml:"\xC4",Aring:"\xC5",AElig:"\xC6",Ccedil:"\xC7",Egrave:"\xC8",Eacute:"\xC9",Ecirc:"\xCA",Euml:"\xCB",Igrave:"\xCC",Iacute:"\xCD",Icirc:"\xCE",Iuml:"\xCF",ETH:"\xD0",Ntilde:"\xD1",Ograve:"\xD2",Oacute:"\xD3",Ocirc:"\xD4",Otilde:"\xD5",Ouml:"\xD6",times:"\xD7",Oslash:"\xD8",Ugrave:"\xD9",Uacute:"\xDA",Ucirc:"\xDB",Uuml:"\xDC",Yacute:"\xDD",THORN:"\xDE",szlig:"\xDF",agrave:"\xE0",aacute:"\xE1",acirc:"\xE2",atilde:"\xE3",auml:"\xE4",aring:"\xE5",aelig:"\xE6",ccedil:"\xE7",egrave:"\xE8",eacute:"\xE9",ecirc:"\xEA",euml:"\xEB",igrave:"\xEC",iacute:"\xED",icirc:"\xEE",iuml:"\xEF",eth:"\xF0",ntilde:"\xF1",ograve:"\xF2",oacute:"\xF3",ocirc:"\xF4",otilde:"\xF5",ouml:"\xF6",divide:"\xF7",oslash:"\xF8",ugrave:"\xF9",uacute:"\xFA",ucirc:"\xFB",uuml:"\xFC",yacute:"\xFD",thorn:"\xFE",yuml:"\xFF",OElig:"\u0152",oelig:"\u0153",Scaron:"\u0160",scaron:"\u0161",Yuml:"\u0178",fnof:"\u0192",circ:"\u02C6",tilde:"\u02DC",Alpha:"\u0391",Beta:"\u0392",Gamma:"\u0393",Delta:"\u0394",Epsilon:"\u0395",Zeta:"\u0396",Eta:"\u0397",Theta:"\u0398",Iota:"\u0399",Kappa:"\u039A",Lambda:"\u039B",Mu:"\u039C",Nu:"\u039D",Xi:"\u039E",Omicron:"\u039F",Pi:"\u03A0",Rho:"\u03A1",Sigma:"\u03A3",Tau:"\u03A4",Upsilon:"\u03A5",Phi:"\u03A6",Chi:"\u03A7",Psi:"\u03A8",Omega:"\u03A9",alpha:"\u03B1",beta:"\u03B2",gamma:"\u03B3",delta:"\u03B4",epsilon:"\u03B5",zeta:"\u03B6",eta:"\u03B7",theta:"\u03B8",iota:"\u03B9",kappa:"\u03BA",lambda:"\u03BB",mu:"\u03BC",nu:"\u03BD",xi:"\u03BE",omicron:"\u03BF",pi:"\u03C0",rho:"\u03C1",sigmaf:"\u03C2",sigma:"\u03C3",tau:"\u03C4",upsilon:"\u03C5",phi:"\u03C6",chi:"\u03C7",psi:"\u03C8",omega:"\u03C9",thetasym:"\u03D1",upsih:"\u03D2",piv:"\u03D6",ensp:"\u2002",emsp:"\u2003",thinsp:"\u2009",zwnj:"\u200C",zwj:"\u200D",lrm:"\u200E",rlm:"\u200F",ndash:"\u2013",mdash:"\u2014",lsquo:"\u2018",rsquo:"\u2019",sbquo:"\u201A",ldquo:"\u201C",rdquo:"\u201D",bdquo:"\u201E",dagger:"\u2020",Dagger:"\u2021",bull:"\u2022",hellip:"\u2026",permil:"\u2030",prime:"\u2032",Prime:"\u2033",lsaquo:"\u2039",rsaquo:"\u203A",oline:"\u203E",frasl:"\u2044",euro:"\u20AC",image:"\u2111",weierp:"\u2118",real:"\u211C",trade:"\u2122",alefsym:"\u2135",larr:"\u2190",uarr:"\u2191",rarr:"\u2192",darr:"\u2193",harr:"\u2194",crarr:"\u21B5",lArr:"\u21D0",uArr:"\u21D1",rArr:"\u21D2",dArr:"\u21D3",hArr:"\u21D4",forall:"\u2200",part:"\u2202",exist:"\u2203",empty:"\u2205",nabla:"\u2207",isin:"\u2208",notin:"\u2209",ni:"\u220B",prod:"\u220F",sum:"\u2211",minus:"\u2212",lowast:"\u2217",radic:"\u221A",prop:"\u221D",infin:"\u221E",ang:"\u2220",and:"\u2227",or:"\u2228",cap:"\u2229",cup:"\u222A",int:"\u222B",there4:"\u2234",sim:"\u223C",cong:"\u2245",asymp:"\u2248",ne:"\u2260",equiv:"\u2261",le:"\u2264",ge:"\u2265",sub:"\u2282",sup:"\u2283",nsub:"\u2284",sube:"\u2286",supe:"\u2287",oplus:"\u2295",otimes:"\u2297",perp:"\u22A5",sdot:"\u22C5",lceil:"\u2308",rceil:"\u2309",lfloor:"\u230A",rfloor:"\u230B",loz:"\u25CA",spades:"\u2660",clubs:"\u2663",hearts:"\u2665",diams:"\u2666",lang:"\u27E8",rang:"\u27E9"};Xi[100]="JSXIdentifier";Xi[101]="JSXText";function Po(r){let e;switch(r.type){case"JSXIdentifier":e=r.name;break;case"JSXNamespacedName":let i=r;e=Po(i.namespace)+":"+Po(i.name);break;case"JSXMemberExpression":let n=r;e=Po(n.object)+"."+Po(n.property);break;default:break}return e}var Fx=class extends bw{constructor(r,e,t){super(r,e,t)}parsePrimaryExpression(){return this.match("<")?this.parseJSXRoot():super.parsePrimaryExpression()}startJSX(){this.scanner.index=this.startMarker.index,this.scanner.lineNumber=this.startMarker.line,this.scanner.lineStart=this.startMarker.index-this.startMarker.column}finishJSX(){this.nextToken()}reenterJSX(){this.startJSX(),this.expectJSX("}"),this.config.tokens&&this.tokens.pop()}createJSXNode(){return this.collectComments(),{index:this.scanner.index,line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}}createJSXChildNode(){return{index:this.scanner.index,line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}}scanXHTMLEntity(r){let e="&",t=!0,i=!1,n=!1,s=!1;for(;!this.scanner.eof()&&t&&!i;){let o=this.scanner.source[this.scanner.index];if(o===r)break;if(i=o===";",e+=o,++this.scanner.index,!i)switch(e.length){case 2:n=o==="#";break;case 3:n&&(s=o==="x",t=s||qe.isDecimalDigit(o.charCodeAt(0)),n=n&&!s);break;default:t=t&&!(n&&!qe.isDecimalDigit(o.charCodeAt(0))),t=t&&!(s&&!qe.isHexDigit(o.charCodeAt(0)));break}}if(t&&i&&e.length>2){let o=e.substr(1,e.length-2);n&&o.length>1?e=String.fromCharCode(parseInt(o.substr(1),10)):s&&o.length>2?e=String.fromCharCode(parseInt("0"+o.substr(1),16)):!n&&!s&&pv[o]&&(e=pv[o])}return e}lexJSX(){let r=this.scanner.source.charCodeAt(this.scanner.index);if(r===60||r===62||r===47||r===58||r===61||r===123||r===125)return{type:7,value:this.scanner.source[this.scanner.index++],lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:this.scanner.index-1,end:this.scanner.index};if(r===34||r===39){let e=this.scanner.index,t=this.scanner.source[this.scanner.index++],i="";for(;!this.scanner.eof();){let n=this.scanner.source[this.scanner.index++];if(n===t)break;n==="&"?i+=this.scanXHTMLEntity(t):i+=n}return{type:8,value:i,lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:e,end:this.scanner.index}}if(r===46){let e=this.scanner.source.charCodeAt(this.scanner.index+1),t=this.scanner.source.charCodeAt(this.scanner.index+2),i=e===46&&t===46?"...":".",n=this.scanner.index;return this.scanner.index+=i.length,{type:7,value:i,lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:n,end:this.scanner.index}}if(r===96)return{type:10,value:"",lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:this.scanner.index,end:this.scanner.index};if(qe.isIdentifierStart(r)&&r!==92){let e=this.scanner.index;for(++this.scanner.index;!this.scanner.eof();){let i=this.scanner.source.charCodeAt(this.scanner.index);if(qe.isIdentifierPart(i)&&i!==92)++this.scanner.index;else if(i===45)++this.scanner.index;else break}return{type:100,value:this.scanner.source.slice(e,this.scanner.index),lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:e,end:this.scanner.index}}return this.scanner.lex()}nextJSXToken(){this.collectComments(),this.startMarker.index=this.scanner.index,this.startMarker.line=this.scanner.lineNumber,this.startMarker.column=this.scanner.index-this.scanner.lineStart;let r=this.lexJSX();return this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart,this.config.tokens&&this.tokens.push(this.convertToken(r)),r}nextJSXText(){this.startMarker.index=this.scanner.index,this.startMarker.line=this.scanner.lineNumber,this.startMarker.column=this.scanner.index-this.scanner.lineStart;let r=this.scanner.index,e="";for(;!this.scanner.eof();){let i=this.scanner.source[this.scanner.index];if(i==="{"||i==="<")break;++this.scanner.index,e+=i,qe.isLineTerminator(i.charCodeAt(0))&&(++this.scanner.lineNumber,i==="\r"&&this.scanner.source[this.scanner.index]===`
`&&++this.scanner.index,this.scanner.lineStart=this.scanner.index)}this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart;let t={type:101,value:e,lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:r,end:this.scanner.index};return e.length>0&&this.config.tokens&&this.tokens.push(this.convertToken(t)),t}peekJSXToken(){let r=this.scanner.saveState();this.scanner.scanComments();let e=this.lexJSX();return this.scanner.restoreState(r),e}expectJSX(r){let e=this.nextJSXToken();(e.type!==7||e.value!==r)&&this.throwUnexpectedToken(e)}matchJSX(r){let e=this.peekJSXToken();return e.type===7&&e.value===r}parseJSXIdentifier(){let r=this.createJSXNode(),e=this.nextJSXToken();return e.type!==100&&this.throwUnexpectedToken(e),this.finalize(r,new px(e.value))}parseJSXElementName(){let r=this.createJSXNode(),e=this.parseJSXIdentifier();if(this.matchJSX(":")){let t=e;this.expectJSX(":");let i=this.parseJSXIdentifier();e=this.finalize(r,new dv(t,i))}else if(this.matchJSX("."))for(;this.matchJSX(".");){let t=e;this.expectJSX(".");let i=this.parseJSXIdentifier();e=this.finalize(r,new mx(t,i))}return e}parseJSXAttributeName(){let r=this.createJSXNode(),e,t=this.parseJSXIdentifier();if(this.matchJSX(":")){let i=t;this.expectJSX(":");let n=this.parseJSXIdentifier();e=this.finalize(r,new dv(i,n))}else e=t;return e}parseJSXStringLiteralAttribute(){let r=this.createJSXNode(),e=this.nextJSXToken();e.type!==8&&this.throwUnexpectedToken(e);let t=this.getTokenRaw(e);return this.finalize(r,new Wn(e.value,t))}parseJSXExpressionAttribute(){let r=this.createJSXNode();this.expectJSX("{"),this.finishJSX(),this.match("}")&&this.tolerateError("JSX attributes must only be assigned a non-empty expression");let e=this.parseAssignmentExpression();return this.reenterJSX(),this.finalize(r,new cv(e))}parseJSXAttributeValue(){return this.matchJSX("{")?this.parseJSXExpressionAttribute():this.matchJSX("<")?this.parseJSXElement():this.parseJSXStringLiteralAttribute()}parseJSXNameValueAttribute(){let r=this.createJSXNode(),e=this.parseJSXAttributeName(),t=null;return this.matchJSX("=")&&(this.expectJSX("="),t=this.parseJSXAttributeValue()),this.finalize(r,new gx(e,t))}parseJSXSpreadAttribute(){let r=this.createJSXNode();this.expectJSX("{"),this.expectJSX("..."),this.finishJSX();let e=this.parseAssignmentExpression();return this.reenterJSX(),this.finalize(r,new yx(e))}parseJSXAttributes(){let r=[];for(;!this.matchJSX("/")&&!this.matchJSX(">");){let e=this.matchJSX("{")?this.parseJSXSpreadAttribute():this.parseJSXNameValueAttribute();r.push(e)}return r}parseJSXOpeningElement(){let r=this.createJSXNode();if(this.expectJSX("<"),this.matchJSX(">"))return this.expectJSX(">"),this.finalize(r,new bx(!1));let e=this.parseJSXElementName(),t=this.parseJSXAttributes(),i=this.matchJSX("/");return i&&this.expectJSX("/"),this.expectJSX(">"),this.finalize(r,new fv(e,i,t))}parseJSXBoundaryElement(){let r=this.createJSXNode();if(this.expectJSX("<"),this.matchJSX("/")){if(this.expectJSX("/"),this.matchJSX(">"))return this.expectJSX(">"),this.finalize(r,new fx);let n=this.parseJSXElementName();return this.expectJSX(">"),this.finalize(r,new dx(n))}let e=this.parseJSXElementName(),t=this.parseJSXAttributes(),i=this.matchJSX("/");return i&&this.expectJSX("/"),this.expectJSX(">"),this.finalize(r,new fv(e,i,t))}parseJSXEmptyExpression(){let r=this.createJSXChildNode();return this.collectComments(),this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart,this.finalize(r,new hx)}parseJSXExpressionContainer(){let r=this.createJSXNode();this.expectJSX("{");let e;return this.matchJSX("}")?(e=this.parseJSXEmptyExpression(),this.expectJSX("}")):(this.finishJSX(),e=this.parseAssignmentExpression(),this.reenterJSX()),this.finalize(r,new cv(e))}parseJSXChildren(){let r=[];for(;!this.scanner.eof();){let e=this.createJSXChildNode(),t=this.nextJSXText();if(t.start<t.end){let i=this.getTokenRaw(t),n=this.finalize(e,new vx(t.value,i));r.push(n)}if(this.scanner.source[this.scanner.index]==="{"){let i=this.parseJSXExpressionContainer();r.push(i)}else break}return r}parseComplexJSXElement(r){let e=[];for(;!this.scanner.eof();){r.children=r.children.concat(this.parseJSXChildren());let t=this.createJSXChildNode(),i=this.parseJSXBoundaryElement();if(i.type==="JSXOpeningElement"){let n=i;if(n.selfClosing){let s=this.finalize(t,new Jh(n,[],null));r.children.push(s)}else e.push(r),r={node:t,opening:n,closing:null,children:[]}}if(i.type==="JSXClosingElement"){r.closing=i;let n=Po(r.opening.name),s=Po(r.closing.name);if(n!==s&&this.tolerateError("Expected corresponding JSX closing tag for %0",n),e.length>0){let o=this.finalize(r.node,new Jh(r.opening,r.children,r.closing));r=e[e.length-1],r.children.push(o),e.pop()}else break}if(i.type==="JSXClosingFragment")if(r.closing=i,r.opening.type!=="JSXOpeningFragment")this.tolerateError("Expected corresponding JSX closing tag for jsx fragment");else break}return r}parseJSXElement(){let r=this.createJSXNode(),e=this.parseJSXOpeningElement(),t=[],i=null;if(!e.selfClosing){let n=this.parseComplexJSXElement({node:r,opening:e,closing:i,children:t});t=n.children,i=n.closing}return this.finalize(r,new Jh(e,t,i))}parseJSXRoot(){this.config.tokens&&this.tokens.pop(),this.startJSX();let r=this.parseJSXElement();return this.finishJSX(),r}isStartOfExpression(){return super.isStartOfExpression()||this.match("<")}},kx=["(","{","[","in","typeof","instanceof","new","return","case","delete","throw","void","=","+=","-=","*=","**=","/=","%=","<<=",">>=",">>>=","&=","|=","^=",",","+","-","*","**","/","%","++","--","<<",">>",">>>","&","|","^","!","~","&&","||","??","?",":","===","==",">=","<=","<",">","!=","!=="],Cx=class{values;curly;paren;constructor(){this.values=[],this.curly=this.paren=-1}beforeFunctionExpression(r){return kx.includes(r)}isRegexStart(){let r=this.values[this.values.length-1],e=r!==null;switch(r){case"this":case"]":e=!1;break;case")":let t=this.values[this.paren-1];e=t==="if"||t==="while"||t==="for"||t==="with";break;case"}":if(e=!0,this.values[this.curly-3]==="function"){let i=this.values[this.curly-4];e=i?!this.beforeFunctionExpression(i):!1}else if(this.values[this.curly-4]==="function"){let i=this.values[this.curly-5];e=i?!this.beforeFunctionExpression(i):!0}break;default:break}return e}push(r){r.type===7||r.type===4?(r.value==="{"?this.curly=this.values.length:r.value==="("&&(this.paren=this.values.length),this.values.push(r.value)):this.values.push(null)}},Sx=class{errorHandler;scanner;trackRange;trackLoc;buffer;reader;constructor(r,e){this.errorHandler=new mw,this.errorHandler.tolerant=e?typeof e.tolerant=="boolean"&&e.tolerant:!1,this.scanner=new gw(r,this.errorHandler),this.scanner.trackComment=e?typeof e.comment=="boolean"&&e.comment:!1,this.trackRange=e?typeof e.range=="boolean"&&e.range:!1,this.trackLoc=e?typeof e.loc=="boolean"&&e.loc:!1,this.buffer=[],this.reader=new Cx}errors(){return this.errorHandler.errors}getNextToken(){if(this.buffer.length===0){let r=this.scanner.scanComments();if(this.scanner.trackComment)for(let e=0;e<r.length;++e){let t=r[e],i=this.scanner.source.slice(t.slice[0],t.slice[1]),n={type:t.multiLine?"BlockComment":"LineComment",value:i};this.trackRange&&(n.range=t.range),this.trackLoc&&(n.loc=t.loc),this.buffer.push(n)}if(!this.scanner.eof()){let e;this.trackLoc&&(e={start:{line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart},end:{}});let t=this.scanner.source[this.scanner.index]==="/"&&this.reader.isRegexStart(),i;if(t){let s=this.scanner.saveState();try{i=this.scanner.scanRegExp()}catch{this.scanner.restoreState(s),i=this.scanner.lex()}}else i=this.scanner.lex();this.reader.push(i);let n={type:Xi[i.type],value:this.scanner.source.slice(i.start,i.end)};if(this.trackRange&&(n.range=[i.start,i.end]),this.trackLoc&&(e.end={line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart},n.loc=e),i.type===9){let s=i.pattern,o=i.flags;n.regex={pattern:s,flags:o}}this.buffer.push(n)}}return this.buffer.shift()}};function np(r,e,t){let i=null,n=(d,h)=>{t&&t(d,h),i&&i.visit(d,h)},s=typeof t=="function"?n:null,o=!1;if(e){o=typeof e.comment=="boolean"&&e.comment;let d=typeof e.attachComment=="boolean"&&e.attachComment;(o||d)&&(i=new cx,i.attach=d,e.comment=!0,s=n)}let a=!1;e&&typeof e.sourceType=="string"&&(a=e.sourceType==="module");let l;e&&typeof e.jsx=="boolean"&&e.jsx?l=new Fx(r,e,s):l=new bw(r,e,s);let c=a?l.parseModule():l.parseScript();return o&&i&&(c.comments=i.comments),l.config.tokens&&(c.tokens=l.tokens),l.config.tolerant&&(c.errors=l.errorHandler.errors),c}function Px(r,e,t){let i=e||{};return i.sourceType="module",np(r,i,t)}function Ex(r,e,t){let i=e||{};return i.sourceType="script",np(r,i,t)}function Ix(r,e,t){let i=new Sx(r,e),n=[];try{for(;;){let s=i.getNextToken();if(!s)break;t&&(s=t(s)),n.push(s)}}catch(s){i.errorHandler.tolerate(s)}return i.errorHandler.tolerant&&(n.errors=i.errors()),n}var xx="6.0.3",yw={parse:np,parseModule:Px,parseScript:Ex,tokenize:Ix,Syntax:mv,version:xx};var Tx=["__proto__","prototype","[[Prototype]]"],$r=class r{#e={items:[],trie:{}};get data(){return this.#e}get startLength(){return 4}setItems(e){this.#e.items=e}setTrie(e){this.#e.trie=e}getAll(){let e={};return this._appendToResults("",this.#e.trie,e),e}_isTermToAvoid(e){return Tx.includes(e)}_appendToResults(e,t,i){for(let n in t){let s=t[n];if(s)if(n==="\xB1"||n==="$"){let o=s;o.constructor===Array&&(this._isTermToAvoid(e)||(i[e]=this.getValuesFromIndexArray(o)))}else s.constructor===Array?this._isTermToAvoid(e+n)||(i[e+n]=this.getValuesFromIndexArray(s)):this._appendToResults(e+n,s,i)}}mergeFrom(e,t){let i=e.getAll();for(let n in i){let s=i[n],o;for(let a of s)a.annotation&&(o?o.indexOf(a.annotation)<0&&(o+=a.annotation):o=a.annotation);this.insert(n,t,o)}}static processResultValues(e,t){if(t){let i=[];for(let n of e)n.annotation&&t.includes(n.annotation)&&i.push(n);e=i}return e}getValuesFromIndexArray(e){let t=[];if(!e)return t;B.arrayHasNegativeAndIsNumeric(e)&&(e=B.decodeSequentialRunLengthUsingNegative(e));for(let i of e)if(typeof i=="object"){let n=i.n;n>=0&&n<this.#e.items.length&&t.push({value:this.#e.items[n],annotation:i.a})}else i>=0&&i<this.#e.items.length&&t.push({value:this.#e.items[i],annotation:void 0});return t}loadFromData(e){this.#e=e}hasPathMatches(e){e=e.toLowerCase();let t=e.lastIndexOf(".");t>=0&&(e=e.substring(0,t));for(let i of this.data.items)if(i.startsWith("/")){let n=i.lastIndexOf(".");if(n>=0&&(i=i.substring(0,n)),i.endsWith(e))return!0}return!1}async getMatches(e,t){e=e.trim().toLowerCase();let i=e.split(" "),n=!1,s;for(let a of i)if(a.length>1){let l=this.getTermMatch(a);if(n=!0,l&&l.length)if(s===void 0)s=l;else{let u=[];for(let c of l)s.includes(c)&&u.push(c)}}return s===void 0||s.length===0?n?[]:void 0:r.processResultValues(this.getValuesFromIndexArray(s),t).sort((a,l)=>{let u=0,c=0,d=a.value.toLowerCase(),h=l.value.toLowerCase();for(let f of i)d.startsWith(f)?u+=5:d.includes(f)&&u++,h.startsWith(f)?c+=5:h.includes(f)&&c++;return u===c?a.value.localeCompare(l.value):c-u})}getTermMatchStrings(e){let t=this.getTermMatch(e);return t===void 0?t:this.getValuesFromIndexArray(t)}async getDescendentStrings(e){let t=0,i=this.#e.trie,n={},s=!0,o="";for(;t<e.length&&s;){if(s=!1,i.constructor===Array)return;let a=i[e[t]];if(a)i=a,t++,o=e.substring(0,t),s=!0;else{let l=e[t];for(let u in i)if(u.startsWith(l)&&i[u]!==void 0){let c=0;for(s=!0,i=i[u],o=e.substring(0,t)+u;t<e.length&&c<u.length&&u[c]===e[t];)c++,t++;break}}}if(t<e.length){let a=e.substring(t);for(let l in i)l.startsWith(a)&&i[l]&&this._appendToResults(e.substring(0,t)+l,i[l],n)}else i.constructor===Array?n[o]=this.getValuesFromIndexArray(i):i["\xB1"]!==void 0&&this._appendToResults(o,i,n);return n}getTermMatch(e){let t=0,i=this.#e.trie,n=!0;for(;t<e.length&&n;){if(n=!1,i.constructor===Array)return;let s=i[e[t]];if(s)i=s,t++,n=!0;else{let o=e[t];t<e.length-1&&(o+=e[t+1]);for(let a in i)if(a.startsWith(o)&&i[a]!==void 0&&!n){let l=0;for(n=!0,i=i[a];t<e.length&&l<a.length&&a[l]===e[t];)l++,t++}}}if(!(t<e.length)){if(i.constructor===Array)return i;if(i["\xB1"]!==void 0)return i["\xB1"];{let s=[];return this.aggregateIndices(i,s),s}}}aggregateIndices(e,t){for(let i in e){let n=e[i];if(n)if(n.constructor===Array)for(let s of n)t.includes(s)||t.push(s);else if(n["\xB1"]!==void 0)for(let s of n["\xB1"])t.includes(s)||t.push(s);else this.aggregateIndices(n,t)}}insertArray(e,t){for(let i of t)this.insert(e,i.value,i.annotation)}insert(e,t,i){if(B.isNumericIsh(e)||e.length>70)return;e=e.replace(//gi,"").toLowerCase().trim();let n=0,s=this.#e.trie,o=s,a,l=-1,u=0;for(let d of this.#e.items){if(d===t){l=u;break}u++}l<0&&(l=this.#e.items.length,this.#e.items.push(t));let c=!0;for(;n<e.length&&c;)if(c=!1,s.constructor!==Array){for(let d in s)if(d.startsWith(e[n])&&s[d]!==void 0){let h=0;for(c=!0,a=d,o=s,s=s[d];n<e.length&&h<d.length&&d[h]===e[n];)h++,n++;if(d[h]!==e[n]&&h<d.length&&n<=e.length){o[a]=void 0,a=d.substring(0,h);let f={};o[a]=f;let m=d.substring(h);this._isTermToAvoid(m)||(f[m]=s),s=f}break}}if(n<e.length){s.constructor===Array&&a&&(o[a]={},o[a]["\xB1"]=s,s=o[a]);let d=e.substring(n);d!=="\xB1"&&(this._isTermToAvoid(d)||(s[d]=this.ensureAnnotatedContentInArray([],l,i)))}else s.constructor===Array&&a?this._isTermToAvoid(a)||(o[a]=this.ensureAnnotatedContentInArray(s,l,i)):(s["\xB1"]===void 0&&(s["\xB1"]=[]),s["\xB1"]=this.ensureAnnotatedContentInArray(s["\xB1"],l,i))}ensureAnnotatedContentInArray(e,t,i){try{for(let n of e)if(typeof n=="object"){if(n.n===t)return i&&(n.a?n.a.indexOf(i)<0&&(n.a+=i):n.a=i),e}else if(n===t){if(!i)return e;let s=[];for(let o of e)o!==t&&s.push(o);return s.push({n:t,a:i}),s}i?e.push({n:t,a:i}):e.push(t)}catch(n){console.warn("Error ensuring annotated content: "+n+"|"+e+"|"+JSON.stringify(e))}return e}parseJsContent(e,t){try{let i=yw.tokenize(t);if(i)for(let n of i)n.type==="Identifier"&&n.value&&n.value.length>3&&n.value!=="from"&&this.insert(n.value.toLowerCase(),e,"S")}catch(i){C.debugAlert("JS parsing error:"+i)}}parseTextContent(e,t){let i={},n="";t=t.toLowerCase();for(let s=0;s<t.length;s++){let o=t[s];o==="{"||o==="}"||o===" "||o==="\r"||o===`
`||o==="	"||o==="("||o===")"||o==="["||o==="]"||o===":"||o==='"'||o==="'"?n.length>0&&(n.length>3&&!B.isNumericIsh(n)&&(i[n]=!0),n=""):n+=t[s]}for(let s in i)this.insert(s,e)}parseJsonContent(e,t){let i={},n="";t=t.toLowerCase();for(let s=0;s<t.length;s++){let o=t[s];o==="{"||o==="}"||o===" "||o==="\r"||o===`
`||o==="	"||o==="("||o===")"||o==="["||o==="]"||o===":"||o==='"'||o==="'"?n.length>0&&(n.length>3&&!B.isNumericIsh(n)&&(i[n]=!0),n=""):n+=t[s]}for(let s in i)this.insert(s,e)}};var oe=class r{static{this.isLoaded=!1}static{this.isScriptTypesLoaded=!1}static{this.catalog=null}static{this.loadedFormCount=0}static{this._creatorToolsIngameProject=null}static{this.uxCatalog={}}static{this.formsFolders={}}static{this.betaTypeDefs=null}static{this.libs=null}static{this.stableTypeDefs=null}static{this.contentFolder=null}static{this.snippetsFolder=null}static{this.previewMetadataFolder=null}static{this.releaseMetadataFolder=null}static{this.previewVanillaFolder=null}static{this.releaseVanillaFolder=null}static{this.samplesFolder=null}static{this.releaseVanillaBehaviorPackFolder=null}static{this.releaseVanillaResourcePackFolder=null}static{this.local=null}static{this.vanillaInfoData=null}static{this.vanillaContentIndex=null}static{this.previewVanillaInfoData=null}static{this.previewVanillaContentIndex=null}static{this.samplesInfoData=null}static{this.samplesContentIndex=null}static{this.addonsDocs=null}static{this.biomesMetadata=null}static{this.blocksMetadata=null}static{this._isLoadingSnippets=!1}static{this._pendingLoadSnippetsRequests=[]}static{this._isLoadingVanilla=!1}static{this._pendingLoadVanillaRequests=[]}static{this._isLoadingPreviewVanilla=!1}static{this._pendingLoadPreviewVanillaRequests=[]}static{this._isLoadingSamples=!1}static{this._pendingLoadSamplesRequests=[]}static{this.dataPath="res/latest/"}static{this.minecraftEduVersion="1.21.0"}static{this.minecraftEduPreviewVersion="1.21.0"}static{this.minecraftModuleNames=["@minecraft/server-gametest","@minecraft/server","@minecraft/server-ui","@minecraft/server-net","@minecraft/server-admin","@minecraft/server-editor"]}static{this.maxMinecraftPatchVersions={"1.19":"80","1.20":"80","1.21":"50"}}static{this.moduleDescriptors={}}static{this.blockTypes={}}static{this.schemaContents={}}static{this.blockBaseTypes={}}static{this.javaBlockTypeData={}}static get defaultBlockBaseType(){return r._defaultBlockBaseType===void 0&&(r._defaultBlockBaseType=r.ensureBlockBaseType("block")),r._defaultBlockBaseType}static async ensureFormLoadedByPath(e){let t=e.lastIndexOf("/");if(t>=0)return await r.ensureFormLoaded(e.substring(0,t),e.substring(t+1))}static async ensureFormLoaded(e,t){if(t=t.toLowerCase(),r.uxCatalog[t]!==void 0)return r.uxCatalog[t];let i=Ne.contentRoot+"data/forms/";if(e&&(i+=e+"/"),r.local){let n=await r.local.createStorage(i);if(n){await n.rootFolder.load();let s=n.rootFolder.files[t+".form.json"];if(s)return await s.loadContent(),S.getJsonObject(s);C.fail("Could not load file locally for '"+(e?e+"/":"")+t+"'.");return}}else try{let n=await zt.get(i+t+".form.json");return r.uxCatalog[(e?e+".":"")+t]=n.data,r.loadedFormCount++,n.data}catch{C.fail("Could not load UX file for '"+(e?e+"/":"")+t+"'.")}}static async getFormsFolder(e){if(this.formsFolders[e])return this.formsFolders[e];let t="data/forms/"+e+"/";if(r.local){let i=await r.local.createStorage(t);i&&(await i.rootFolder.load(),this.formsFolders[e]=i.rootFolder)}else{let i=new li(Ne.contentRoot+t);await i.rootFolder.load(),this.formsFolders[e]=i.rootFolder}return this.formsFolders[e]}static getFormByPath(e){let t=e.lastIndexOf("/");if(t>=0)return r.getForm(e.substring(0,t),e.substring(t+1))}static getForm(e,t){return t=t.toLowerCase(),r.uxCatalog[(e?e+".":"")+t]}static getBlockType(e){return e=Be.canonicalizeName(e),r.blockTypes[e]}static populateBlockTypesByLegacyId(){this._blockTypesByLegacyId=[];for(let e in this.blockTypes){let t=this.blockTypes[e];t.numericId!==void 0&&(C.assert(this._blockTypesByLegacyId[t.numericId]===void 0,"Multiple block types registered for the same ID:"+t.id),this._blockTypesByLegacyId[t.numericId]=t)}}static async getModuleDescriptor(e){if(r.moduleDescriptors[e])return r.moduleDescriptors[e];try{let t=await zt.get("https://registry.npmjs.org/"+e);r.moduleDescriptors[e]=new Ha(t.data)}catch{C.fail("Could not load registry for '"+e+"'")}return r.moduleDescriptors[e]}static async getLatestMinecraftRetailVersion(){let e=await this.getModuleDescriptor("@minecraft/server");return!e||!e.latestRetailVersion?"1.21.0":e.latestRetailVersion}static async isRecentVersionFromVersionArray(e){if(e===void 0||e.length!==3)return!1;let t=await this.getLatestVersionInfo(0);if(!t)return!1;let i=Be.getVersionArrayFrom(t);if(!i||i.length<3)return!1;let n=i[0],s=i[1];return!(e[0]<n||n===e[0]&&s-e[1]>1)}static async ensureCreatorToolsIngameProject(){if(r._creatorToolsIngameProject)return r._creatorToolsIngameProject;if(await r.loadContent(),r.contentFolder===null||!Ne.carto){C.unexpectedContentState();return}let e=r.contentFolder.ensureFile("creator_tools_ingame.mcaddon");if(await e.loadContent(),e.content instanceof Uint8Array){r._creatorToolsIngameProject=new sr(Ne.carto,"Creator Tools",null);let n=(await r._creatorToolsIngameProject.ensureProjectFolder()).ensureFolder("addons").ensureFile(e.name);n.setContent(e.content),n.saveContent();let s=n.getFolderRelativePath(r._creatorToolsIngameProject.projectFolder);return s!==void 0&&(r._creatorToolsIngameProject.ensureItemByProjectPath(s,0,e.name,53,void 0,0),await r._creatorToolsIngameProject.inferProjectItemsFromZipFile(s,n,!1)),r._creatorToolsIngameProject}}static async getLatestVersionInfo(e,t){if(e===2)return r.minecraftEduVersion;if(e===3)return r.minecraftEduPreviewVersion;if(e===1&&r.latestPreviewVersion&&!t)return r.latestPreviewVersion;if(e===0&&r.latestVersion&&!t)return r.latestVersion;let i,n="https://raw.githubusercontent.com/Mojang/bedrock-samples/main/version.json";e===1&&(n="https://raw.githubusercontent.com/Mojang/bedrock-samples/preview/version.json");try{i=await zt.get(n)}catch(a){throw console.log("Could not access Minecraft version details."+a),new Error(a.toString())}let s=0,o="";try{if(i===void 0||i.data===void 0)throw new Error("Unexpected empty response.");let a=JSON.parse(JSON.stringify(i.data));if(!a)throw new Error("Improperly formatted response (source: "+i.data+")");for(let l in a){let u=a[l].version;if(u){let c=r.getVersionIsPreview(u),d=r.getVersionIndexFromVersionStr(u);if(d>0&&d>s&&(c&&e===1||!c&&e===0)){s=d;let h=u.split(".");o=h[0]+"."+h[1]+"."+h[2]+"."+B.frontPadToLength(h[3],2,"0")}}}}catch(a){throw C.error("Could not process Minecraft version details."+a),new Error(a.toString())}return o&&o.length>0&&(e===1?r.latestPreviewVersion=o:r.latestVersion=o),o}static getVersionIsPreview(e){let t=e.split(".");if(t.length!==4)return!1;for(let i=0;i<t.length;i++)if(!B.isNumeric(t[i]))return!1;return parseInt(t[3])>19}static getVersionIndexFromVersionStr(e){let t=e.split(".");if(t.length!==4)return-1;for(let n=0;n<t.length;n++)if(!B.isNumeric(t[n]))return-1;return parseInt(t[0])*16777216+parseInt(t[1])*65536+parseInt(t[2])*256+parseInt(t[3])}static getBlockTypeByLegacyId(e){return this._blockTypesByLegacyId||(this._blockTypesByLegacyId=[],this.populateBlockTypesByLegacyId()),this._blockTypesByLegacyId[e]}static getMatchingBlocks(e){e=e.toLowerCase().trim(),e=e.replace(/_/gi," ");let t=e.split(" "),i,n=[];for(let s in this.blockTypes){let o=this.blockTypes[s],a=o.title.toLowerCase();if(a===e&&i===void 0)i=o;else for(let l=0;l<t.length;l++)if(a.indexOf(t[l])>=0){n.push(o);break}}if(i!==void 0){let s=[i];for(let o=0;o<n.length;o++)s.push(n[o]);n=s}return n}static ensureBlockType(e){e=Be.canonicalizeName(e);let t=r.blockTypes[e];return t==null&&r.catalog!=null&&(t=new Wa(e),r.blockTypes[e]=t,t.data={name:e}),t}static ensureBlockBaseType(e){e=Be.canonicalizeName(e);let t=r.blockBaseTypes[e];return t==null&&(t=new Co(e),r.blockBaseTypes[e]=t),t}static async loadContent(){if(r.contentFolder===null)if(r.local){let e=await r.local.createStorage("data/content/");e&&(await e.rootFolder.load(),r.contentFolder=e.rootFolder)}else{let e=new li(Ne.contentRoot+"data/content/");await e.rootFolder.load(),r.contentFolder=e.rootFolder}}static async initSnippetsFolder(){if(r.snippetsFolder===null)if(this._isLoadingSnippets){let e=this._pendingLoadSnippetsRequests,t=(i,n)=>{e.push(i)};await new Promise(t);return}else{this._isLoadingSnippets=!0;let e;if(r.local){let i=await r.local.createStorage("data/snippets/");i&&(e=i.rootFolder)}else e=new li(Ne.contentRoot+"data/snippets/").rootFolder;if(e===void 0)return;await e.load();for(let i in e.files){let n=e.files[i];n&&await n.loadContent()}r.snippetsFolder=e,this._isLoadingSnippets=!1;let t=this._pendingLoadSnippetsRequests;this._pendingLoadSnippetsRequests=[];for(let i of t)i(void 0)}}static itemMatchesSearch(e,t){if(!t||t.length<3)return!0;let i=t.toLowerCase();if(e.title&&e.title.toLowerCase().indexOf(i)>=0||e.description&&e.description.toLowerCase().indexOf(i)>=0)return!0;if(e.topics){for(let n of e.topics)if(n.toLowerCase().indexOf(i)>=0)return!0}return!1}static async getSnippet(e,t){if(r.snippetsFolder||await r.initSnippetsFolder(),!!r.snippetsFolder&&r.snippetsFolder!==null&&r.snippetsFolder.files){let i=r.snippetsFolder.files[e+".json"];if(i){let n=S.getJsonObject(i);if(n&&n[t])return n[t]}}}static async getAddonsDocs(){return r.addonsDocs||(r.addonsDocs=await r.getMetadataObject("/doc_modules/addons.json")),r.addonsDocs}static async getBiomesMetadata(){return r.biomesMetadata||(r.biomesMetadata=await r.getMetadataObject("/vanilladata_modules/mojang-biomes.json")),r.biomesMetadata}static async getBlocksMetadata(){return r.blocksMetadata||(r.blocksMetadata=await r.getMetadataObject("/vanilladata_modules/mojang-blocks.json")),r.blocksMetadata}static async getMetadataObject(e){if(await r.loadPreviewMetadataFolder(),!r.previewMetadataFolder)return null;let t=await r.previewMetadataFolder.getFileFromRelativePath(e);if(!t)return C.unexpectedUndefined(),null;await t.loadContent();let i=S.getJsonObject(t);return i||(C.unexpectedUndefined(),null)}static async loadPreviewMetadataFolder(){if(!this.previewMetadataFolder)if(r.local){let e=await r.local.createStorage("res/latest/van/preview/metadata/");e&&(this.previewMetadataFolder=e.rootFolder)}else{let e=new li(Ne.contentRoot+"res/latest/van/preview/metadata/");await e.rootFolder.load(),this.previewMetadataFolder=e.rootFolder}return this.previewMetadataFolder}static async loadReleaseMetadataFolder(){if(!this.releaseMetadataFolder)if(r.local){let e=await r.local.createStorage("res/latest/van/release/metadata/");e&&(this.releaseMetadataFolder=e.rootFolder)}else{let e=new li(Ne.contentRoot+"res/latest/van/release/metadata/");await e.rootFolder.load(),this.releaseMetadataFolder=e.rootFolder}return this.releaseMetadataFolder}static async getReleaseVanillaFolder(){if(r.releaseVanillaFolder!==null)return r.releaseVanillaFolder;if(r.local){let e=await r.local.createStorage("res/latest/van/release/");e&&(r.releaseVanillaFolder=e.rootFolder)}else{let e=new li(Ne.contentRoot+"res/latest/van/release/");r.releaseVanillaFolder=e.rootFolder}return r.releaseVanillaFolder&&await r.releaseVanillaFolder.load(),r.releaseVanillaFolder}static async getPreviewVanillaFolder(){if(r.previewVanillaFolder!==null)return r.previewVanillaFolder;if(r.local){let e=await r.local.createStorage("res/latest/van/preview/");e&&(r.previewVanillaFolder=e.rootFolder)}else{let e=new li(Ne.contentRoot+"res/latest/van/preview/");r.previewVanillaFolder=e.rootFolder}return r.previewVanillaFolder&&await r.previewVanillaFolder.load(),r.previewVanillaFolder}static async getSamplesFolder(){if(r.samplesFolder!==null)return r.samplesFolder;if(r.local){let e=await r.local.createStorage("res/samples/microsoft/minecraft-samples-main/");e&&(r.samplesFolder=e.rootFolder)}else{let e=new li(Ne.contentRoot+"res/samples/microsoft/minecraft-samples-main/");r.samplesFolder=e.rootFolder}return r.samplesFolder&&await r.samplesFolder.load(),r.samplesFolder}static async getReleaseVanillaBehaviorPackFolder(){if(r.releaseVanillaBehaviorPackFolder!==null)return r.releaseVanillaBehaviorPackFolder;if(r.local){let e=await r.local.createStorage("res/latest/van/release/behavior_pack/");e&&(r.releaseVanillaBehaviorPackFolder=e.rootFolder)}else{let e=new li(Ne.contentRoot+"res/latest/van/release/behavior_pack/");r.releaseVanillaBehaviorPackFolder=e.rootFolder}return r.releaseVanillaBehaviorPackFolder&&await r.releaseVanillaBehaviorPackFolder.load(),r.releaseVanillaBehaviorPackFolder}static async getReleaseVanillaResourcePackFolder(){if(r.releaseVanillaResourcePackFolder!==null)return r.releaseVanillaResourcePackFolder;if(r.local){let e=await r.local.createStorage("res/latest/van/release/resource_pack/");e&&(r.releaseVanillaResourcePackFolder=e.rootFolder)}else{let e=new li(Ne.contentRoot+"res/latest/van/release/resource_pack/");r.releaseVanillaResourcePackFolder=e.rootFolder}return r.releaseVanillaResourcePackFolder&&await r.releaseVanillaResourcePackFolder.load(),r.releaseVanillaResourcePackFolder}static async loadUx(){}static getComponentFormField(e){if(r.uxCatalog===void 0||r.uxCatalog===null){C.unexpectedNull();return}throw new Error("Not implemented.")}static async getSchema(e){if(e=e.toLowerCase(),r.schemaContents[e])return r.schemaContents[e];let t="/"+r.dataPath+"schemas/"+e;try{if(typeof window<"u"){let i=await zt.get(B.ensureEndsWithSlash(Ne.contentRoot)+B.ensureNotStartsWithSlash(t));return r.schemaContents[e]=i.data,r.schemaContents[e]||C.fail("Could not load schema '"+t+"'"),r.schemaContents[e]}else if(r.local){let i=await r.local.readJsonFile(t);if(i!==null)return r.schemaContents[e]=i,r.schemaContents[e];C.fail("Could not load schema '"+t+"'");return}else{C.fail("Unexpected database config (no database available) when trying to load schema for:"+e);return}}catch(i){C.fail("Could not load Minecraft schema catalog: "+Ne.contentRoot+" - "+t+" "+i.toString());return}}static async loadBetaScriptTypes(){if(!r.betaTypeDefs)try{if(typeof window<"u"){let e=await zt.get(Ne.contentRoot+"data/typedefs.beta.json");r.betaTypeDefs=e.data}else if(r.local){let e=await r.local.readJsonFile("data/typedefs.beta.json");e!==null&&(r.betaTypeDefs=e)}}catch{C.fail("Could not load beta Minecraft types catalog.")}}static async loadStableScriptTypes(){if(!r.stableTypeDefs)try{if(typeof window<"u"){let e=await zt.get(Ne.contentRoot+"data/typedefs.stable.json");r.stableTypeDefs=e.data}else if(r.local){let e=await r.local.readJsonFile("data/typedefs.stable.json");e!==null&&(r.stableTypeDefs=e)}}catch{C.fail("Could not load stable Minecraft types catalog.")}}static async getLibs(){if(r.libs)return r.libs;try{if(typeof window<"u"){let e=await zt.get(Ne.contentRoot+"data/libs.json");r.libs=e.data}else if(r.local){let e=await r.local.readJsonFile("data/libs.json");e!==null&&(r.libs=e)}}catch{C.fail("Could not load libraries catalog.")}return r.libs}static async matchesVanillaPath(e){let t=await r.getReleaseVanillaResourcePackFolder();if(t&&t.folderCount>0){e=B.ensureStartsWithSlash(e);let i=await t.getFolderFromRelativePath(S.getFolderPath(e));if(!i||!await i.exists())return!1;let s=S.getBaseFromName(S.getLeafName(e)).toLowerCase();await i.load();for(let o in i.files)if(o&&S.getBaseFromName(o).toLowerCase()===s)return!0}else return await r.matchesVanillaPathFromIndex(e);return!1}static async matchesVanillaPathFromIndex(e){if(r.vanillaContentIndex||await this.loadVanillaInfoData(),!r.vanillaContentIndex)return!1;let t=r.vanillaContentIndex.hasPathMatches(e);return t||(t=await r.isVanillaToken(e)),t||!e.startsWith("/resource_pack/")&&e.startsWith("/")&&(t=r.vanillaContentIndex.hasPathMatches("/resource_pack"+e),t||(t=await r.isVanillaToken("/resource_pack"+e),t||e.startsWith("/behavior_pack/")||(t=r.vanillaContentIndex.hasPathMatches("/behavior_pack"+e),t||(t=await r.isVanillaToken("/behavior_pack"+e))))),t}static async isVanillaToken(e){let t=await r.getVanillaMatches(e);return!!(t&&t.length>0)}static async getVanillaMatches(e,t){if(r.vanillaContentIndex||await this.loadVanillaInfoData(),!!r.vanillaContentIndex)return await r.vanillaContentIndex.getMatches(e,t)}static async getPreviewVanillaMatches(e,t){if(r.previewVanillaContentIndex||await this.loadPreviewVanillaInfoData(),!!r.previewVanillaContentIndex)return await r.previewVanillaContentIndex.getMatches(e,t)}static async getSamplesMatches(e,t){if(r.samplesContentIndex||await this.loadSampleInfoData(),!!r.samplesContentIndex)return await r.samplesContentIndex.getMatches(e,t)}static async loadVanillaInfoData(){if(!r.vanillaInfoData)if(this._isLoadingVanilla){let e=this._pendingLoadVanillaRequests,t=(i,n)=>{e.push(i)};await new Promise(t)}else{this._isLoadingVanilla=!0;try{if(typeof window<"u"){let t=await zt.get(Ne.contentRoot+"data/mci/release.mci.json");r.vanillaInfoData=t.data}else if(r.local){let t=await r.local.readJsonFile("data/mci/release.mci.json");t!==null&&(r.vanillaInfoData=t)}r.vanillaInfoData&&r.vanillaInfoData.index&&!r.vanillaContentIndex&&(r.vanillaContentIndex=new $r,r.vanillaContentIndex.loadFromData(r.vanillaInfoData.index))}catch{}this._isLoadingVanilla=!1;let e=this._pendingLoadVanillaRequests;this._pendingLoadVanillaRequests=[];for(let t of e)t(void 0)}}static async loadPreviewVanillaInfoData(){if(!r.previewVanillaContentIndex)if(this._isLoadingPreviewVanilla){let e=this._pendingLoadPreviewVanillaRequests,t=(i,n)=>{e.push(i)};await new Promise(t)}else{this._isLoadingPreviewVanilla=!0;try{if(typeof window<"u"){let t=await zt.get(Ne.contentRoot+"data/mci/preview.mci.json");r.previewVanillaInfoData=t.data}else if(r.local){let t=await r.local.readJsonFile("data/mci/preview.mci.json");t!==null&&(r.previewVanillaInfoData=t)}r.previewVanillaInfoData&&r.previewVanillaInfoData.index&&!r.previewVanillaContentIndex&&(r.previewVanillaContentIndex=new $r,r.previewVanillaContentIndex.loadFromData(r.previewVanillaInfoData.index))}catch{}this._isLoadingVanilla=!1;let e=this._pendingLoadPreviewVanillaRequests;this._pendingLoadPreviewVanillaRequests=[];for(let t of e)t(void 0)}}static async loadSampleInfoData(){if(!r.samplesContentIndex)if(this._isLoadingSamples){let e=this._pendingLoadSamplesRequests,t=(i,n)=>{e.push(i)};await new Promise(t)}else{this._isLoadingSamples=!0;try{if(typeof window<"u"){let t=await zt.get(Ne.contentRoot+"data/mci/minecraft-samples-main.mci.json");r.samplesInfoData=t.data}else if(r.local){let t=await r.local.readJsonFile("data/mci/minecraft-samples-main.mci.json");t!==null&&(r.samplesInfoData=t)}r.samplesInfoData&&r.samplesInfoData.index&&!r.samplesContentIndex&&(r.samplesContentIndex=new $r,r.samplesContentIndex.loadFromData(r.samplesInfoData.index))}catch{}this._isLoadingSamples=!1;let e=this._pendingLoadSamplesRequests;this._pendingLoadSamplesRequests=[];for(let t of e)t(void 0)}}static async load(){if(!r.isLoaded)try{if(typeof window<"u"){let e=await zt.get(Ne.contentRoot+"data/mccat.json");r.catalog=e.data}else if(r.local){let e=await r.local.readJsonFile("data/mccat.json");e!==null&&(r.catalog=e)}if(r.catalog!==null)for(let e=0;e<r.catalog.blockBaseTypes.length;e++){let t=r.catalog.blockBaseTypes[e],i=Be.canonicalizeName(t.name),n=new Co(i);if(n.data=t,t.abstract===void 0||t.abstract===!1){let s={name:t.name,id:t.id,icon:t.icon,mapColor:t.mapColor,shortId:t.shortId,altShortId:t.altShortId},o=this.ensureBlockType(i);o.data=s,o.baseType=n}if(t.variants!==void 0)for(let s=0;s<t.variants.length;s++){let o=t.variants[s],a=this.ensureBlockType(o.name);!o.id&&t.id&&(o.id=t.id),!o.icon&&t.icon&&(o.icon=t.icon),!o.shortId&&t.shortId&&(o.shortId=t.shortId),!o.altShortId&&t.altShortId&&(o.altShortId=t.altShortId),!o.mapColor&&t.mapColor&&(o.mapColor=t.mapColor),a.data=o,a.baseType=n}}}catch{C.fail("Could not load Minecraft types catalog.")}}};var l0=Le(Je());var ww=Le(Je());var Ir=class r{constructor(){this._isLoaded=!1;this.definitions=[];this._identifiers=[];this._onLoaded=new ww.EventDispatcher}get data(){return this._data}get formatVersion(){return this._data?.format_version}get isLoaded(){return this._isLoaded}get file(){return this._file}set file(e){this._file=e}get onLoaded(){return this._onLoaded.asEvent()}get identifiers(){if(this._identifiers)return this._identifiers;if(!this._data||!this._data["minecraft:geometry"]||this._data["minecraft:geometry"].length!==1||!this._data["minecraft:geometry"][0].description)return[];let e=[];for(let t of this.definitions)t.description&&t.description.identifier&&e.push(t.description.identifier);return e}getById(e){C.assert(e!=="minecraft:geometry");let t=this._data[e];if(t)return t;for(let i of this.definitions)if(i.description&&i.description.identifier===e)return i}getVisibleBoundsWidth(e){if(!(e<0||e>=this.definitions.length)&&this.definitions[e])return this.definitions[e].description?this.definitions[e].description.visible_bounds_width:this.definitions[e].visible_bounds_width}getVisibleBoundsHeight(e){if(!(e<0||e>=this.definitions.length)&&this.definitions[e])return this.definitions[e].description?this.definitions[e].description.visible_bounds_height:this.definitions[e].visible_bounds_height}getVisibleBoundsOffset(e){if(!(e<0||e>=this.definitions.length)&&this.definitions[e])return this.definitions[e].description?this.definitions[e].description.visible_bounds_offset:this.definitions[e].visible_bounds_offset}getTextureWidth(e){if(!(e<0||e>=this.definitions.length)&&this.definitions[e])return this.definitions[e].description?this.definitions[e].description.texture_width:this.definitions[e].texturewidth}ensureDefault(e){this._data||(this._data={format_version:"1.12.0","minecraft:geometry":[{description:{identifier:e,texture_width:128,texture_height:64,visible_bounds_width:4,visible_bounds_height:3.5,visible_bounds_offset:[0,1.25,0]},bones:[]}]},this.persist(),this.populateDefsAndIds(),this._isLoaded=!0)}getTextureHeight(e){if(!(e<0||e>=this.definitions.length)&&this.definitions[e])return this.definitions[e].description?this.definitions[e].description.texture_height:this.definitions[e].textureheight}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}async getFormatVersionIsCurrent(){let e=this.getFormatVersion();return e===void 0||e.length!==3?!1:await oe.isRecentVersionFromVersionArray(e)}getFormatVersion(){return!this._data||!this._data.format_version?[0,0,0]:Be.getVersionArrayFrom(this._data.format_version)}persist(){if(this._file===void 0)return;let e=JSON.stringify(this._data,null,2);this._file.setContent(e)}ensureDefinition(e){this._data||(this._data={format_version:"1.12.0","minecraft:geometry":[{description:{identifier:e,texture_width:32,texture_height:32,visible_bounds_width:2,visible_bounds_height:2,visible_bounds_offset:[0,0,0]},bones:[]}]})}async save(){this._file!==void 0&&(this.persist(),await this._file.saveContent(!1))}populateDefsAndIds(){if(this.definitions=[],this._identifiers=[],this._data&&this._data["minecraft:geometry"])for(let e of this._data["minecraft:geometry"])e.description&&e.description.identifier&&this._identifiers.push(e.description.identifier),this.definitions.push(e);else if(this._data)for(let e in this._data)e!=="format_version"&&e.startsWith("geometry.")&&this._data[e]&&(this._identifiers.push(e),this.definitions.push(this._data[e]))}async load(){this._file===void 0||this._isLoaded||(await this._file.loadContent(),!(this._file.content===null||this._file.content instanceof Uint8Array)&&(this._data=S.getJsonObject(this._file),this.populateDefsAndIds(),this._isLoaded=!0))}};var _w=Le(Je());var Ya=class r{static async process(e,t,i,n,s){n===void 0?n="":n+=".",s===void 0&&(s=[]);for(let o in e){let a=e[o],l=!1;for(let u of t.fields)if(u.id===o){if(l=!0,u.dataType===15&&u.subForm&&a&&Array.isArray(a))for(let c of a)await r.process(c,u.subForm,i,n+o,s);if(u.dataType===14&&u.subForm){if(a&&typeof a=="object")for(let c in a){let d=a[c];await r.process(d,u.subForm,i,n+o+"."+c,s)}}else if(u.dataType===16&&u.subForm||u.dataType===22||u.dataType===20){if(a&&typeof a=="object"){let c=0;for(let d in e)d&&c++;c===0&&(u.undefinedIfEmpty||u.dataType===22||u.dataType===20)?(s.push({subject:o,message:"Object is defined but empty; should be undefined.",path:n}),(i===1||i===9||u.dataType===22||u.dataType===20)&&(e[o]=void 0)):u.dataType===16&&u.subForm&&await r.process(a,u.subForm,i,n+o,s)}}else if((u.dataType===28||u.dataType===30)&&a&&typeof a=="object"){let c=0;for(let d in a)d&&c++;c===0&&u.undefinedIfEmpty&&(s.push({subject:o,message:"Object is defined but empty; should be undefined.",path:n}),(i===1||i===9)&&(e[o]=void 0))}}l||(s.push({subject:o,message:"Could not find field in data definition.",path:n}),i===9&&(e[o]=void 0))}}};var xr=class r{constructor(){this._isLoaded=!1;this._onLoaded=new _w.EventDispatcher}get data(){return this._data}get idList(){if(!this._data||!this._data.render_controllers)return;let e=[];for(let t in this._data.render_controllers){let i=this._data.render_controllers[t];t&&i&&e.push(t)}return e}get renderControllers(){if(!this._data||!this._data.render_controllers)return;let e=[];for(let t in this._data.render_controllers){let i=this._data.render_controllers[t];t&&i&&e.push(i)}return e}get isLoaded(){return this._isLoaded}get file(){return this._file}set file(e){this._file=e}get onLoaded(){return this._onLoaded.asEvent()}async removeTexture(e){await this.load();let t=this._data?.render_controllers;if(t)for(let i in t){let n=t[i];if(n&&n.arrays.textures)for(let s in n.arrays.textures){let o=n.arrays.textures[s],a=[];if(o)for(let l of o)l!==e&&l!=="Texture."+e&&a.push(l);a.length===0&&(a=void 0),n.arrays.textures[s]=a}}}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}async persist(){if(this._file===void 0)return;if(this._data){let t=await oe.ensureFormLoaded("resource","render_controller_set");t&&await Ya.process(this._data,t,1)}let e=JSON.stringify(this._data,null,2);this._file.setContent(e)}ensureDefinition(e,t){this._data||(this._data={format_version:"1.12.0",render_controllers:{}})}async save(){this._file!==void 0&&(await this.persist(),await this._file.saveContent(!1))}async load(){this._file===void 0||this._isLoaded||(await this._file.loadContent(),!(this._file.content===null||this._file.content instanceof Uint8Array)&&(this._data=S.getJsonObject(this._file),this._isLoaded=!0))}};var Fw=Le(Je());var Tr=class r{constructor(){this._isLoaded=!1;this._onLoaded=new Fw.EventDispatcher}get data(){return this._data}get isLoaded(){return this._isLoaded}get file(){return this._file}get onLoaded(){return this._onLoaded.asEvent()}set file(e){this._file=e}get id(){return this._id}set id(e){this._id=e}get idList(){if(!this._data||!this._data.animation_controllers)return;let e=[];for(let t in this._data.animation_controllers){let i=this._data.animation_controllers[t];t&&i&&e.push(t)}return e}get shortId(){if(this._id!==void 0)return this._id.startsWith("minecraft:")?this._id.substring(10,this._id.length):this._id}async getFormatVersionIsCurrent(){let e=this.getFormatVersion();return e===void 0||e.length!==3?!1:await oe.isRecentVersionFromVersionArray(e)}getFormatVersion(){if(!(!this._data||!this._data.format_version))return Be.getVersionArrayFrom(this._data.format_version)}setResourcePackFormatVersion(e){this._ensureDataInitialized(),this._data&&(this._data.format_version=e)}_ensureDataInitialized(){this._data===void 0&&(this._data={format_version:"1.12.0",animation_controllers:{}})}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}persist(){if(this._file===void 0)return;let e=JSON.stringify(this._data,null,2);this._file.setContent(e)}async load(){this._file===void 0||this._isLoaded||(await this._file.loadContent(),!(this._file.content===null||this._file.content instanceof Uint8Array)&&(this._data=S.getJsonObject(this._file),this._isLoaded=!0))}};var kw=Le(Je());var ji=class r{constructor(){this._isLoaded=!1;this._onLoaded=new kw.EventDispatcher}get data(){return this._data}get isLoaded(){return this._isLoaded}get file(){return this._file}get onLoaded(){return this._onLoaded.asEvent()}set file(e){this._file=e}get id(){return this._id}set id(e){this._id=e}get shortId(){if(this._id!==void 0)return this._id.startsWith("minecraft:")?this._id.substring(10,this._id.length):this._id}get idList(){if(!this._data||!this._data.animations)return;let e=[];for(let t in this._data.animations){let i=this._data.animations[t];t&&i&&e.push(t)}return e}get animations(){if(this._data&&this._data.animations)return this._data.animations}async getFormatVersionIsCurrent(){let e=this.getFormatVersion();return e===void 0||e.length!==3?!1:await oe.isRecentVersionFromVersionArray(e)}getFormatVersion(){if(!(!this._data||!this._data.format_version))return Be.getVersionArrayFrom(this._data.format_version)}setResourcePackFormatVersion(e){this._ensureDataInitialized(),this._data&&(this._data.format_version=e)}_ensureDataInitialized(){this._data===void 0&&(this._data={format_version:"1.12.0",animations:{}})}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}persist(){if(this._file===void 0)return;let e=JSON.stringify(this._data,null,2);this._file.setContent(e)}async load(){this._file===void 0||this._isLoaded||(await this._file.loadContent(),!(this._file.content===null||this._file.content instanceof Uint8Array)&&(this._data=S.getJsonObject(this._file),this._isLoaded=!0))}};var Cw=Le(Je());var cr=class r{constructor(){this._isLoaded=!1;this._onLoaded=new Cw.EventDispatcher}get isLoaded(){return this._isLoaded}get file(){return this._file}get onLoaded(){return this._onLoaded.asEvent()}set file(e){this._file=e}get id(){return this._id}set id(e){this._id=e}get shortId(){if(this._id!==void 0)return this._id.startsWith("minecraft:")?this._id.substring(10,this._id.length):this._id}getAllTimeline(){let e=[];if(this.data&&this.data.animations)for(let t in this.data.animations){let i=this.data.animations[t];if(i&&i.timeline)for(let n in i.timeline){let s=i.timeline[n];s&&e.push({animationId:t,timestamp:n,timeline:s})}}return e}async getFormatVersionIsCurrent(){let e=this.getFormatVersion();return e===void 0||e.length!==3?!1:await oe.isRecentVersionFromVersionArray(e)}getFormatVersion(){if(!(!this.data||!this.data.format_version))return Be.getVersionArrayFrom(this.data.format_version)}setBehaviorPackFormatVersion(e){this._ensureDataInitialized(),this.data&&(this.data.format_version=e)}_ensureDataInitialized(){this.data===void 0&&(this.data={format_version:"1.12.0",animations:{}})}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}persist(){if(this._file===void 0)return;let e=JSON.stringify(this.data,null,2);this._file.setContent(e)}async load(){this._file===void 0||this._isLoaded||(await this._file.loadContent(),!(this._file.content===null||this._file.content instanceof Uint8Array)&&(this.data=S.getJsonObject(this._file),this._isLoaded=!0))}};var Sw=Le(Je());var gn=class r{constructor(){this._isLoaded=!1;this._onLoaded=new Sw.EventDispatcher}get isLoaded(){return this._isLoaded}get file(){return this._file}get onLoaded(){return this._onLoaded.asEvent()}set file(e){this._file=e}get id(){return this._id}set id(e){this._id=e}get shortId(){if(this._id!==void 0)return this._id.startsWith("minecraft:")?this._id.substring(10,this._id.length):this._id}async getFormatVersionIsCurrent(){let e=this.getFormatVersion();return e===void 0||e.length!==3?!1:await oe.isRecentVersionFromVersionArray(e)}getAllStates(){let e=[];if(this.data&&this.data.animation_controllers)for(let t in this.data.animation_controllers){let i=this.data.animation_controllers[t];if(i&&i.states)for(let n in i.states){let s=i.states[n];s&&e.push({id:n,animationControllerId:t,state:s})}}return e}getFormatVersion(){if(!(!this.data||!this.data.format_version))return Be.getVersionArrayFrom(this.data.format_version)}setBehaviorPackFormatVersion(e){this._ensureDataInitialized(),this.data&&(this.data.format_version=e)}_ensureDataInitialized(){this.data===void 0&&(this.data={format_version:"1.12.0",animation_controllers:{}})}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}persist(){if(this._file===void 0)return;let e=JSON.stringify(this.data,null,2);this._file.setContent(e)}async load(){this._file===void 0||this._isLoaded||(await this._file.loadContent(),!(this._file.content===null||this._file.content instanceof Uint8Array)&&(this.data=S.getJsonObject(this._file),this._isLoaded=!0))}};var s0=Le(Je());var Qa=class{constructor(){this.type=99}};var Eo=class r{constructor(e,t,i){this.childTagType=99;this.value=null;this._children=[];this.type=e,this.name=t,this.isListChild=i}get childrenWithEnd(){return this._children}getTagChildren(){return this._children.length===0?[]:this.lastTagIsEnd?this._children.slice(0,-1):this._children}getTagLength(){return this.lastTagIsEnd?this._children.length-1:this._children.length}get lastTagIsEnd(){if(this._children.length===0)return!1;let e=this._children[this._children.length-1];return e.type===0?!0:this.childTagType===0&&e._children.length===0}get valueAsString(){return typeof this.value=="number"?this.value.toString():typeof this.value=="string"?this.value:""}get valueAsJSONObject(){let e,t=this.valueAsString;if(t)try{e=JSON.parse(t)}catch{e=void 0}return e}get valueAsNumericArray(){let e=this.getTagChildren(),t=[];for(let i of e)t.push(i.valueAsInt);return t}get valueAsStringArray(){let e=this.getTagChildren(),t=[];for(let i of e)t.push(i.valueAsString);return t}get valueAsBoolean(){return typeof this.value=="boolean"?this.value:typeof this.value=="string"?this.value==="true"||this.value==="TRUE"||this.value==="1":typeof this.value=="number"?!(this.value<=0):!1}get valueAsInt(){return typeof this.value=="number"?this.value:typeof this.value=="string"?parseInt(this.value):typeof this.value=="boolean"&&this.value===!0?1:0}get valueAsFloat(){return typeof this.value=="number"?this.value:typeof this.value=="string"?parseFloat(this.value):0}get valueAsBigInt(){if(typeof this.value=="bigint")return this.value;let e=typeof this.value;return this.value!==null&&(e==="number"||e==="string"||e==="boolean"||e==="bigint")?BigInt(this.value):BigInt(0)}setListFromArray(e){let t=this.getTagChildren();if(t.length>e.length)for(;t.length>e.length;)this.removeTagByIndex(t.length-1),t=this.getTagChildren();else for(;t.length<e.length;){let i=new r(3,"",this.type===9);this.pushTag(i),t=this.getTagChildren()}for(let i=0;i<t.length;i++)t[i].value=e[i]}pushTag(e){this.type===9&&this.lastTagIsEnd&&this._children.length===1&&e.type!==0?(this._children[0]=e,(this.childTagType===99||this.childTagType===0)&&e.childTagType!==0&&(this.childTagType=e.type)):this.type===9?((this.childTagType===99||this.childTagType===0)&&e.childTagType!==0&&(this.childTagType=e.type),this._children.push(e)):this.type===10&&this.lastTagIsEnd&&e.type!==0?(this._children.push(this._children[this._children.length-1]),this._children[this._children.length-2]=e):this._children.push(e)}prepareForSave(e){if(this.type===9?this._children.length===0?(this.childTagType=0,this.addTag(0)):this._children.length>1&&this.lastTagIsEnd&&(this._children=this._children.slice(0,-1)):this.type===10&&!this.lastTagIsEnd&&this.addTag(0),e)for(let t=0;t<this._children.length;t++)this._children[t].prepareForSave(e)}getByteSize(){this.prepareForSave(!1);let e=0;switch(this.isListChild||(e+=1,this.type!==0&&(e+=2+this.name.length)),this.type){case 1:e+=1;break;case 2:e+=2;break;case 3:e+=4;break;case 4:e+=8;break;case 5:e+=4;break;case 6:e+=8;break;case 8:if(e+=2,typeof this.value=="string"){let t=B.convertStringToBytes(this.value,"UTF-8");if(t===void 0)throw new Error("Unexpected NBT conversion error in writing string.");e+=t.length}break;case 9:e+=5;break;case 11:e+=4,e+=4*this.value.length;break;case 12:e+=4,e+=8*this.value.length;break;default:break}for(let t=0;t<this._children.length;t++)e+=this._children[t].getByteSize();return e}getJsonString(){return JSON.stringify(this.getJson(),null,2)}getJson(){this.prepareForSave(!1);let e=new Qa;if(this.name!==void 0&&this.name!==""&&(e.name=this.name),this.type!==99&&(e.type=this.type),this.value!==void 0&&(e.value=this.value),this.childTagType!==99&&(e.childTagType=this.childTagType),this._children.length>0){e.children=[];for(let t=0;t<this._children.length;t++)e.children.push(this._children[t].getJson())}return e}writeBytes(e,t,i){this.prepareForSave(!1);let n=e.buffer.byteLength,s=new DataView(e.buffer,0,n);if(!this.isListChild&&(s.setInt8(t,this.type),t+=1,this.type!==0)){s.setInt16(t,this.name.length,i),t+=2;for(let o=0;o<this.name.length;o++)e[t++]=this.name.charCodeAt(o)}switch(this.type){case 1:s.setInt8(t,this.valueAsInt),t+=1;break;case 2:s.setInt16(t,this.valueAsInt,i),t+=2;break;case 3:s.setInt32(t,this.valueAsInt,i),t+=4;break;case 4:s.setBigInt64(t,this.valueAsBigInt,i),t+=8;break;case 5:s.setFloat32(t,this.valueAsFloat,i),t+=4;break;case 6:s.setFloat64(t,this.valueAsFloat,i),t+=8;break;case 8:if(typeof this.value=="string"){let l=B.convertStringToBytes(this.value,"UTF-8");if(l===void 0)throw new Error("Unexpected NBT conversion error in writing string.");if(s.setInt16(t,l.length,i),t+=2,t=B.writeString(s,t,this.value,"UTF-8"),t<0||t>=n)throw new Error("Unexpected error writing string.")}else s.setInt16(t,0,i),t+=2;break;case 9:s.setInt8(t,this.childTagType),t+=1,s.setInt32(t,this.getTagLength(),i),t+=4;break;case 11:s.setInt32(t,this._children.length,i),t+=4;let o=this.value;for(let l=0;l<o.length;l++)s.setInt32(t,o[l],i),t+=4;break;case 12:s.setInt32(t,this._children.length,i),t+=4;let a=this.value;for(let l=0;l<a.length;l++)s.setBigInt64(t,a[l],i),t+=8;break}for(let o=0;o<this._children.length;o++)t=this._children[o].writeBytes(e,t,i);return t}removeTagByIndex(e){let t=[],i=!1;for(let n=0;n<this._children.length;n++)n!==e?t.push(this._children[n]):i=!0;return this._children=t,i}removeTag(e){let t=[],i=!1;for(let n=0;n<this._children.length;n++)this._children[n].name!==e?t.push(this._children[n]):i=!0;return this._children=t,i}ensureTag(e,t){let i=this.child(e);return i!==null?(C.assert(i.type===t,"Unexpected data type '"+i.type+"' for an nbt tag '"+e+"'"),i):this.addTag(t,e)}addTag(e,t){if(this.type!==10&&this.type!==9)throw new Error("Unsupported type for adding a tag");t===void 0&&(t="");let i=new r(e,t,this.type===9);return this.pushTag(i),i}getProperty(e){for(let t=0;t<this._children.length;t++)if(this._children[t].name===e)return this._children[t];return null}child(e){if(this.name===e)return this;for(let t=0;t<this._children.length;t++)if(this._children[t].name===e)return this._children[t];return null}find(e){if(this.name===e)return this;for(let t=0;t<this._children.length;t++)if(this._children[t].name===e)return this._children[t];for(let t=0;t<this._children.length;t++){let i=this._children[t];if(i.type===10||i.type===9){let n=i.find(e);if(n!=null)return n}}return null}};var el=class{constructor(e){this._nbtType=null;this._block=e}static getBlockPropertyTypeByName(e){switch(this.name){case"direction":case"age":case"stage":return 0;case"leaves":case"damage":return 4}throw new Error}get type(){return typeof this._value=="string"?2:typeof this._value=="number"?0:typeof this._value=="boolean"?1:0}get nbtType(){return this._nbtType===null?typeof this._value=="string"?8:typeof this._value=="number"?3:typeof this._value=="boolean"?1:1:this._nbtType}set nbtType(e){this._nbtType=e}get value(){return this._value}asBoolean(e){return this._value===null||this._value===void 0?e:typeof this._value=="boolean"?this._value:typeof this._value=="number"?this._value!==0:typeof this._value=="string"?this._value==="true"||this._value==="1":e}asString(e){return this._value===null||this._value===void 0?e:this._value.toString()}asNumber(e){return this._value===null||this._value===void 0?e:typeof this._value=="number"?this._value:typeof this._value=="string"?parseInt(this._value):typeof this._value=="boolean"?this._value?1:0:e}set value(e){this._value!==e&&(this._value=e,this._block._notifyPropertyChanged(this))}};var sp=Le(Je());var pd=Le(Je());var tl=class{loadFromNbtTag(e){let t=e.find("Min");t!==null&&(this.minimum=t.valueAsInt);let i=e.find("Max");i!==null&&(this.maximum=i.valueAsInt);let n=e.find("DefaultMin");n!==null&&(this.defaultMinimum=n.valueAsInt);let s=e.find("DefaultMax");s!==null&&(this.defaultMaximum=s.valueAsInt);let o=e.find("Base");o!==null&&(this.base=o.valueAsInt);let a=e.find("Current");a!==null&&(this.current=a.valueAsInt)}};var xo=class{loadFromNbtTag(e){let t=e.find("Min");t!==null&&(this.minimum=t.valueAsFloat);let i=e.find("Max");i!==null&&(this.maximum=i.valueAsFloat);let n=e.find("DefaultMin");n!==null&&(this.defaultMinimum=n.valueAsFloat);let s=e.find("DefaultMax");s!==null&&(this.defaultMaximum=s.valueAsFloat);let o=e.find("Base");o!==null&&(this.base=o.valueAsFloat);let a=e.find("Current");a!==null&&(this.current=a.valueAsFloat)}};var il=class{constructor(e,t){this.isCoreProp=!1;this.isInstanceProp=!1;this._item=e,this.id=t}load(){if(oe.uxCatalog===null||this._form!==void 0)return;let e=oe.getComponentFormField(this.id);e!==void 0?(this._form=e.form,this._form.id==="entityCore"?this.isCoreProp=!0:this._form.id==="entityInstance"&&(this.isInstanceProp=!0),this._field=e.field):C.debugAlert("Form field "+this.id+" not found.")}get type(){return this._field!==void 0?this._field.dataType:2}get defaultValue(){if(this._field===void 0){C.fail("Unbacked component property '"+this.id+"' found.");return}return this._field.defaultValue}get value(){if(this._field===void 0){C.fail("Unbacked component property '"+this.id+"' found.");return}if(this.isCoreProp&&this._field.groupId!==void 0){let e=this._field.groupId,t=this._item.getComponent(e);if(this._field.dataType===1)return t!==void 0;if((this._field.dataType===7||this._field.dataType===0||this._field.dataType===6||this._field.dataType===9)&&t!==void 0)return t.value}else if(!this.isCoreProp&&this._form!==void 0&&this._field!==void 0&&this._form.id){let e=this._form.id,t=this._item.getComponent(e);if(t!==void 0&&typeof t!="object")return t[this._field.id]}return this.defaultValue}asBoolean(e){let t=this.value;return t==null?e:typeof t=="boolean"?t:typeof t=="number"?t!==0:typeof t=="string"?t==="true"||t==="1":e}asString(e){let t=this.value;return t==null?e:t.toString()}asNumber(e){let t=this.value;return t==null?e:typeof t=="number"?t:typeof t=="string"?parseInt(t):typeof t=="boolean"?t?1:0:e}set value(e){let t=this.value}};var Ss=class{constructor(){this._onComponentAdded=new pd.EventDispatcher;this._onComponentRemoved=new pd.EventDispatcher;this._onComponentChanged=new pd.EventDispatcher;this._componentProperties={},this._components={},this._managedComponents={}}get onComponentAdded(){return this._onComponentAdded.asEvent()}get onComponentRemoved(){return this._onComponentRemoved.asEvent()}get onComponentChanged(){return this._onComponentChanged.asEvent()}getComponent(e){if(this._components===void 0)return;e=Be.canonicalizeFullName(e);let t=this._components[e];if(t!==void 0)return this._managedComponents[e]||(this._managedComponents[e]=new ei(e,t)),this._managedComponents[e]}notifyComponentUpdated(e){let t=this.getComponent(e);t===void 0?C.unexpectedUndefined("CBNCU"):this._onComponentChanged.dispatch(this,t)}getAllComponents(){return this.getComponents()}getComponents(){let e=[];if(this._components!==void 0)for(let t in this._managedComponents){let i=this.getComponent(t);i!==void 0&&e.push(i)}return e}ensureDataComponent(e,t){if(this._ensureComponentsInitialized(),e=Be.canonicalizeFullName(e),this._components===void 0||this._managedComponents===void 0)throw C.unexpectedUndefined("CBEDC"),new Error;if(this._managedComponents[e]!==void 0)return this._managedComponents[e].getData();let i=this.ensureComponent(e,new ei(e,t));if(i)return i.getData()}ensureComponent(e,t){if(this._ensureComponentsInitialized(),e=Be.canonicalizeFullName(e),this._components===void 0||this._managedComponents===void 0)throw C.unexpectedUndefined("CBEC"),new Error;return this._managedComponents[e]!==void 0?this._managedComponents[e]:(this._managedComponents[e]=t,this._components[e]=t.getData(),this._onComponentAdded.dispatch(this,t),t)}addComponent(e,t){this._ensureComponentsInitialized(),e=Be.canonicalizeFullName(e),t.id=e,this._managedComponents!==void 0&&(this._managedComponents[e]=t,this._onComponentAdded.dispatch(this,t)),this._components&&(this._components[e]=t.getData())}removeComponent(e){if(this._components===void 0)return;e=Be.canonicalizeFullName(e);let t={},i={};for(let n in this._components)if(Be.canonicalizeFullName(n)!==e){let o=this._components[n];t[n]=o}for(let n in this._managedComponents)if(Be.canonicalizeFullName(n)!==e){let o=this._managedComponents[n];i[n]=o}this._components=t,this._managedComponents=i}getComponentProperty(e){return this._componentProperties[e]}ensureComponentProperty(e){return this.addComponentProperty(e)}addComponentProperty(e){let t=this._componentProperties[e];return t==null&&(t=new il(this,e),t.id=e,this._componentProperties[e]=t,this.notifyComponentPropertyChanged(t)),t}notifyComponentPropertyChanged(e){}loadAttributeComponentsFromNbtTag(e){let t=e.getTagChildren();for(let i=0;i<t.length;i++){let s=t[i].find("Name");if(s!==null){let o=s.valueAsString,a=null;o.endsWith("luck")||o.endsWith("health")||o.endsWith("absorption")||o.endsWith("knockback_resistance")||o.endsWith("follow_range")?a=new tl:o.endsWith("movement")||o.endsWith("jump_strength")?a=new xo:(C.debugAlert("Unknown component '"+o+"' found"),a=new xo);let l=new ei(o,a);this.ensureComponent(o,l)}}}_ensureComponentsInitialized(){this._components===null&&(this._components={})}};var ui=class r extends Ss{constructor(t){super();this._data=0;this.extraLiquidDepth=-1;this.persistenceVersion=-1;this.properties={};this._onTypeChanged=new sp.EventDispatcher;this._onPropertyChanged=new sp.EventDispatcher;this._typeId=t}static{this.MAX_WATER_LEVEL=16}get onTypeChanged(){return this._onTypeChanged.asEvent()}get onPropertyChanged(){return this._onPropertyChanged.asEvent()}get data(){return this._data}set data(t){this._data=t}get surroundings(){return this._surroundings!==void 0?this._surroundings:(this._ensureSurroundingsIfCube(),this._surroundings)}setType(t){this._type=t,this._bedrockType=void 0,this._typeId=t.typeId}get opaqueSideCount(){if(this._ensureSurroundingsIfCube(),this._surroundings===void 0)return 0;let t=0,i=this.shortTypeName,n=this._surroundings.left;return(n===void 0||n.isEmpty||!n.isOpaque&&i!==n.shortTypeName)&&t++,n=this._surroundings.right,(n===void 0||n.isEmpty||!n.isOpaque&&i!==n.shortTypeName)&&t++,n=this._surroundings.up,(n===void 0||n.isEmpty||!n.isOpaque&&i!==n.shortTypeName)&&t++,n=this._surroundings.down,(n===void 0||n.isEmpty||!n.isOpaque&&i!==n.shortTypeName)&&t++,n=this._surroundings.forward,(n===void 0||n.isEmpty||!n.isOpaque&&i!==n.shortTypeName)&&t++,n=this._surroundings.backward,(n===void 0||n.isEmpty||!n.isOpaque&&i!==n.shortTypeName)&&t++,t}get isOpaque(){return this._bedrockType===void 0&&this._ensureTypes(),this._bedrockType!==void 0?this._bedrockType.baseType.isOpaque:!1}_ensureTypes(){if(this._bedrockType===void 0&&this._typeId!==void 0)if(this._type=oe.ensureBlockType(this._typeId),this._type.javaData!==null&&this._type.javaData.name!==null&&this._type.javaData.name!==this._typeId){this._bedrockType=oe.ensureBlockType(this._type.javaData.name);let t=this.getProperty("type");t!==void 0&&(this._bedrockType.shortTypeName==="piston"&&t.asString("")==="sticky"?this._bedrockType=oe.ensureBlockType("sticky_piston"):this._bedrockType.shortTypeName==="sticky_piston"&&t.asString("")==="normal"&&(this._bedrockType=oe.ensureBlockType("piston")))}else this._bedrockType=this._type}_updateDataFromProperties(){if(this._ensureTypes(),this._bedrockType===void 0)return;let t=this._bedrockType.baseType,i=0;if(t.data.properties!==void 0)for(let n=0;n<t.data.properties.length;n++){let s=t.data.properties[n];if(s.values!==void 0){let o=this.getProperty(s.name);if(o!=null){for(let a=0;a<s.values.length;a++)if(o.value===s.values[a].id){let l=s.values[a].data;l!==void 0&&(i+=l)}}}}this._data=i}_notifyTypeChanged(){this._onTypeChanged.dispatch(this,this)}_notifyPropertyChanged(t){this._updateDataFromProperties(),this._onPropertyChanged.dispatch(this,t),this.line!==void 0&&this.line.cube!==void 0&&this.line.cube._notifyBlockPropertyChanged(this)}get bedrockType(){return this._ensureTypes(),this._bedrockType}get textureName(){if(this._ensureTypes(),this._bedrockType!==void 0&&this.shortTypeName!=="water")return this._bedrockType.typeId}copyFrom(t){this.typeName=t.typeName}static fromLegacyId(t){if(t===0||t>=256||t===void 0)return new r("minecraft:air");let i=oe.getBlockTypeByLegacyId(t);return i?new r(i.typeId):new r("minecraft:dirt")}get effectiveWaterLevel(){let t=this.getProperty("level");return t!==void 0?t.asNumber(0)*2:this.shortTypeName==="water"?15:(t=this.getProperty("liquid_depth"),t!==void 0?15-t.asNumber(0):this.extraLiquidDepth<0?0:15-this.extraLiquidDepth)}get renderType(){return this._ensureTypes(),this._bedrockType===void 0?1:this.shortTypeName==="water"?39:this._bedrockType.renderType}getProperty(t){return this.properties[t]}ensureProperty(t){return this.addProperty(t)}getPropertyBoolean(t,i){let n=this.properties[t];return n==null?i:n.asBoolean(i)}getPropertyString(t,i){let n=this.properties[t];return n==null?i:n.asString(i)}getPropertyNumber(t,i){let n=this.properties[t];return n==null?i:n.asNumber(i)}addProperty(t){let i=this.properties[t];return i==null&&(i=new el(this),i.id=t,this.properties[t]=i),i}get z(){return this._z}set z(t){this._z=t}get x(){if(this.line!==void 0)return this.line.x}get y(){if(this.line!==void 0)return this.line.y}get coordinatesString(){return this.line===void 0?"":this.x+"."+this.y+"."+this.z}get typeName(){return this._typeId}set typeName(t){this._typeId!==t&&(this._typeId=t,this._bedrockType=void 0,this._type=void 0,this.line!==void 0&&this.line.cube!==void 0&&this.line.cube._notifyBlockTypeChanged(this))}getBlockData(){let t=this.typeName;t==null&&(t="");let i={};for(let s in this.properties){let o=this.properties[s];i[s]=o.value}return{typeId:t,state:i}}toString(){return JSON.stringify(this.getBlockData(),null,2)}get isEmpty(){return this._typeId==null||this.shortTypeName==="air"}_ensureSurroundingsIfCube(){if(this.line===void 0||this._z===void 0||this._surroundings!==void 0)return;let t=this.line.cube,i=this.line.x,n=this.line.y,s=this._z,o,a,l,u,c,d,h=t.x(i);n>=1&&(o=h.y(n-1).z(s)),n<t.maxY-1&&(a=h.y(n+1).z(s)),i>=1&&(l=t.x(i-1).y(n).z(s)),i<t.maxX-1&&(u=t.x(i+1).y(n).z(s));let f=t.x(i).y(n);s>=1&&(d=f.z(s-1)),s<t.maxZ-1&&(c=f.z(s+1)),this._surroundings={down:o,up:a,left:l,right:u,backward:d,forward:c}}get isCovered(){if(this._covered!==void 0)return this._covered;if(this._ensureSurroundingsIfCube(),this._surroundings===void 0||this._z===void 0)return this._covered=!1,!1;let t=this._surroundings;return t.down===void 0||t.down.isEmpty||!t.down.isOpaque||!t.down.isCovered||t.up===void 0||t.up.isEmpty||!t.up.isOpaque||!t.up.isCovered||t.left===void 0||t.left.isEmpty||!t.left.isOpaque||!t.left.isCovered||t.right===void 0||t.right.isEmpty||!t.right.isOpaque||!t.right.isCovered||t.forward===void 0||t.forward.isEmpty||!t.forward.isOpaque||!t.forward.isCovered||t.backward===void 0||t.backward.isEmpty||!t.backward.isOpaque||!t.backward.isCovered?(this._covered=!1,!1):(this._covered=!0,!0)}get isTouchingOtherBlock(){if(this._ensureSurroundingsIfCube(),this._surroundings===void 0)return!1;let t=this._surroundings;return t.down!==void 0&&!t.down.isEmpty||t.up!==void 0&&!t.up.isEmpty||t.left!==void 0&&!t.left.isEmpty||t.right!==void 0&&!t.right.isEmpty||t.forward!==void 0&&!t.forward.isEmpty||t.backward!==void 0&&!t.backward.isEmpty}get up(){if(this._ensureSurroundingsIfCube(),this._surroundings!==void 0)return this._surroundings.up}get down(){if(this._ensureSurroundingsIfCube(),this._surroundings!==void 0)return this._surroundings.down}get left(){if(this._ensureSurroundingsIfCube(),this._surroundings!==void 0)return this._surroundings.left}get right(){if(this._ensureSurroundingsIfCube(),this._surroundings!==void 0)return this._surroundings.right}get forward(){if(this._ensureSurroundingsIfCube(),this._surroundings!==void 0)return this._surroundings.forward}get backward(){if(this._ensureSurroundingsIfCube(),this._surroundings!==void 0)return this._surroundings.backward}get shortTypeName(){if(this._typeId!==void 0)return this._typeId.startsWith("minecraft:")?this._typeId.substring(10,this._typeId.length):this._typeId}applyFrom(t){C.assert(t!=null,"Undefined block template"),this._typeId=t.typeName;for(let i in t.properties){let n=t.getProperty(i),s=this.ensureProperty(i);s.nbtType=n.nbtType,s.value=n.value}}};var rl=class{get cube(){return this._cube}get y(){return this._y}get x(){return this._plane.x}get plane(){return this._plane}constructor(e,t,i){this.blocks=[],this._cube=e,this._plane=t,this._y=i}z(e){if(e>this._cube.maxZ)throw new Error("Value exceeds maximum Z");for(;e>=this.blocks.length;){let t=new ui(void 0);t.line=this,t.z=this.blocks.length,this.blocks[this.blocks.length]=t}return this.blocks[e]}};var nl=class{get x(){return this._x}constructor(e,t){this.lines=[],this._cube=e,this._x=t}y(e){if(e>this._cube.maxY)throw new Error("Value exceeds maximum Y");for(;e>=this.lines.length;){let t=this.lines.length;this.lines[t]=new rl(this._cube,this,t)}return this.lines[e]}};var md=Le(Je());var sl=class r{get x(){return this._x}set x(e){C.assertIsInt(e,"BLX"),this._x=e}get y(){return this._y}set y(e){C.assertIsInt(e,"BLY"),this._y=e}get z(){return this._z}set z(e){C.assertIsInt(e,"BLZ"),this._z=e}get title(){return this.x+"x"+this.y+"y"+this.z+"z"}toLocation(){return new dr(this.x,this.y,this.z)}toArray(){return[this.x,this.y,this.z]}toSummary(){return"("+this.x+","+this.y+","+this.z+");"}constructor(e,t,i){this._x=e??0,this._y=t??0,this._z=i??0,C.assertIsInt(this._x,"BLCX"),C.assertIsInt(this._y,"BLCY"),C.assertIsInt(this._z,"BLCZ")}static from(e){return e instanceof r?e:e instanceof dr?e.toRoundedBlockLocation():e.length&&e.length===3?new r(e[0],e[1],e[2]):e?e.x||e.y||e.z?new r(e.x,e.y,e.z):new r(0,0,0):new r(0,0,0)}};var dr=class{get x(){return this._x}set x(e){this._x=e}get y(){return this._y}set y(e){this._y=e}get z(){return this._z}set z(e){this._z=e}toSummary(){return"("+this.x.toPrecision(4)+","+this.y.toPrecision(4)+","+this.z.toPrecision(4)+")"}toRoundedBlockLocation(){return new sl(Math.round(this.x),Math.round(this.y),Math.round(this.z))}constructor(e,t,i){this._x=e??0,this._y=t??0,this._z=i??0}distanceTo(e){return Math.sqrt(Math.pow(Math.abs(this._x-e.x),2)+Math.pow(Math.abs(this._y-e.y),2)+Math.pow(Math.abs(this._z-e.z),2))}};var ol=class{get yaw(){return this._yaw}set yaw(e){this._yaw=e}get pitch(){return this._pitch}set pitch(e){this._pitch=e}constructor(e,t){this._yaw=e??0,this._pitch=t??0}};var Pw=Le(Je()),bn=class extends Ss{constructor(){super(...arguments);this._typeId="";this.location=new dr(null,null,null);this.rotation=new ol(null,null);this.tags=[];this.definitions=[];this._onPropertyChanged=new Pw.EventDispatcher}get onPropertyChanged(){return this._onPropertyChanged.asEvent()}get typeId(){return this._typeId}set typeId(t){this._typeId=t}getProperty(t){return this.getComponentProperty(t)}ensureProperty(t){return this.addComponentProperty(t)}addProperty(t){return this.addComponentProperty(t)}notifyComponentPropertyChanged(t){this._onPropertyChanged.dispatch(this,t)}loadDefinitionsFromNbtTag(t){let i=t.getTagChildren(),n=[];for(let s=0;s<i.length;s++){let o=i[s];n.push(o.valueAsString)}this.definitions=n}loadTagsFromNbtTag(t){let i=t.getTagChildren(),n=[];for(let s=0;s<i.length;s++){let o=i[s];n.push(o.valueAsString)}this.tags=n}loadRotationFromNbtTag(t){let i=t.getTagChildren();i.length===2?(this.rotation.yaw=i[0].valueAsFloat,this.rotation.pitch=i[1].valueAsFloat):C.debugAlert("Unexpected rotation")}loadLocationFromNbtTag(t){let i=t.getTagChildren();i.length===3?(this.location.x=i[0].valueAsFloat,this.location.y=i[1].valueAsFloat,this.location.z=i[2].valueAsFloat):C.debugAlert("Unexpected pos")}};var fr=class{constructor(){this._maxX=1;this._maxY=1;this._maxZ=1;this._onMaxDimensionsChanged=new md.EventDispatcher;this._onBlockTypeChanged=new md.EventDispatcher;this._onBlockPropertyChanged=new md.EventDispatcher;this.planes=[]}get onMaxDimensionsChanged(){return this._onMaxDimensionsChanged.asEvent()}get onBlockTypeChanged(){return this._onBlockTypeChanged.asEvent()}get onBlockPropertyChanged(){return this._onBlockPropertyChanged.asEvent()}get columns(){return this._columns===void 0&&(this._columns=this._generateColumnInfo()),this._columns}get maxX(){return this._maxX}get maxY(){return this._maxY}get maxZ(){return this._maxZ}set maxX(e){this._maxX=e,this._onMaxDimensionsChanged.dispatch(this,"x")}set maxY(e){this._maxY=e,this._onMaxDimensionsChanged.dispatch(this,"y")}set maxZ(e){this._maxZ=e,this._onMaxDimensionsChanged.dispatch(this,"z")}setMaxDimensions(e,t,i){this._maxX=e,this._maxY=t,this._maxZ=i,this._onMaxDimensionsChanged.dispatch(this,"xyz")}spawnEntity(e,t){return new bn}getBlock(e){return C.assert(e.x>=0&&e.x<=this.maxX&&e.y>=0&&e.x<=this.maxY&&e.z>=0&&e.z<=this.maxZ,"Block location not within bounds."),this.x(e.x).y(e.y).z(e.z)}getCommandList(e,t,i){let n=[];for(let s=0;s<this.maxX;s++)for(let o=0;o<this.maxY;o++)for(let a=0;a<this.maxZ;a++){let l=this.x(s).y(o).z(a);l.isEmpty||n.push("setblock ~"+(e+s)+" ~"+(t+o)+" ~"+(i+a)+" "+l.typeName)}return n}_generateColumnInfo(){let e=new Array(this.maxZ);for(let t=0;t<this.maxY;t++){e[t]=new Array(this.maxX);for(let i=0;i<this.maxX;i++){let n=this.x(i),s=!1,o=!1,a=0,l=0,u=0;for(let c=0;t<this.maxY;c++){let d=n.y(c).z(t);!d.isEmpty&&d.isOpaque&&!s?a++:d.isEmpty?(s=!0,o=!0):(o||l++,u=c,d.isOpaque||(s=!0))}e[i][t]={contiguousHeight:l,height:u,opaqueHeight:a}}}return e}_notifyBlockTypeChanged(e){this._columns=void 0,this._onBlockTypeChanged.dispatch(this,e)}_notifyBlockPropertyChanged(e){this._onBlockPropertyChanged.dispatch(this,e)}x(e){if(e>this.maxX)throw new Error("Value exceeds maximum X");for(;e>=this.planes.length;){let t=this.planes.length;this.planes[t]=new nl(this,t)}return this.planes[e]}fillEmpty(e,t,i,n,s,o,a){for(let l=t;l<=s;l++)for(let u=i;u<=o;u++){let c=this.x(l).y(u).z(n);c.typeName=e,c=this.x(l).y(u).z(a),c.typeName=e}for(let l=i;l<=o;l++)for(let u=n+1;u<a;u++){let c=this.x(t).y(l).z(u);c.typeName=e,c=this.x(s).y(l).z(u),c.typeName=e}}fill(e,t,i,n,s,o,a){for(let l=t;l<=s;l++)for(let u=i;u<=o;u++)for(let c=n;c<=a;c++){let d=this.x(l).y(u).z(c);d.typeName=e}}fillY(e,t){for(let i=0;i<this.maxX;i++){let n=this.x(i).y(t);for(let s=0;s<this.maxZ;s++){let o=n.z(s);o.typeName=e}}}};var ti=class{constructor(){this.roots=null}get singleRoot(){return this.roots===null||this.roots.length===0?null:(this.roots.length!==1&&this._pushError("Unexpectedly did not find a single root ("+this.roots.length+")"),this.roots[0])}_pushError(e,t){this.isInErrorState=!0,this.errorMessages===void 0&&(this.errorMessages=[]);let i;t?i=this.context?this.context+"-"+t:t:i=this.context,C.error(e+(i?" "+i:"")),this.errorMessages.push({message:e,context:i})}_getSignedByte(e){let t=new ArrayBuffer(1),i=new Uint8Array(t);return i[0]=e,new DataView(t).getInt8(0)}_getFloat(e,t,i,n,s){let o=new ArrayBuffer(4),a=new Uint8Array(o);return a[0]=e,a[1]=t,a[2]=i,a[3]=n,new DataView(o).getFloat32(0,s)}_getSignedLong(e,t,i,n,s,o,a,l,u){let c=new ArrayBuffer(8),d=new Uint8Array(c);return d[0]=e,d[1]=t,d[2]=i,d[3]=n,d[4]=s,d[5]=o,d[6]=a,d[7]=l,new DataView(c).getBigInt64(0,u)}_getSignedDouble(e,t,i,n,s,o,a,l,u){let c=new ArrayBuffer(8),d=new Uint8Array(c);return d[0]=e,d[1]=t,d[2]=i,d[3]=n,d[4]=s,d[5]=o,d[6]=a,d[7]=l,new DataView(c).getFloat64(0,u)}_getVarInt(e,t){let i=0,n=0,s=0;do{s=e[t];let o=s&127;if(n|=o<<7*i,i++,i>5)throw new Error("VarInt is unexpectedly large")}while((s&128)!==0);return{value:n,bytesRead:i}}_getSignedShort(e,t,i){let n=new ArrayBuffer(2),s=new Uint8Array(n);return s[0]=e,s[1]=t,new DataView(n).getInt16(0,i)}_getUnsignedShort(e,t,i){let n=new ArrayBuffer(2),s=new Uint8Array(n);return s[0]=e,s[1]=t,new DataView(n).getUint16(0,i)}_getSignedInteger(e,t,i,n,s){let o=new ArrayBuffer(4),a=new Uint8Array(o);return a[0]=e,a[1]=t,a[2]=i,a[3]=n,new DataView(o).getInt32(0,s)}_getUnsignedInteger(e,t,i,n,s){let o=new ArrayBuffer(4),a=new Uint8Array(o);return a[0]=e,a[1]=t,a[2]=i,a[3]=n,new DataView(o).getUint32(0,s)}getJsonString(){return JSON.stringify(this.getJson())}getJson(){if(this.roots===null)return{};if(this.roots.length===1)return this.roots[0].getJson();throw new Error("Unexpected multiple roots.")}toBinary(){if(this.roots===void 0||this.roots===null)return;let e=0;for(let s=0;s<this.roots.length;s++)e+=this.roots[s].getByteSize();let t=new ArrayBuffer(e),i=new Uint8Array(t),n=0;for(let s=0;s<this.roots.length;s++)n+=this.roots[s].writeBytes(i,n,!0);return C.assert(n===e,"Unexpectedly did not write full NBT."),i}ensureSingleRoot(){if(this.roots){if(this.roots.length!==1)throw new Error("Unexpected root count.");return this.roots[0]}return this.roots=[],this.roots.push(new Eo(10,"",!1)),this.roots[0]}fromBinary(e,t,i,n,s,o){let a=[],l=[],u=[];this.roots=[];let c=0;for(n!==void 0&&(c=n),s||(s=!1);c<e.length;){let h=99,f="",m=!1;if(a.length===0||a[a.length-1].type!==9){if(h=e[c++],h>13&&h!==99&&this._pushError("Unexpected NBT tag type: "+h),h!==0){let g=0;if(i){let b=this._getVarInt(e,c);g=b.value,c+=b.bytesRead}else g=e[c++],g+=e[c++]*256;for(let b=0;b<g;b++)f+=String.fromCharCode(e[c++])}else if(a.length===0)break}else h=u[a.length-1],m=!0;let p=new Eo(h,f,m);if(a.length===0)this.roots.push(p);else{let g=a[a.length-1];g.type===9&&(g.childTagType===void 0||g.childTagType===99)&&(g.childTagType=p.type),g.childrenWithEnd.push(p)}if(a.length>0&&a[a.length-1].type===9&&(l[a.length-1]--,l[a.length-1]===0&&a.pop()),p.type===10)a.push(p);else if(p.type===0){if(a.pop(),a.length===0&&!o)break}else if(p.type===1)p.value=this._getSignedByte(e[c++]);else if(p.type===7){let g=this._getSignedInteger(e[c++],e[c++],e[c++],e[c++],t),b=[];for(let F=0;F<g;F++)b.push(this._getSignedByte(e[c++]));p.value=b}else if(p.type===9)p.type=9,a.push(p),u[a.length-1]=e[c++],l[a.length-1]=this._getSignedInteger(e[c++],e[c++],e[c++],e[c++],t);else if(p.type===11){let g=this._getSignedInteger(e[c++],e[c++],e[c++],e[c++],t),b=[];for(let F=0;F<g;F++)b.push(this._getSignedInteger(e[c++],e[c++],e[c++],e[c++],t));p.value=b}else if(p.type===12){let g=this._getSignedInteger(e[c++],e[c++],e[c++],e[c++],t),b=[];for(let F=0;F<g;F++)b.push(this._getSignedLong(e[c++],e[c++],e[c++],e[c++],e[c++],e[c++],e[c++],e[c++],t));p.value=b}else if(p.type===2)p.value=this._getSignedShort(e[c++],e[c++],t);else if(p.type===3)p.value=this._getSignedInteger(e[c++],e[c++],e[c++],e[c++],t);else if(p.type===5)p.value=this._getFloat(e[c++],e[c++],e[c++],e[c++],t);else if(p.type===6)p.value=this._getSignedDouble(e[c++],e[c++],e[c++],e[c++],e[c++],e[c++],e[c++],e[c++],t);else if(p.type===4)p.value=this._getSignedLong(e[c++],e[c++],e[c++],e[c++],e[c++],e[c++],e[c++],e[c++],t);else if(p.type===8){let g=0;if(i){let w=this._getVarInt(e,c);g=w.value,c+=w.bytesRead}else g=this._getUnsignedShort(e[c++],e[c++],t);let b=new DataView(e.buffer),F;if(s?F=B.readStringASCIIBuffer(e,c,g):F=B.getString(b,c,g,"UTF8"),F===void 0)throw new Error("Unexpectedly could not read a string.");p.value=F,c+=g,C.assert(c<=e.length,"NBTFB")}else C.unexpectedError("Unsupported NBT tag type '"+p.type+"'")}let d=c;return n!==void 0&&(d-=n),d}};var al=class{constructor(e){this.slot=e}};var ll=class{};var Jn=class extends ll{constructor(){super(),this.slots={}}ensureSlot(e){let t=this.slots[e];return t===void 0&&(t=new al(e),this.slots[e]=t),t}loadFromNbtTag(e){let t=e.getTagChildren();for(let i=0;i<t.length;i++){let n=t[i],s=n.find("Slot"),o=n.find("Name"),a=n.find("Count"),l=n.find("WasPickedUp"),u=n.find("Damage");if(o!==null&&o.value!==null&&a!==null&&a!==null&&u!==null&&u.value!==null&&l!==null&&l.value!==null){let c=i;s!==null&&(c=s.valueAsInt);let d=this.ensureSlot(c);d.name=o.valueAsString,d.count=a.valueAsInt,d.wasPickedUp=l.valueAsBoolean,d.damage=u.valueAsInt}else C.fail("Unexpected inventory item in structure.")}}};var ul=class{constructor(){this._blockPalette=[];this.defaultBlockPersistenceVersion=17879555}get cube(){return this._cube}set cube(e){this._cube=e}get entities(){return this._entities}shallowCopyFrom(e){this.cube=e.cube,this._entities=e.entities,this.originX=e.originX,this.originY=e.originY,this.originZ=e.originZ}createNbt(){if(this._cube===void 0)return;let e=new ti,t=e.ensureSingleRoot();t.addTag(3,"format_version").value=1;let i=t.addTag(9,"size");i.childTagType=99,i.addTag(3).value=this._cube.maxX,i.addTag(3).value=this._cube.maxY,i.addTag(3).value=this._cube.maxZ;let n=t.addTag(10,"structure"),s=n.addTag(9,"block_indices"),o=s.addTag(9),a=s.addTag(9),l={},u=[];for(let m=0;m<this._cube.maxX;m++)for(let p=0;p<this._cube.maxY;p++)for(let g=0;g<this._cube.maxZ;g++){let b=this._cube.x(m).y(p).z(g),F=b.toString(),w=l[F];b.typeName==null||b.typeName==="air"?w=-1:w==null&&(w=u.length,l[F]=w,u.push(b)),o.addTag(3).value=w,a.addTag(3).value=b.extraLiquidDepth}n.addTag(9,"entities"),this._entities;let c=n.addTag(10,"palette");n.addTag(0);let d=c.addTag(10,"default");c.addTag(0);let h=d.addTag(9,"block_palette");for(let m=0;m<u.length;m++){let p=u[m];if(p.typeName==null)throw new Error("Unexpected palette block.");let g=h.addTag(10);g.addTag(8,"name").value=p.typeName;let b=g.addTag(10,"states");for(let w in p.properties){let _=p.getProperty(w),I=_.nbtType,A=_.value;A===void 0?b.addTag(I,w).value=null:b.addTag(I,w).value=A}let F=p.persistenceVersion;F<=0&&(F=this.defaultBlockPersistenceVersion),g.addTag(3,"version").value=F,g.addTag(0)}if(d.addTag(10,"block_position_data").addTag(0),d.addTag(0),this.originX!==void 0&&this.originY!==void 0&&this.originZ!==void 0){let m=t.addTag(9,"structure_world_origin");m.addTag(3).value=this.originX,m.addTag(3).value=this.originY,m.addTag(3).value=this.originZ}return t.addTag(0),e}loadFromSnbtText(e){let t=null,i=Be.fixupJson(e);try{t=JSON.stringify(i)}catch{throw new Error("Error processing SNBT.")}if(t==null)throw new Error("Could not create SNBT.")}loadFromSnbt(e){if(e.size===null||e.size===void 0||e.size.length!==3||e.data===void 0)throw new Error("Unexpected structure to Snbt file.");this._cube===void 0&&(this._cube=new fr),this._cube.setMaxDimensions(e.size[0],e.size[1],e.size[2]);for(let t=0;t<e.data.length;t++){let i=e.data[t];if(i.pos===void 0||i.pos.length!==3||i.state===void 0)throw new Error("Unexpected format for a block in an Snbt");let n=this._cube.x(i.pos[0]).y(i.pos[1]).z(i.pos[2]),s=i.state,o=s.indexOf("{");if(o>=0){if(s[s.length-1]!=="}")throw new Error("Unexpected property found.");let a=s.substring(o+1,s.length-1).split(",");for(let l of a){let u=l.split(":");if(u.length===2)n.ensureProperty(u[0]).value=u[1];else throw new Error("Unexpected property found.")}s=s.substring(0,o)}n.typeName=s}}async loadFromNbtBytes(e){let t=new ti;t.fromBinary(e,!0,!1),this.nbt=t,await this.loadFromNbt(t)}getMCStructureBytes(){this.originX===void 0&&(this.originX=10),this.originY===void 0&&(this.originY=10),this.originZ===void 0&&(this.originZ=10);let e=this.createNbt();if(e!==void 0)return e.toBinary();C.fail("Could not create MC Structure bytes for updated.")}async loadFromNbt(e){let t=new fr,i=e.singleRoot;if(i===null)return;let n=i.find("block_palette"),s=i.find("block_indices"),o=i.find("size");if(n===null||o===null||s===null||o.getTagChildren().length!==3||s.getTagChildren().length!==2)return;let a=o.getTagChildren(),l=s.getTagChildren(),u=n.getTagChildren();t.setMaxDimensions(a[0].value,a[1].value,a[2].value),this._blockPalette=[];for(let p=0;p<u.length;p++){let g=u[p],b=g.getProperty("name"),F=g.getProperty("states"),w=g.getProperty("version");if(b!=null&&F!=null&&w!=null){let _=new ui(b.value);this._blockPalette.push(_);let I=F.getTagChildren();for(let A=0;A<I.length;A++){let T=I[A],E=_.ensureProperty(T.name);E.nbtType=T.type,T.value===null?E.value=void 0:E.value=T.value}_.persistenceVersion=w.value,this.defaultBlockPersistenceVersion=_.persistenceVersion}}let c=l[0].getTagChildren(),d=0;for(let p=0;p<t.maxX;p++)for(let g=0;g<t.maxY;g++)for(let b=0;b<t.maxZ;b++){let F=c[d].value,w=t.x(p).y(g).z(b);F===-1?w.typeName="minecraft:air":w.applyFrom(this._blockPalette[F]),w.extraLiquidDepth=-1,d++}let h=l[1].getTagChildren();d=0;for(let p=0;p<t.maxX;p++)for(let g=0;g<t.maxY;g++)for(let b=0;b<t.maxZ;b++){let F=h[d].value;if(F!==-1){let w=t.x(p).y(g).z(b),_=this._blockPalette[F];_.shortTypeName==="water"&&(w.extraLiquidDepth=_.getPropertyNumber("liquid_depth",-1))}d++}let f=i.find("entities");if(this._entities=[],f!==null&&(await oe.loadUx(),oe.uxCatalog!==void 0)){let p=f.getTagChildren();for(let g=0;g<p.length;g++){let b=p[g],F=new bn,w=b.getTagChildren();for(let _=0;_<w.length;_++){let I=w[_];if(I.name==="definitions")F.loadDefinitionsFromNbtTag(I);else if(I.name==="identifier")C.assert(I.type===8,"Expected string type"),F.typeId=I.valueAsString;else if(I.name==="Attributes")F.loadAttributeComponentsFromNbtTag(I);else if(I.name==="Rotation")F.loadRotationFromNbtTag(I);else if(I.name==="Tags")F.loadTagsFromNbtTag(I);else if(I.name==="ChestItems")F.ensureDataComponent("inventory",new Jn).loadFromNbtTag(I);else if(I.name==="Armor")F.ensureDataComponent("armor_inventory",new Jn).loadFromNbtTag(I);else if(I.name==="Mainhand")I.getTagChildren().length===1&&F.ensureDataComponent("mainhand",new Jn).loadFromNbtTag(I);else if(I.name==="Offhand")I.getTagChildren().length===1&&F.ensureDataComponent("offhand",new Jn).loadFromNbtTag(I);else if(I.name==="Pos")F.loadLocationFromNbtTag(I);else if(I.value===null){let A=F.ensureComponentProperty(I.name);A.load(),A.value=void 0}else{let A=F.ensureComponentProperty(I.name);A.load(),A.value=I.value}}this._entities.push(F)}}let m=i.find("structure_world_origin");if(m!==null&&m.getTagChildren().length===3){let p=m.getTagChildren();this.originX=p[0].valueAsInt,this.originY=p[1].valueAsInt,this.originZ=p[2].valueAsInt}else this.originX=void 0,this.originY=void 0,this.originZ=void 0;this._cube=t}};var Ui=class r{static{this.defaultTestJavaScript=`import { Test } from "@minecraft/server-gametest";
import { world, system } from "@minecraft/server";
        
function basicTest(test) {
    const zoglinEntityType = "zoglin";
    const skeletonEntityType = "skeleton";
        
    test.spawn(zoglinEntityType, { x: 2, y: 2, z: 3});
    test.spawn(skeletonEntityType, { x: 5, y: 2, z: 3});
    
    test.succeedWhen( ()=> {
            test.assertEntityPresentInArea(skeletonEntityType, false);
        }
    );
}
        
gt.register("MyProject", "basicTest", basicTest).structureName("gametests:basic");     
`}static{this.emptyTestJavaScript=`import { Test } from "@minecraft/server-gametest";
import { world, system } from "@minecraft/server";
        
function basicTest(test) {

}
        
gt.register("MyProject", "basicTest", basicTest).structureName("gametests:basic");     
`}static{this.emptyJavaScript=`import { world, system } from "@minecraft/server";
        
function myFunction() 
{

}
`}static{this.emptyActionSet=`{
}
`}static{this.emptyWorldTest=`{
}
`}static getItemName(e){return e=e.trim(),e=e.replace(/ /gi,""),e.length>3&&e.charAt(0)>="A"&&e.charAt(0)<="Z"&&(e=e[0].toLowerCase()+e.substring(1,e.length)),e}static getDefaultTestJavaScript(e,t){let i=r.defaultTestJavaScript;return i=this.replaceCommonItems(i,e),i=i.replace(/basicTest/gi,r.getItemName(t)),i}static getDefaultTestTypeScript(e,t){let i=r.defaultTestJavaScript;return i=i.replace("(test)","(test : gt.Test)"),i=this.replaceCommonItems(i,e),i=i.replace(/basicTest/gi,r.getItemName(t)),i}static getEmptyTestJavaScript(e,t){let i=r.emptyTestJavaScript;return i=this.replaceCommonItems(i,e),i=i.replace(/basicTest/gi,r.getItemName(t)),i}static getEmptyTestTypeScript(e,t){let i=r.emptyTestJavaScript;return i=i.replace("(test)","(test : gt.Helper)"),i=this.replaceCommonItems(i,e),i=i.replace(/basicTest/gi,r.getItemName(t)),i}static replaceCommonItems(e,t){return e.replace('"MyProject"','"'+r.getItemName(t)+'"')}static getEmptyActionSet(e,t){return r.emptyActionSet}static getEmptyWorldTest(e,t){return r.emptyActionSet}static getEmptyJavaScript(e,t){let i=r.emptyJavaScript;return i=i.replace("myFunction",r.getItemName(e)+"Action"),i}static getEmptyTypeScript(e,t){return this.getEmptyJavaScript(e,t)}static generateDefaultStructure(){let e=new ul,t=new fr;return t.setMaxDimensions(8,8,8),e.cube=t,t.fillY("minecraft:dirt",0),t.fillEmpty("minecraft:glass",0,1,0,7,7,7),e.getMCStructureBytes()}};var xw=Le(Je());var Ew=Le(Je());var jt=class r{constructor(){this._isLoaded=!1;this._onLoaded=new Ew.EventDispatcher}get isLoaded(){return this._isLoaded}get file(){return this._file}set file(e){this._file=e}get onLoaded(){return this._onLoaded.asEvent()}get description(){if(!(!this.definition||!this.definition.header))return this.definition.header.description}set description(e){this.definition&&this.definition.header&&e&&(this.definition.header.description=e)}get packScope(){if(!(!this.definition||!this.definition.header))return this.definition.header.pack_scope}set packScope(e){!this.definition||!this.definition.header||(this.definition.header.pack_scope=e)}get productType(){if(!(!this.definition||!this.definition.metadata))return this.definition.metadata.product_type}set productType(e){this.ensureMetadata(),!(!this.definition||!this.definition.metadata)&&(this.definition.metadata.product_type=e)}get name(){if(this.definition&&this.definition.header)return this.definition.header.name}set name(e){this.definition&&this.definition.header&&e&&(this.definition.header.name=e)}get id(){return this.definition&&this.definition.header?this.definition.header.uuid:this._id}set id(e){this.definition&&this.definition.header&&e&&(this.definition.header.uuid=e),this._id=e}async setUuid(e,t){let i=this.id;this.id=e,e&&i&&t&&await r.setNewResourcePackId(t,e,i)}ensureHeaderForProject(e){return this.ensureHeader(e.title,e.description)}get minEngineVersion(){if(!(!this.definition||!this.definition.header||!this.definition.header.min_engine_version))return this.definition.header.min_engine_version}setMinEngineVersion(e,t){let i=this.ensureHeaderForProject(t);i.min_engine_version=e}static async setNewResourcePackId(e,t,i){let n=e.getItemsCopy(),s=!1;for(let o=0;o<n.length;o++){let a=n[o];if(a.file){if(a.itemType===14&&!s){let l=await r.ensureOnFile(a.file);if(l){if(l.id&&B.uuidEqual(l.id,i))l.id=t,s=!0,await l.save();else if(l.definition&&l.definition.dependencies){let u=l.definition?.dependencies;for(let c of u)c.uuid===i&&(c.uuid=t);await l.save()}}}else if(a.itemType===5){let l=await Et.ensureOnFile(a.file);if(l&&l.definition&&l.definition.dependencies){let u=l.definition?.dependencies;for(let c of u)c.uuid===i&&(c.uuid=t);await l.save()}}}}}hasAddonProperties(){return this.productType==="addon"&&this.packScope==="world"}async setAddonProperties(){this.productType="addon",this.packScope="world",await this.save()}randomizeModuleUuids(e,t){if(this.definition)for(let i=0;i<this.definition.modules.length;i++){let n=this.definition.modules[i];n.uuid&&(t&&e&&(n.uuid===t||n.uuid===e)?n.uuid=e:n.uuid=B.createUuid())}}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}persist(){if(this._file===void 0)return;let e=JSON.stringify(this.definition,null,2);this._file.setContent(e)}ensureDefinition(e,t){this.definition||(this.definition={format_version:2,header:{name:e,description:t,version:[0,0,1],min_engine_version:[1,20,10],uuid:B.createUuid()},modules:[],dependencies:[]})}ensureHeader(e,t){if(this.ensureDefinition(e,t),!this.definition)throw new Error;return this.definition.header||(this.definition.header=this.getDefaultHeader(e,t)),this.definition.header}ensureMetadata(){if(this.definition)return this.definition.metadata||(this.definition.metadata={}),this.definition.metadata}getDefaultHeader(e,t){return{name:e,description:t,version:[0,0,1],min_engine_version:[1,20,10],uuid:B.createUuid()}}async save(){this._file!==void 0&&(this.persist(),await this._file.saveContent(!1))}async load(){this._file===void 0||this._isLoaded||(await this._file.loadContent(),!(this._file.content===null||this._file.content instanceof Uint8Array)&&(this.definition=S.getJsonObject(this._file),this._isLoaded=!0))}};var Et=class r{constructor(){this._isLoaded=!1;this._onLoaded=new xw.EventDispatcher}get isLoaded(){return this._isLoaded}get file(){return this._file}set file(e){this._file=e}get onLoaded(){return this._onLoaded.asEvent()}get productType(){if(!(!this.definition||!this.definition.metadata))return this.definition.metadata.product_type}set productType(e){this.ensureMetadata(),!(!this.definition||!this.definition.metadata)&&(this.definition.metadata.product_type=e)}get description(){if(!(!this.definition||!this.definition.header))return this.definition.header.description}set description(e){this.definition&&this.definition.header&&e&&(this.definition.header.description=e)}get name(){if(this.definition&&this.definition.header)return this.definition.header.name}set name(e){this.definition&&this.definition.header&&e&&(this.definition.header.name=e)}get id(){return this.definition&&this.definition.header?this.definition.header.uuid:this._id}set id(e){this.definition&&this.definition.header&&e&&(this.definition.header.uuid=e),this._id=e}async setUuid(e,t){let i=this.id;this.id=e,e&&i&&t&&await r.setNewBehaviorPackId(t,e,i)}static async setNewBehaviorPackId(e,t,i){let n=e.getItemsCopy(),s=!1;for(let o=0;o<n.length;o++){let a=n[o];if(a.file){if(a.itemType===5&&!s){let l=await r.ensureOnFile(a.file);if(l){if(l.id&&B.uuidEqual(l.id,i))l.id=t,s=!0,await l.save();else if(l.definition&&l.definition.dependencies){let u=l.definition?.dependencies;for(let c of u)c.uuid===i&&(c.uuid=t);await l.save()}}}else if(a.itemType===14){let l=await jt.ensureOnFile(a.file);if(l&&l.definition&&l.definition.dependencies){let u=l.definition?.dependencies;for(let c of u)c.uuid===i&&(c.uuid=t);await l.save()}}}}}hasAddonProperties(){return this.productType==="addon"}async setAddonProperties(){this.productType="addon",await this.save()}randomizeModuleUuids(e,t){if(this.definition)for(let i=0;i<this.definition.modules.length;i++){let n=this.definition.modules[i];n.uuid&&(t&&e&&(n.uuid===t||n.uuid===e)?n.uuid=e:n.uuid=B.createUuid())}}getNonScriptModuleDependencyCount(){if(!this.definition||!this.definition.dependencies)return 0;let e=0;for(let t of this.definition.dependencies)t.uuid&&e++;return e}getFirstNonScriptModuleDependency(){if(!(!this.definition||!this.definition.dependencies)){for(let e of this.definition.dependencies)if(e.uuid)return e}}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}get minEngineVersion(){if(!(!this.definition||!this.definition.header||!this.definition.header.min_engine_version))return this.definition.header.min_engine_version}setMinEngineVersion(e,t){let i=this.ensureHeaderForProject(t);i.min_engine_version=e}setModuleVersion(e,t){if(!this.definition||!this.definition.dependencies)return!1;let i=t,n=!1;if(t.indexOf("-")<1){let s=t.split(".");if(s&&s.length===3){i=[];for(let o=0;o<s.length;o++){try{i.push(parseInt(s[o]))}catch(a){throw a}if(Number.isNaN(i[o]))throw new Error("Could not parse "+t)}}}for(let s=0;s<this.definition.dependencies.length;s++){let o=this.definition.dependencies[s];o.module_name===e&&o.version!==i&&(o.version=i,n=!0)}return n}persist(){if(this._file===void 0)return;let e=JSON.stringify(this.definition,null,2);this._file.setContent(e)}ensureDefinition(e,t){this.definition||(this.definition={format_version:2,header:{name:e,description:t,version:[0,0,1],min_engine_version:[1,20,10],uuid:B.createUuid()},modules:[],dependencies:[]})}ensureHeaderForProject(e){return this.ensureHeader(e.title,e.description)}ensureMetadata(){if(this.definition)return this.definition.metadata||(this.definition.metadata={}),this.definition.metadata}ensureHeader(e,t){if(this.ensureDefinition(e,t),!this.definition)throw new Error;return this.definition.header||(this.definition.header=this.getDefaultHeader(e,t)),this.definition.header}getDefaultHeader(e,t){return{name:e,description:t,version:[0,0,1],min_engine_version:[1,20,10],uuid:B.createUuid()}}getScriptModule(){if(this.definition)for(let e=0;e<this.definition.modules.length;e++){let t=this.definition.modules[e];if(t.type&&t.type.toLowerCase()==="script")return t}}ensureScriptModule(e,t){if(this.ensureDefinition(e,t),!this.definition)throw new Error;for(let n=0;n<this.definition.modules.length;n++){let s=this.definition.modules[n];if(s.type&&s.type.toLowerCase()==="script")return s}let i={type:"script",description:e,version:[0,0,1],uuid:B.createUuid(),language:"javascript"};return this.definition.modules.push(i),i}async save(){this._file!==void 0&&(this.persist(),await this._file.saveContent(!1))}async load(){this._file===void 0||this._isLoaded||(await this._file.loadContent(),!(this._file.content===null||this._file.content instanceof Uint8Array)&&(this.definition=S.getJsonObject(this._file),this._isLoaded=!0))}static async getContent(e,t){let i=0,n=0,s=1;e.versionMajor!==void 0&&(i=e.versionMajor),e.versionMinor!==void 0&&(n=e.versionMinor),e.versionPatch!==void 0&&(s=e.versionPatch);let o=[],a=[],l,u=e.getFirstItemByType(3);u!==void 0&&(l=u.file);let c=await e.getDefaultBehaviorPackFolder(!1,t);l===void 0&&(u=e.getFirstItemByType(2),u!==void 0&&(l=u.file),l===void 0&&(u=e.getFirstItemByType(1),u!==void 0&&(l=u.file)));let d=await e.getScriptState();if(d.hasScript&&l!==null&&l!==void 0&&c!==null){let f=l.getFolderRelativePath(c);if(f!==void 0){f.startsWith("/")&&(f=f.substring(1,f.length)),o.push({description:e.title+" script",language:"javascript",type:"script",uuid:e.defaultScriptModuleUniqueId,version:[i,n,s],entry:f});for(let m=0;m<cl.length;m++){let p=cl[m];d.hasModule[p.id]&&a.push({uuid:p.uuid,module_name:p.module_name,version:p.preferredVersion})}}}let h={format_version:2,__comment__:Tw,header:{description:e.description,name:e.title,uuid:e.defaultBehaviorPackUniqueId,version:[i,n,s],min_engine_version:[1,20,10]},modules:o,dependencies:a};return e.focus===4&&(h.capabilities=["editorExtension"]),JSON.stringify(h,null,2)}};var Dw=Le(Je());var Ps=class r{constructor(){this._isLoaded=!1;this._onLoaded=new Dw.EventDispatcher}get isLoaded(){return this._isLoaded}get file(){return this._file}set file(e){this._file=e}get onLoaded(){return this._onLoaded.asEvent()}get description(){if(!(!this.definition||!this.definition.header))return this.definition.header.description}set description(e){this.definition&&this.definition.header&&e&&(this.definition.header.description=e)}get packScope(){if(!(!this.definition||!this.definition.header))return this.definition.header.pack_scope}get productType(){if(!(!this.definition||!this.definition.metadata))return this.definition.metadata.product_type}get name(){if(this.definition&&this.definition.header)return this.definition.header.name}set name(e){this.definition&&this.definition.header&&e&&(this.definition.header.name=e)}get uuid(){return this.definition&&this.definition.header?this.definition.header.uuid:this._id}set uuid(e){this.definition&&this.definition.header&&e&&(this.definition.header.uuid=e),this._id=e}ensureHeaderForProject(e){return this.ensureHeader(e.title,e.description)}get minEngineVersion(){if(!(!this.definition||!this.definition.header||!this.definition.header.min_engine_version))return this.definition.header.min_engine_version}setMinEngineVersion(e,t){let i=this.ensureHeaderForProject(t);i.min_engine_version=e}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}persist(){if(this._file===void 0)return;let e=JSON.stringify(this.definition,null,2);this._file.setContent(e)}ensureDefinition(e,t){this.definition||(this.definition={format_version:2,header:{name:e,description:t,version:[0,0,1],min_engine_version:[1,20,10],uuid:B.createUuid()},modules:[],dependencies:[]})}ensureHeader(e,t){if(this.ensureDefinition(e,t),!this.definition)throw new Error;return this.definition.header||(this.definition.header=this.getDefaultHeader(e,t)),this.definition.header}getDefaultHeader(e,t){return{name:e,description:t,version:[0,0,1],min_engine_version:[1,20,10],uuid:B.createUuid()}}async save(){this._file!==void 0&&(this.persist(),await this._file.saveContent(!1))}async load(){this._file===void 0||this._isLoaded||(await this._file.loadContent(),!(this._file.content===null||this._file.content instanceof Uint8Array)&&(this.uuid=this._file.name,this.definition=S.getJsonObject(this._file),this._isLoaded=!0))}};var Aw=Le(Je());var Es=class r{constructor(){this._isLoaded=!1;this._onLoaded=new Aw.EventDispatcher}get isLoaded(){return this._isLoaded}get file(){return this._file}set file(e){this._file=e}get onLoaded(){return this._onLoaded.asEvent()}get description(){if(!(!this.definition||!this.definition.header))return this.definition.header.description}set description(e){this.definition&&this.definition.header&&e&&(this.definition.header.description=e)}get packScope(){if(!(!this.definition||!this.definition.header))return this.definition.header.pack_scope}get productType(){if(!(!this.definition||!this.definition.metadata))return this.definition.metadata.product_type}get name(){if(this.definition&&this.definition.header)return this.definition.header.name}set name(e){this.definition&&this.definition.header&&e&&(this.definition.header.name=e)}get uuid(){return this.definition&&this.definition.header?this.definition.header.uuid:this._id}set uuid(e){this.definition&&this.definition.header&&e&&(this.definition.header.uuid=e),this._id=e}ensureHeaderForProject(e){return this.ensureHeader(e.title,e.description)}get minEngineVersion(){if(!(!this.definition||!this.definition.header||!this.definition.header.min_engine_version))return this.definition.header.min_engine_version}setMinEngineVersion(e,t){let i=this.ensureHeaderForProject(t);i.min_engine_version=e}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}persist(){if(this._file===void 0)return;let e=JSON.stringify(this.definition,null,2);this._file.setContent(e)}ensureDefinition(e,t){this.definition||(this.definition={format_version:2,header:{name:e,description:t,version:[0,0,1],min_engine_version:[1,20,10],uuid:B.createUuid()},modules:[],dependencies:[]})}ensureHeader(e,t){if(this.ensureDefinition(e,t),!this.definition)throw new Error;return this.definition.header||(this.definition.header=this.getDefaultHeader(e,t)),this.definition.header}getDefaultHeader(e,t){return{name:e,description:t,version:[0,0,1],min_engine_version:[1,20,10],uuid:B.createUuid()}}async save(){this._file!==void 0&&(this.persist(),await this._file.saveContent(!1))}async load(){this._file===void 0||this._isLoaded||(await this._file.loadContent(),!(this._file.content===null||this._file.content instanceof Uint8Array)&&(this.uuid=this._file.name,this.definition=S.getJsonObject(this._file),this._isLoaded=!0))}};var dl=class r{constructor(e,t){this.folder=e,this.type=t}ensureManifestFile(){return this.manifestFile===void 0&&(this.manifestFile=this.folder.ensureFile("manifest.json")),this.manifestFile}async ensureManifest(){return this.manifest?this.manifest:(this.manifestFile=this.ensureManifestFile(),this.type===1?this.manifest=await Et.ensureOnFile(this.manifestFile):this.type===2?this.manifest=await Ps.ensureOnFile(this.manifestFile):this.type===3?this.manifest=await Es.ensureOnFile(this.manifestFile):this.manifest=await jt.ensureOnFile(this.manifestFile),this.manifest)}static ensureOnFolder(e,t,i){if(e.manager===void 0){let n=new r(e,t);return n.project=i,n.type=t,n}else return e.manager}};var Lw=Le(Je());var Rw={"@minecraft/core-build-tasks":"^1.1.3","eslint-plugin-minecraft-linting":"^1.2.2","source-map":"^0.7.4","ts-node":"^10.9.1",typescript:"^5.5.4"},op={lint:"just-scripts lint",build:"just-scripts build",clean:"just-scripts clean","local-deploy":"just-scripts local-deploy",mcaddon:"just-scripts mcaddon",enablemcloopback:"CheckNetIsolation.exe LoopbackExempt -a -p=S-1-15-2-1958404141-86561845-1752920682-3514627264-368642714-62675701-733520436",enablemcpreviewloopback:"CheckNetIsolation.exe LoopbackExempt -a -p=S-1-15-2-424268864-5579737-879501358-346833251-474568803-887069379-4040235476",buildsnippets:"just-scripts buildSnippets"},Bw={"@minecraft/math":"^1.4.0","@minecraft/server":"^1.13.0","@minecraft/server-editor":"^0.1.0-beta.1.21.30-preview.24","@minecraft/server-ui":"^1.2.0","@minecraft/vanilla-data":"^1.21.20"},ap={"@minecraft/math":{"@minecraft/server":"$@minecraft/server"},"@minecraft/server-gametest":{"@minecraft/server":"$@minecraft/server"},"@minecraft/server-ui":{"@minecraft/server":"$@minecraft/server"}},Ax=["name","author","dependencies","devDependencies","contributors","license","overrides","version","productName","description","private","scripts"],Hr=class r{constructor(){this._isLoaded=!1;this._onLoaded=new Lw.EventDispatcher}get isLoaded(){return this._isLoaded}get file(){return this._file}set file(e){this._file=e}get onLoaded(){return this._onLoaded.asEvent()}get description(){if(this.definition)return this.definition.description}get name(){if(this.definition)return this.definition.name}get id(){return this._id}set id(e){this._id=e}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}async persist(){if(this._file===void 0)return;let e=JSON.stringify(this.definition,null,2);this._file.setContent(e)}async save(){this._file!==void 0&&(this.persist(),await this._file.saveContent(!1))}async ensureStandardContent(){if(await this.load(),!!this.definition){if(this.definition.devDependencies){let e=!0;for(let t in this.definition.devDependencies)Rw[t]===void 0&&(C.debugAlert("Unexpected dev dependency '"+t+"' found."),e=!1);e||(this.definition.devDependencies=Rw)}if(this.definition.dependencies){let e=!0;for(let t in this.definition.dependencies)Bw[t]===void 0&&(C.debugAlert("Unexpected dependency '"+t+"' found."),e=!1);e||(this.definition.dependencies=Bw)}if(this.definition.overrides){let e=this.definition.overrides,t=!0;for(let i in e)ap[i]===void 0?(C.debugAlert("Unexpected override '"+i+"' found."),t=!1):JSON.stringify(ap[i])!==JSON.stringify(e[i])&&(C.debugAlert("Unexpected override '"+i+"' is not in exepected form: "+JSON.stringify(e[i])),t=!1);t||(this.definition.overrides=ap)}if(this.definition.scripts){let e=!0;for(let t in this.definition.scripts)op[t]===void 0?(C.debugAlert("Unexpected script '"+t+"' found."),e=!1):this.definition.scripts[t]!==op[t]&&(C.debugAlert("Script '"+t+"' is in unexpected form: "+this.definition.scripts[t]),e=!1);e||(this.definition.scripts=op)}for(let e in this.definition)Ax.includes(e)||(this.definition[e]=void 0,C.debugAlert("Unexpected setting '"+e+"' found in package.json."))}}async load(){this._file===void 0||this._isLoaded||(await this._file.loadContent(),!(this._file.content===null||this._file.content instanceof Uint8Array)&&(this.id=this._file.name,this.definition=S.getJsonObject(this._file),this._isLoaded=!0))}};var fl=Le(Je());var yn=class r{constructor(e){this._typeId="";this._baseTypeId="";this._material="";this._isCustom=!1;this._wrapper=null;this._isLoaded=!1;this._managed={};this._onLoaded=new fl.EventDispatcher;this._onComponentAdded=new fl.EventDispatcher;this._onComponentRemoved=new fl.EventDispatcher;this._onComponentChanged=new fl.EventDispatcher;this.renderType=0;this._typeId=e,this._typeData={name:e},e.indexOf(":")>=0&&!e.startsWith("minecraft:")&&(this._isCustom=!0)}get data(){return this._data}get numericId(){return this._typeData.id}get baseTypeId(){return this._baseTypeId}get mapColor(){return this._typeData.mapColor}get isCustom(){return this._isCustom}get baseType(){return this._baseType!==void 0?this._baseType:oe.defaultBlockBaseType}async getFormatVersionIsCurrent(){let e=this.getFormatVersion();return e===void 0||e.length!==3?!1:await oe.isRecentVersionFromVersionArray(e)}ensureDescription(){this._data||(this._data={description:{identifier:this._typeId},components:{},events:{}}),this._data.description||(this._data.description={identifier:this._typeId})}ensurePlacementDirectionTrait(){this.ensureBlockTraits();let e=this._data?.description.traits;e&&(e["minecraft:placement_direction"]||(e["minecraft:placement_direction"]={enabled_states:["minecraft:cardinal_direction","minecraft:facing_direction"]}))}removePlacementDirectionTrait(){let e=this._data?.description.traits;e&&e["minecraft:placement_direction"]&&(e["minecraft:placement_direction"]=void 0)}ensurePlacementPositionTrait(){this.ensureBlockTraits();let e=this._data?.description.traits;e&&(e["minecraft:placement_position"]||(e["minecraft:placement_position"]={enabled_states:["minecraft:block_face","minecraft:vertical_half"]}))}removePlacementPositionTrait(){let e=this._data?.description.traits;e&&e["minecraft:placement_position"]&&(e["minecraft:placement_position"]=void 0)}ensureBlockTraits(){this.ensureDescription(),this._data?.description&&(this._data.description.traits={})}removeState(e){this._data?.description?.states&&(this._data.description.states[e]=void 0),this._data?.description?.properties&&(this._data.description.properties[e]=void 0)}getFormatVersion(){if(this._wrapper)return Be.getVersionArrayFrom(this._wrapper.format_version)}getStates(){if(!(!this._wrapper||!this._data||!this._data?.description))return!this._data.description.states&&this._data.description.properties?this._data.description.properties:this._data.description.states}addState(e,t){if(!this._data||!this._data.description)return;let i=[];t===1?i=[!1,!0]:t===2?i=[0,1,2]:t===0&&(i=["value1","value2"]),this._data.description.states||(this._data.description.states={}),this._data.description.states[e]=i}getStateList(){let e=this.getStates();if(!e)return[];let t=[];for(let i in e)e[i]!==void 0&&t.push(i);return t}set baseType(e){this._baseType=e,this._baseTypeId=e.name}get material(){return this._material}get icon(){let e=this._typeData.icon;return e===void 0&&this.baseType!==void 0&&(e=this.baseType.icon),e}get typeId(){return this._typeId}get shortTypeName(){let e=this._typeId,t=e.indexOf(":");return t>=0&&(e=e.substring(t+1,e.length)),e}get title(){let e=this.shortTypeName;return B.humanifyMinecraftName(e)}get id(){return this._data&&this._data.description?this._data.description.identifier:this._id}set id(e){this._id=e,this._data&&this._data.description&&e&&(this._data.description.identifier=e)}get onComponentAdded(){return this._onComponentAdded.asEvent()}get onComponentRemoved(){return this._onComponentRemoved.asEvent()}get onComponentChanged(){return this._onComponentChanged.asEvent()}get isLoaded(){return this._isLoaded}get behaviorPackFile(){return this._behaviorPackFile}get onLoaded(){return this._onLoaded.asEvent()}set behaviorPackFile(e){this._behaviorPackFile=e}get shortId(){if(this._id!==void 0)return this._id.startsWith("minecraft:")?this._id.substring(10,this._id.length):this._id}getComponent(e){if(this._data!==void 0){if(!this._managed[e]){let t=this._data.components[e];t&&(this._managed[e]=new ei(e,t))}return this._managed[e]}}notifyComponentUpdated(e){let t=this.getComponent(e);t===void 0?C.unexpectedUndefined("BTNCU"):this._onComponentChanged.dispatch(this,t)}getAllComponents(){return this.getComponents()}getComponents(){let e=[];if(this._data!==void 0)for(let t in this._data.components){let i=this.getComponent(t);i!==void 0&&e.push(i)}return e}addComponent(e,t){this._ensureBehaviorPackDataInitialized();let i=new ei(e,t),n=this._data;n.components[e]=t,this._managed[e]=i,this._onComponentAdded.dispatch(this,i)}removeComponent(e){if(this._data===void 0)return;let t={},i={};for(let n in this._data.components)if(n!==e){let s=this._data.components[n];t[n]=s}for(let n in this._managed)n!==e&&(i[n]=this._managed[n]);this._data.components=t,this._managed=i}_ensureBehaviorPackDataInitialized(){this._data===void 0&&(this._data={description:{identifier:"unknown"},components:{},events:{}})}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r("custom:"+e.name),i.behaviorPackFile=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}persist(){if(this._behaviorPackFile===void 0)return;let e=JSON.stringify(this._wrapper,null,2);this._behaviorPackFile.setContent(e)}async load(){if(this._behaviorPackFile===void 0||this._isLoaded||(await this._behaviorPackFile.loadContent(),!this._behaviorPackFile.content||this._behaviorPackFile.content instanceof Uint8Array))return;let e={},t=S.getJsonObject(this._behaviorPackFile);t&&(e=t),this._wrapper=e;let i=e["minecraft:block"];i&&i.description&&(this.id=i.description.identifier),this._data=i,this._onLoaded.dispatch(this,this),this._isLoaded=!0}};var bd=Le(Je());var Lt=class{static getUnsignedInteger(e,t,i,n,s){let o=new ArrayBuffer(4),a=new Uint8Array(o);return a[0]=e,a[1]=t,a[2]=i,a[3]=n,new DataView(o).getUint32(0,s)}static writeUnsignedInteger(e,t,i,n){new DataView(e.buffer,t,4).setUint32(0,i,n)}static getSignedByte(e){let t=new ArrayBuffer(1),i=new Uint8Array(t);return i[0]=e,new DataView(t).getInt8(0)}static getFloat(e,t,i,n,s){let o=new ArrayBuffer(4),a=new Uint8Array(o);return a[0]=e,a[1]=t,a[2]=i,a[3]=n,new DataView(o).getFloat32(0,s)}static getSignedLong(e,t,i,n,s,o,a,l,u){let c=new ArrayBuffer(8),d=new Uint8Array(c);return d[0]=e,d[1]=t,d[2]=i,d[3]=n,d[4]=s,d[5]=o,d[6]=a,d[7]=l,new DataView(c).getBigInt64(0,u)}static getVarInt(e,t){let i=0,n=0,s=0;do{s=e[t];let o=s&127;if(n|=o<<7*i,i++,i>5)throw new Error("VarInt is unexpectedly large")}while((s&128)!==0);return{value:n,bytesRead:i}}static getSignedShort(e,t,i){let n=new ArrayBuffer(2),s=new Uint8Array(n);return s[0]=e,s[1]=t,new DataView(n).getInt16(0,i)}static getUnsignedShort(e,t,i){let n=new ArrayBuffer(2),s=new Uint8Array(n);return s[0]=e,s[1]=t,new DataView(n).getUint16(0,i)}static getSignedInteger(e,t,i,n,s){let o=new ArrayBuffer(4),a=new Uint8Array(o);return a[0]=e,a[1]=t,a[2]=i,a[3]=n,new DataView(o).getInt32(0,s)}};var Ow=32767;var hr=class{createNbt(){let e=new ti;return e.context=this.context,e}_pushError(e,t){this.isInErrorState=!0,this.errorMessages===void 0&&(this.errorMessages=[]),C.error(e+(t?" "+t:"")),this.errorMessages.push({message:e,context:t})}loadFromNbtBytes(e,t){this.isInErrorState=!1,this.errorMessages=void 0;let i=new ti;i.context=this.context;let n=Lt.getUnsignedInteger(e[0],e[1],e[2],e[3],!0),s=Lt.getUnsignedInteger(e[4],e[5],e[6],e[7],!0);if(n<4||n===7||n>10){this._pushError("Unexpected world level dat type ("+n+")",t);return}s!==e.length-8&&s!==e.length-16&&this._pushError("Unexpected world level dat length.",t),i.fromBinary(e,!0,!1,8),this.nbt=i,this.loadFromNbt(i),B.appendErrors(this,i,t)}ensureNbt(){if(this.nbt!==void 0)return;let e=new ti;e.context=this.context,e.ensureSingleRoot(),this.nbt=e}getBytes(){if(this.ensureNbt(),this.nbt!==void 0){let e=this.nbt.toBinary();if(e!==void 0){let t=new Uint8Array(e.length+8);for(let i=0;i<e.length;i++)t[i+8]=e[i];return Lt.writeUnsignedInteger(t,0,10,!0),Lt.writeUnsignedInteger(t,4,e.length,!0),t}}C.fail("Could not create MC level bytes for updating.")}persist(){this.ensureNbt(),this.nbt!==void 0&&this._saveToNbt(this.nbt)}ensureDefaults(){if(this.biomeOverride===void 0&&(this.biomeOverride=""),this.centerMapsToOrigin===void 0&&(this.centerMapsToOrigin=!1),this.confirmedPlatformLockedContent===void 0&&(this.confirmedPlatformLockedContent=!1),this.savedWithToggledExperiments===void 0&&(this.savedWithToggledExperiments=!1),this.experimentsEverUsed===void 0&&(this.experimentsEverUsed=!1),this.difficulty===void 0&&(this.difficulty=1),this.forceGameType===void 0&&(this.forceGameType=!1),this.experimentsEverUsed===void 0&&(this.experimentsEverUsed=!1),this.savedWithToggledExperiments===void 0&&(this.savedWithToggledExperiments=!1),this.isCreatedInEditor===void 0&&(this.isCreatedInEditor=!1),this.isExportedFromEditor===void 0&&(this.isExportedFromEditor=!1),this.flatWorldLayers===void 0&&(this.flatWorldLayers={biome_id:1,block_layers:[{block_name:"minecraft:bedrock",count:1},{block_name:"minecraft:dirt",count:2},{block_name:"minecraft:grass",count:1}],encoding_version:6,structure_options:null,world_version:"version.post_1_18"}),this.forceGameType===void 0&&(this.forceGameType=!1),this.gameType===void 0&&(this.gameType=1),this.generator===void 0&&(this.generator=1),this.inventoryVersion===void 0&&(this.inventoryVersion="1.20.0"),this.lanBroadcast===void 0&&(this.lanBroadcast=!0),this.lanBroadcastIntent===void 0&&(this.lanBroadcastIntent=!0),this.lastPlayed===void 0){let e=new Date;this.lastPlayed=BigInt(Math.floor(e.getTime()/1e3))}this.limitedWorldOriginX===void 0&&(this.limitedWorldOriginX=0),this.limitedWorldOriginY===void 0&&(this.limitedWorldOriginY=Ow),this.limitedWorldOriginZ===void 0&&(this.limitedWorldOriginZ=0),this.minimumCompatibleClientVersion===void 0&&(this.minimumCompatibleClientVersion=[1,20,0,0,0]),this.multiplayerGame===void 0&&(this.multiplayerGame=!0),this.multiplayerGameIntent===void 0&&(this.multiplayerGameIntent=!0),this.netherScale===void 0&&(this.netherScale=8),this.networkVersion===void 0&&(this.networkVersion=588),this.platform===void 0&&(this.platform=2),this.platformBroadcastIntent===void 0&&(this.platformBroadcastIntent=2),this.randomSeed===void 0&&(this.randomSeed="3025905974105939481"),this.spawnV1Villagers===void 0&&(this.spawnV1Villagers=!1),this.spawnX===void 0&&(this.spawnX=0),this.spawnY===void 0&&(this.spawnY=Ow),this.spawnZ===void 0&&(this.spawnZ=0),this.storageVersion===void 0&&(this.storageVersion=10),this.time===void 0&&(this.time=BigInt(1)),this.worldVersion===void 0&&(this.worldVersion=1),this.xblBroadcastIntent===void 0&&(this.xblBroadcastIntent=2),this.baseGameVersion===void 0&&(this.baseGameVersion="*"),this.bonusChestEnabled===void 0&&(this.bonusChestEnabled=!1),this.bonusChestSpawned===void 0&&(this.bonusChestSpawned=!1),this.commandBlockOutput===void 0&&(this.commandBlockOutput=!0),this.commandBlocksEnabled===void 0&&(this.commandBlocksEnabled=!0),this.commandsEnabled===void 0&&(this.commandsEnabled=!0),this.cheatsEnabled===void 0&&(this.cheatsEnabled=!0),this.currentTick===void 0&&(this.currentTick=BigInt(1)),this.doDaylightCycle===void 0&&(this.doDaylightCycle=!0),this.daylightCycle===void 0&&(this.daylightCycle=0),this.doEntityDrops===void 0&&(this.doEntityDrops=!0),this.doFireTick===void 0&&(this.doFireTick=!0),this.doImmediateRespawn===void 0&&(this.doImmediateRespawn=!1),this.doInsomnia===void 0&&(this.doInsomnia=!0),this.doMobLoot===void 0&&(this.doMobLoot=!0),this.doMobSpawning===void 0&&(this.doMobSpawning=!0),this.doTileDrops===void 0&&(this.doTileDrops=!0),this.doWeatherCycle===void 0&&(this.doWeatherCycle=!0),this.drowningDamage===void 0&&(this.drowningDamage=!0),this.eduOffer===void 0&&(this.eduOffer=0),this.educationFeaturesEnabled===void 0&&(this.educationFeaturesEnabled=!1),this.fallDamage===void 0&&(this.fallDamage=!0),this.fireDamage===void 0&&(this.fireDamage=!0),this.freezeDamage===void 0&&(this.freezeDamage=!0),this.functionCommandLimit===void 0&&(this.functionCommandLimit=1e4),this.hasBeenLoadedInCreative===void 0&&(this.hasBeenLoadedInCreative=!0),this.hasLockedBehaviorPack===void 0&&(this.hasLockedBehaviorPack=!1),this.hasLockedResourcePack===void 0&&(this.hasLockedResourcePack=!1),this.immutableWorld===void 0&&(this.immutableWorld=!1),this.isFromLockedTemplate===void 0&&(this.isFromLockedTemplate=!1),this.isRandomSeedAllowed===void 0&&(this.isRandomSeedAllowed=!1),this.isFromWorldTemplate===void 0&&(this.isFromWorldTemplate=!1),this.isSingleUseWorld===void 0&&(this.isSingleUseWorld=!1),this.isWorldTemplateOptionLocked===void 0&&(this.isWorldTemplateOptionLocked=!1),this.keepInventory===void 0&&(this.keepInventory=!1),this.lastOpenedWithVersion===void 0&&(this.lastOpenedWithVersion=[1,20,0,0,1]),this.lightningTime===void 0&&(this.lightningTime=124600),this.lightningLevel===void 0&&(this.lightningLevel=0),this.limitedWorldDepth===void 0&&(this.limitedWorldDepth=16),this.limitedWorldWidth===void 0&&(this.limitedWorldWidth=16),this.maxCommandChainLength===void 0&&(this.maxCommandChainLength=65535),this.mobGriefing===void 0&&(this.mobGriefing=!0),this.naturalRegeneration===void 0&&(this.naturalRegeneration=!0),this.permissionsLevel===void 0&&(this.permissionsLevel=0),this.playerPermissionsLevel===void 0&&(this.playerPermissionsLevel=1),this.prid===void 0&&(this.prid=""),this.pvp===void 0&&(this.pvp=!0),this.rainLevel===void 0&&(this.rainLevel=0),this.rainTime===void 0&&(this.rainTime=94841),this.randomTickSpeed===void 0&&(this.randomTickSpeed=1),this.requiresCopiedPackRemovalCheck===void 0&&(this.requiresCopiedPackRemovalCheck=!1),this.respawnBlocksExplode===void 0&&(this.respawnBlocksExplode=!0),this.sendCommandFeedback===void 0&&(this.sendCommandFeedback=!0),this.serverChunkTickRange===void 0&&(this.serverChunkTickRange=4),this.showBorderEffect===void 0&&(this.showBorderEffect=!0),this.showCoordinates===void 0&&(this.showCoordinates=!1),this.showDeathMessages===void 0&&(this.showDeathMessages=!0),this.showTags===void 0&&(this.showTags=!0),this.spawnMobs===void 0&&(this.spawnMobs=!0),this.spawnRadius===void 0&&(this.spawnRadius=5),this.startWithMapEnabled===void 0&&(this.startWithMapEnabled=!1),this.texturePacksRequired===void 0&&(this.texturePacksRequired=!1),this.tntExplodes===void 0&&(this.tntExplodes=!0),this.useMsaGamertagsOnly===void 0&&(this.useMsaGamertagsOnly=!1),this.worldStartCount===void 0&&(this.worldStartCount=BigInt(4294967294)),this.attackMobs===void 0&&(this.attackMobs=!0),this.attackPlayers===void 0&&(this.attackPlayers=!0),this.build===void 0&&(this.build=!0),this.doorsAndSwitches===void 0&&(this.doorsAndSwitches=!0),this.flySpeed===void 0&&(this.flySpeed=.5),this.flying===void 0&&(this.flying=!1),this.instaBuild===void 0&&(this.instaBuild=!1),this.invulnerable===void 0&&(this.invulnerable=!1),this.lightning===void 0&&(this.lightning=!1),this.mayFly===void 0&&(this.mayFly=!1),this.mine===void 0&&(this.mine=!0),this.op===void 0&&(this.op=!1),this.openContainers===void 0&&(this.openContainers=!0),this.teleport===void 0&&(this.teleport=!0),this.walkSpeed===void 0&&(this.walkSpeed=.1)}applyFromWorldSettings(e){e.generator!==void 0&&(this.generator=e.generator),e.gameType!==void 0&&(this.gameType=e.gameType),e.difficulty!==void 0&&(this.difficulty=e.difficulty),e.commandsEnabled!==void 0&&(this.commandsEnabled=e.commandsEnabled),e.cheatsEnabled!==void 0&&(this.cheatsEnabled=e.cheatsEnabled),e.randomSeed!==void 0&&(this.randomSeed=e.randomSeed),e.name!==void 0&&(this.levelName=e.name),e.lastPlayed!==void 0&&(this.lastPlayed=BigInt(e.lastPlayed)),e.isEditor?(this.isCreatedInEditor=!0,this.editorWorldType=1):e.isEditor===!1&&(this.isCreatedInEditor=!1,this.editorWorldType=void 0),e.betaApisExperiment===!0?this.betaApisExperiment=e.betaApisExperiment:e.betaApisExperiment===!1&&(this.betaApisExperiment=!1),e.deferredTechnicalPreviewExperiment===!0?this.deferredTechnicalPreviewExperiment=e.deferredTechnicalPreviewExperiment:e.deferredTechnicalPreviewExperiment===!1&&(this.deferredTechnicalPreviewExperiment=!1)}_saveToNbt(e){let t=e.ensureSingleRoot();if(t==null)return;if(this.biomeOverride!==void 0&&(t.ensureTag("BiomeOverride",8).value=this.biomeOverride),this.centerMapsToOrigin!==void 0&&(t.ensureTag("CenterMapsToOrigin",1).value=this.centerMapsToOrigin),this.confirmedPlatformLockedContent!==void 0&&(t.ensureTag("ConfirmedPlatformLockedContent",1).value=this.confirmedPlatformLockedContent),this.difficulty!==void 0&&(t.ensureTag("Difficulty",3).value=this.difficulty),this.flatWorldLayers!==void 0&&(t.ensureTag("FlatWorldLayers",8).value=JSON.stringify(this.flatWorldLayers).trim()),this.forceGameType!==void 0&&(t.ensureTag("ForceGameType",1).value=this.forceGameType),this.gameType!==void 0&&(t.ensureTag("GameType",3).value=this.gameType),this.generator!==void 0&&(t.ensureTag("Generator",3).value=this.generator),this.inventoryVersion!==void 0&&(t.ensureTag("InventoryVersion",8).value=this.inventoryVersion),this.lanBroadcast!==void 0&&(t.ensureTag("LANBroadcast",1).value=this.lanBroadcast),this.lanBroadcastIntent!==void 0&&(t.ensureTag("LANBroadcastIntent",1).value=this.lanBroadcastIntent),this.lastPlayed!==void 0&&(t.ensureTag("LastPlayed",4).value=this.lastPlayed),this.levelName!==void 0&&(t.ensureTag("LevelName",8).value=this.levelName),this.limitedWorldOriginX!==void 0&&(t.ensureTag("LimitedWorldOriginX",3).value=this.limitedWorldOriginX),this.limitedWorldOriginY!==void 0&&(t.ensureTag("LimitedWorldOriginY",3).value=this.limitedWorldOriginY),this.limitedWorldOriginZ!==void 0&&(t.ensureTag("LimitedWorldOriginZ",3).value=this.limitedWorldOriginZ),this.minimumCompatibleClientVersion&&this.minimumCompatibleClientVersion.length>0&&t.ensureTag("MinimumCompatibleClientVersion",9).setListFromArray(this.minimumCompatibleClientVersion),this.multiplayerGame!==void 0&&(t.ensureTag("MultiplayerGame",1).value=this.multiplayerGame),this.multiplayerGameIntent!==void 0&&(t.ensureTag("MultiplayerGameIntent",1).value=this.multiplayerGameIntent),this.netherScale!==void 0&&(t.ensureTag("NetherScale",3).value=this.netherScale),this.networkVersion!==void 0&&(t.ensureTag("NetworkVersion",3).value=this.networkVersion),this.platform!==void 0&&(t.ensureTag("Platform",3).value=this.platform),this.platformBroadcastIntent!==void 0&&(t.ensureTag("PlatformBroadcastIntent",3).value=this.platformBroadcastIntent),this.randomSeed!==void 0)try{let n=BigInt(this.randomSeed);t.ensureTag("RandomSeed",4).value=n}catch{C.debugAlert("Could not set seed: "+this.randomSeed)}this.spawnV1Villagers!==void 0&&(t.ensureTag("SpawnV1Villagers",1).value=this.spawnV1Villagers),this.spawnX!==void 0&&(t.ensureTag("SpawnX",3).value=this.spawnX),this.spawnY!==void 0&&(t.ensureTag("SpawnY",3).value=this.spawnY),this.spawnZ!==void 0&&(t.ensureTag("SpawnZ",3).value=this.spawnZ),this.storageVersion!==void 0&&(t.ensureTag("StorageVersion",3).value=this.storageVersion),this.time!==void 0&&(t.ensureTag("Time",4).value=this.time),this.worldVersion!==void 0&&(t.ensureTag("WorldVersion",3).value=this.worldVersion),this.xblBroadcastIntent!==void 0&&(t.ensureTag("XBLBroadcastIntent",3).value=this.xblBroadcastIntent);let i=t.ensureTag("abilities",10);if(this.attackMobs!==void 0&&(i.ensureTag("attackmobs",1).value=this.attackMobs),this.attackPlayers!==void 0&&(i.ensureTag("attackplayers",1).value=this.attackPlayers),this.build!==void 0&&(i.ensureTag("build",1).value=this.build),this.doorsAndSwitches!==void 0&&(i.ensureTag("doorsandswitches",1).value=this.doorsAndSwitches),this.flySpeed!==void 0&&(i.ensureTag("flySpeed",5).value=this.flySpeed),this.flying!==void 0&&(i.ensureTag("flying",1).value=this.flying),this.instaBuild!==void 0&&(i.ensureTag("instabuild",1).value=this.instaBuild),this.invulnerable!==void 0&&(i.ensureTag("invulnerable",1).value=this.invulnerable),this.lightning!==void 0&&(i.ensureTag("lightning",1).value=this.lightning),this.mayFly!==void 0&&(i.ensureTag("mayfly",1).value=this.mayFly),this.mine!==void 0&&(i.ensureTag("mine",1).value=this.mine),this.op!==void 0&&(i.ensureTag("op",1).value=this.op),this.openContainers!==void 0&&(i.ensureTag("opencontainers",1).value=this.openContainers),this.teleport!==void 0&&(i.ensureTag("teleport",1).value=this.teleport),this.walkSpeed!==void 0&&(i.ensureTag("walkSpeed",5).value=this.walkSpeed),this.baseGameVersion!==void 0&&(t.ensureTag("baseGameVersion",8).value=this.baseGameVersion),this.bonusChestEnabled!==void 0&&(t.ensureTag("bonusChestEnabled",1).value=this.bonusChestEnabled),this.bonusChestSpawned!==void 0&&(t.ensureTag("bonusChestSpawned",1).value=this.bonusChestSpawned),this.cheatsEnabled!==void 0&&(t.ensureTag("cheatsEnabled",1).value=this.cheatsEnabled),this.commandBlockOutput!==void 0&&(t.ensureTag("commandblockoutput",1).value=this.commandBlockOutput),this.commandBlocksEnabled!==void 0&&(t.ensureTag("commandblocksenabled",1).value=this.commandBlocksEnabled),this.commandsEnabled!==void 0&&(t.ensureTag("commandsEnabled",1).value=this.commandsEnabled),this.currentTick!==void 0&&(t.ensureTag("currentTick",4).value=this.currentTick),this.daylightCycle!==void 0&&(t.ensureTag("daylightCycle",3).value=this.daylightCycle),this.doDaylightCycle!==void 0&&(t.ensureTag("dodaylightcycle",1).value=this.doDaylightCycle),this.doEntityDrops!==void 0&&(t.ensureTag("doentitydrops",1).value=this.doEntityDrops),this.doFireTick!==void 0&&(t.ensureTag("dofiretick",1).value=this.doFireTick),this.doImmediateRespawn!==void 0&&(t.ensureTag("doimmediaterespawn",1).value=this.doImmediateRespawn),this.doInsomnia!==void 0&&(t.ensureTag("doinsomnia",1).value=this.doInsomnia),this.doMobLoot!==void 0&&(t.ensureTag("domobloot",1).value=this.doMobLoot),this.doMobSpawning!==void 0&&(t.ensureTag("domobspawning",1).value=this.doMobSpawning),this.doTileDrops!==void 0&&(t.ensureTag("dotiledrops",1).value=this.doTileDrops),this.doWeatherCycle!==void 0&&(t.ensureTag("doweathercycle",1).value=this.doWeatherCycle),this.drowningDamage!==void 0&&(t.ensureTag("drowningdamage",1).value=this.drowningDamage),this.eduOffer!==void 0&&(t.ensureTag("eduOffer",3).value=this.eduOffer),this.educationFeaturesEnabled!==void 0&&(t.ensureTag("educationFeaturesEnabled",1).value=this.educationFeaturesEnabled),this.betaApisExperiment||this.dataDrivenItemsExperiment||this.deferredTechnicalPreviewExperiment||this.savedWithToggledExperiments||this.experimentsEverUsed){let n=t.ensureTag("experiments",10);this.betaApisExperiment?n.ensureTag("gametest",1).value=1:n.removeTag("gametest"),this.dataDrivenItemsExperiment?n.ensureTag("data_driven_items",1).value=1:n.removeTag("data_driven_items"),this.deferredTechnicalPreviewExperiment?n.ensureTag("deferred_technical_preview",1).value=1:n.removeTag("deferred_technical_preview"),this.savedWithToggledExperiments!==void 0&&(n.ensureTag("saved_with_toggled_experiments",1).value=this.savedWithToggledExperiments),this.experimentsEverUsed!==void 0&&(n.ensureTag("experiments_ever_used",1).value=this.experimentsEverUsed)}this.fallDamage!==void 0&&(t.ensureTag("falldamage",1).value=this.fallDamage),this.fireDamage!==void 0&&(t.ensureTag("firedamage",1).value=this.fireDamage),this.freezeDamage!==void 0&&(t.ensureTag("freezedamage",1).value=this.freezeDamage),this.functionCommandLimit!==void 0&&(t.ensureTag("functioncommandlimit",3).value=this.functionCommandLimit),this.hasBeenLoadedInCreative!==void 0&&(t.ensureTag("hasBeenLoadedInCreative",1).value=this.hasBeenLoadedInCreative),this.hasLockedBehaviorPack!==void 0&&(t.ensureTag("hasLockedBehaviorPack",1).value=this.hasLockedBehaviorPack),this.hasLockedResourcePack!==void 0&&(t.ensureTag("hasLockedResourcePack",1).value=this.hasLockedResourcePack),this.immutableWorld!==void 0&&(t.ensureTag("immutableWorld",1).value=this.immutableWorld),this.isCreatedInEditor!==void 0&&(t.ensureTag("isCreatedInEditor",1).value=this.isCreatedInEditor),this.editorWorldType!==void 0&&(t.ensureTag("editorWorldType",1).value=this.editorWorldType),this.isExportedFromEditor!==void 0&&(t.ensureTag("isExportedFromEditor",1).value=this.isExportedFromEditor),this.isFromLockedTemplate!==void 0&&(t.ensureTag("isFromLockedTemplate",1).value=this.isFromLockedTemplate),this.isFromWorldTemplate!==void 0&&(t.ensureTag("isFromWorldTemplate",1).value=this.isFromWorldTemplate),this.isRandomSeedAllowed!==void 0&&(t.ensureTag("isRandomSeedAllowed",1).value=this.isRandomSeedAllowed),this.isSingleUseWorld!==void 0&&(t.ensureTag("isSingleUseWorld",1).value=this.isSingleUseWorld),this.isWorldTemplateOptionLocked!==void 0&&(t.ensureTag("isWorldTemplateOptionLocked",1).value=this.isWorldTemplateOptionLocked),this.keepInventory!==void 0&&(t.ensureTag("keepinventory",1).value=this.keepInventory),this.lastOpenedWithVersion&&this.lastOpenedWithVersion.length>0&&t.ensureTag("lastOpenedWithVersion",9).setListFromArray(this.lastOpenedWithVersion),this.lightningLevel!==void 0&&(t.ensureTag("lightningLevel",5).value=this.lightningLevel),this.lightningTime!==void 0&&(t.ensureTag("lightningTime",3).value=this.lightningTime),this.limitedWorldDepth!==void 0&&(t.ensureTag("limitedWorldDepth",3).value=this.limitedWorldDepth),this.limitedWorldWidth!==void 0&&(t.ensureTag("limitedWorldWidth",3).value=this.limitedWorldWidth),this.maxCommandChainLength!==void 0&&(t.ensureTag("maxcommandchainlength",3).value=this.maxCommandChainLength),this.mobGriefing!==void 0&&(t.ensureTag("mobgriefing",1).value=this.mobGriefing),this.naturalRegeneration!==void 0&&(t.ensureTag("naturalregeneration",1).value=this.naturalRegeneration),this.permissionsLevel!==void 0&&(t.ensureTag("permissionsLevel",3).value=this.permissionsLevel),this.playerPermissionsLevel!==void 0&&(t.ensureTag("playerPermissionsLevel",3).value=this.playerPermissionsLevel),this.prid!==void 0&&(t.ensureTag("prid",8).value=this.prid),this.pvp!==void 0&&(t.ensureTag("pvp",1).value=this.pvp),this.rainLevel!==void 0&&(t.ensureTag("rainLevel",5).value=this.rainLevel),this.rainTime!==void 0&&(t.ensureTag("rainTime",3).value=this.rainTime),this.randomTickSpeed!==void 0&&(t.ensureTag("randomtickspeed",3).value=this.randomTickSpeed),this.requiresCopiedPackRemovalCheck!==void 0&&(t.ensureTag("requiresCopiedPackRemovalCheck",1).value=this.requiresCopiedPackRemovalCheck),this.respawnBlocksExplode!==void 0&&(t.ensureTag("respawnblocksexplode",1).value=this.respawnBlocksExplode),this.sendCommandFeedback!==void 0&&(t.ensureTag("sendcommandfeedback",1).value=this.sendCommandFeedback),this.serverChunkTickRange!==void 0&&(t.ensureTag("serverChunkTickRange",3).value=this.serverChunkTickRange),this.showBorderEffect!==void 0&&(t.ensureTag("showbordereffect",1).value=this.showBorderEffect),this.showCoordinates!==void 0&&(t.ensureTag("showcoordinates",1).value=this.showCoordinates),this.showDeathMessages!==void 0&&(t.ensureTag("showdeathmessages",1).value=this.showDeathMessages),this.showTags!==void 0&&(t.ensureTag("showtags",1).value=this.showTags),this.spawnMobs!==void 0&&(t.ensureTag("spawnMobs",1).value=this.spawnMobs),this.spawnRadius!==void 0&&(t.ensureTag("spawnradius",3).value=this.spawnRadius),this.startWithMapEnabled!==void 0&&(t.ensureTag("startWithMapEnabled",1).value=this.startWithMapEnabled),this.texturePacksRequired!==void 0&&(t.ensureTag("texturePacksRequired",1).value=this.texturePacksRequired),this.tntExplodes!==void 0&&(t.ensureTag("tntexplodes",1).value=this.tntExplodes),this.useMsaGamertagsOnly!==void 0&&(t.ensureTag("useMsaGamertagsOnly",1).value=this.useMsaGamertagsOnly),this.worldStartCount!==void 0&&(t.ensureTag("worldStartCount",4).value=this.worldStartCount)}loadFromNbt(e){if(this.nbt=e,e.singleRoot==null)return;let t=e.singleRoot,i=t.find("LevelName");if(i!==null&&(this.levelName=i.valueAsString),i=t.find("SpawnX"),i!==null&&(this.spawnX=i.valueAsInt),i=t.find("SpawnY"),i!==null&&(this.spawnY=i.valueAsInt),i=t.find("SpawnZ"),i!==null&&(this.spawnZ=i.valueAsInt),i=t.find("editorWorldType"),i!==null&&(this.editorWorldType=i.valueAsInt),i=t.find("GameType"),i!==null&&(this.gameType=i.valueAsInt),i=t.find("Generator"),i!==null&&(this.generator=i.valueAsInt),i=t.find("commandsEnabled"),i!==null&&(this.commandsEnabled=i.valueAsBoolean),i=t.find("cheatsEnabled"),i!==null&&(this.cheatsEnabled=i.valueAsBoolean),i=t.find("commandsblocksenabled"),i!==null&&(this.commandBlocksEnabled=i.valueAsBoolean),i=t.find("experimentalgameplay"),i!==null&&(this.experimentalGameplay=i.valueAsBoolean),i=t.find("BiomeOverride"),i!==null&&(this.biomeOverride=i.valueAsString),i=t.find("CenterMapsToOrigin"),i!==null&&(this.centerMapsToOrigin=i.valueAsBoolean),i=t.find("ConfirmedPlatformLockedComponent"),i!==null&&(this.confirmedPlatformLockedContent=i.valueAsBoolean),i=t.find("Difficulty"),i!==null&&(this.difficulty=i.valueAsInt),i=t.find("FlatWorldLayers"),i!==null&&(this.flatWorldLayers=i.valueAsJSONObject),i=t.find("ForceGameType"),i!==null&&(this.forceGameType=i.valueAsBoolean),i=t.find("InventoryVersion"),i!==null&&(this.inventoryVersion=i.valueAsString),i=t.find("LANBroadcast"),i!==null&&(this.lanBroadcast=i.valueAsBoolean),i=t.find("LANBroadcastIntent"),i!==null&&(this.lanBroadcastIntent=i.valueAsBoolean),i=t.find("LastPlayed"),i!==null&&(this.lastPlayed=i.valueAsBigInt),i=t.find("LimitedWorldOriginX"),i!==null&&(this.limitedWorldOriginX=i.valueAsInt),i=t.find("LimitedWorldOriginY"),i!==null&&(this.limitedWorldOriginY=i.valueAsInt),i=t.find("LimitedWorldOriginZ"),i!==null&&(this.limitedWorldOriginZ=i.valueAsInt),i=t.find("MinimumCompatibleClientVersion"),i!==null&&(this.minimumCompatibleClientVersion=i.valueAsNumericArray),i=t.find("lastOpenedWithVersion"),i!==null&&(this.lastOpenedWithVersion=i.valueAsNumericArray),i=t.find("MultiplayerGame"),i!==null&&(this.multiplayerGame=i.valueAsBoolean),i=t.find("MultiplayerGameIntent"),i!==null&&(this.multiplayerGameIntent=i.valueAsBoolean),i=t.find("NetherScale"),i!==null&&(this.netherScale=i.valueAsInt),i=t.find("NetworkVersion"),i!==null&&(this.networkVersion=i.valueAsInt),i=t.find("Platform"),i!==null&&(this.platform=i.valueAsInt),i=t.find("PlatformBroadcastIntent"),i!==null&&(this.platformBroadcastIntent=i.valueAsInt),i=t.find("RandomSeed"),i!==null&&(this.randomSeed=i.valueAsBigInt.toString()),i=t.find("SpawnV1Villagers"),i!==null&&(this.spawnV1Villagers=i.valueAsBoolean),i=t.find("StorageVersion"),i!==null&&(this.storageVersion=i.valueAsInt),i=t.find("Time"),i!==null&&(this.time=i.valueAsBigInt),i=t.find("WorldVersion"),i!==null&&(this.worldVersion=i.valueAsInt),i=t.find("XBLBroadcastIntent"),i!==null&&(this.xblBroadcastIntent=i.valueAsInt),i=t.find("baseGameVersion"),i!==null&&(this.baseGameVersion=i.valueAsString),i=t.find("bonusChestEnabled"),i!==null&&(this.bonusChestEnabled=i.valueAsBoolean),i=t.find("bonusChestSpawned"),i!==null&&(this.bonusChestSpawned=i.valueAsBoolean),i=t.find("commandblockoutput"),i!==null&&(this.commandBlockOutput=i.valueAsBoolean),i=t.find("MultiplayerGame"),i!==null&&(this.multiplayerGame=i.valueAsBoolean),i=t.find("currentTick"),i!==null&&(this.currentTick=i.valueAsBigInt),i=t.find("dodaylightcycle"),i!==null&&(this.doDaylightCycle=i.valueAsBoolean),i=t.find("daylightCycle"),i!==null&&(this.daylightCycle=i.valueAsInt),i=t.find("doentitydrops"),i!==null&&(this.doEntityDrops=i.valueAsBoolean),i=t.find("dofiretick"),i!==null&&(this.doFireTick=i.valueAsBoolean),i=t.find("doimmediaterespawn"),i!==null&&(this.doImmediateRespawn=i.valueAsBoolean),i=t.find("doinsomnia"),i!==null&&(this.doInsomnia=i.valueAsBoolean),i=t.find("domobloot"),i!==null&&(this.doMobLoot=i.valueAsBoolean),i=t.find("domobspawning"),i!==null&&(this.doMobSpawning=i.valueAsBoolean),i=t.find("dotiledrops"),i!==null&&(this.doTileDrops=i.valueAsBoolean),i=t.find("doweathercycle"),i!==null&&(this.doWeatherCycle=i.valueAsBoolean),i=t.find("drowningdamage"),i!==null&&(this.drowningDamage=i.valueAsBoolean),i=t.find("eduOffer"),i!==null&&(this.eduOffer=i.valueAsInt),i=t.find("educationFeaturesEnabled"),i!==null&&(this.educationFeaturesEnabled=i.valueAsBoolean),i=t.find("falldamage"),i!==null&&(this.fallDamage=i.valueAsBoolean),i=t.find("freezedamage"),i!==null&&(this.freezeDamage=i.valueAsBoolean),i=t.find("functioncommandlimit"),i!==null&&(this.functionCommandLimit=i.valueAsInt),i=t.find("hasBeenLoadedInCreative"),i!==null&&(this.hasBeenLoadedInCreative=i.valueAsBoolean),i=t.find("hasLockedBehaviorPack"),i!==null&&(this.hasLockedBehaviorPack=i.valueAsBoolean),i=t.find("hasLockedResourcePack"),i!==null&&(this.hasLockedResourcePack=i.valueAsBoolean),i=t.find("immutableWorld"),i!==null&&(this.immutableWorld=i.valueAsBoolean),i=t.find("isFromLockedTemplate"),i!==null&&(this.isFromLockedTemplate=i.valueAsBoolean),i=t.find("isRandomSeedAllowed"),i!==null&&(this.isRandomSeedAllowed=i.valueAsBoolean),i=t.find("isCreatedInEditor"),i!==null&&(this.isCreatedInEditor=i.valueAsBoolean),i=t.find("isExportedFromEditor"),i!==null&&(this.isExportedFromEditor=i.valueAsBoolean),i=t.find("isFromWorldTemplate"),i!==null&&(this.isFromWorldTemplate=i.valueAsBoolean),i=t.find("isSingleUseWorld"),i!==null&&(this.isSingleUseWorld=i.valueAsBoolean),i=t.find("isWorldTemplateOptionLocked"),i!==null&&(this.isWorldTemplateOptionLocked=i.valueAsBoolean),i=t.find("keepinventory"),i!==null&&(this.keepInventory=i.valueAsBoolean),i=t.find("lightningTime"),i!==null&&(this.lightningTime=i.valueAsInt),i=t.find("lightningLevel"),i!==null&&(this.lightningLevel=i.valueAsFloat),i=t.find("limitedWorldDepth"),i!==null&&(this.limitedWorldDepth=i.valueAsInt),i=t.find("limitedWorldWidth"),i!==null&&(this.limitedWorldWidth=i.valueAsInt),i=t.find("maxcommandchainlength"),i!==null&&(this.maxCommandChainLength=i.valueAsInt),i=t.find("mobgriefing"),i!==null&&(this.mobGriefing=i.valueAsBoolean),i=t.find("naturalregeneration"),i!==null&&(this.naturalRegeneration=i.valueAsBoolean),i=t.find("permissionsLevel"),i!==null&&(this.permissionsLevel=i.valueAsInt),i=t.find("playerPermissionsLevel"),i!==null&&(this.playerPermissionsLevel=i.valueAsInt),i=t.find("prid"),i!==null&&(this.prid=i.valueAsString),i=t.find("pvp"),i!==null&&(this.pvp=i.valueAsBoolean),i=t.find("rainLevel"),i!==null&&(this.rainLevel=i.valueAsFloat),i=t.find("rainTime"),i!==null&&(this.rainTime=i.valueAsInt),i=t.find("randomtickspeed"),i!==null&&(this.randomTickSpeed=i.valueAsInt),i=t.find("requiresCopiedPackRemovalCheck"),i!==null&&(this.requiresCopiedPackRemovalCheck=i.valueAsBoolean),i=t.find("respawnblocksexplode"),i!==null&&(this.respawnBlocksExplode=i.valueAsBoolean),i=t.find("sendcommandfeedback"),i!==null&&(this.sendCommandFeedback=i.valueAsBoolean),i=t.find("serverChunkTickRange"),i!==null&&(this.serverChunkTickRange=i.valueAsInt),i=t.find("showbordereffect"),i!==null&&(this.showBorderEffect=i.valueAsBoolean),i=t.find("showcoordinates"),i!==null&&(this.showCoordinates=i.valueAsBoolean),i=t.find("showdeathmessages"),i!==null&&(this.showDeathMessages=i.valueAsBoolean),i=t.find("showtags"),i!==null&&(this.showTags=i.valueAsBoolean),i=t.find("spawnMobs"),i!==null&&(this.spawnMobs=i.valueAsBoolean),i=t.find("spawnradius"),i!==null&&(this.spawnRadius=i.valueAsInt),i=t.find("startWithMapEnabled"),i!==null&&(this.startWithMapEnabled=i.valueAsBoolean),i=t.find("texturePacksRequired"),i!==null&&(this.texturePacksRequired=i.valueAsBoolean),i=t.find("tntexplodes"),i!==null&&(this.tntExplodes=i.valueAsBoolean),i=t.find("useMsaGamertagsOnly"),i!==null&&(this.useMsaGamertagsOnly=i.valueAsBoolean),i=t.find("worldStartCount"),i!==null&&(this.worldStartCount=i.valueAsBigInt),i=t.find("abilities"),i!==null){let n=i.find("attackmobs");n&&(this.attackMobs=n.valueAsBoolean);let s=i.find("attackplayers");s&&(this.attackPlayers=s.valueAsBoolean);let o=i.find("build");o&&(this.build=o.valueAsBoolean);let a=i.find("doorsandswitches");a&&(this.doorsAndSwitches=a.valueAsBoolean);let l=i.find("flySpeed");l&&(this.flySpeed=l.valueAsFloat);let u=i.find("flying");u&&(this.flying=u.valueAsBoolean);let c=i.find("instabuild");c&&(this.instaBuild=c.valueAsBoolean);let d=i.find("invulnerable");d&&(this.invulnerable=d.valueAsBoolean);let h=i.find("lightning");h&&(this.lightning=h.valueAsBoolean);let f=i.find("mayfly");f&&(this.mayFly=f.valueAsBoolean);let m=i.find("mine");m&&(this.mine=m.valueAsBoolean);let p=i.find("op");p&&(this.op=p.valueAsBoolean);let g=i.find("opencontainers");g&&(this.openContainers=g.valueAsBoolean);let b=i.find("teleport");b&&(this.teleport=b.valueAsBoolean);let F=i.find("walkSpeed");F&&(this.walkSpeed=F.valueAsFloat)}if(i=t.find("experiments"),this.betaApisExperiment=void 0,this.dataDrivenItemsExperiment=void 0,i!==null){let n=i.find("gametest");n!==null&&n.valueAsInt===1?this.betaApisExperiment=!0:this.betaApisExperiment=!1;let s=i.find("data_driven_items");s!==null&&s.valueAsInt===1?this.dataDrivenItemsExperiment=!0:this.dataDrivenItemsExperiment=!1;let o=i.find("experiments_ever_used");o!==null?this.experimentsEverUsed=o.valueAsBoolean:this.experimentsEverUsed=!1;let a=i.find("saved_with_toggled_experiments");a!==null?this.savedWithToggledExperiments=a.valueAsBoolean:this.savedWithToggledExperiments=!1}}};var hl=class{constructor(){this.blocks=[]}parseFromBytes(e,t,i){for(let n=0;n<i;n++){let s=new ti;if(t+=s.fromBinary(e,!0,!1,t,!0),C.assert(t<=e.length,"Unexpected expansion of bytes processed."),s.singleRoot===null)return t;let o=s.singleRoot.getTagChildren(),a=null;for(let l=0;l<o.length;l++){let u=o[l];u.name==="name"?(a=new ui,a.typeName=u.valueAsString,this.blocks.push(a)):u.name}}return t}};var At=class{constructor(e){this.rootTag=e;let t=this.rootTag.find("x");t!==null&&(this.x=t.valueAsInt),t=this.rootTag.find("y"),t!==null&&(this.y=t.valueAsInt),t=this.rootTag.find("z"),t!==null&&(this.z=t.valueAsInt),t=this.rootTag.find("id"),t!==null&&(this.id=t.valueAsString),t=this.rootTag.find("isMovable"),t&&(this.isMovable=t.valueAsBoolean)}};var Is=class extends At{load(){}};var pl=class extends At{constructor(){super(...arguments);this.items=[]}load(){if(!this.rootTag)return;let t=this.rootTag.find("Findable");if(t&&(this.findable=t.valueAsBoolean),t=this.rootTag.find("Items"),t!==null){let i=t.getTagChildren();this.items=[];for(let n=0;n<i.length;n++){let s=i[n],o=s.find("Count"),a=s.find("Damage"),l=s.find("Name"),u=s.find("Slot"),c=s.find("WasPickedUp");o&&a&&l&&u&&c&&this.items.push({count:o.valueAsInt,damage:a.valueAsInt,name:l.valueAsString,slot:u.valueAsInt,wasPickedUp:c.valueAsBoolean})}}}};var ml=class extends At{load(){if(!this.rootTag)return;let e=this.rootTag.find("color");e&&(this.color=e.valueAsBoolean)}};var gl=class extends At{load(){if(!this.rootTag)return;let e=this.rootTag.find("ItemDropChance");if(e&&(this.itemDropChance=e.valueAsFloat),e=this.rootTag.find("ItemRotation"),e&&(this.itemRotation=e.valueAsFloat),e=this.rootTag.find("Item"),e!==null){let t=e.getTagChildren();for(let i=0;i<t.length;i++){let n=t[i],s=n.find("Count"),o=n.find("Damage"),a=n.find("Name"),l=n.find("WasPickedUp");s&&o&&a&&l&&(this.item={count:s.valueAsInt,damage:o.valueAsInt,name:a.valueAsString,wasPickedUp:l.valueAsBoolean})}}}};var bl=class extends At{load(){if(!this.rootTag)return;let e=this.rootTag.find("note");e&&(this.note=e.valueAsBoolean)}};var yl=class extends At{load(){if(!this.rootTag)return;let e=this.rootTag.find("IgnoreLighting");e&&(this.ignoreLighting=e.valueAsBoolean),e=this.rootTag.find("PersistFormatting"),e&&(this.persistFormatting=e.valueAsBoolean),e=this.rootTag.find("SignTextColor"),e&&(this.signTextColor=e.valueAsInt),e=this.rootTag.find("Text"),e&&(this.text=e.valueAsString),e=this.rootTag.find("TextOwner"),e&&(this.textOwner=e.valueAsString),e=this.rootTag.find("TextIgnoreLegacyBugResolved"),e&&(this.textIgnoreLegacyBugResolved=e.valueAsBoolean),e=this.rootTag.find("IsMovable"),e&&(this.isMovable=e.valueAsBoolean)}};var vl=class extends At{load(){if(!this.rootTag)return;let e=this.rootTag.find("animationMode");e&&(this.animationMode=e.valueAsBoolean),e=this.rootTag.find("animationSeconds"),e&&(this.animationSeconds=e.valueAsFloat),e=this.rootTag.find("data"),e&&(this.data=e.valueAsInt),e=this.rootTag.find("dataField"),e&&(this.dataField=e.valueAsString),e=this.rootTag.find("ignoreEntities"),e&&(this.ignoreEntities=e.valueAsBoolean),e=this.rootTag.find("includePlayers"),e&&(this.includePlayers=e.valueAsBoolean),e=this.rootTag.find("integrity"),e&&(this.integrity=e.valueAsFloat),e=this.rootTag.find("isPowered"),e&&(this.isMovable=e.valueAsBoolean),e=this.rootTag.find("mirror"),e&&(this.mirror=e.valueAsBoolean),e=this.rootTag.find("redstoneSaveMode"),e&&(this.redstoneSaveMode=e.valueAsInt),e=this.rootTag.find("removeBlocks"),e&&(this.removeBlocks=e.valueAsBoolean),e=this.rootTag.find("rotation"),e&&(this.rotation=e.valueAsBoolean),e=this.rootTag.find("seed"),e&&(this.seed=e.valueAsBigInt),e=this.rootTag.find("showBoundingBox"),e&&(this.showBoundingBox=e.valueAsBoolean),e=this.rootTag.find("structureName"),e&&(this.structureName=e.valueAsString),e=this.rootTag.find("xStructureOffset"),e&&(this.xStructureOffset=e.valueAsInt),e=this.rootTag.find("xStructureSize"),e&&(this.xStructureSize=e.valueAsInt),e=this.rootTag.find("yStructureOffset"),e&&(this.yStructureOffset=e.valueAsInt),e=this.rootTag.find("yStructureSize"),e&&(this.yStructureSize=e.valueAsInt),e=this.rootTag.find("zStructureOffset"),e&&(this.zStructureOffset=e.valueAsInt),e=this.rootTag.find("zStructureSize"),e&&(this.zStructureSize=e.valueAsInt)}};var wl=class extends At{constructor(){super(...arguments);this.items=[]}load(){if(!this.rootTag)return;let t=this.rootTag.find("PotionId");if(t&&(this.potionId=t.valueAsInt),t=this.rootTag.find("PotionType"),t&&(this.potionType=t.valueAsInt),t=this.rootTag.find("Items"),t!==null){let i=t.getTagChildren();this.items=[];for(let n=0;n<i.length;n++){let s=i[n],o=s.find("Count"),a=s.find("Damage"),l=s.find("Name"),u=s.find("Slot"),c=s.find("WasPickedUp");o&&a&&l&&u&&c&&this.items.push({count:o.valueAsInt,damage:a.valueAsInt,name:l.valueAsString,slot:u.valueAsInt,wasPickedUp:c.valueAsBoolean})}}}};var _l=class extends At{load(){if(!this.rootTag)return;let e=this.rootTag.find("itemTime1");e&&(this.itemTime1=e.valueAsInt),e=this.rootTag.find("itemTime2"),e&&(this.itemTime2=e.valueAsInt),e=this.rootTag.find("itemTime3"),e&&(this.itemTime3=e.valueAsInt),e=this.rootTag.find("itemTime4"),e&&(this.itemTime4=e.valueAsInt)}};var Fl=class extends At{load(){if(!this.rootTag)return;let e=this.rootTag.find("shouldSpawnBees");e&&(this.shouldSpawnBees=e.valueAsBoolean)}};var xs=class extends At{load(){if(!this.rootTag)return;let e=this.rootTag.find("Command");e&&(this.command=e.valueAsString),e=this.rootTag.find("CustomName"),e&&(this.customName=e.valueAsString),e=this.rootTag.find("ExecuteOnFirstTick"),e&&(this.executeOnFirstTick=e.valueAsBoolean),e=this.rootTag.find("LPCommandMode"),e&&(this.lpCommandMode=e.valueAsInt),e=this.rootTag.find("LPCondionalMode"),e&&(this.lpConditionalMode=e.valueAsBoolean),e=this.rootTag.find("LPRedstoneMode"),e&&(this.lpRedstoneMode=e.valueAsBoolean),e=this.rootTag.find("LastExecution"),e&&(this.lastExecution=e.valueAsBigInt),e=this.rootTag.find("LastOutput"),e&&(this.lastOutput=e.valueAsString),e=this.rootTag.find("LastOutputParams"),e&&(this.lastOutputParams=e.valueAsStringArray),e=this.rootTag.find("SuccessCount"),e&&(this.successCount=e.valueAsInt),e=this.rootTag.find("TickDelay"),e&&(this.tickDelay=e.valueAsInt),e=this.rootTag.find("TrackOutput"),e&&(this.trackOutput=e.valueAsBoolean),e=this.rootTag.find("Version"),e&&(this.version=e.valueAsInt),e=this.rootTag.find("auto"),e&&(this.auto=e.valueAsBoolean),e=this.rootTag.find("powered"),e&&(this.powered=e.valueAsBoolean)}};var kl=class extends At{load(){if(!this.rootTag)return;let e=this.rootTag.find("Delay");e&&(this.delay=e.valueAsInt),e=this.rootTag.find("DisplayEntityType"),e&&(this.displayEntityHeight=e.valueAsFloat),e=this.rootTag.find("DisplayEntityScale"),e&&(this.displayEntityScale=e.valueAsFloat),e=this.rootTag.find("DisplayEntityWidth"),e&&(this.displayEntityWidth=e.valueAsFloat),e=this.rootTag.find("EntityIdentifier"),e&&(this.entityIdentifier=e.valueAsString),e=this.rootTag.find("MaxNearbyEntities"),e&&(this.maxNearbyEntities=e.valueAsInt),e=this.rootTag.find("MaxSpawnDelay"),e&&(this.maxSpawnDelay=e.valueAsInt),e=this.rootTag.find("MinSpawnDelay"),e&&(this.minSpawnDelay=e.valueAsInt),e=this.rootTag.find("RequiredPlayerRange"),e&&(this.requiredPlayerRange=e.valueAsInt),e=this.rootTag.find("SpawnCount"),e&&(this.spawnCount=e.valueAsInt),e=this.rootTag.find("SpawnRange"),e&&(this.spawnRange=e.valueAsInt)}};var Cl=class extends At{load(){if(!this.rootTag)return;let e=this.rootTag.find("CustomName");e&&(this.customName=e.valueAsString),e=this.rootTag.find("TransferCooldown"),e&&(this.transferCooldown=e.valueAsInt)}};var Sl=class extends At{load(){if(!this.rootTag)return;let e=this.rootTag.find("OutputSignal");e&&(this.outputSignal=e.valueAsInt)}};var Pl=class{static create(e,t){switch(e){case"minecraft:wall_sign":case"minecraft:standing_sign":case"Sign":case"HangingSign":return new yl(t);case"minecraft:structure_block":case"StructureBlock":return new vl(t);case"minecraft:ender_chest":case"minecraft:chest":case"minecraft:barrel":case"Barrel":case"Chest":case"EnderChest":return new pl(t);case"Cauldron":return new wl(t);case"minecraft:noteblock":case"Music":return new bl(t);case"minecraft:frame":case"ItemFrame":case"GlowItemFrame":return new gl(t);case"minecraft:spore_blossom":case"SporeBlossom":case"FlowerPot":case"EndPortal":case"Banner":case"EnchantTable":case"Lectern":case"BlastFurnace":case"Furnace":case"DaylightDetector":case"ShulkerBox":case"BrewingStand":case"Skull":case"Dropper":case"Dispenser":case"Bell":case"BrushableBlock":case"ChiseledBookshelf":case"SculkSensor":case"PistonArm":case"SculkShrieker":case"NetherReactor":case"SculkCatalyst":case"Lodestone":case"Beacon":case"Conduit":case"Jukebox":case"JigsawBlock":case"Smoker":case"ChalkboardBlock":case"ChemistryTable":case"CalibratedSculkSensor":case"DecoratedPot":case"SuspiciousSand":case"EndGateway":case"SuspiciousGravel":case"Piston":case"MovingBlock":case"Vault":return new Is(t);case"Bed":return new ml(t);case"Campfire":case"SoulCampfire":return new _l(t);case"Beehive":return new Fl(t);case"minecraft:chain_command_block":case"CommandBlock":return new xs(t);case"MobSpawner":case"mob_spawner":case"minecraft:mob_spawner":return new kl(t);case"Hopper":return new Cl(t);case"Comparator":return new Sl(t);default:C.debugAlert("Unexpected block actor type found '"+e+"'");return}}};var El=16,vn=16,gd=16,Rx=128;var To=class{constructor(e,t,i){this.blockActorKeys=[];this._blockActorsRelLoc=[];this._blockActors=[];this.blockActorsEnsured=!1;this.absoluteZeroY=-512;this.chunkMinY=0;this.x=0;this.z=0;this.maxSubChunkIndex=-512;this.minSubChunkIndex=512;this.world=e,this.subChunks=[],this.subChunkFormatType=[],this.blockPalettes=[],this.bitsPerBlock=[],this.blockDataStart=[],this.auxBlockPalettes=[],this.auxBitsPerBlock=[],this.auxBlockDataStart=[],this.pendingSubChunksToProcess=[],this.actorDigests=[];for(let n=0;n<64;n++)this.pendingSubChunksToProcess[n]=!1;this.x=t,this.z=i}get absoluteMinY(){return this.absoluteZeroY}get minY(){return this.absoluteZeroY+this.minSubChunkIndex*16}get maxY(){return this.absoluteZeroY+(this.maxSubChunkIndex+1)*16}get absoluteMaxY(){return this.absoluteZeroY+this.subChunks.length*16}get blockActors(){return this.blockActorsEnsured||this.ensureBlockActors(),this._blockActors}clearCachedData(){for(let e=0;e<64;e++)this.subChunks[e]!==void 0&&(this.blockDataStart[e]=-1,this.bitsPerBlock[e]=-1,this.blockPalettes[e]=void 0,this.pendingSubChunksToProcess[e]=!0);this.blockTops=void 0,this.blockActorsEnsured=!1,this._blockActorsRelLoc=[],this._blockActors=[]}addActorDigest(e){this.actorDigests.push(e)}translateSubChunkIndex(e){return C.assert(e>=0&&e<=31||e>=224&&e<=255,"Unexpected subchunk index ("+e+")"),e>=224?e-224:e+32}processSubChunk(e){this.pendingSubChunksToProcess[e]===!0&&(this.pendingSubChunksToProcess[e]=!1,this.parseSubChunk(e))}addKeyValue(e){let t=e.keyBytes;if(t){let i=t.length>=13?4:0,n=t[8+i];switch(n){case 43:if(C.assert(e.value!==void 0&&e.value.length>512,"Unexpected length for a type 43 record."),e.value){this.blockTops=[];for(let a=0;a<16;a++){let l=[];for(let u=0;u<16;u++){let c=e.value[u*32+a*2]+e.value[u*32+(a*2+1)]*256;l.push(c-65)}this.blockTops.push(l)}}break;case 115:break;case 118:C.assert(e.value!==void 0&&(e.value.length===0||e.value.length===1),"Unexpected type 118 record."),e.value&&e.value.length===1?this.legacyVersion=e.value[0]:e.value&&e.value.length===0&&(this.legacyVersion=void 0);break;case 44:this.chunkVersion=e;break;case 45:this.biomesAndElevation=e;break;case 46:break;case 47:let s=this.translateSubChunkIndex(t[9+i]);if(s<0){C.fail("Unexpected sub chunk index.");return}if(this.subChunks[s],!e.value||e.value.length<=0){C.assert(this.subChunks[s]===void 0,"Empty subchunk defined.");return}this.subChunks[s]=e,this.maxSubChunkIndex=Math.max(this.maxSubChunkIndex,s),this.minSubChunkIndex=Math.min(this.minSubChunkIndex,s),this.pendingSubChunksToProcess[s]=!0;break;case 48:let o=e.value;o&&o.length>0&&(C.assert(o.length===83200,"LegacyTerrain record should be 83,200 bytes"),this.legacyTerrainBytes=o);break;case 49:this.blockActorKeys.push(e),this.blockActorsEnsured=!1;break;case 50:this.entity=e;break;case 51:this.pendingTicks=e;break;case 52:break;case 53:this.biomeState=e;break;case 54:this.finalizedState=e;break;case 55:break;case 56:break;case 57:break;case 58:break;case 59:this.checksumKey=e;break;case 60:break;case 61:break;case 62:break;case 63:break;case 64:break;case 65:break;case 119:break;default:C.debugAlert("Unsupported chunk type: "+n)}}}clearKeyValue(e){if(e){let t=e.length>18||e.length===13||e.length===14?4:0,i=e.charCodeAt(8+t);switch(i){case 43:break;case 115:break;case 118:case 44:this.chunkVersion=void 0;break;case 45:this.biomesAndElevation=void 0;break;case 46:break;case 47:break;case 48:this.legacyTerrainBytes=void 0;break;case 49:break;case 50:this.entity=void 0;break;case 51:this.pendingTicks=void 0;break;case 52:break;case 53:this.biomeState=void 0;break;case 54:this.finalizedState=void 0;break;case 55:break;case 56:break;case 57:break;case 58:break;case 59:this.checksumKey=void 0;break;case 60:break;case 61:break;case 62:break;case 63:break;case 64:break;case 65:break;case 72:break;case 119:break;default:throw new Error("Unsupported chunk type: "+i)}}}ensureBlockActors(){if(!(!this._blockActorsRelLoc||this.blockActorsEnsured)){this._blockActorsRelLoc=[],this._blockActors=[];for(let e of this.blockActorKeys)if(e.value&&e.value.length>0){let t=new ti;t.context=this.world.name+" chunk at x:"+this.x*16+" z:"+this.z*16;try{t.fromBinary(e.value,!0,!1,0,!0,!0)}catch{C.error("Could not parse a block actor.")}if(t.roots)for(let i=0;i<t.roots.length;i++){let n=new Is(t.roots[i]);if(n.x!==void 0&&n.z!==void 0&&n.y!==void 0&&n.x>=this.x*16&&n.x<(this.x+1)*16&&n.z>=this.z*16&&n.z<(this.z+1)*16){let s=n.x%16,o=n.z%16;if(s<0&&(s=16+s),o<0&&(o=16+o),n.id){let a=Pl.create(n.id,t.roots[i]);a&&(a.load(),this._blockActorsRelLoc[s]||(this._blockActorsRelLoc[s]=[]),this._blockActorsRelLoc[s][n.y]||(this._blockActorsRelLoc[s][n.y]=[]),this._blockActorsRelLoc[s][n.y][o]=a,a.x!==void 0&&a.y!==void 0&&a.z,this._blockActors.push(a)),C.assert(a!==void 0,"Could not find an actor implementation for '"+n.id+"'")}}}}this.blockActorsEnsured=!0}}removeBlockActorAtLoc(e,t,i){let n=[];for(let s of this._blockActors)(s.x!==e||s.y!==t||s.z!==i)&&n.push(s);this._blockActors=n}getSubChunkCube(e){let t=new fr;return t.maxX=El,t.maxY=gd,t.maxZ=vn,this.fillCube(t,0,0,0,16,16,16,0,e*gd,0),t}fillCubeLegacy(e,t,i,n,s,o,a,l,u,c){if(C.assert(t>=0&&i>=0&&n>=0&&s>t&&o>i&&a>n&&l<El&&c<vn&&this.legacyTerrainBytes!==void 0,"Fill cube legacy not within bounds."),!!this.legacyTerrainBytes)for(let d=t;d<s&&d-t+l<El;d++){let h=d-t+l,f=e.x(d);for(let m=i;m<o&&m-i+u<128;m++){let p=f.y(m),g=m-i+u;for(let b=n;b<a&&b-n+c<vn;b++){let F=b-n+c,w=this.legacyTerrainBytes[h*128*16+F*128+g];w&&p.z(b).copyFrom(ui.fromLegacyId(w))}}}}fillCube(e,t,i,n,s,o,a,l,u,c){if(this.legacyTerrainBytes){this.fillCubeLegacy(e,t,i,n,s,o,a,l,u,c);return}C.assert(t>=0&&i>=0&&n>=0&&s>t&&o>i&&a>n&&l<El&&c<vn,"Fill cube not within bounds.");let d=o-i,h=this.getSubChunkIndexFromY(u),f=this.getSubChunkIndexFromY(u+d);C.assert(h>=0&&f>=h,"WCFC");for(let m=0;m<=f-h;m++){let p=h+m,g=this.subChunks[p];if(g){let b=this.getStartYFromSubChunkIndex(p+1),F=0;if(m>=1&&(F=16-(Math.abs(this.absoluteZeroY)+u)%16),m>=2&&(F+=(m-1)*16),this.subChunkFormatType[p]===1){let w=[],_=g.value;if(_){C.assert(_.length===10251||_.length===10241||_.length===6145,"Expected 6145 or 10241 bytes for a legacy subchunk. ("+_.length+")");for(let I=0;I<4096;I++){let A=_[1+I],T=_[4097+I],E=A*256+T;if(!w[E]){let K=oe.getBlockTypeByLegacyId(A);if(!K||!K.typeId)throw new Error("Expected a block type for index "+A);let P=new ui("minecraft:"+K.typeId);P.data=T,w[E]=P}e.x(I%16).y(Math.floor(I/256)).z(Math.floor(I/16)).copyFrom(w[E])}}}else{let w=this.bitsPerBlock[p],_=Math.floor(32/w),I=this.blockDataStart[p],A=g.value,T=this.blockPalettes[p];if(A&&T)for(let E=t;E<s&&E-t+l<El;E++){let K=E-t+l,P=e.x(E),G=K*256;for(let y=i+F;y<o&&y-i+u<b;y++){let z=(Math.abs(this.absoluteZeroY)+(y-i+u))%16;C.assert(z>=0,"WCFCA");let Fe=P.y(y);for(let re=n;re<a&&re-n+c<vn;re++){let Re=re-n+c,pe=I+Math.floor((G+Re*16+z)/_)*4,ze=(G+Re*16+z)%_,ee=Lt.getUnsignedInteger(A[pe],A[pe+1],A[pe+2],A[pe+3],!0);ee>>>=w*ze;let Y=0;for(let Ve=0;Ve<w;Ve++){let U=ee%2;U<<=Ve,Y+=U,ee>>>=1}if(T.blocks.length>0){C.assert(Y<T.blocks.length,"Unexpected block index.");let Ve=T.blocks[Y];Ve&&Fe.z(re).copyFrom(Ve)}}}}}}}}getTopBlockY(e,t){if(this.blockTops||this.determineBlockTops(),!this.blockTops)throw new Error("Unexpected block top error.");return this.blockTops[e][t]}getTopBlock(e,t){if(this.blockTops||this.determineBlockTops(),!this.blockTops)throw new Error("Unexpected block top error.");return this.getBlock(e,this.blockTops[e][t],t)}_getBlockLegacy(e,t,i){if(!this.legacyTerrainBytes||i<0||e<0||t<0)throw new Error;let n=this.legacyTerrainBytes[e*128*16+i*128+t];return ui.fromLegacyId(n)}_getBlockLegacyList(){if(!this.legacyTerrainBytes)throw new Error;let e=[];for(let t=0;t<Rx;t++)for(let i=0;i<16;i++)for(let n=0;n<16;n++){let s=this.legacyTerrainBytes[n*128*16+i*128+t];e.push(ui.fromLegacyId(s))}return e}doesBlockPaletteExist(e){if(this.legacyTerrainBytes)return!0;let t=this.getSubChunkIndexFromY(e);return!!this.blockPalettes[t]}getBlock(e,t,i){if(t<this.absoluteZeroY)return;if(C.assert(e>=0&&e<16&&i>=0&&i<16,"Retrieving an out-of-range block from a chunk."),this.legacyTerrainBytes)return this._getBlockLegacy(e,t,i);let n=this.getSubChunkIndexFromY(t);if(this.pendingSubChunksToProcess[n]===!0&&this.processSubChunk(n),this.subChunkFormatType[n]===1){let l=this.subChunks[n];if(l===void 0)return;let u=l.value;if(u){let c=t-this.getStartYFromSubChunkIndex(n);C.assert(c>=0&&c<16,"Unexpected Y for a sub chunk ("+c+")"),C.assert(u.length===10251||u.length===10241||u.length===6145,"1.00 subchunk format should be 6145 or 10241 bytes. ("+u.length+")");let d=u[1+(c+i*16+e*256)],h=u[4097+(c+i*16+e*256)],f=oe.getBlockTypeByLegacyId(d);C.assertDefined(f.typeId);let m=new ui("minecraft:"+f.typeId);return m.data=h,m}return}let s=this.getBlockPaletteIndex(e,t,i);if(s===void 0)return;let o=this.blockPalettes[n];if(!o)return;let a=o.blocks;return C.assert(s<a.length,"Unexpected block index"),a[s]}getBlockList(){if(this.legacyTerrainBytes)return this._getBlockLegacyList();let e=[];for(let t=this.minSubChunkIndex;t<this.maxSubChunkIndex;t++){let i=this.subChunks[t];if(i!==void 0)if(this.pendingSubChunksToProcess[t]===!0&&this.processSubChunk(t),this.subChunkFormatType[t]===1){let n=[],s=i.value;if(s){C.assert(s.length===10251||s.length===10241||s.length===6145||s.length===6155,"Expected 6145 or 10241 bytes for a legacy subchunk in getblock. ("+s.length+")");for(let o=0;o<4096;o++){let a=s[1+o],l=s[4097+o],u=a*256+l;if(!n[u]){let c=oe.getBlockTypeByLegacyId(a);if(!c||!c.typeId)throw new Error("Expected a block type for index "+a);let d=new ui("minecraft:"+c.typeId);d.data=l,n[u]=d}e.push(n[u])}}}else{let n=this.getBlockPaletteIndexList(t);if(n){let s=this.blockPalettes[t];if(s){let o=s.blocks;for(let a=0;a<n.length;a++)e.push(o[n[a]])}}}}return e}_determineBlockTopsLegacy(){if(!(!this.legacyTerrainBytes||!this.blockTops))for(let e=0;e<16;e++){let t=e*128*16;for(let i=0;i<16;i++){let n=i*128;for(let s=127;s>=0;s--)this.legacyTerrainBytes[t+n+s]!==0&&(this.blockTops[e][i]=s,s=-1)}}}determineBlockTops(){this.blockTops=[];for(let t=0;t<16;t++){let i=[];for(let n=0;n<16;n++)i.push(-32768);this.blockTops.push(i)}if(this.legacyTerrainBytes){this._determineBlockTopsLegacy();return}let e=0;for(let t=this.maxSubChunkIndex;t>=0;t--){this.pendingSubChunksToProcess[t]===!0&&this.parseSubChunk(t);let i=this.subChunks[t];if(i!==void 0){let n=i.value;if(n!==void 0)if(this.subChunkFormatType[t]===1)for(let s=15;s>=0;s--)for(let o=0;o<16;o++)for(let a=0;a<16;a++){let l=n[a*256+o*vn+s];if(l!==0&&l!==37&&l!==31&&this.blockTops[a][o]<-1024){let u=s+this.getStartYFromSubChunkIndex(t);if(this.blockTops[a][o]=u-1,e++,e===256)return}}else{let s=this.bitsPerBlock[t],o=Math.floor(32/s),a=[],l=this.blockPalettes[t];if(l){C.assert(l.blocks!==void 0,"WCDBTA");for(let u=0;u<l.blocks.length;u++){let c=l.blocks[u];(c.shortTypeName==="air"||c.shortTypeName==="flower"||c.shortTypeName==="tallgrass")&&a.push(u)}for(let u=15;u>=0;u--){let c=u+this.getStartYFromSubChunkIndex(t);for(let d=0;d<16;d++)for(let h=0;h<16;h++)if(c>=this.blockTops[h][d]){let f=h*256+d*vn+u,m=this.blockDataStart[t]+Math.floor(f/o)*4,p=f%o,g=Lt.getUnsignedInteger(n[m],n[m+1],n[m+2],n[m+3],!0);g>>>=s*p;let b=0;for(let w=0;w<s;w++){let _=g%2;_<<=w,b+=_,g>>>=1}let F=!0;for(let w=0;w<a.length;w++)b===a[w]&&(F=!1);if(F&&(e++,this.blockTops[h][d]=c,e===256))return}}}}}}}getSubChunkIndexFromY(e){return Math.floor((e-this.absoluteZeroY)/gd)}getStartYFromSubChunkIndex(e){return e*gd+this.absoluteZeroY}getBlockPaletteIndex(e,t,i){C.assert(e>=0&&e<=15&&i>=0&&i<=15,"Unexpected x/z");let n=this.getSubChunkIndexFromY(t),s=this.subChunks[n];if(s===void 0)return;let o=s.value;if(o===void 0)return;let a=Math.abs(t%16),l=e*256+i*vn+a,u=this.bitsPerBlock[n],c=Math.floor(32/u),d=this.blockDataStart[n]+Math.floor(l/c)*4,h=l%c,f=Lt.getUnsignedInteger(o[d],o[d+1],o[d+2],o[d+3],!0);f>>>=u*h;let m=0;for(let p=0;p<u;p++){let g=f%2;g<<=p,m+=g,f>>>=1}return m}getBlockPaletteIndexList(e){let t=[],i=this.subChunks[e];if(i!==void 0){let n=i.value;if(n===void 0)return;let s=this.absoluteZeroY+this.minSubChunkIndex*16;for(let o=0;o<16;o++)for(let a=0;a<16;a++){let l=o*256+a*vn+s,u=this.bitsPerBlock[e],c=Math.floor(32/u),d=this.blockDataStart[e]+Math.floor(l/c)*4,h=l%c,f=Lt.getUnsignedInteger(n[d],n[d+1],n[d+2],n[d+3],!0);f>>>=u*h;let m=0;for(let p=0;p<u;p++){let g=f%2;g<<=p,m+=g,f>>>=1}t.push(m)}}return t}parseSubChunk(e){let t=this.subChunks[e].value;if(t===void 0||t.length<=0){C.fail("Unexpected no bytes supplied for a chunk.");return}let i=1,n=t[0];if(n<8&&n!==1){this.subChunkFormatType[e]=1,this.chunkMinY=0,this.world.chunkMinY=Math.min(this.chunkMinY,this.world.chunkMinY);return}if(!(n===1||n===8||n===9)){C.fail("Unexpected sub chunk version ("+n+")");return}let s=1,o=1;if(n!==1&&(s=t[1],C.assert(s===1||s===2,"Storage areas > 2 not expected"),o++),n===9){let a=t[2];C.assert(a>=0&&a<=32||a>=224&&a<=256,"Unexpected chunk index"),o++,this.chunkMinY=-512}else n===8&&(this.chunkMinY=0);this.chunkMinY!==void 0&&(this.world.chunkMinY=Math.min(this.chunkMinY,this.world.chunkMinY));for(let a=0;a<s;a++)if(t[o]%2===1&&C.unexpectedError("Unexpected non-save persistence version found."),i=t[o]>>>1,o++,i!==0){let l=Math.floor(32/i),u=Math.ceil(4096/l)*4,c=Lt.getUnsignedInteger(t[u+o],t[u+o+1],t[u+o+2],t[u+o+3],!0);c>=4096&&(c=Lt.getUnsignedInteger(t[u+o],t[u+o+1],t[u+o+2],t[u+o+3],!1)),C.assert(c<=4096,"Unexpectedly large number of palette entries");let d=new hl,h=o;o=d.parseFromBytes(t,u+o+4,c),d.blocks.length!==c&&C.unexpectedError("Unexpected block palette count mismatch."),C.assert(a!==s-1||o===t.length,"Unexpectedly didn't consume entire subchunk."),a===0?(this.blockDataStart[e]=h,this.bitsPerBlock[e]=i,this.blockPalettes[e]=d,this.subChunkFormatType[e]=0):(this.auxBlockDataStart[e]=h,this.auxBitsPerBlock[e]=i,this.auxBlockPalettes[e]=d,this.subChunkFormatType[e]=0)}}};var Ts=class{get from(){return this.data.from}set from(e){this.data.from=e}get to(){return this.data.to}set to(e){this.data.to=e}get name(){return this.data.name}set name(e){this.data.name=e}constructor(e){e?this.data=e:this.data={from:{x:0,y:0,z:0},to:{x:0,y:0,z:0},name:""}}};var Il=class{constructor(){this.data={};this.anchors={}}clear(e){let t=this.data[e]!==void 0||this.anchors[e]!==void 0;return this.data[e]=void 0,this.anchors[e]=void 0,t}clearAll(){this.data={},this.anchors={}}getLength(){let e=0;for(let t in this.data)e++;return e}getKeys(){let e=[];for(let t in this.data)e.push(t);return e}get(e){if(this.anchors[e])return this.anchors[e];if(this.data[e])return this.anchors[e]=new Ts(this.data[e]),this.anchors[e]}ensure(e,t,i){let n;return this.anchors[e]&&(n=this.anchors[e]),!n&&this.data[e]&&(this.anchors[e]=new Ts(this.data[e]),n=this.anchors[e]),n||(this.data[e]={from:t,to:i,name:e},this.anchors[e]=new Ts(this.data[e]),n=this.anchors[e]),n&&(n.from=t,n.to=i,n.name=e),n}getAsString(){return JSON.stringify(this.data)}fromString(e){try{this.data=JSON.parse(e)}catch{}}};var Do=class{constructor(e,t){this.#i={};this.armorItems=[];this.chestItems=[];this.attributes=[];this.#e=e;let i=new ti;i.context=e,i.fromBinary(t,!0,!1,0,!0),i.singleRoot&&(this.#r=i.singleRoot,this.loadFromNbt())}#e;#r;#i;loadFromNbt(){if(!this.#r)return;let e=this.#r,t=e.find("Armor");if(t!==null){let i=t.getTagChildren();this.armorItems=[];for(let n=0;n<i.length;n++){let s=i[n],o=s.find("Count"),a=s.find("Damage"),l=s.find("Name"),u=s.find("WasPickedUp");o&&a&&l&&u&&this.armorItems.push({count:o.valueAsInt,damage:a.valueAsInt,name:l.valueAsString,wasPickedUp:u.valueAsBoolean})}}if(t=e.find("ChestItems"),t!==null){let i=t.getTagChildren();this.armorItems=[];for(let n=0;n<i.length;n++){let s=i[n],o=s.find("Count"),a=s.find("Damage"),l=s.find("Name"),u=s.find("Slot"),c=s.find("WasPickedUp");o&&a&&l&&u&&c&&this.chestItems.push({count:o.valueAsInt,damage:a.valueAsInt,name:l.valueAsString,slot:u.valueAsInt,wasPickedUp:c.valueAsBoolean})}}if(t=e.find("Attributes"),t!==null){let i=t.getTagChildren();this.attributes=[];for(let n=0;n<i.length;n++){let s=i[n],o=s.find("Base"),a=s.find("Current"),l=s.find("DefaultMax"),u=s.find("DefaultMin"),c=s.find("Max"),d=s.find("Min"),h=s.find("Name");o&&a&&h&&l&&u&&c&&d&&this.attributes.push({base:o.valueAsInt,current:a.valueAsInt,defaultMax:l.valueAsInt,defaultMin:u.valueAsInt,max:c.valueAsInt,min:d.valueAsInt,name:h.valueAsString})}}if(t=e.find("DynamicProperties"),t!==null){let i=t.getTagChildren();this.#i={};for(let n of i)if(n.name&&B.isValidUuid(n.name)){this.#i[n.name]={};let s=n.getTagChildren();for(let o of s)o.name&&o.type===8&&(this.#i[n.name][o.name]=o.valueAsString)}}t=e.find("AttackTime"),t!==null&&(this.attackTime=t.valueAsInt),t=e.find("Air"),t!==null&&(this.air=t.valueAsInt),t=e.find("BodyRot"),t!==null&&(this.bodyRot=t.valueAsFloat),t=e.find("Chested"),t!==null&&(this.chested=t.valueAsBoolean),t=e.find("Color"),t!==null&&(this.color=t.valueAsInt),t=e.find("Color2"),t!==null&&(this.color2=t.valueAsInt),t=e.find("Dead"),t!==null&&(this.dead=t.valueAsBoolean),t=e.find("DeathTime"),t!==null&&(this.deathTime=t.valueAsInt),t=e.find("FallDistance"),t!==null&&(this.fallDistance=t.valueAsFloat),t=e.find("HasExecuted"),t!==null&&(this.hasExecuted=t.valueAsBoolean),t=e.find("HurtTime"),t!==null&&(this.hurtTime=t.valueAsInt),t=e.find("Invulnerable"),t!==null&&(this.invulnerable=t.valueAsBoolean),t=e.find("IsAngry"),t!==null&&(this.isAngry=t.valueAsBoolean),t=e.find("IsAutonomous"),t!==null&&(this.isAutonomous=t.valueAsBoolean),t=e.find("IsBaby"),t!==null&&(this.isBaby=t.valueAsBoolean),t=e.find("IsEating"),t!==null&&(this.isEating=t.valueAsBoolean),t=e.find("IsGliding"),t!==null&&(this.isGliding=t.valueAsBoolean),t=e.find("IsGlobal"),t!==null&&(this.isGliding=t.valueAsBoolean),t=e.find("IsIllagerCaptain"),t!==null&&(this.isIllagerCaptain=t.valueAsBoolean),t=e.find("IsOrphaned"),t!==null&&(this.isOrphaned=t.valueAsBoolean),t=e.find("IsOutOfControl"),t!==null&&(this.isOutOfControl=t.valueAsBoolean),t=e.find("IsPregnant"),t!==null&&(this.isPregnant=t.valueAsBoolean),t=e.find("IsRoaring"),t!==null&&(this.isRoaring=t.valueAsBoolean),t=e.find("IsScared"),t!==null&&(this.isScared=t.valueAsBoolean),t=e.find("IsStunned"),t!==null&&(this.isStunned=t.valueAsBoolean),t=e.find("IsSwimming"),t!==null&&(this.isSwimming=t.valueAsBoolean),t=e.find("IsTamed"),t!==null&&(this.isTamed=t.valueAsBoolean),t=e.find("IsTrusting"),t!==null&&(this.isTrusting=t.valueAsBoolean),t=e.find("LastDimensionId"),t!==null&&(this.lastDimensionId=t.valueAsInt),t=e.find("LeasherID"),t!==null&&(this.leasherId=t.valueAsInt),t=e.find("LootDropped"),t!==null&&(this.lootDropped=t.valueAsBoolean),t=e.find("Mainhand"),t!==null&&(this.mainhand=t.valueAsString),t=e.find("MarkVariant"),t!==null&&(this.markVariant=t.valueAsInt),t=e.find("NaturalSpawn"),t!==null&&(this.naturalSpawn=t.valueAsBoolean),t=e.find("Offhand"),t!==null&&(this.offhand=t.valueAsString),t=e.find("OnGround"),t!==null&&(this.onGround=t.valueAsBoolean),t=e.find("OwnerNew"),t!==null&&(this.ownerNew=t.valueAsBigInt),t=e.find("Persistent"),t!==null&&(this.persistent=t.valueAsBoolean),t=e.find("PortalCooldown"),t!==null&&(this.portalCooldown=t.valueAsBoolean),t=e.find("Pos"),t!==null&&(this.pos=t.valueAsNumericArray),t=e.find("Rotation"),t!==null&&(this.rotation=t.valueAsNumericArray),t=e.find("Saddled"),t!==null&&(this.saddled=t.valueAsBoolean),t=e.find("Sheared"),t!==null&&(this.sheared=t.valueAsBoolean),t=e.find("ShowBottom"),t!==null&&(this.showBottom=t.valueAsBoolean),t=e.find("Sitting"),t!==null&&(this.sitting=t.valueAsBoolean),t=e.find("SkinID"),t!==null&&(this.skinId=t.valueAsInt),t=e.find("Strength"),t!==null&&(this.strength=t.valueAsInt),t=e.find("StrengthMax"),t!==null&&(this.strengthMax=t.valueAsFloat),t=e.find("Surface"),t!==null&&(this.surface=t.valueAsBoolean),t=e.find("TargetID"),t!==null&&(this.targetId=t.valueAsBigInt),t=e.find("TradeExperience"),t!==null&&(this.tradeExperience=t.valueAsInt),t=e.find("TradeTier"),t!==null&&(this.tradeTier=t.valueAsInt),t=e.find("UniqueID"),t!==null&&(this.uniqueId=t.valueAsBigInt),t=e.find("Variant"),t!==null&&(this.variant=t.valueAsInt),t=e.find("boundX"),t!==null&&(this.boundX=t.valueAsInt),t=e.find("boundY"),t!==null&&(this.boundY=t.valueAsInt),t=e.find("boundZ"),t!==null&&(this.boundZ=t.valueAsInt),t=e.find("canPickupItems"),t!==null&&(this.canPickupItems=t.valueAsBoolean),t=e.find("definitions"),t!==null&&(this.definitions=t.valueAsStringArray),t=e.find("hasBoundOrigin"),t!==null&&(this.hasBoundOrigin=t.valueAsBoolean),t=e.find("hasSetCanPickupItems"),t!==null&&(this.hasSetCanPickupItems=t.valueAsBoolean),t=e.find("identifier"),t!==null&&(this.identifier=t.valueAsString)}};var lp="/world_behavior_packs.json",up="/world_behavior_pack_history.json",cp="/world_resource_packs.json",dp="/world_resource_pack_history.json",Mw="/level.dat",Bx="/level.dat_old",Nw="/levelname.txt",jw="/manifest.json",xl=16,Tl=16,fp="5d2f0b91-ca29-49da-a275-e6c6262ea3de",Vt=class r{constructor(){this._anchors=new Il;this._dynamicProperties={};this._isLoaded=!1;this._isDataLoaded=!1;this._onLoaded=new bd.EventDispatcher;this._onDataLoaded=new bd.EventDispatcher;this._hasDynamicProps=!1;this._hasCustomProps=!1;this._onPropertyChanged=new bd.EventDispatcher;this.chunkCount=0;this._chunkMinY=-64;this.actorsById={};this.regionsByDimension={};this.chunks={}}get project(){return this._project}set project(e){this._project=e}get anchors(){return this._anchors}get chunkMinY(){return this._chunkMinY}set chunkMinY(e){this._chunkMinY=e}get effectiveRootFolder(){if(this._folder)return this._folder;if(this._file&&this._file.fileContainerStorage)return this._file.fileContainerStorage.rootFolder;if(this._zipStorage!==void 0)return this._zipStorage.rootFolder}get manifest(){return this._manifest}get hasDynamicProps(){return this._hasDynamicProps}get hasCustomProps(){return this._hasCustomProps}get minX(){return this._minX}get maxX(){return this._maxX}get minZ(){return this._minZ}get maxZ(){return this._maxZ}get generationSeed(){if(this._generationSeed===void 0&&this._levelChunkMetaData&&this._levelChunkMetaData.singleRoot){let e=this._levelChunkMetaData.singleRoot.find("GenerationSeed");e!==null&&(this._generationSeed=e.valueAsBigInt.toString())}return this._generationSeed}async copyAsFolderTo(e){this._folder?await S.syncFolderTo(this._folder,e,!0,!0,!0):this._file&&this.storage&&await S.syncFolderTo(this.storage.rootFolder,e,!0,!0,!0)}get storage(){return this._file?(this._file.fileContainerStorage||(this._file.fileContainerStorage=new yt,this._file.fileContainerStorage.storagePath=this._file.extendedPath+"#"),this._file.fileContainerStorage):(this._zipStorage===void 0&&(this._zipStorage=new yt),this._zipStorage)}ensureZipStorage(){this._zipStorage===void 0&&(this._zipStorage=new yt)}get onPropertyChanged(){return this._onPropertyChanged.asEvent()}get storageErrorStatus(){return this.storage?this.storage.errorStatus:0}get storageErrorMessage(){return this.storage.errorMessage}get storageFullPath(){if(this._file)return this._file.fullPath;if(this._folder)return this._folder.fullPath}get deferredTechnicalPreviewExperiment(){if(this.levelData!==void 0){let e=this.levelData.deferredTechnicalPreviewExperiment;return e===void 0?!1:e}return!1}set deferredTechnicalPreviewExperiment(e){this.levelData===void 0&&(this.levelData=new hr),this.levelData!==void 0&&(this.levelData.deferredTechnicalPreviewExperiment=e)}get betaApisExperiment(){if(this.levelData!==void 0){let e=this.levelData.betaApisExperiment;return e===void 0?!1:e}return!1}set betaApisExperiment(e){this.levelData===void 0&&(this.levelData=new hr),this.levelData!==void 0&&(this.levelData.betaApisExperiment=e)}get dataDrivenItemsExperiment(){if(this.levelData!==void 0){let e=this.levelData.dataDrivenItemsExperiment;return e===void 0?!1:e}return!1}set dataDrivenItemsExperiment(e){this.levelData===void 0&&(this.levelData=new hr),this.levelData!==void 0&&(this.levelData.dataDrivenItemsExperiment=e)}get name(){return this._levelNameText!==void 0?this._levelNameText:this.levelData!==void 0&&this.levelData.levelName!==void 0?this.levelData.levelName:this._file!==void 0?this._file.name:""}set name(e){this._levelNameText=e,this.levelData!==void 0&&(this.levelData.levelName=e)}get file(){return this._file}set file(e){this._file=e}get folder(){return this._folder}set folder(e){this._folder=e}get isLoaded(){return this._isLoaded}get spawnX(){if(this.levelData!==void 0)return this.levelData.spawnX}set spawnX(e){this.levelData===void 0&&(this.levelData=new hr),this.levelData.spawnX=e,this._onPropertyChanged.dispatch(this,"spawnX")}get spawnY(){if(this.levelData!==void 0)return this.levelData.spawnY}set spawnY(e){this.levelData===void 0&&(this.levelData=new hr),this.levelData.spawnY=e,this._onPropertyChanged.dispatch(this,"spawnY")}get spawnZ(){if(this.levelData!==void 0)return this.levelData.spawnZ}set spawnZ(e){this.levelData===void 0&&(this.levelData=new hr),this.levelData.spawnZ=e,this._onPropertyChanged.dispatch(this,"spawnZ")}get onLoaded(){return this._onLoaded.asEvent()}get onDataLoaded(){return this._onDataLoaded.asEvent()}static async ensureMCWorldOnFolder(e,t,i){if(e.manager===void 0){let n=new r;n.project=t,n.folder=e,e.manager=n}if(e.manager!==void 0&&e.manager instanceof r){let n=e.manager;return n.isLoaded?i&&i(n,n,{unsub:()=>{},stopPropagation:()=>{}}):(i&&n.onLoaded.subscribe(i),await n.load(!1)),n}}static async ensureOnItem(e){let t;return e.folder?t=await r.ensureMCWorldOnFolder(e.folder,e.project):e.file&&(t=await r.ensureOnFile(e.file,e.project)),t||C.debugAlert("Could not find respective world."),t}static async ensureOnFile(e,t,i){if(e.manager===void 0){let n=new r;n.project=t,n.file=e,e.manager=n}if(e.manager!==void 0&&e.manager instanceof r){let n=e.manager;return n.isLoaded?i&&i(n,n,{unsub:()=>{},stopPropagation:()=>{}}):(i&&n.onLoaded.subscribe(i),await n.load(!1)),n}}loadAnchorsFromDynamicProperties(){if(this._dynamicProperties&&this._dynamicProperties[fp]){this._anchors.clearAll();let e=this._dynamicProperties&&this._dynamicProperties[fp].anchors;e&&typeof e=="string"&&(this._anchors.fromString(e),this.saveAutoGenItems())}}_updateMeta(){this.regionsByDimension={};for(let e in this.chunks){let t=this.chunks[e],i=[];for(let n in t){let s=parseInt(n),o=t[s];for(let a in o){let l=parseInt(a),u=!1;for(let c of i)s>=c.minX&&s<=c.maxX&&l>=c.minZ&&l<=c.maxZ&&(c.minX=Math.min(c.minX,s-1),c.minZ=Math.min(c.minZ,l-1),c.maxX=Math.max(c.maxX,s+1),c.maxZ=Math.max(c.maxZ,l+1),u=!0);u||i.push({minX:s-1,minZ:l-1,maxX:s+1,maxZ:l+1})}}this.regionsByDimension[e]=this._coalesceRegions(i)}}_coalesceRegions(e){let t=[];for(let i of e){let n=!1;for(let s of t){if(i.minX>=s.minX&&i.minX<=s.maxX&&i.minZ>=s.minZ&&i.minZ<=s.maxZ){s.minX=Math.min(s.minX,i.minX-1),s.minZ=Math.min(s.minZ,i.minZ-1),s.maxX=Math.max(s.maxX,i.minX+1),s.maxZ=Math.max(s.maxZ,i.minZ+1),n=!0;break}if(i.maxX>=s.minX&&i.maxX<=s.maxX&&i.minZ>=s.minZ&&i.minZ<=s.maxZ){s.minX=Math.min(s.minX,i.maxX-1),s.minZ=Math.min(s.minZ,i.minZ-1),s.maxX=Math.max(s.maxX,i.maxX+1),s.maxZ=Math.max(s.maxZ,i.minZ+1),n=!0;break}if(i.minX>=s.minX&&i.minX<=s.maxX&&i.maxZ>=s.minZ&&i.maxZ<=s.maxZ){s.minX=Math.min(s.minX,i.minX-1),s.minZ=Math.min(s.minZ,i.maxZ-1),s.maxX=Math.max(s.maxX,i.minX+1),s.maxZ=Math.max(s.maxZ,i.maxZ+1),n=!0;break}if(i.maxX>=s.minX&&i.maxX<=s.maxX&&i.maxZ>=s.minZ&&i.maxZ<=s.maxZ){s.minX=Math.min(s.minX,i.maxX-1),s.minZ=Math.min(s.minZ,i.maxZ-1),s.maxX=Math.max(s.maxX,i.maxX+1),s.maxZ=Math.max(s.maxZ,i.maxZ+1),n=!0;break}}n||t.push(i)}return t}_pushError(e,t){this.isInErrorState=!0,this.errorMessages===void 0&&(this.errorMessages=[]),C.error(e+(t?" "+t:"")),this.errorMessages.push({message:e,context:t})}async save(){this.storageErrorStatus!==1&&(await this.saveWorldManifest(),await this.saveLevelnameTxt(),await this.saveLevelDat(),await this.saveAutoGenItems(),await this.saveWorldBehaviorPacks(),await this.saveWorldBehaviorPackHistory(),await this.saveWorldResourcePacks(),await this.saveWorldResourcePackHistory())}async saveWorldManifest(){if(this._manifest!==void 0&&this.effectiveRootFolder!==void 0){this._manifest.header.name=this.name;let e=await this.effectiveRootFolder.ensureFileFromRelativePath(jw);e!==void 0&&(e.setContent(JSON.stringify(this._manifest,null,2)),await e.saveContent())}}async saveLevelnameTxt(){let e=this.name;if(e!==void 0&&this.effectiveRootFolder!==void 0){let t=await this.effectiveRootFolder.ensureFileFromRelativePath(Nw);t!==void 0&&(t.setContent(e),await t.saveContent())}}async saveLevelDat(){if(this.levelData!==void 0&&this.effectiveRootFolder!==void 0){this.levelData.persist();let e=await this.effectiveRootFolder.ensureFileFromRelativePath(Mw),t=this.levelData.getBytes();e!==void 0&&t!==void 0&&(e.setContent(t),await e.saveContent()),e=await this.effectiveRootFolder.ensureFileFromRelativePath(Bx),e!==void 0&&t!==void 0&&(e.setContent(t),await e.saveContent())}}async getBytes(){if(this._file)return this._file.fileContainerStorage||(this._file.fileContainerStorage=new yt,this._file.fileContainerStorage.storagePath=this._file.extendedPath+"#"),await this.save(),await this._file.fileContainerStorage.generateUint8ArrayAsync();if(this._zipStorage!==void 0)return await this.save(),await this._zipStorage.generateUint8ArrayAsync()}async syncFolderTo(e){await this.save();let t=this.effectiveRootFolder;if(!t){C.unexpectedUndefined("SFT");return}await S.syncFolderTo(t,e,!0,!0,!0)}async saveToFile(){if(this._zipStorage===void 0||this._file===void 0)return;let e=await this.getBytes();e!==void 0&&this._file.setContent(e)}ensurePackReferenceSet(e){if(this.worldBehaviorPacks===void 0&&(this.worldBehaviorPacks=[]),this.worldResourcePacks===void 0&&(this.worldResourcePacks=[]),this.worldBehaviorPackHistory===void 0&&(this.worldBehaviorPackHistory={packs:[]}),this.worldResourcePackHistory===void 0&&(this.worldResourcePacks=[]),this.worldResourcePackHistory===void 0&&(this.worldResourcePackHistory={packs:[]}),e.behaviorPackReferences)for(let t=0;t<e.behaviorPackReferences.length;t++)this.ensurePackReferenceInCollection(e.behaviorPackReferences[t],this.worldBehaviorPacks),this.ensurePackReferenceInHistory(e.behaviorPackReferences[t],this.worldBehaviorPackHistory,e.name);if(e.resourcePackReferences)for(let t=0;t<e.resourcePackReferences.length;t++)this.ensurePackReferenceInCollection(e.resourcePackReferences[t],this.worldResourcePacks),this.ensurePackReferenceInHistory(e.resourcePackReferences[t],this.worldResourcePackHistory,e.name)}ensurePackReferenceInCollection(e,t){C.assert(e.version.length===3,"Packref version not within bounds.");let i=B.canonicalizeId(e.uuid);for(let n=0;n<t.length;n++)if(B.canonicalizeId(t[n].pack_id)===i)return;t.push({pack_id:e.uuid,version:e.version,priority:e.priority?e.priority:32767})}ensurePackReferenceInHistory(e,t,i){C.assert(e.version.length===3,"Packref version not within bounds."),t.packs===void 0&&(t.packs=[]);let n=B.canonicalizeId(e.uuid);for(let s=0;s<t.packs.length;s++)if(B.canonicalizeId(t.packs[s].uuid)===n)return;t.packs.push({can_be_redownloaded:!1,name:i,uuid:e.uuid,version:e.version})}_loadFromNbt(){}getProperty(e){switch(e.toLowerCase()){case"spawnx":return this.spawnX;case"spawny":return this.spawnY;case"spawnz":return this.spawnZ;case"gametype":return this.levelData?.gameType;case"difficulty":return this.levelData?.difficulty;case"generator":return this.levelData?.generator}}setProperty(e,t){switch(e.toLowerCase()){case"spawnX":this.spawnX=t;break;case"spawnY":this.spawnY=t;break;case"spawnZ":this.spawnZ=t;break}}async load(e){if(!(this._isLoaded&&!e||this._file===void 0&&this._folder===void 0)){if(this._file){if(await this._file.loadContent(),this._file.content===void 0||!(this._file.content instanceof Uint8Array))return;await this.loadFromBytes(this._file.content)}this._folder&&await this.loadFromFolder(this._folder)}}ensureResourcePacksFromString(e){let t=Be.getIdsAndVersions(e);for(let i of t)this.ensureResourcePack(i.uuid,i.version,i.uuid)}ensureBehaviorPacksFromString(e){let t=Be.getIdsAndVersions(e);for(let i of t)this.ensureBehaviorPack(i.uuid,i.version,i.uuid)}ensureBehaviorPack(e,t,i,n){this.worldBehaviorPacks===void 0&&(this.worldBehaviorPacks=[]),this.worldBehaviorPackHistory===void 0&&(this.worldBehaviorPackHistory={packs:[]});let s=!1;return this.getBehaviorPack(e)===void 0&&(this.worldBehaviorPacks.push({pack_id:e,version:t,priority:n}),s=!0),this.getBehaviorPackHistory(e)===void 0&&(this.worldBehaviorPackHistory.packs.push({uuid:e,version:t,name:i,can_be_redownloaded:!1}),s=!0),s}getBehaviorPack(e){if(this.worldBehaviorPacks!==void 0){e=B.canonicalizeId(e);for(let t=0;t<this.worldBehaviorPacks.length;t++){let i=this.worldBehaviorPacks[t];if(B.canonicalizeId(i.pack_id)===e)return i}}}getBehaviorPackHistory(e){if(this.worldBehaviorPackHistory===void 0)return;e=B.canonicalizeId(e);let t=this.worldBehaviorPackHistory.packs;for(let i=0;i<t.length;i++){let n=t[i];if(B.canonicalizeId(n.uuid)===e)return n}}static sortPackRegByPriority(e,t){return(e.priority===void 0?32767:e.priority)-(t.priority===void 0?32767:t.priority)}static sortPackCollectionByPriority(e){return r.freezePackRegistrationOrder(e),e.sort(r.sortPackRegByPriority)}static freezePackRegistrationOrder(e){for(let t=0;t<e.length;t++)e[t].priority===void 0&&(e[t].priority=t*100)}async saveWorldBehaviorPacks(){if(this.effectiveRootFolder===void 0)return;let e=this.effectiveRootFolder;if(this.worldBehaviorPacks===void 0||this.worldBehaviorPacks.length===0){await e.deleteFileFromRelativePath(lp);return}let t=await e.ensureFileFromRelativePath(lp),i=r.freezeAndStripPriorities(this.worldBehaviorPacks);t.setContent(JSON.stringify(i,null,2)),t.saveContent()}static freezeAndStripPriorities(e){let t=[],i=r.sortPackCollectionByPriority(e);for(let n=0;n<i.length;n++)t.push({pack_id:i[n].pack_id,version:i[n].version});return t}async saveWorldBehaviorPackHistory(){if(this.effectiveRootFolder===void 0)return;let e=this.effectiveRootFolder;if(this.worldBehaviorPackHistory===void 0||this.worldBehaviorPackHistory.packs.length===0){await e.deleteFileFromRelativePath(up);return}let t=await e.ensureFileFromRelativePath(up);t.setContent(JSON.stringify(this.worldBehaviorPackHistory,null,2)),t.saveContent()}ensureResourcePack(e,t,i,n){this.worldResourcePacks===void 0&&(this.worldResourcePacks=[]),this.worldResourcePackHistory===void 0&&(this.worldResourcePackHistory={packs:[]});let s=!1;return this.getResourcePack(e)===void 0&&(this.worldResourcePacks.push({pack_id:e,version:t,priority:n}),s=!0),this.getResourcePackHistory(e)===void 0&&(this.worldResourcePackHistory.packs.push({uuid:e,version:t,name:i,can_be_redownloaded:!1}),s=!0),s}getResourcePack(e){if(this.worldResourcePacks!==void 0){e=B.canonicalizeId(e);for(let t=0;t<this.worldResourcePacks.length;t++){let i=this.worldResourcePacks[t];if(B.canonicalizeId(i.pack_id)===e)return i}}}getResourcePackHistory(e){if(this.worldResourcePackHistory===void 0)return;e=B.canonicalizeId(e);let t=this.worldResourcePackHistory.packs;for(let i=0;i<t.length;i++){let n=t[i];if(B.canonicalizeId(n.uuid)===e)return n}}async saveWorldResourcePacks(){if(this.effectiveRootFolder===void 0)return;let e=this.effectiveRootFolder;if(this.worldResourcePacks===void 0||this.worldResourcePacks.length===0){await e.deleteFileFromRelativePath(cp);return}let t=await e.ensureFileFromRelativePath(cp),i=r.freezeAndStripPriorities(this.worldResourcePacks);t.setContent(JSON.stringify(i,null,2)),t.saveContent()}async saveWorldResourcePackHistory(){if(this.effectiveRootFolder===void 0)return;let e=this.effectiveRootFolder;if(this.worldResourcePackHistory===void 0||this.worldResourcePackHistory.packs.length===0){await e.deleteFileFromRelativePath(dp);return}let t=await e.ensureFileFromRelativePath(dp);t.setContent(JSON.stringify(this.worldResourcePackHistory,null,2)),t.saveContent()}async loadFromBytes(e){let t;this._file?(this._file.fileContainerStorage||(this._file.fileContainerStorage=new yt,this._file.fileContainerStorage.storagePath=this._file.extendedPath+"#"),t=this._file.fileContainerStorage):(this._zipStorage=new yt,t=this._zipStorage),await t.loadFromUint8Array(e,this._file?.name);let i=t.rootFolder;await this.loadFromFolder(i)}async applyWorldSettings(e){this._isLoaded||await this.load(!1),this.ensureLevelData(),this.levelData&&(this.levelData.ensureDefaults(),e&&this.levelData.applyFromWorldSettings(e))}ensureLevelData(){return this.levelData===void 0&&(this.levelData=new hr),this.levelData}async loadFromFolder(e){let t=await e.getFileFromRelativePath(Mw);t!==void 0&&(await t.loadContent(),t.content!==void 0&&t.content instanceof Uint8Array&&(this.levelData=new hr,this.levelData.loadFromNbtBytes(t.content),B.appendErrors(this,this.levelData),this._loadFromNbt()));let i=await e.getFileFromRelativePath(Nw);i!==void 0&&(await i.loadContent(),i.content!==void 0&&typeof i.content=="string"&&(this.name=i.content));let n=await e.getFileFromRelativePath(jw);n!==void 0&&(await n.loadContent(),n.content!==void 0&&typeof n.content=="string"&&(this._manifest=JSON.parse(n.content)));let s=await e.getFileFromRelativePath(lp);if(s!==void 0&&(await s.loadContent(),s.content!==void 0&&typeof s.content=="string"))try{this.worldBehaviorPacks=JSON.parse(s.content)}catch{this._pushError("Could not parse behavior pack file content"),this.worldBehaviorPacks=void 0}if(s=await e.getFileFromRelativePath(cp),s!==void 0&&(await s.loadContent(),s.content!==void 0&&typeof s.content=="string"))try{this.worldResourcePacks=JSON.parse(s.content)}catch{this._pushError("Could not parse resource pack file content"),this.worldResourcePacks=void 0}let o=await e.getFileFromRelativePath(up);if(o!==void 0&&(await o.loadContent(),o.content!==void 0&&typeof o.content=="string"))try{this.worldBehaviorPackHistory=JSON.parse(o.content)}catch{this._pushError("Could not parse behavior pack history file content"),this.worldBehaviorPackHistory=void 0}if(o=await e.getFileFromRelativePath(dp),o!==void 0&&(await o.loadContent(),o.content!==void 0&&typeof o.content=="string"))try{this.worldResourcePackHistory=JSON.parse(o.content)}catch{this._pushError("Could not parse resource pack history file content"),this.worldResourcePackHistory=void 0}let a=await e.getFileFromRelativePath("/world_icon.jpeg");a!==void 0&&(await a.loadContent(),a.content instanceof Uint8Array&&(this.imageBase64=B.uint8ArrayToBase64(a.content))),this._isLoaded=!0,this._onLoaded.dispatch(this,this)}async loadData(e=!1){if(!e&&this._isDataLoaded)return;let t=await this._project?.carto.notifyOperationStarted("Starting first-pass load of '"+this.name+"' world",3),i=this.effectiveRootFolder;if(!i)return;await i.load();let n=await i.getFolderFromRelativePath("/db"),s=[],o=[],a=[];if(n){await n.load();for(let l in n.files){let u=n.files[l];if(u){let c=S.getTypeFromName(u.name);l.startsWith("MANIFEST")?a.push(u):c==="ldb"?s.push(u):c==="log"&&o.push(u)}}}this.levelDb=new Dl(s,o,a,this.name),await this.levelDb.init(async l=>{await this._project?.carto.notifyStatusUpdate(l,3)}),B.appendErrors(this,this.levelDb),t!==void 0&&await this._project?.carto.notifyOperationEnded(t,"Completed first-pass load of '"+this.name+"' world",3),await this.loadFromLevelDb(this.levelDb)}async loadFromLevelDb(e){this.levelDb=e,await this.processWorldData(),this._updateMeta(),this._onDataLoaded.dispatch(this,this),this._isDataLoaded=!0}getTopBlockY(e,t,i){let n=Math.floor(e/xl),s=this.chunks[i||0][n];if(s===void 0)return;let o=Math.floor(t/Tl),a=s[o];if(a!==void 0)return a.getTopBlockY(e-n*xl,t-o*Tl)}getTopBlock(e,t,i){let n=Math.floor(e/xl),s=this.chunks[i||0][n];if(s===void 0)return;let o=Math.floor(t/Tl),a=s[o];if(a!==void 0)return a.getTopBlock(e-n*xl,t-o*Tl)}spawnEntity(e,t){return new bn}getBlock(e,t){let i=Math.floor(e.x/xl),n=this.chunks[t||0][i];if(n===void 0)return new ui("air");let s=Math.floor(e.z/Tl),o=n[s];if(o===void 0)return new ui("air");let a=e.x%16,l=e.z%16;a<0&&(a+=16),l<0&&(l+=16);let u=o.getBlock(a,e.y,l);return u||new ui("air")}async processWorldData(){if(!this.levelDb)return;this.chunks=[],this.chunkCount=0;let e=await this._project?.carto.notifyOperationStarted("Starting second-pass load of '"+this.name+"' world",3);for(let t in this.levelDb.keys){let i=this.levelDb.keys[t];if(!t.startsWith("AutonomousEntities")){if(!t.startsWith("schedulerWT")){if(t.startsWith("Overworld")&&i){let n=i.value;if(n){let s=new ti;s.context=this.name+" overworld",s.fromBinary(n,!0,!1,0,!0),this._overworldData=s}}else if(t.startsWith("BiomeData")&&i){let n=i.value;if(n){let s=new ti;s.context=this.name+" biome data",s.fromBinary(n,!0,!1,0,!0),this._biomeData=s}}else if(t.startsWith("CustomProperties"))this._hasCustomProps=!0;else if(t.startsWith("DynamicProperties")&&i){this._hasDynamicProps=!0;let n=i.value;if(n){let s=new ti;if(s.context=this.name+" dynamic props",s.fromBinary(n,!0,!1,0,!0),s.singleRoot){let o=s.singleRoot.getTagChildren();this._dynamicProperties={};for(let a of o)if(a.name&&B.isValidUuid(a.name)){this._dynamicProperties[a.name]={};let l=a.getTagChildren();for(let u of l)u.name&&u.type===8&&(this._dynamicProperties[a.name][u.name]=u.valueAsString,a.name===fp&&this.loadAnchorsFromDynamicProperties())}}}}else if(t.startsWith("LevelChunkMetaDataDictionary")&&i){let n=i.value;if(n){let s=new ti;s.context=this.name+" level chunk metadata",s.fromBinary(n,!0,!1,12,!0),this._levelChunkMetaData=s}}else if(!t.startsWith("structuretemplate_")){if(t.startsWith("digp")&&i){let n=i.keyBytes;if(n){let s=Lt.getSignedInteger(n[4],n[5],n[6],n[7],!0),o=Lt.getSignedInteger(n[8],n[9],n[10],n[11],!0);C.assert(n.length===16||n.length===24||n.length===20||n.length===13||n.length===12,"Unexpected digp key size ("+n.length+")");let a=0;if(n.length>=17&&(a=Lt.getSignedInteger(n[8],n[9],n[10],n[11],!0),C.assert(a>=0&&a<=2,"Unexpected dimension index - digp ("+a+")")),this.chunks[a]===void 0&&(this.chunks[a]=[]),this.chunks[a][s]===void 0&&(this.chunks[a][s]=[]),this.chunks[a][s][o]===void 0){let l=new To(this,s,o);this.chunkCount++,this.chunks[a][s][o]=l}if(i.value!==void 0){let l=i.value;if(l.length>0&&l.length%8===0){let u="";for(let c=0;c<l.length;c+=8)u+=B.convertToHexString([l[c+0],l[c+1],l[c+2],l[c+3],l[c+4],l[c+5],l[c+6],l[c+7]]);this.chunks[a][s][o].addActorDigest(u)}else l.length}}}else if(t.startsWith("actorprefix")&&i){let n=i.keyBytes;if(n&&n.length===19&&i.value){let s=B.convertToHexString([n[11],n[12],n[13],n[14],n[15],n[16],n[17],n[18]]),o=new Do(s,i.value);this.actorsById[s]=o}else if(n&&n.length===27&&i.value){let s=B.convertToHexString([n[11],n[12],n[13],n[14],n[15],n[16],n[17],n[18],n[19],n[20],n[21],n[22],n[23],n[24],n[25],n[26]]),o=new Do(s,i.value);this.actorsById[s]=o}}else if(!t.startsWith("player")){if(!t.startsWith("portals")){if(!t.startsWith("LevelSpawnWasFixed")){if(!t.startsWith("VILLAGE_")){if(!t.startsWith("gametestinstance_")){if(!t.startsWith("tickingarea_")){if(!t.startsWith("map_")){if(!t.startsWith("scoreboard")){if(!t.startsWith("SavedEntity")){if(!t.startsWith("ServerMapRuntime")){if(!t.startsWith("VillageRuntime")){if(!t.startsWith("WorldFeatureRuntime")){if(!t.startsWith("WorldGenerationRuntime")){if(!t.startsWith("WorldStreamRuntime")){if(!t.startsWith("BSharpRuntime")){if(!t.startsWith("BadgerSynced")){if(!t.startsWith("CinematicsRuntime")){if(!t.startsWith("CustomGameOptions")){if(!t.startsWith("DeckRuntime")){if(!t.startsWith("EntityFactorySetup")){if(!t.startsWith("GeologyRuntime")){if(!t.startsWith("InvasionRuntime")){if(!t.startsWith("MapRevealRuntime")){if(!t.startsWith("~local_player")){if(!t.startsWith("RealmsStoriesData")){if(!t.startsWith("mobevents")){if(!t.startsWith("game_flatworldlayers")){if(!t.startsWith("dimension")){if(!t.startsWith("structureplacement")){if(!t.startsWith("chunk_loaded_request")){if(!t.startsWith("legacy_console_player")){if(!t.startsWith("PosTrackDB")){if(!t.startsWith("PositionTrackDB")){if(!t.startsWith("OwnedEntitiesLimbo")){if(!t.startsWith("MCeditMap")){if(!t.startsWith("EDU_CurrentCodingURL")){if(!t.startsWith("TheEnd")){if(!(t.indexOf("WasPicked")>=0)){if(!(t.indexOf("TextIg")>=0)){if(!t.startsWith("SST_SALOG")){if(!t.startsWith("SST_WORD")){if(!t.startsWith("SST_NAME")){if(!t.startsWith("SST_")){if(!t.startsWith("SUSP")){if(!t.startsWith("neteaseData")){if(!t.startsWith("scriptGid")){if(!t.startsWith("Nether")){if(i&&(t.length===9||t.length===10||t.length===13||t.length===14)){let n=i.keyBytes,s=t.length>=13;if(C.assertDefined(n),n){let o=Lt.getSignedInteger(n[0],n[1],n[2],n[3],!0),a=Lt.getSignedInteger(n[4],n[5],n[6],n[7],!0),l=0;if(s&&(l=Lt.getSignedInteger(n[8],n[9],n[10],n[11],!0),l<1||l>2)){this._pushError("Unexpected dimension index. ("+l+")");continue}(this._minX===void 0||o*16<this._minX)&&(this._minX=o*16),(this._maxX===void 0||(o+1)*16>this._maxX)&&(this._maxX=(o+1)*16),(this._minZ===void 0||a*16<this._minZ)&&(this._minZ=a*16),(this._maxZ===void 0||(a+1)*16>this._maxZ)&&(this._maxZ=(a+1)*16),this.chunks[l]===void 0&&(this.chunks[l]=[]),this.chunks[l][o]===void 0&&(this.chunks[l][o]=[]);let u=!1;if(this.chunks[l][o][a]===void 0){let c=new To(this,o,a);this.chunkCount++,u=!0,this.chunks[l][o][a]=c}this.chunks[l][o][a].addKeyValue(i),this.chunkCount%1e4===0&&u&&await this._project?.carto.notifyStatusUpdate("Initialized "+this.chunkCount/1e3+"K chunks in "+r.name)}}else if(i===!1&&(t.length===9||t.length===10||t.length===13||t.length===14)){let n=t.length===13||t.length===14,s=Lt.getSignedInteger(t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),!0),o=Lt.getSignedInteger(t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7),!0),a=0;n&&(a=Lt.getSignedInteger(t.charCodeAt(8),t.charCodeAt(9),t.charCodeAt(10),t.charCodeAt(11),!0),C.assert(a>=0&&a<=2,"Unexpected dimension index. ("+a+")")),this.chunks[a]!==void 0&&this.chunks[a][s]!==void 0&&this.chunks[a][s][o]!==void 0&&this.chunks[a][s][o].clearKeyValue(t)}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}await this.notifyLoadEnded(e)}async notifyLoadEnded(e){e!==void 0&&await this._project?.carto.notifyOperationEnded(e,"Completed second-pass load of '"+this.name+"' world.",3)}async saveAutoGenItems(){this._project}getAutoGenScript(){let e=[];if(e.push("export const "+Be.makeNameScriptSafe(this.name)+" = {"),this.anchors){let t=this.anchors.getKeys();e.push("  anchors: {");for(let i of t){let n=this.anchors.get(i);n&&e.push("    "+Be.makeNameScriptSafe(n.name)+": { from: { x: "+n.from.x+", y: "+n.from.y+", z:"+n.from.z+"}},")}e.push("  }")}return e.push("}"),e.join(`
`)}getCube(e,t,i){let n=new fr,s=e.y;s&&s<this.chunkMinY&&(s=this.chunkMinY),n.setMaxDimensions(Math.abs(t.x-e.x),Math.abs(t.y-s),Math.abs(t.z-e.z));let o=Math.floor(e.x/16),a=Math.floor(t.x/16),l=Math.floor(e.z/16),u=Math.floor(t.z/16),c=0,d=(e.x-o*16)%16,h=Math.abs(t.x-e.x)+1;for(let f=o;f<=a;f++){let m=Math.min(h,16,16-d),p=0,g=(e.z-l*16)%16,b=Math.abs(t.z-e.z)+1;for(let F=l;F<=u;F++){let w=this.chunks[i||0][f];if(w){let _=w[F],I=Math.min(b,16,16-g);_&&_.fillCube(n,c,0,p,c+m,Math.abs(t.y-s),p+I,d,s,g)}F===l?(p+=16-g,b-=16-g,g=0):(p+=16,b-=16)}f===o?(c+=16-d,h-=16-d,d=0):(c+=16,h-=16)}return n}getSubChunkCube(e,t,i,n){let s=this.chunks[n||0][Math.floor(e/16)];if(s===null)return;let o=s[Math.floor(i/16)];if(o!==void 0)return o.getSubChunkCube(Math.floor(t/16))}};var Al=class extends Cr{get name(){return this._name}get isContentLoaded(){return!0}get parentFolder(){return this._parentFolder}get fullPath(){let e=this._parentFolder.fullPath;return e.endsWith(Dr.slashFolderDelimiter)||(e+=Dr.slashFolderDelimiter),e+=this._name,e}constructor(e,t){super(),this._parentFolder=e,this._name=t}async deleteThisFile(e){throw new Error("Not implemented.")}async moveTo(e){throw new Error("Not implemented.")}async loadContent(e){if(e||!this.lastLoadedOrSaved){this._content=null;let t=this._parentFolder.storage;if(Ne.isWeb){let i=t.manager.octokit,n=this.fullPath;n.startsWith("/")&&(n=n.substring(1,n.length));let s;try{s=await i.rest.repos.getContent({owner:t.ownerName,repo:t.repoName,ref:t.branch,path:n})}catch(o){if(o.name&&o.name==="HttpError"&&o.message.indexOf("rate limit")>=0)throw new Error(o.message);C.debugAlert("Could not get content for GitHub file: '"+o.toString()+"'")}if(s){let o=s.data;if(o.content!==void 0&&o.encoding!==void 0)if(o.encoding==="base64"){let a=o.content;if(a&&typeof a=="string"&&(a=a.replace(/\n/gi,"")),this._content=new Uint8Array(B.base64ToArrayBuffer(a)),S.getEncodingByFileName(this.name)===1){let u=B.readStringUTF8(new DataView(this._content.buffer),0,this._content.length);this._content=u.str}}else this._content=o.content}}else{this._content=null;let i=this._parentFolder.storage,n="https://raw.githubusercontent.com/"+i.ownerName+"/"+i.repoName+"/"+(i.branch?i.branch:"main")+B.ensureStartsWithSlash(this.fullPath);if(S.getEncodingByFileName(this.name)===0){let s;try{s=await zt.get(n,{responseType:"arraybuffer",headers:{}})}catch{return C.error("Could not retrieve file '"+this.fullPath+"' from '"+n+"'"),this.lastLoadedOrSaved=new Date,this.lastLoadedOrSaved}this._content=new Uint8Array(s.data)}else{let s;try{s=await zt.get(n,{headers:{}})}catch{return C.error("Could not retrieve file '"+this.fullPath+"'",n),this.lastLoadedOrSaved=new Date,this.lastLoadedOrSaved}let o=s.data;if(typeof o=="object")try{o=JSON.stringify(o,null,2)}catch{C.fail("Could not convert file to JSON")}s.status!==200&&(C.fail("Could not retrieve file from '"+n+"' - response code is "+s.status),C.verbose("Could not retrieve file from '"+n+"' - response code is "+s.status)),(o===null||o==="null")&&(C.fail("Could not retrieve file from '"+n+"' - result is null."),C.verbose("Could not retrieve file from '"+n+"' - result is null.")),this._content=o}}this.lastLoadedOrSaved=new Date}return this.lastLoadedOrSaved}setContent(e){S.contentsAreEqual(this._content,e)||(this._content=e,this.contentWasModified())}async saveContent(){if(this.parentFolder.storage.readOnly)throw new Error("Can't save read-only file.");return this.lastLoadedOrSaved=new Date,this.lastLoadedOrSaved}};var Rl=class r extends Sr{get storage(){return this._storage}get parentFolder(){return this._parentFolder}get name(){return this._name}get fullPath(){let e=this._parentPath;return e.endsWith(Dr.slashFolderDelimiter)||(e+=Dr.slashFolderDelimiter),e+=this.name,e}constructor(e,t,i,n){super(),this._storage=e,this._parentFolder=t,this._parentPath=i,this._name=n,this.folders={},this.files={}}async exists(){return!0}async ensureExists(){return!0}async moveTo(e){throw new Error("Not implemented.")}async deleteThisFolder(){throw new Error("Deletion of this folder "+this.fullPath+" is not supported.")}async deleteAllFolderContents(){throw new Error("Deletion of all folder contents at "+this.fullPath+" is not supported.")}ensureFile(e){let t=S.canonicalizeName(e),i=this.files[t];return i==null&&(i=new Al(this,e),this.files[t]=i),i}ensureFolder(e){let t=S.canonicalizeName(e),i=this.folders[t];return i||(i=new r(this._storage,this,this.fullPath,e),this.folders[t]=i),i}async deleteFile(e){throw new Error("Deletion of files not supported")}async createFile(e){throw new Error("Creation of files not supported")}async load(e){if(this.lastLoadedOrSaved!=null&&!e)return this.lastLoadedOrSaved;let t=this.storage.manager.octokit.rest.repos,i=this.fullPath;i==="/"?i="":i.startsWith("/")||(i="/"+i),i.endsWith("/")&&(i=i.substring(0,i.length-1));let n={owner:this.storage.ownerName,repo:this.storage.repoName,path:i},s;try{s=await t.getContent(n)}catch(l){C.debug("Error retrieving repo information: "+this.storage.ownerName+" "+this.storage.repoName+" "+l)}if(s===void 0)return C.debug("No data retrieved from repo: "+this.storage.ownerName+" "+this.storage.repoName),this.updateLastLoadedOrSaved(),this.lastLoadedOrSaved;let a=s.data;for(let l in a){let u=a[l];if(u.type==="dir"){let c=this.ensureFolder(u.name);c.sha=u.sha}else if(u.type==="file"&&S.isUsableFile(u.name)){let c=this.ensureFile(u.name);c.sha=u.sha}}return this.updateLastLoadedOrSaved(),this.lastLoadedOrSaved}};var Dr=class r extends Ni{constructor(e,t,i,n,s=""){if(super(),this.manager=e,this.repoName=t,this.branch=n,this.ownerName=i,i!=="microsoft"&&i!=="mojang")throw new Error("Unsupported GitHub action.");this.subPath=s,this.rootFolder=new Rl(this,null,s,"")}joinPath(e,t){let i=e;return i.endsWith(r.slashFolderDelimiter)||(i+=r.slashFolderDelimiter),i+=t,i}static getParentFolderPath(e){let t=e.lastIndexOf(this.slashFolderDelimiter);return t<0?e:e.substring(0,t)}};var Uw=Le(Je());var Ci=class r{static{this._pendingStringPromiseResolvers=[]}static{this._pendingArrayBufferPromiseResolvers=[]}static{this._pendingStringPromiseRejecters=[]}static{this._pendingArrayPromiseRejecters=[]}static{this._onMessage=new Uw.EventDispatcher}static get onMessage(){return r._onMessage.asEvent()}static get hasAppService(){return r._api!==void 0}static get hasAppServiceOrDebug(){return r._api!==void 0||B.isDebug}static get hasAppServiceOrSim(){return r._api!==void 0||B.isAppSim}static init(){typeof window<"u"&&(r._api=window.api,r._api&&Ne.hostType!==5&&Ne.hostType!==7&&(Ne.hostType=3)),r._api!==void 0&&(r._api.receive("appsvc",r._handleNewMessage),C.onItemAdded.subscribe(r._handleLog))}static _handleLog(e,t){r.logToConsole(t.message)}static async logToConsole(e){await r.sendAsync("logToConsole",e)}static send(e,t){if(r._api===void 0){if(B.isAppSim){C.debugAlert("Command: "+e+" Data: "+t);return}throw new Error("Not an Electron API")}if(e==="fsWriteFile"){let n=t.content;n instanceof Uint8Array?n=B.uint8ArrayToBase64(n):t instanceof ArrayBuffer?n=B.arrayBufferToBase64(n):(t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Uint8ClampedArray||t instanceof BigUint64Array)&&C.fail("Unsupported binary type encountered."+t),t.content=n}let i;try{i=r._api.send("appweb",e,t)}catch(n){let s=t;throw typeof t=="object"&&(s=JSON.stringify(t)),new Error("Error running command "+e+", data: "+s+", error: "+n)}return e==="fsReadFile"?i===void 0||i.length===0?void 0:B.base64ToArrayBuffer(i):i}static sendAsyncBinary(e,t){let i=new Promise(r._arrayBufferPromiseHandler);if(r._api===void 0){if(B.isAppSim)return C.debugAlert("Command: "+e+" Data: "+t),i;throw new Error("Not an Electron API")}let n=r._pendingArrayBufferPromiseResolvers.length-1,s="bsync"+e+"|"+n;return r._api.send("appweb",s,t),i}static sendBinaryAsync(e,t){let i=new Promise(r._stringPromiseHandler);if(r._api===void 0){if(B.isAppSim)return C.debugAlert("Command: "+e+" Data: "+t),i;throw new Error("Not an Electron API")}let n=t.content;n instanceof Uint8Array?n=B.uint8ArrayToBase64(n):t instanceof ArrayBuffer?n=B.arrayBufferToBase64(n):(t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Uint8ClampedArray||t instanceof BigUint64Array)&&C.fail("Unsupported binary type encountered."+t),t.content=n;let s=r._pendingStringPromiseResolvers.length-1,o="async"+e+"|"+s;return r._api.send("appweb",o,t),i}static sendAsync(e,t,i){let n=new Promise(r._stringPromiseHandler);if(r._api===void 0){if(B.isAppSim)return i||C.debugAlert("Command: "+e+" Data: "+t),n;throw new Error("Not an Electron API")}let s=r._pendingStringPromiseResolvers.length-1,o="async"+e+"|"+s;return r._api.send("appweb",o,t),n}static sendHost(e,t,i){if(r._api===void 0)throw new Error("Not an Electron API");typeof i=="object"?i=JSON.stringify(i):typeof i!="string"&&(i=i.toString()),r._api.send(e,t,i)}static openLinkExternal(e){try{typeof window<"u"&&window.open(e,"_blank")}catch{}}static _arrayBufferPromiseHandler(e,t){let i=r._pendingArrayBufferPromiseResolvers.length;r._pendingArrayBufferPromiseResolvers[i]=e,r._pendingStringPromiseRejecters[i]=t}static _stringPromiseHandler(e,t){let i=r._pendingStringPromiseResolvers.length;r._pendingStringPromiseResolvers[i]=e,r._pendingStringPromiseRejecters[i]=t}static _handleNewMessage(e){if(e!==null&&e.length>0)if(e.startsWith("async")){let t=e.split("|");if(t.length>2){let i=parseInt(t[1]);if(i>=0){let n=r._pendingStringPromiseResolvers[i],s=t[2];s==="<undefined>"&&(s=void 0),n(s)}}}else if(e.startsWith("bsync")){let t=e.split("|");if(t.length>2){let i=parseInt(t[1]);if(i>=0){let n=r._pendingArrayBufferPromiseResolvers[i],s;t[2]!=="<undefined>"&&(s=B.base64ToArrayBuffer(t[2])),n(s)}}}else{let t=e.indexOf("|");t>=0&&r._onMessage.dispatch(e.substring(0,t),e.substring(t+1,e.length))}}};var j=class{#e;#r;get dataObject(){return this.#e}get itemType(){return this.#e.iTp}get message(){return this.#e.m}set message(e){this.#e.m=e}get generatorId(){return this.#e.gId}get generatorIndex(){return this.#e.gIx}get projectItem(){return this.#r}get data(){return this.#e.d}set data(e){this.#e.d=e}get content(){return this.#e.c}get featureSets(){return this.#e.fs}get contentSummary(){let e=this.#e.c;return e&&(e=e.replace(/\n/gi," "),e=e.replace(/\r/gi," "),e.length>80&&(e=e.substring(0,77)+"...")),e}disconnect(){this.#r=void 0}get typeSummary(){switch(this.#e.iTp){case 2:return"Info";case 4:return"Warning";case 6:return"Recommendation";case 7:return"Feature aggregation";case 1:return"Test fail";case 0:return"Test success";case 3:return"Error";default:return"Unknown"}}get projectItemPath(){if(this.projectItem)return this.projectItem.projectPath;if(this.#e.p)return this.#e.p}get shortProjectItemPath(){if(this.projectItem&&this.projectItem.projectPath)return Be.getAfterPackPath(this.projectItem.projectPath);if(this.#e.p)return Be.getAfterPackPath(this.#e.p)}get typeSummaryShort(){let e=this.typeSummary.toUpperCase();return e=e.replace(/\s/g,""),e}toString(){let e=this.typeSummaryShort+": ";e+="["+this.generatorId+B.frontPadToLength(this.generatorIndex,3,"0")+"] ",this.projectItem?e+="("+this.projectItem.projectPath+") ":this.#e.p&&(e+="("+this.#e.p+") "),this.message&&(e+=this.message),this.data&&(e+=": "+this.data);let t=this.contentSummary;return t&&(e+=" [in "+t+"]"),e}minFeature(e,t,i){this.#e.fs===void 0&&(this.#e.fs={});let n=this.#e.fs[e];n===void 0&&(n={},this.#e.fs[e]=n);let s=n[t];s===void 0?s=i:s=Math.min(s,i),n[t]=s}maxFeature(e,t,i){this.#e.fs===void 0&&(this.#e.fs={});let n=this.#e.fs[e];n===void 0&&(n={},this.#e.fs[e]=n);let s=n[t];s===void 0?s=i:s=Math.max(s,i),n[t]=s}getFeatureContaining(e){e=e.toLowerCase();for(let t in this.#e.fs){let i=this.#e.fs[t];if(i){for(let n in i)if(n.toLowerCase().indexOf(e)>=0)return i[n]}}}spectrumFeature(e,t){this.#e.fs===void 0&&(this.#e.fs={}),this.incrementFeature(e,"Instance Count",1),this.incrementFeature(e,"Total",t),this.maxFeature(e,"Max",t),this.minFeature(e,"Min",t);let i=this.#e.fs[e];i===void 0&&(i={},this.#e.fs[e]=i);let n=i.Total,s=i["Instance Count"];s&&n!==void 0&&(i.Average=n/s)}spectrumIntFeature(e,t){this.#e.fs===void 0&&(this.#e.fs={});let i=this.#e.fs[e];i===void 0&&(i={},this.#e.fs[e]=i),this.incrementFeature(e,"Instance Count",1),this.incrementFeature(e,"Total",t),this.maxFeature(e,"Max",t),this.minFeature(e,"Min",t);let n=i.Total,s=i["Instance Count"];s&&n!==void 0&&(i.Average=Math.round(n/s))}incrementFeature(e,t,i){this.#e.fs===void 0&&(this.#e.fs={}),t===void 0&&(t="Count"),i===0?i=0:i===void 0&&(i=1);let n=this.#e.fs[e];n===void 0&&(n={},this.#e.fs[e]=n);let s=n[t];s?s+=i:s=i,n[t]=s}constructor(e,t,i,n,s,o,a,l,u){this.#e={iTp:e,gId:t,gIx:i,m:n,p:s?s.projectPath:u,d:o,iId:a,c:l,fs:void 0},this.#r=s}};var Ot=class{#e;get dataObject(){return this.#e}get resultType(){return this.#e.resultType}get message(){return this.#e.message}get updaterId(){return this.#e.updaterId}get updaterIndex(){return this.#e.updaterIndex}get data(){return this.#e.data}get content(){return this.#e.content}get contentSummary(){let e=this.#e.content;return e&&(e=e.replace(/\n/gi," "),e=e.replace(/\r/gi," "),e.length>80&&(e=e.substring(0,77)+"...")),e}get typeSummary(){switch(this.#e.resultType){case 0:return"No changes";case 1:return"Updated file";default:return"Unknown"}}get typeSummaryShort(){let e=this.typeSummary.toUpperCase();return e=e.replace(/\s/g,""),e}toString(){let e=this.typeSummaryShort+": ";e+="["+this.updaterId+B.frontPadToLength(this.updaterIndex,3,"0")+"] ",e+=this.message,this.data&&(e+=": "+this.data);let t=this.contentSummary;return t&&(e+=" [in "+t+"]"),e}constructor(e,t,i,n,s,o,a,l){this.#e={resultType:e,updaterId:t,updaterIndex:i,message:n,itemStoragePath:s?s.projectPath:void 0,data:o,itemId:a,content:l}}};var Gw=Le(Je());var As=class r{constructor(){this._isLoaded=!1;this._onLoaded=new Gw.EventDispatcher;this.project=void 0}get isLoaded(){return this._isLoaded}get file(){return this._file}set file(e){this._file=e}get onLoaded(){return this._onLoaded.asEvent()}get id(){return this._id}set id(e){this._id=e}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}async ensureEnvFile(e){if(this._file===void 0)return;await this.load();let t=this._file?.content;t===null&&(t="")}async persist(){this._file}async save(){this._file!==void 0&&(this._file.isContentLoaded&&this.project&&this._file.content&&typeof this._file.content=="string"&&this._file.setContent(await r.getContent(this.project,this._file.content)),await this._file.saveContent(!1))}async load(){this._file===void 0||this._isLoaded||(await this._file.loadContent(!0),!(this._file.content===null||this._file.content instanceof Uint8Array)&&(this._isLoaded=!0))}static async getContent(e,t){t===void 0&&(t=`PROJECT_NAME=""\r
MINECRAFT_PRODUCT="BedrockUWP"\r
CUSTOM_DEPLOYMENT_PATH=""\r
`);let i=await e.getDefaultBehaviorPackFolder();if(i){let o=t.indexOf('PROJECT_NAME="');if(o>=0){let a=t.indexOf('"',o+14);a>o&&(t=t.substring(0,o)+'PROJECT_NAME="'+i.name+t.substring(a))}else t.endsWith(`
`)||(t+=`\r
`),t=t+'PROJECT_NAME="'+i.name+`"\r
`}let n=t.indexOf('MINECRAFT_PRODUCT="'),s=e.track===1?"PreviewURP":"BedrockUWP";if(n>=0){let o=t.indexOf('"',n+19);o>n&&(t=t.substring(0,n)+'MINECRAFT_PRODUCT="'+s+t.substring(o))}else t.endsWith(`
`)||(t+=`\r
`),t=t+'MINECRAFT_PRODUCT="'+s+`"\r
`;return t}};var Rs=class{constructor(){this.id="SCRIPTMODULE";this.title="Script Modules";this.modulesInUse={};this.packRegsInUse={}}getTopicData(e){return{title:e.toString()}}getUpdaterData(e){return{title:e.toString()}}summarize(e,t){}async generateProjectState(e){let t=[];this.modulesInUse={},this.packRegsInUse={};let i=e.getItemsCopy();for(let n=0;n<i.length;n++){let s=i[n];if(s.itemType===5){if(await s.ensureFileStorage(),s.file){let o=await Et.ensureOnFile(s.file);if(o&&o.definition&&o.definition.dependencies){let a=o.definition.dependencies;for(let l=0;l<a.length;l++){let u=a[l];if(u.module_name&&u.version){let c="";typeof u.version=="string"?c=u.version:c=u.version.join("."),this.modulesInUse[u.module_name]||(this.modulesInUse[u.module_name]=[]),t.push(new j(2,this.id,100,"Behavior pack dependency on "+c+" at "+u.module_name,s,c,u.module_name)),this.modulesInUse[u.module_name].push({version:c,manifest:o,item:s})}}}}}else if(s.itemType===59){if(await s.ensureFileStorage(),s.file){let o=await Hr.ensureOnFile(s.file);if(o&&o.definition){let a=o.definition.dependencies,l=o.definition.devDependencies;if(a)for(let u in a)u.startsWith("@minecraft/")&&(this.packRegsInUse[u]||(this.packRegsInUse[u]=[]),this.packRegsInUse[u].push({package:o,isDevDependency:!1,version:a[u]}),t.push(new j(2,this.id,101,"Package.json registers usage of "+u+" at "+a[u],s,a[u],u)));if(l)for(let u in l)u.startsWith("@minecraft/")&&(this.packRegsInUse[u]||(this.packRegsInUse[u]=[]),this.packRegsInUse[u].push({package:o,isDevDependency:!0,version:l[u]}),t.push(new j(2,this.id,102,"Package.json registers developer usage of "+u+" at "+l[u],s,l[u],u)))}}}else s.itemType===121&&(await s.ensureFileStorage(),s.file&&await(await As.ensureOnFile(s.file))?.ensureEnvFile(e))}return t}async generate(e,t){let i=await this.generateProjectState(e),n=!1,s=!1,o=!1;for(let a of e.items)a.itemType===59&&(o=!0);for(let a in this.modulesInUse){let l=this.modulesInUse[a];if(n=!0,l){let u=await oe.getModuleDescriptor(a);if(u){if(u.betaVersion)for(let d=0;d<l.length;d++){let h=l[d];h.version.indexOf("-beta")>=0&&(h.version.startsWith(u.betaVersion)||(i.push(new j(3,this.id,114,"For "+a+", using an out of date beta version: "+h.version+" compared to what is available ("+u.betaVersion+")",h.item,h.version)),s=!0))}!this.packRegsInUse[a]&&o&&(i.push(new j(3,this.id,110,"Could not find an package.json registration for "+a,void 0,a)),s=!0)}else o&&(i.push(new j(3,this.id,111,"Could not find an NPMJS.org NPM module registration for "+a,void 0,a)),s=!0)}}return n?s&&i.push(new j(0,this.id,262,"Script module version check passes.")):i.push(new j(0,this.id,260,"No script module was found; script module version check passes.")),i}async update(e,t){let i=[];switch(t){case 1:let n=await this.updateModulesToLatestVersion(e);i.push(...n);break}return i}getUpdateIds(){return[1]}async updateModulesToLatestVersion(e){let t=[];await this.generateProjectState(e);for(let i in this.modulesInUse){let n=this.modulesInUse[i];if(n){let s=await oe.getModuleDescriptor(i);if(s)for(let o=0;o<n.length;o++){let a=n[o];a.version.indexOf("-beta")>=0?s.betaVersion&&a.manifest.setModuleVersion(i,s.betaVersion+"-beta")&&(await a.manifest.save(),t.push(new Ot(1,this.id,1,"Set module to latest beta version",void 0,s.betaVersion+"-beta"))):a.version.indexOf("-")<1&&s.latest&&(a.manifest.setModuleVersion(i,s.latest),await a.manifest.save(),t.push(new Ot(1,this.id,1,"Set module to latest stable version",void 0,s.latest)))}}}return t}};var zw=Le(Je());var $n=class r{constructor(){this._isLoaded=!1;this._onLoaded=new zw.EventDispatcher}get isLoaded(){return this._isLoaded}get file(){return this._file}set file(e){this._file=e}get onLoaded(){return this._onLoaded.asEvent()}get id(){return this._id}set id(e){this._id=e}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}async persist(){if(this._file===void 0)return;let e=JSON.stringify(this.definition,null,2);this._file.setContent(e)}async save(){this._file!==void 0&&(this.persist(),await this._file.saveContent(!1))}async hasMinContent(){if(await this.load(),!this.definition||!this.definition.tasks)return!1;for(let e of this.definition.tasks)if(e.dependsOn&&e.label==="build"){for(let t of e.dependsOn)if(B.replaceAll(t.toLowerCase()," ","")==="minecraft:deploy")return!0}return!1}async ensureMinContent(){if(await this.hasMinContent())return!0;this.definition||(this.definition={}),this.definition.version||(this.definition.version="2.0.0"),this.definition.tasks||(this.definition.tasks=[]);let t=!1;for(let i of this.definition.tasks)if(i.label==="build"){i.dependsOn||(i.dependsOn=[]);for(let n of i.dependsOn)B.replaceAll(n.toLowerCase()," ","")==="minecraft:deploy"&&(t=!0);t||(i.dependsOn.push("minecraft: deploy"),t=!0)}return t||(this.definition.tasks.push({label:"build",dependsOrder:"sequence",dependsOn:["minecraft: deploy"]}),!0)}async load(){if(!(this._file===void 0||this._isLoaded)&&(await this._file.loadContent(),!(this._file.content===null||this._file.content instanceof Uint8Array))){this.id=this._file.name;try{let e=JSON.parse(this._file.content);this.definition=e}catch(e){C.fail("Could not parse vscode launch JSON "+e)}this._isLoaded=!0}}};var Vw=Le(Je());var Hn=class r{constructor(){this._isLoaded=!1;this._onLoaded=new Vw.EventDispatcher;this.project=void 0}get isLoaded(){return this._isLoaded}get file(){return this._file}set file(e){this._file=e}get onLoaded(){return this._onLoaded.asEvent()}get id(){return this._id}set id(e){this._id=e}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}async hasMinContent(e){if(e||(e={isServer:!1}),await this.load(),!this.definition||!this.definition.configurations)return!1;for(let t of this.definition.configurations)if(t.type&&t.type==="minecraft-js")return!(e.isServer&&t.mode==="listen"||!e.isServer&&t.mode!=="listen"||e.port&&t.port!==e.port);return!1}async ensureMinContent(e){if(e||(e={isServer:!1}),await this.hasMinContent(e))return!0;this.definition||(this.definition={}),(!this.definition.version||this.definition.version==="0.2.0")&&(this.definition.version="0.3.0"),this.definition.configurations||(this.definition.configurations=[]);let i=!1;for(let n of this.definition.configurations)n.type==="minecraft-js"&&(await this.applyDebugSettingsToConfig(n,e),i=!0);if(!i){let n={type:"minecraft-js",port:e.port?e.port:19144};return await this.applyDebugSettingsToConfig(n,e),this.definition.configurations.push(n),!0}return i}async applyDebugSettingsToConfig(e,t){t.isServer?e.mode=void 0:e.mode="listen",e.name===void 0&&(e.name="Debug with Minecraft"),e.preLaunchTask===void 0&&(e.preLaunchTask="build");let i=t.behaviorPackFolderName;if(i===void 0&&(i="starterbp"),!e.targetedModuleUuid&&this.project){let n=await this.project.getDefaultBehaviorPack();if(n&&n.manifest instanceof Et){let s=n.manifest.getScriptModule();s&&(e.targetedModuleUuid=s.uuid)}}e.sourceMapRoot||(e.sourceMapRoot="${workspaceFolder}/dist/debug/"),e.generatedSourceRoot||(e.generatedSourceRoot="${workspaceFolder}/dist/scripts/"),t.port&&(e.port=t.port)}async persist(){if(this._file===void 0)return;let e=JSON.stringify(this.definition,null,2);this._file.setContent(e)}async save(){this._file!==void 0&&(this.persist(),await this._file.saveContent(!1))}async load(){this._file===void 0||this._isLoaded||(await this._file.loadContent(),!(this._file.content===null||this._file.content instanceof Uint8Array)&&(this.id=this._file.name,this.definition=S.getJsonObject(this._file),this._isLoaded=!0))}};var Bs=class{constructor(){this.id="VSCODEFILE";this.title="VSCode Files"}getTopicData(e){return{title:e.toString()}}getUpdaterData(e){return{title:e.toString()}}summarize(e,t){}async generate(e,t){let i=[],n=e.getItemsCopy();for(let s of n)if(s.itemType===76&&s.storageType===0){if(await s.ensureFileStorage(),s.file){let o=await $n.ensureOnFile(s.file);o&&(await o.hasMinContent()||i.push(new j(2,this.id,100,"Project has a VSCode tasks file, but no minecraft deploy tasks.",s,void 0,s.file.storageRelativePath)))}}else if(s.itemType===75&&s.storageType===0&&(await s.ensureFileStorage(),s.file)){let o=await Hn.ensureOnFile(s.file);o&&(o.project=e,await o.hasMinContent({isServer:!0})||i.push(new j(2,this.id,101,"Project has a VSCode launch file, but is not configured for Minecraft server launch.",s,void 0,s.file.storageRelativePath)))}return i}async update(e,t){let i=[];switch(t){case 1:i.push(...await this.ensureMinecraftLaunchTasks(e));break;case 2:i.push(...await this.ensureMinecraftDebugConfig(e));break}return i}getUpdateIds(){return[1,2]}async ensureMinecraftLaunchTasks(e){let t=[],i=e.getItemsCopy();for(let n of i)if(n.itemType===76&&n.storageType===0&&(await n.ensureFileStorage(),n.file)){let s=await $n.ensureOnFile(n.file);s&&(await s.hasMinContent()||await s.ensureMinContent()&&(await s.save(),t.push(new Ot(1,this.id,1,"Updated Minecraft Tasks",n))))}return t}async ensureMinecraftDebugConfig(e){let t=[],i=e.getItemsCopy();for(let n of i)if(n.itemType===75&&n.storageType===0&&(await n.ensureFileStorage(),n.file)){let s=await Hn.ensureOnFile(n.file),o=await e.getDefaultBehaviorPack(),a={isServer:!0};o&&o.folder&&(a.behaviorPackFolderName=o.folder.name),s&&(await s.hasMinContent(a)||await s.ensureMinContent(a)&&(await s.save(),t.push(new Ot(1,this.id,2,"Updated Minecraft Launch JSON",n))))}return t}};var Ww=Le(Je());var qr=class r{constructor(){this._isLoaded=!1;this._onLoaded=new Ww.EventDispatcher}get isLoaded(){return this._isLoaded}get file(){return this._file}set file(e){this._file=e}get onLoaded(){return this._onLoaded.asEvent()}get description(){if(!(!this.definition||!this.definition.header))return this.definition.header.description}set description(e){this.definition&&this.definition.header&&e&&(this.definition.header.description=e)}get name(){if(this.definition&&this.definition.header)return this.definition.header.name}set name(e){this.definition&&this.definition.header&&e&&(this.definition.header.name=e)}get uuid(){return this.definition&&this.definition.header?this.definition.header.uuid:this._id}set uuid(e){this.definition&&this.definition.header&&e&&(this.definition.header.uuid=e),this._id=e}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}get baseGameVersion(){if(!(!this.definition||!this.definition.header||!this.definition.header.base_game_version))return this.definition.header.base_game_version}setBaseGameVersion(e,t){let i=this.ensureHeaderForProject(t);i.base_game_version=e}persist(){if(this._file===void 0)return;let e=JSON.stringify(this.definition,null,2);this._file.setContent(e)}ensureDefinition(e,t){this.definition||(this.definition={format_version:2,header:{name:e,description:t,version:[0,0,1],base_game_version:[1,20,10],uuid:B.createUuid()},modules:[]})}ensureHeaderForProject(e){return this.ensureHeader(e.title,e.description)}ensureHeader(e,t){if(this.ensureDefinition(e,t),!this.definition)throw new Error;return this.definition.header||(this.definition.header=this.getDefaultHeader(e,t)),this.definition.header}getDefaultHeader(e,t){return{name:e,description:t,version:[0,0,1],min_engine_version:[1,20,10],uuid:B.createUuid(),base_game_version:[1,20,10]}}async save(){this._file!==void 0&&(this.persist(),await this._file.saveContent(!1))}async load(){this._file===void 0||this._isLoaded||(await this._file.loadContent(),!(this._file.content===null||this._file.content instanceof Uint8Array)&&(this.uuid=this._file.name,this.definition=S.getJsonObject(this._file),this._isLoaded=!0))}};var Ls=class{constructor(){this.id="MINENGINEVER";this.title="Min Engine Version";this.performPlatformVersionValidations=!1}getTopicData(e){let t={updaterId:this.id,updaterIndex:1,action:"Set min_engine_version to latest version."};switch(e){case 100:return{title:"Behavior Pack Min Engine Version Defined"};case 110:return{title:"Behavior Pack Min Engine Version Major Version Lower than Current",updaters:[t]};case 111:return{title:"Behavior Pack Min Engine Version Major Version Higher than Current",updaters:[t]};case 120:return{title:"Behavior Pack Min Engine Version Minor Version Lower than Current",updaters:[t]};case 121:return{title:"Behavior Pack Min Engine Version Minor Version Higher than Current",updaters:[t]};case 130:return{title:"Behavior Pack Min Engine Version Patch Version Lower than Current",updaters:[t]};case 131:return{title:"Behavior Pack Min Engine Version Patch Version Higher than Current",updaters:[t]};case 200:return{title:"Resource Pack Min Engine Version Defined"};case 210:return{title:"Resource Pack Min Engine Version Major Version Lower than Current",updaters:[t]};case 211:return{title:"Resource Pack Min Engine Version Major Version Higher than Current",updaters:[t]};case 220:return{title:"Resource Pack Min Engine Version Minor Version Lower than Current",updaters:[t]};case 221:return{title:"Resource Pack Min Engine Version Minor Version Higher than Current",updaters:[t]};case 230:return{title:"Resource Pack Min Engine Version Patch Version Lower than Current",updaters:[t]};case 231:return{title:"Resource Pack Min Engine Version Patch Version Higher than Current",updaters:[t]};case 500:return{title:"Retrieve Latest Minecraft Version"};case 501:return{title:"Parse Latest Minecraft Version"}}return{title:e.toString()}}getUpdaterData(e){return{title:e.toString()}}summarize(e,t){}async generate(e,t){let i=[],n=await oe.getLatestVersionInfo(e.effectiveTrack),s=!1,o=!1,a=!1,l=!1,u=!1,c=!1;if(!n)return i.push(new j(5,this.id,500,"Could not retrieve version.")),i;let d=n.split(".");if(d.length<3||d.length>4)return i.push(new j(5,this.id,501,"Could not process latest product version.",void 0,n)),i;let h=d[0]+"."+d[1]+"."+d[2],f=e.getItemsCopy();for(let m=0;m<f.length;m++){let p=f[m];if(p.itemType===5){if(await p.ensureFileStorage(),p.file){s=!0;let g=await Et.ensureOnFile(p.file);if(g)if(!g.definition||!g.definition.header||!g.definition.header.min_engine_version)i.push(new j(3,this.id,100,"Behavior pack manifest does not define a header/min_engine_version.",p)),c=!0;else{let b=g?.definition?.header.min_engine_version;b[0]<parseInt(d[0])?i.push(new j(this.performPlatformVersionValidations?3:6,this.id,110,"Behavior pack manifest ("+b.join(".")+") has a lower major version number compared to current version ("+h+")",p)):b[0]>parseInt(d[0])?(i.push(new j(3,this.id,111,"Behavior pack manifest ("+b.join(".")+") has a higher major version number compared to current version ("+h+")",p)),c=!0):b[1]<parseInt(d[1])-1?i.push(new j(this.performPlatformVersionValidations?3:6,this.id,120,"Behavior pack manifest ("+b.join(".")+") has a lower minor version number compared to the current version or the previous current minor version ("+h+")",p)):b[1]>parseInt(d[1])&&(i.push(new j(3,this.id,121,"Behavior pack manifest ("+b.join(".")+") has a higher minor version number compared to current version ("+h+")",p)),c=!0)}}}else if(p.itemType===14){if(await p.ensureFileStorage(),p.file){let g=await jt.ensureOnFile(p.file);if(g)if(o=!0,!g.definition||!g.definition.header||!g.definition.header.min_engine_version)i.push(new j(3,this.id,200,"Resource pack manifest does not define a header/min_engine_version.",p));else{let b=g?.definition?.header.min_engine_version;b[0]<parseInt(d[0])?i.push(new j(3,this.id,210,"Resource pack manifest ("+b.join(".")+") has a lower major version number compared to current version ("+h+")",p)):b[0]>parseInt(d[0])?i.push(new j(3,this.id,211,"Resource pack manifest ("+b.join(".")+") has a higher major version number compared to current version ("+h+")",p)):b[1]<parseInt(d[1])-1?i.push(new j(this.performPlatformVersionValidations?3:6,this.id,220,"Resource pack manifest ("+b.join(".")+") has a lower minor version number compared to current version or the previous current minor version ("+h+")",p)):b[1]>parseInt(d[1])&&i.push(new j(3,this.id,221,"Resource pack manifest ("+b.join(".")+") has a higher minor version number compared to current version ("+h+")",p))}}}else p.itemType===67?(await p.ensureFileStorage(),p.file&&await Ps.ensureOnFile(p.file)&&(a=!0)):p.itemType===68?(await p.ensureFileStorage(),p.file&&await qr.ensureOnFile(p.file)&&(l=!0)):p.itemType===125&&(await p.ensureFileStorage(),p.file&&await Es.ensureOnFile(p.file)&&(u=!0))}return!s&&!o&&!a&&!l&&!u&&i.push(new j(1,this.id,180,"No resource/behavior/skin pack manifest or world template manifest was found.")),c?i.push(new j(1,this.id,181,"Errors found with minimum engine version check.")):c&&i.push(new j(0,this.id,262,"Pack manifest/version checks passes.")),i}async update(e,t){let i=[];switch(t){case 1:let n=await this.updateMinEngineVersionToLatestVersion(e);i.push(...n);break}return i}getUpdateIds(){return[1]}async updateMinEngineVersionToLatestVersion(e){let t=[],i=await oe.getLatestVersionInfo(e.effectiveTrack);if(!i)return t.push(new Ot(99,this.id,199,"Could not retrieve version.")),t;let n=i.split(".");if(n.length<3||n.length>4)return t.push(new Ot(99,this.id,200,"Could not retrieve latest product version.",void 0,i)),t;let s=parseInt(n[0]),o=parseInt(n[1]),a=parseInt(n[2]),l=e.getItemsCopy();for(let u=0;u<l.length;u++){let c=l[u];if(c.itemType===5&&(await c.ensureFileStorage(),c.file)){let d=await Et.ensureOnFile(c.file);if(d){let h=d.minEngineVersion;(!h||h.length<3||h.length>4||h[0]!==s||h[1]!==o||h[2]!==a)&&(d.setMinEngineVersion([s,o,a],e),d.persist(),t.push(new Ot(1,this.id,200,"Updated behavior pack min_engine_version to '"+s+"."+o+"."+a+"'.",c,i)))}}if(c.itemType===14&&(await c.ensureFileStorage(),c.file)){let d=await jt.ensureOnFile(c.file);if(d){let h=d.minEngineVersion;(!h||h.length<3||h.length>4||h[0]!==s||h[1]!==o||h[2]!==a)&&(d.setMinEngineVersion([s,o,a],e),d.persist(),t.push(new Ot(1,this.id,201,"Updated resource pack min_engine_version to '"+s+"."+o+"."+a+"'.",c,i)))}}}return t}};var Os=class{constructor(){this.id="BASEGAMEVER";this.title="Base Game Version";this.performPlatformVersionValidations=!1}getTopicData(e){let t={updaterId:this.id,updaterIndex:1,action:"Set base_game_version to latest version."};switch(e){case 100:return{title:"World Template Base Game Version Defined"};case 110:return{title:"World Template Base Game Version Major Version Lower than Current",updaters:[t]};case 111:return{title:"World Template Base Game Version Major Version Higher than Current",updaters:[t]};case 120:return{title:"World Template Base Game Version Minor Version Lower than Current",updaters:[t]};case 121:return{title:"World Template Base Game Version Minor Version Higher than Current",updaters:[t]};case 130:return{title:"World Template Base Game Version Patch Version Lower than Current",updaters:[t]};case 131:return{title:"World Template Base Game Version Patch Version Higher than Current",updaters:[t]};case 500:return{title:"Retrieve Latest Minecraft Version"};case 501:return{title:"Parse Latest Minecraft Version"}}return{title:e.toString()}}getUpdaterData(e){return{title:e.toString()}}summarize(e,t){}async generate(e,t){let i=[],n=await oe.getLatestVersionInfo(e.effectiveTrack),s=!1,o=!1;if(!n)return i.push(new j(5,this.id,500,"Could not retrieve version.")),i;let a=n.split(".");if(a.length<3||a.length>4)return i.push(new j(5,this.id,501,"Could not latest product retrieve version.",void 0,n)),i;let l=a[0]+"."+a[1]+"."+a[2],u=e.getItemsCopy();for(let c=0;c<u.length;c++){let d=u[c];if(d.itemType===68&&(await d.ensureFileStorage(),d.file)){s=!0;let h=await qr.ensureOnFile(d.file);if(h)if(!h.definition||!h.definition.header||!h.definition.header.base_game_version)i.push(new j(3,this.id,100,"World template manifest does not define a header/base_game_version.",d)),o=!0;else{let f=h?.definition?.header.base_game_version;f[0]<parseInt(a[0])?i.push(new j(this.performPlatformVersionValidations?3:6,this.id,110,"World template manifest base game version ("+f.join(".")+") has a lower major version number compared to current version ("+l+")",d)):f[0]>parseInt(a[0])?(i.push(new j(3,this.id,111,"World template manifest base game version ("+f.join(".")+") has a higher major version number compared to current version ("+l+")",d)),o=!0):f[1]<parseInt(a[1])-1?i.push(new j(this.performPlatformVersionValidations?3:6,this.id,120,"World template manifest base game version ("+f.join(".")+") has a lower minor version number compared to the current version or the previous current minor version ("+l+")",d)):f[1]>parseInt(a[1])?(i.push(new j(3,this.id,121,"World template manifest base game version ("+f.join(".")+") has a higher minor version number compared to current version ("+l+")",d)),o=!0):f[2]<parseInt(a[2])?i.push(new j(6,this.id,130,"World template manifest base game version ("+f.join(".")+") has a lower patch version number compared to current version ("+l+")",d)):f[2]>parseInt(a[2])&&f[1]===parseInt(a[1])&&(i.push(new j(3,this.id,131,"World template manifest base game version ("+f.join(".")+") has a higher patch version number compared to current version ("+l+")",d)),o=!0)}}}return s?o?i.push(new j(1,this.id,261,"Base game version check fails.")):o&&i.push(new j(0,this.id,262,"Base game version check passes.")):i.push(new j(0,this.id,260,"No world template was found; base game version check passes.")),i}async update(e,t){let i=[];switch(t){case 1:let n=await this.updateBaseGameVersionToLatestVersion(e);i.push(...n);break}return i}getUpdateIds(){return[1]}async updateBaseGameVersionToLatestVersion(e){let t=[],i=await oe.getLatestVersionInfo(e.effectiveTrack);if(!i)return t.push(new Ot(99,this.id,199,"Could not retrieve version.")),t;let n=i.split(".");if(n.length<3||n.length>4)return t.push(new Ot(99,this.id,200,"Could not retrieve latest product version.",void 0,i)),t;let s=parseInt(n[0]),o=parseInt(n[1]),a=parseInt(n[2]),l=e.getItemsCopy();for(let u=0;u<l.length;u++){let c=l[u];if(c.itemType===68&&(await c.ensureFileStorage(),c.file)){let d=await qr.ensureOnFile(c.file);if(d){let h=d.baseGameVersion;(!h||h.length<3||h.length>4||h[0]!==s||h[1]!==o||h[2]!==a)&&(d.setBaseGameVersion([s,o,a],e),d.persist(),t.push(new Ot(1,this.id,200,"Updated world template base_game_version to '"+s+"."+o+"."+a+"'.",c,i)))}}}return t}};var Ms=class{constructor(){this.id="BPENTITYTYPE";this.title="Entity Type Behavior Pack"}getTopicData(e){let t={updaterId:this.id,updaterIndex:1,action:"Set behavior pack entity type format to latest version."};switch(e){case 2:return{title:"Entity Type Runtime Identifier"};case 3:return{title:"Entity Type Identifier"};case 4:return{title:"Entity Type Metadata"};case 100:return{title:"Behavior Pack Entity Type Format Version defined"};case 110:return{title:"Behavior Pack Entity Type Format Version Major Version Lower than Current",updaters:[t]};case 111:return{title:"Behavior Pack Entity Type Format Version Major Version Higher than Current",updaters:[t]};case 120:return{title:"Behavior Pack Entity Type Format Version Minor Version Lower than Current",updaters:[t]};case 121:return{title:"Behavior Pack Entity Type Format Version Minor Version Higher than Current",updaters:[t]};case 130:return{title:"Behavior Pack Entity Type Format Version Patch Version Lower than Current",updaters:[t]};case 131:return{title:"Behavior Pack Entity Type Format Version Patch Version Higher than Current",updaters:[t]};case 500:return{title:"Retrieve Latest Minecraft Version"};case 501:return{title:"Parse Latest Minecraft Version"}}return{title:e.toString()}}getUpdaterData(e){return{title:e.toString()}}summarize(e,t){}async generate(e,t){let i=[],n=await oe.getLatestVersionInfo(e.effectiveTrack),s=!1,o=!1;if(!n)return i.push(new j(5,this.id,509,"Could not retrieve version.")),i;let a=n.split(".");if(a.length<3||a.length>4)return i.push(new j(5,this.id,501,"Could not latest product retrieve version.",void 0,n)),i;let l=new j(7,this.id,2,"Entity Type Runtime Identifier"),u=new j(7,this.id,3,"Entity Type Identifier"),c=new j(7,this.id,4,"Entity Type Metadata");i.push(l),i.push(u),i.push(c);let d=e.getItemsCopy();for(let h=0;h<d.length;h++){let f=d[h];if(f.itemType===10&&(await f.ensureFileStorage(),f.file)){s=!0;let m=await Ii.ensureOnFile(f.file);if(m){if(await m.load(),m&&m._data&&m._data.description){let g=m._data.description;if(g.identifier!==void 0&&g.identifier.toLowerCase().startsWith("minecraft:")?u.incrementFeature(g.identifier.toLowerCase()):u.incrementFeature("(no override identifier)"),g.runtime_identifier!==void 0&&g.runtime_identifier.toLowerCase!==void 0&&g.runtime_identifier.toLowerCase().startsWith("minecraft:")?l.incrementFeature(g.runtime_identifier.toLowerCase()):l.incrementFeature("(no runtime identifier)"),g.aliases)for(let b in g.aliases)c.incrementFeature("Entity Type Alias");if(g.properties)for(let b in g.properties)c.incrementFeature("Entity Type Property");g.is_experimental&&c.incrementFeature("Experimental Entity Type"),g.is_spawnable&&c.incrementFeature("Spawnable Entity Type"),g.is_summonable&&c.incrementFeature("Summonable Entity Type")}else c.incrementFeature("Entity Type without description");let p=m.getFormatVersion();!m||!m.behaviorPackWrapper||!m.behaviorPackWrapper.format_version||!p?(i.push(new j(3,this.id,100,"Entity type does not define a format_version.",f)),o=!0):p.length>0&&p[0]<parseInt(a[0])?i.push(new j(6,this.id,110,"Behavior pack entity type format version ("+p.join(".")+") has a lower major version number compared to current version ("+n+")",f)):p[0]>parseInt(a[0])?(i.push(new j(3,this.id,111,"Behavior pack entity type format version ("+p.join(".")+") has a higher major version number compared to current version ("+n+")",f)),o=!0):p[1]<parseInt(a[1])-1?i.push(new j(6,this.id,120,"Behavior pack entity type format version ("+p.join(".")+") has a lower minor version number compared to the current version or the previous current minor version ("+n+")",f)):p[1]>parseInt(a[1])?(i.push(new j(3,this.id,121,"Behavior pack entity type format version ("+p.join(".")+") has a higher minor version number compared to current version ("+n+")",f)),o=!0):p[2]<parseInt(a[2])?i.push(new j(6,this.id,130,"Behavior pack entity type format version ("+p.join(".")+") has a lower patch version number compared to current version ("+n+")",f)):p[2]>parseInt(a[2])&&p[1]===parseInt(a[1])&&(i.push(new j(3,this.id,131,"Behavior pack entity type format version ("+p.join(".")+") has a higher patch version number compared to current version ("+n+")",f)),o=!0)}}}return s?o?i.push(new j(1,this.id,261,"Behavior pack entity type format version check fails.")):o&&i.push(new j(0,this.id,262,"Behavior pack entity type format version check passes.")):i.push(new j(0,this.id,260,"No entity type behavior format version was found; base game version check passes.")),i}async update(e,t){let i=[];switch(t){case 1:let n=await this.updateFormatVersionToLatestVersion(e);i.push(...n);break}return i}getUpdateIds(){return[1]}async updateFormatVersionToLatestVersion(e){let t=[],i=await oe.getLatestVersionInfo(e.effectiveTrack);if(!i)return t.push(new Ot(99,this.id,199,"Could not retrieve version.")),t;let n=i.split(".");if(n.length<3||n.length>4)return t.push(new Ot(99,this.id,200,"Could not retrieve latest product version.",void 0,i)),t;let s=parseInt(n[0]),o=parseInt(n[1]),a=parseInt(n[2]),l=e.getItemsCopy();for(let u=0;u<l.length;u++){let c=l[u];if(c.itemType===5&&(await c.ensureFileStorage(),c.file)){let d=await Ii.ensureOnFile(c.file);if(d){let h=d.behaviorPackWrapper?.format_version;if(h){let f=h?.split(".");f&&(f.length<3||f.length>4||parseInt(f[0])!==s||parseInt(f[1])!==o||parseInt(f[2])!==a)&&(d.setBehaviorPackFormatVersion(s+"."+o+"."+a),d.persist(),t.push(new Ot(1,this.id,200,"Updated behavior pack entity type manager format_version to '"+s+"."+o+"."+a+"'.",c,i)))}}}}return t}};var Bl=Le(Je());var pr=class r{constructor(){this.wrapper=null;this._isLoaded=!1;this._managed={};this._onLoaded=new Bl.EventDispatcher;this._onComponentAdded=new Bl.EventDispatcher;this._onComponentRemoved=new Bl.EventDispatcher;this._onComponentChanged=new Bl.EventDispatcher}get data(){return this._data}get onComponentAdded(){return this._onComponentAdded.asEvent()}get onComponentRemoved(){return this._onComponentRemoved.asEvent()}get onComponentChanged(){return this._onComponentChanged.asEvent()}get isLoaded(){return this._isLoaded}get behaviorPackFile(){return this._behaviorPackFile}get onLoaded(){return this._onLoaded.asEvent()}set behaviorPackFile(e){this._behaviorPackFile=e}get id(){return this._id}set id(e){this._id=e}get shortId(){if(this._id!==void 0)return this._id.startsWith("minecraft:")?this._id.substring(10,this._id.length):this._id}async getFormatVersionIsCurrent(){let e=this.getFormatVersion();return e===void 0||e.length!==3?!1:await oe.isRecentVersionFromVersionArray(e)}getFormatVersion(){if(this.wrapper)return Be.getVersionArrayFrom(this.wrapper.format_version)}getComponent(e){if(this._data!==void 0){if(!this._managed[e]){let t=this._data.components[e];t&&(this._managed[e]=new ei(e,t))}return this._managed[e]}}notifyComponentUpdated(e){let t=this.getComponent(e);t===void 0?C.unexpectedUndefined("ITNCU"):this._onComponentChanged.dispatch(this,t)}getAllComponents(){return this.getComponents()}getComponents(){let e=[];if(this._data!==void 0)for(let t in this._data.components){let i=this.getComponent(t);i!==void 0&&e.push(i)}return e}setBehaviorPackFormatVersion(e){this._ensureBehaviorPackDataInitialized(),this.wrapper&&(this.wrapper.format_version=e)}addComponent(e,t){this._ensureBehaviorPackDataInitialized();let i=new ei(e,t),n=this._data;n.components[e]=t,this._managed[e]=i,this._onComponentAdded.dispatch(this,i)}removeComponent(e){if(this._data===void 0)return;let t={},i={};for(let n in this._data.components)if(n!==e){let s=this._data.components[n];t[n]=s}for(let n in this._managed)n!==e&&(i[n]=this._managed[n]);this._data.components=t,this._managed=i}_ensureBehaviorPackDataInitialized(){this._data===void 0&&(this._data={description:{identifier:"unknown"},components:{},events:{}})}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.behaviorPackFile=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}persist(){if(this._behaviorPackFile===void 0)return;let e=JSON.stringify(this.wrapper,null,2);this._behaviorPackFile.setContent(e)}async load(){if(!(this._behaviorPackFile===void 0||this._isLoaded)&&(await this._behaviorPackFile.loadContent(),!(this._behaviorPackFile.content===null||this._behaviorPackFile.content instanceof Uint8Array))){if(this.wrapper=S.getJsonObject(this._behaviorPackFile),this.wrapper){let e=this.wrapper["minecraft:item"];e&&e.description&&(this.id=e.description.identifier),this._data=e}this._isLoaded=!0}}};var Ns=class{constructor(){this.id="BPITEMTYPE";this.title="Item Type Behavior Pack"}getTopicData(e){let t={updaterId:this.id,updaterIndex:1,action:"Set behavior pack item type format to latest version."};switch(e){case 3:return{title:"Item Type Identifier"};case 4:return{title:"Item Type Category"};case 100:return{title:"Behavior Pack Item Type Format Version defined"};case 110:return{title:"Behavior Pack Item Type Format Version Major Version Lower than Current",updaters:[t]};case 111:return{title:"Behavior Pack Item Type Format Version Major Version Higher than Current",updaters:[t]};case 120:return{title:"Behavior Pack Item Type Format Version Minor Version Lower than Current",updaters:[t]};case 121:return{title:"Behavior Pack Item Type Format Version Minor Version Higher than Current",updaters:[t]};case 130:return{title:"Behavior Pack Item Type Format Version Patch Version Lower than Current",updaters:[t]};case 131:return{title:"Behavior Pack Item Type Format Version Patch Version Higher than Current",updaters:[t]};case 500:return{title:"Retrieve Latest Minecraft Version"};case 501:return{title:"Parse Latest Minecraft Version"}}return{title:e.toString()}}getUpdaterData(e){return{title:e.toString()}}summarize(e,t){}async generate(e,t){let i=[],n=await oe.getLatestVersionInfo(e.effectiveTrack),s=!1,o=!1;if(!n)return i.push(new j(5,this.id,500,"Could not retrieve version.")),i;let a=n.split(".");if(a.length<3||a.length>4)return i.push(new j(5,this.id,501,"Could not latest product retrieve version.",void 0,n)),i;let l=new j(7,this.id,3,"Item Type Identifier"),u=new j(7,this.id,4,"Item Type Category");i.push(l),i.push(u);let c=e.getItemsCopy();for(let d=0;d<c.length;d++){let h=c[d];if(h.itemType===23&&(await h.ensureFileStorage(),h.file)){s=!0;let f=await pr.ensureOnFile(h.file);if(f){if(await f.load(),f&&f.data&&f.data.description){let p=f.data.description;p.identifier!==void 0&&p.identifier.toLowerCase().startsWith("minecraft:")?l.incrementFeature(p.identifier.toLowerCase()):l.incrementFeature("(no override identifier)"),p.category&&(p.category.startsWith("minecraft:")||p.category.indexOf(":")<=0)&&u.incrementFeature(p.category)}else u.incrementFeature("Item Type without description");let m=f.getFormatVersion();!f||!f.wrapper||!f.wrapper.format_version||!m?(i.push(new j(3,this.id,100,"Item Type does not define a format_version.",h)),o=!0):m.length>0&&m[0]<parseInt(a[0])?i.push(new j(6,this.id,110,"Behavior pack Item Type format version ("+m.join(".")+") has a lower major version number compared to current version ("+n+")",h)):m[0]>parseInt(a[0])?(i.push(new j(3,this.id,111,"Behavior pack Item Type format version ("+m.join(".")+") has a higher major version number compared to current version ("+n+")",h)),o=!0):m[1]<parseInt(a[1])-1?i.push(new j(6,this.id,120,"Behavior pack Item Type format version ("+m.join(".")+") has a lower minor version number compared to the current version or the previous current minor version ("+n+")",h)):m[1]>parseInt(a[1])?(i.push(new j(3,this.id,121,"Behavior pack Item Type format version ("+m.join(".")+") has a higher minor version number compared to current version ("+n+")",h)),o=!0):m[2]<parseInt(a[2])?i.push(new j(6,this.id,130,"Behavior pack Item Type format version ("+m.join(".")+") has a lower patch version number compared to current version ("+n+")",h)):m[2]>parseInt(a[2])&&m[1]===parseInt(a[1])&&(i.push(new j(3,this.id,131,"Behavior pack Item Type format version ("+m.join(".")+") has a higher patch version number compared to current version ("+n+")",h)),o=!0)}}}return s?o?i.push(new j(1,this.id,261,"Behavior pack Item Type format version check fails.")):o&&i.push(new j(0,this.id,262,"Behavior pack Item Type format version check passes.")):i.push(new j(0,this.id,260,"No Item Type behavior format version was found; base game version check passes.")),i}async update(e,t){let i=[];switch(t){case 1:let n=await this.updateFormatVersionToLatestVersion(e);i.push(...n);break}return i}getUpdateIds(){return[1]}async updateFormatVersionToLatestVersion(e){let t=[],i=await oe.getLatestVersionInfo(e.effectiveTrack);if(!i)return t.push(new Ot(99,this.id,199,"Could not retrieve version.")),t;let n=i.split(".");if(n.length<3||n.length>4)return t.push(new Ot(99,this.id,200,"Could not retrieve latest product version.",void 0,i)),t;let s=parseInt(n[0]),o=parseInt(n[1]),a=parseInt(n[2]),l=e.getItemsCopy();for(let u=0;u<l.length;u++){let c=l[u];if(c.itemType===5&&(await c.ensureFileStorage(),c.file)){let d=await pr.ensureOnFile(c.file);if(d){let h=d.wrapper?.format_version;if(h){let f=h?.split(".");f&&(f.length<3||f.length>4||parseInt(f[0])!==s||parseInt(f[1])!==o||parseInt(f[2])!==a)&&(d.setBehaviorPackFormatVersion(s+"."+o+"."+a),d.persist(),t.push(new Ot(1,this.id,200,"Updated behavior pack Item Type manager format_version to '"+s+"."+o+"."+a+"'.",c,i)))}}}}return t}};var Kr=class{constructor(e){this.project=e}createUpdaters(){return[new Rs,new Bs,new Ls,new Os,new Ms,new Ns]}async updateProject(e,t){let i=this.createUpdaters(),n=[];if(!this.project){C.throwUnexpectedUndefined("PURUP");return}for(let s=0;s<i.length;s++){let o=i[s],a=o.getUpdateIds();for(let l=0;l<a.length;l++)if((!e||e.includes(o.id))&&(!t||!t.includes(o.id))){let u=await o.update(this.project,a[l]);n.push(...u)}}return n}async update(e,t){let i=this.createUpdaters(),n=[];if(!this.project)return C.throwUnexpectedUndefined("PURU"),[];for(let s=0;s<i.length;s++){let o=i[s];if(o.id===e){let a=await o.update(this.project,t);for(let l of a)n.push(l)}}return n}};var vd=Le(Jw());var Ll=class r{constructor(e){this.mainScriptsFolder=void 0;this.libs=null;this.distScriptsFolder=void 0;this.entry=void 0;this.project=e,this.loadFile=this.loadFile.bind(this)}static{this.isInitialized=!1}resolveFile(e){return oe.minecraftModuleNames.includes(e.path)?{external:!0,namespace:"ct"}:{path:e.path,namespace:"ct"}}_pushError(e){this.isInErrorState=!0,this.errorMessages||(this.errorMessages=[]),this.errorMessages.push({message:e})}_getErrorResponse(e,t){return this._pushError("Project Build:"+t),{errors:[{id:e,text:t}]}}getTypeDefContentFor(e,t){if(!this.libs)return this._getErrorResponse("esb-typenotfound","Could not find typedef '"+e+"'");for(let i of this.libs.typeDefs)if(i.name===e)return{contents:i.content.join(`\r
`),loader:t?"ts":"js"};return this._getErrorResponse("esb-typenotfound","Could not find typedef '"+e+"'")}get isBuildable(){return this.project&&this.project.projectFolder!==void 0}getHasBuildableElements(){for(let e of this.project.items)if(e.itemType===13)return!0;return!1}async loadFile(e){if(!this.project||!this.project.projectFolder||!this.mainScriptsFolder||!this.distScriptsFolder||!this.libs)return this._getErrorResponse("esb-uninit","Project does not have buildable elements.");if(e.path==="@minecraft/vanilla-data")return this.getTypeDefContentFor("@minecraft/vanilla-data",!0);if(e.path==="@minecraft/math")return this.getTypeDefContentFor("@minecraft/math",!1);let t=e.path;t.startsWith("./")&&(t=t.substring(1));let i=S.getTypeFromName(t);if(i==="js"?t=t.substring(0,t.length-3)+".ts":i===""&&(t=t+".ts"),!t.startsWith("/"))return this._getErrorResponse("esb-importnotfound","Could not find import '"+t+"'");let n=await this.mainScriptsFolder.ensureFileFromRelativePath(t);await n.loadContent();let s=n.content;if(!s||typeof s!="string")if(S.getTypeFromName(t)==="ts")t=t.substring(0,t.length-3)+".js",n=await this.mainScriptsFolder.ensureFileFromRelativePath(t),await n.loadContent(),s=n.content,(!s||typeof s!="string")&&(s="");else return this._getErrorResponse("esb-filenotfound","Could not find file '"+e.path+"'");return{contents:s,loader:"ts",resolveDir:S.getFolderPath(e.path)}}async build(){if(!this.isBuildable||!this.getHasBuildableElements())return;let e=await this.project.carto.notifyOperationStarted("Script building '"+this.project.name+"'"),t=await this.project.getDefaultBehaviorPack();if(t===void 0)return;let i=await t.ensureManifest();if(!i||!(i instanceof Et))return;let n=i.getScriptModule(),s=this.project.getLibScriptsFolder();if(this.mainScriptsFolder=await this.project.getMainScriptsFolder(),n&&n.entry&&s&&(this.libs=await oe.getLibs(),this.distScriptsFolder=await this.project.ensureDistBuildScriptsFolder(),this.libs)){this.entry=n.entry,this.entry.toLowerCase().startsWith("scripts/")&&(this.entry=this.entry.substring(7)),r.isInitialized||(r.isInitialized=!0,await vd.initialize({wasmURL:"./dist/esbuild-wasm/esbuild.wasm"}));let o=this;try{let a=await vd.build({bundle:!0,entryPoints:[this.entry],format:"esm",external:oe.minecraftModuleNames,plugins:[{name:"ct",setup(l){l.onResolve({filter:/.*/},o.resolveFile),l.onLoad({filter:/.*/,namespace:"ct"},o.loadFile)}}]});if(a&&a.outputFiles&&a.outputFiles.length>0){let l=await this.distScriptsFolder.ensureFileFromRelativePath(this.entry);l.setContent(a.outputFiles[0].text),await l.saveContent()}}catch(a){!this.isInErrorState&&a&&this._pushError(a.toString())}await o.project.carto?.notifyOperationEnded(e,"Completed script building '"+this.project.name+"'",4,this.isInErrorState)}}async aggregateScripts(e){await e.load();let t="";for(let i in e.files)if(S.getTypeFromName(i)==="js"){let s=e.files[i];s&&(await s?.loadContent(),s.content&&typeof s.content=="string"&&(t+="// "+i+`\r
`+s.content+`\r
`))}for(let i in e.folders){let n=e.folders[i];if(n){let s=await this.aggregateScripts(n);t+=s}}return t}async syncToBehaviorPack(e){if(!this.getHasBuildableElements())return;let t=await this.project.ensureDistBuildScriptsFolder(),i=e.ensureFolder("scripts");await S.syncFolderTo(t,i,!0,!0,!1,[])}};var Ox=["build","node_modules","dist","lib",".env","*/.*","out","*just.config*","*package-lock*","*.mjs*"],wn=class r{static async generateFlatBetaApisWorldWithPacksZipBytes(e,t,i){if(await oe.loadContent(),oe.contentFolder===null){C.unexpectedNull();return}let n=await this.generateBetaApisWorldWithPacks(t,i,void 0,{generator:2});return n?await n.getBytes():void 0}static async syncProjectFromGitHub(e,t,i,n,s,o,a,l,u,c,d){let h,f="res/samples/"+n+"/"+i+"-"+(s||"main")+"/"+o;Ne.isWeb?h=new li(B.ensureEndsWithSlash(Ne.contentRoot)+f):h=new Dr(t.anonGitHub,i,n,s,o),a||(a="local "+n+" "+i,o!==void 0&&(a+=" "+o.replace(/\//gi," "),a=a.replace(" behavior_packs","")));let m=await t.getNewProjectName(a);l||(l=await t.createNewProject(m,void 0,1,!1)),await h.rootFolder.load();let p=await l.ensureProjectFolder();try{await S.syncFolderTo(h.rootFolder,p,!1,!1,!1,Ox,void 0,c,d)}catch(b){C.error("Error synchronizing from GitHub:"+b.toString())}return await p.saveAll(),e&&(await this.renameDefaultFolders(l,a),l.originalGitHubOwner=n,l.originalGitHubRepoName=i,l.originalGitHubBranch=s,l.originalGitHubFolder=o,l.originalFileList=u),await l.inferProjectItemsFromFiles(!0),await new Kr(l).updateProject(),await l.save(!0),await t.save(),l}static async renameDefaultFolders(e,t){let i=await e.getDefaultBehaviorPackFolder(!0),n=await e.getDefaultResourcePackFolder(!0);if(t=Be.makeNameFolderSafe(t),i)try{await i.rename(t)}catch{}if(n)try{await n.rename(t)}catch{}}static async getPackFolder(e,t){if(await e.load(),e.files["manifest.json"]!==void 0){let n=e.parentFolder,s=!1;if(n!==null&&S.canonicalizeName(n.name).indexOf("resource")>=0&&(s=!0),t&&s)return e;if(!t)return e}else for(let n in e.folders){let s=e.folders[n];if(s!==void 0&&!s.errorStatus){let o=await r.getPackFolder(s,t);if(o!==void 0)return o}}}static async ensureWorldsFolder(e){let t=await e.getFolderFromRelativePath("/minecraftWorlds/");if(t||(t=await e.getFolderFromRelativePath("/worlds/")),t||(t=await e.ensureFolderFromRelativePath("/minecraftWorlds/")),!t){C.unexpectedUndefined("EWF");return}return await t.ensureExists(),t}static async ensureMinecraftWorldsFolder(e){if(e.deploymentStorage===null){C.unexpectedUndefined("EMWF");return}return await this.ensureWorldsFolder(e.deploymentStorage.rootFolder)}static async prepareProject(e){await r.updateProjects(e),await e.save();let t=new Ll(e);if(await t.build(),t.isInErrorState){e.appendErrors(t);return}return t}static async deployProject(e,t,i){let n=await r.prepareProject(t);if(!n)return!1;await r.deployProjectPacks(t,n,i,void 0,1),await i.saveAll();let s=i.ensureFolder("development_resource_packs");if(await s.exists()){await t.ensureProjectFolder();let a=await t.getDefaultResourcePackFolder();if(a){let l=s.ensureFolder(t.name);await l.ensureExists(),await S.syncFolderTo(a,l,!0,!0,!0,["/mcworlds","/minecraftWorlds"])}}return!0}static async deployProjectPacks(e,t,i,n,s){let o=s===2?i:i.ensureFolder(s===1?"development_behavior_packs":"behavior_packs");await o.ensureExists();let a=await e.getDefaultBehaviorPackFolder(),l=await e.getMainScriptsFolder();if(a){let c=o.ensureFolder(a.ensuredName+(s===2?"_bp":""));if(await c.ensureExists(),await S.syncFolderTo(a,c,!0,!0,!1,["mcworlds","db","level.dat","level.dat_old","levelname.txt","behavior_packs","resource_packs"]),await t.syncToBehaviorPack(c),l&&l.parentFolder!==a){let d=c.ensureFolder("scripts");await d.ensureExists(),await S.syncFolderTo(l,d,!0,!0,!1,["*.ts"])}n&&n.ensureBehaviorPack(e.defaultBehaviorPackUniqueId,e.defaultBehaviorPackVersion,a.name),await c.saveAll()}let u=await e.getDefaultResourcePackFolder();if(u){let c=s===2?i:i.ensureFolder(s===1?"development_resource_packs":"resource_packs");await c.ensureExists();let d=c.ensureFolder(u.ensuredName+(s===2?"_rp":""));await d.ensureExists(),await S.syncFolderTo(u,d,!0,!0,!1,["mcworlds","db","level.dat","level.dat_old","levelname.txt","behavior_packs","resource_packs"]),n&&(n.ensureResourcePack(e.defaultResourcePackUniqueId,e.defaultResourcePackVersion,u.name),await d.saveAll())}}static async deployAsWorldAndTestAssets(e,t,i,n,s){let o,a=await e.notifyOperationStarted("Deploying world '"+i.name+"' and test assets.");if(await i.load(),!i.file&&!i.folder){C.unexpectedUndefined("DAWATA");return}if(i.folder?o=await Vt.ensureMCWorldOnFolder(i.folder,t):i.file&&(o=await Vt.ensureOnFile(i.file,t)),!o){C.debugAlert("Could not find respective world.");return}let l=await r.prepareProject(t);l||await e.notifyOperationEnded(a,"Packaging the world not be completed.",void 0,!0);let u=new Date,c=o.name+" - "+B.getFriendlySummary(u),d,h;if(s){let p=await r.ensureWorldsFolder(s);if(!p){C.unexpectedUndefined("DAWATAB");return}d=p.ensureFolder(c),await d.ensureExists()}else if(n)h=new yt,d=h.rootFolder;else{let p=await r.ensureMinecraftWorldsFolder(e);if(!p){C.unexpectedUndefined("DAWATAC");return}d=p.ensureFolder(c),await d.ensureExists()}await o.syncFolderTo(d),l&&await r.deployProjectPacks(t,l,d,o);let f=await oe.ensureCreatorToolsIngameProject();if(f){let p=await r.prepareProject(f);p&&await r.deployProjectPacks(f,p,d,o),await o.save()}await d.saveAll();let m=await Vt.ensureMCWorldOnFolder(d);if(!m){C.debugAlert("Could not build new world.");return}if(await d.saveAll(),await m.save(),await e.notifyOperationEnded(a,"World + local test assets deploy completed."),h)return await h.generateUint8ArrayAsync()}static async deployAsWorld(e,t,i,n,s){let o,a=await e.notifyOperationStarted("Deploying world '"+i.name+"'");if(await i.load(),!i.file&&!i.folder){C.unexpectedUndefined("DAWATA");return}if(i.folder?o=await Vt.ensureMCWorldOnFolder(i.folder,t):i.file&&(o=await Vt.ensureOnFile(i.file,t)),!o){C.debugAlert("Could not find respective world.");return}await r.prepareProject(t)||await e.notifyOperationEnded(a,"Packaging the world not be completed.",void 0,!0);let u=new Date,c=o.name+" - "+B.getFriendlySummary(u),d,h;if(s){let f=await r.ensureWorldsFolder(s);if(!f){C.unexpectedUndefined("DAWATAB");return}d=f.ensureFolder(c),await d.ensureExists()}else if(n)h=new yt,d=h.rootFolder;else{let f=await r.ensureMinecraftWorldsFolder(e);if(!f){C.unexpectedUndefined("DAWATAC");return}d=f.ensureFolder(c),await d.ensureExists()}if(await o.syncFolderTo(d),await d.saveAll(),await e.notifyOperationEnded(a,"World + local assets deploy completed."),h)return await h.generateUint8ArrayAsync()}static async updateProjects(e){await new Kr(e).updateProject(["SCRIPTMODULE"])}static async generateWorldWithPacks(e,t,i,n){let s=await e.notifyOperationStarted("Generating world and packs for '"+t.name+"'."),o=await r.prepareProject(t);if(o===void 0){await e.notifyOperationEnded(s);return}let a;if(n===void 0){if(a=new Vt,a.ensureZipStorage(),n=a.effectiveRootFolder,n===void 0){C.throwUnexpectedUndefined("PEPW");return}}else a=await Vt.ensureMCWorldOnFolder(n);if(!a){C.debugAlert("Could not find respective world.");return}return await a.load(!1),await a.applyWorldSettings(i),o&&await r.deployProjectPacks(t,o,n,a),a.betaApisExperiment=!0,a.name=t.name,await n.saveAll(),await a.save(),await e.notifyOperationEnded(s,"World + local assets generation for '"+n.fullPath+"' completed."),a}static async deployProjectAndGeneratedWorldTo(e,t,i,n){let s=await e.notifyOperationStarted("Deploying project '"+t.name+"' plus world and test assets.");await t.ensureLoadedProjectFolder();let o=t.name+" Test World",a;if(n){let u=await r.ensureWorldsFolder(n);if(!u){C.unexpectedUndefined("DPWATAD");return}a=u.ensureFolder(o),await a.ensureExists()}else{let u=await r.ensureMinecraftWorldsFolder(e);if(!u){C.unexpectedUndefined("DPWATAE");return}a=u.ensureFolder(o),await a.ensureExists()}let l=await r.generateWorldWithPacks(e,t,i,a);return l&&(await a.saveAll(),await l.save()),await e.notifyOperationEnded(s,"World + local assets deploy to '"+a.fullPath+"' completed."),o}static async deployAsFlatPackRefWorld(e,t){await e.notifyStatusUpdate("Saving..."),await r.updateProjects(t),await t.save(),await e.notifyStatusUpdate("Saved"),e.deploymentStorage!==null&&e.deployBehaviorPacksFolder!==null&&e.activeMinecraft&&(await e.notifyStatusUpdate("Deploying pack add-ons"),e.activeMinecraft.syncWithDeployment(),await e.notifyStatusUpdate("Deployed"));let i=t.defaultBehaviorPackUniqueId+"|";(t.lastMapDeployedHash===void 0||t.lastMapDeployedHash!==i)&&e.workingStorage!==null&&(r.generateAndInvokeFlatPackRefMCWorld(e,t),t.lastMapDeployedHash=i,t.lastMapDeployedDate=new Date)}static async convertWorld(e,t,i,n){if(!n)return;if(e.workingStorage===null){C.fail("Did not find expected working storage.");return}let s=new Date,o="WorldConvert"+B.getDateStr(s),a=e.workingStorage.rootFolder.ensureFolder(o);if(await a.ensureExists(),n){let u=a.ensureFolder("source-"+i.name);await u.ensureExists(),await n.copyAsFolderTo(u)}let l=JSON.stringify(i);if(await Ci.sendAsync("convertFile",l,!0),await a.load(!0),a.folderExists(i.name)){let u=a.ensureFolder(i.name),c=new yt;return await S.syncFolderTo(u,c.rootFolder,!1,!1,!1),c.generateCompressedUint8ArrayAsync()}}static async syncFlatPackRefWorldTo(e,t,i,n){if(e.workingStorage===null){C.fail("Did not find expected working storage.");return}let s=await r.generateFlatGameTestWorldWithPackRefs(t,n);s!==void 0?await s.syncFolderTo(i):C.fail("Could not retrieve flat game test world")}static async generateAndInvokeFlatPackRefMCWorld(e,t){if(e.workingStorage===null){C.fail("Did not find expected working storage.");return}let i=t.name+" flatpack.mcworld",n=t.name+" Flat GameTest",s=await r.generateFlatGameTestWorldWithPackRefs(t,n);if(s!==void 0){let o=await s.getBytes();if(o!==void 0){let a=e.workingStorage.rootFolder.ensureFile(i);a.setContent(o),await a.saveContent(),Ci.hasAppService&&await Ci.sendAsync("shellOpenPath",a.fullPath)}}}static async generateFlatGameTestWorldWithPackRefs(e,t){if(await oe.loadContent(),oe.contentFolder===null){C.unexpectedContentState();return}let i=oe.contentFolder.ensureFile("flatcreativegt.mcworld");if(await i.loadContent(),i.content instanceof Uint8Array)return await this.generateBetaApisWorldWithPackRefs(e,t,i.content);C.fail("Unexpectedly could not find default content.")}static async generateMCAddonAsZip(e,t,i){let n=await e.notifyOperationStarted("Exporting '"+t.name+"' as MCPack"),s=new yt,o=await r.prepareProject(t);if(o)if(await r.deployProjectPacks(t,o,s.rootFolder,void 0,2),await s.rootFolder.saveAll(),i){let a=await s.generateBlobAsync();return await e.notifyOperationEnded(n,"Export MCPack of '"+t.name+"' created; downloading..."),a}else return await s.generateUint8ArrayAsync()}static async generateBetaApisWorldWithPacks(e,t,i,n){await e.ensureLoadedProjectFolder();let s=new Vt;i?s.loadFromBytes(i):n||s.ensureLevelData().ensureDefaults(),n&&s.applyWorldSettings(n),s.project=e;let o=await r.prepareProject(e);if(o)return s.betaApisExperiment=!0,s.name=t,await r.deployProjectPacks(e,o,s.storage.rootFolder,s),s}static async generateBetaApisWorldWithPackRefs(e,t,i){let n=new Vt;return n.project=e,await n.loadFromBytes(i),await e.getDefaultBehaviorPackFolder()!==null&&n.ensureBehaviorPack(e.defaultBehaviorPackUniqueId,e.defaultBehaviorPackVersion,e.name),await e.getDefaultResourcePackFolder()!==null&&n.ensureResourcePack(e.defaultResourcePackUniqueId,e.defaultResourcePackVersion,e.name),n.betaApisExperiment=!0,n.name=t,n}};var Hw=Le(Je()),Mx=["import minecraftLinting from 'eslint-plugin-minecraft-linting';","import tsParser from '@typescript-eslint/parser';","import ts from '@typescript-eslint/eslint-plugin';","export default [","  {","    files: ['scripts/**/*.ts'],","    languageOptions: {","      parser: tsParser,","      ecmaVersion: 'latest',","    },","    plugins: {","      ts,","      'minecraft-linting': minecraftLinting,","    },","    rules: {","      'minecraft-linting/avoid-unnecessary-command': 'error',","    },","  },","];"],Ao=class r{constructor(){this._isLoaded=!1;this._onLoaded=new Hw.EventDispatcher;this.project=void 0}get isLoaded(){return this._isLoaded}get file(){return this._file}set file(e){this._file=e}get onLoaded(){return this._onLoaded.asEvent()}get id(){return this._id}set id(e){this._id=e}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}async ensureDefault(){this._file!==void 0&&(await this.load(),this._file.setContent(r.getDefaultContent()))}async ensureMin(){this._file!==void 0&&(await this.load(),(!this._file.content||typeof this._file.content!="string")&&this._file.setContent(r.getDefaultContent()))}async persist(){}async save(){this._file!==void 0&&await this._file.saveContent(!1)}async load(){this._file===void 0||this._isLoaded||(await this._file.loadContent(!0),!(this._file.content===null||this._file.content instanceof Uint8Array)&&(this._isLoaded=!0))}static getDefaultContent(){return Mx.join(`\r
`).replace(/'/gi,'"')}};var qw=Le(Je()),Nx=["import { argv, parallel, series, task, tscTask } from 'just-scripts';","import {","  BundleTaskParameters,","  CopyTaskParameters,","  bundleTask,","  cleanTask,","  cleanCollateralTask,","  copyTask,","  coreLint,","  mcaddonTask,","  setupEnvironment,","  ZipTaskParameters,","  STANDARD_CLEAN_PATHS,","  DEFAULT_CLEAN_DIRECTORIES,","  getOrThrowFromProcess,","  watchTask,","} from '@minecraft/core-build-tasks';","import path from 'path';","setupEnvironment(path.resolve(__dirname, '.env'));","const projectName = getOrThrowFromProcess('PROJECT_NAME');","const bundleTaskOptions: BundleTaskParameters = {","  entryPoint: path.join(__dirname, './scripts/main.ts'),","  external: ['@minecraft/server', '@minecraft/server-ui'],","  outfile: path.resolve(__dirname, './dist/scripts/main.js'),","  minifyWhitespace: false,","  sourcemap: true,","  outputSourcemapPath: path.resolve(__dirname, './dist/debug'),","};","const copyTaskOptions: CopyTaskParameters = {","  copyToBehaviorPacks: [`./behavior_packs/$_{projectName}`],","  copyToScripts: ['./dist/scripts'],","  copyToResourcePacks: [`./resource_packs/$_{projectName}`],","};","const mcaddonTaskOptions: ZipTaskParameters = {","  ...copyTaskOptions,","  outputFile: `./dist/packages/$_{projectName}.mcaddon`,","};","task('lint', coreLint(['scripts/**/*.ts'], argv().fix));","task('typescript', tscTask());","task('bundle', bundleTask(bundleTaskOptions));","task('build', series('typescript', 'bundle'));","task('clean-local', cleanTask(DEFAULT_CLEAN_DIRECTORIES));","task('clean-collateral', cleanCollateralTask(STANDARD_CLEAN_PATHS));","task('clean', parallel('clean-local', 'clean-collateral'));","task('copyArtifacts', copyTask(copyTaskOptions));","task('package', series('clean-collateral', 'copyArtifacts'));","task(","  'local-deploy',","  watchTask(","    ['scripts/**/*.ts', 'behavior_packs/**/*.{json,lang,tga,ogg,png}', 'resource_packs/**/*.{json,lang,tga,ogg,png}'],","    series('clean-local', 'build', 'package')","  )",");","task('createMcaddonFile', mcaddonTask(mcaddonTaskOptions));","task('mcaddon', series('clean-local', 'build', 'createMcaddonFile'));"],qn=class r{constructor(){this._isLoaded=!1;this._onLoaded=new qw.EventDispatcher;this.project=void 0}get isLoaded(){return this._isLoaded}get file(){return this._file}set file(e){this._file=e}get onLoaded(){return this._onLoaded.asEvent()}get id(){return this._id}set id(e){this._id=e}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}async ensureDefault(){this._file!==void 0&&(await this.load(),this._file.setContent(r.getDefaultContent()))}async ensureMin(){this._file!==void 0&&(await this.load(),(!this._file.content||typeof this._file.content!="string")&&this._file.setContent(r.getDefaultContent()))}async persist(){}async save(){this._file!==void 0&&await this._file.saveContent(!1)}async load(){this._file===void 0||this._isLoaded||(await this._file.loadContent(!0),!(this._file.content===null||this._file.content instanceof Uint8Array)&&(this._isLoaded=!0))}static getDefaultContent(){return Nx.join(`\r
`).replace(/'/gi,'"').replace(/\$_{/gi,"${")}};var Ol=class{static async ensureIsStandard(e){if(await e.ensureProjectFolder(),e.projectFolder){let i=await e.projectFolder.getFileFromRelativePath("/just.config.ts");i&&await i.exists()&&(i.setContent(qn.getDefaultContent()),i.saveContent());let n=await e.projectFolder.getFileFromRelativePath("/eslint.config.mjs");n&&await n.exists()&&(n.setContent(Ao.getDefaultContent()),n.saveContent());let s=await e.projectFolder.getFileFromRelativePath("/package.json");s&&await s.exists()&&e.ensureItemByProjectPath("/package.json",0,"package.json",59,void 0,1)}let t=e.getItemsCopy();for(let i=0;i<t.length;i++){let n=t[i];if(n.itemType===119&&n.file){n.creationType=1;let s=await qn.ensureOnFile(n.file);s&&(s.ensureDefault(),await s.save())}else if(n.itemType===120&&n.file){n.creationType=1;let s=await Ao.ensureOnFile(n.file);s&&(s.ensureDefault(),await s.save())}else if(n.itemType===59&&n.file){n.creationType=1;let s=await Hr.ensureOnFile(n.file);s&&(await s.ensureStandardContent(),await s.save())}}}};var Xw=Le(Je()),Kw=["esbenp.prettier-vscode","blockceptionltd.blockceptionvscodeminecraftbedrockdevelopmentextension","mojang-studios.minecraft-debugger"],Ml=class r{constructor(){this._isLoaded=!1;this._onLoaded=new Xw.EventDispatcher}get isLoaded(){return this._isLoaded}get file(){return this._file}set file(e){this._file=e}get onLoaded(){return this._onLoaded.asEvent()}get id(){return this._id}set id(e){this._id=e}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}async persist(){if(this._file===void 0)return;let e=JSON.stringify(this.definition,null,2);this._file.setContent(e)}async save(){this._file!==void 0&&(this.persist(),await this._file.saveContent(!1))}async hasMinContent(){if(await this.load(),!this.definition||!this.definition.recommendations)return!1;for(let e of Kw)if(!this.definition.recommendations.includes(e))return!1;return!0}async ensureMinContent(){if(await this.hasMinContent())return!0;this.definition||(this.definition={recommendations:[]}),this.definition.recommendations||(this.definition.recommendations=[]);for(let t of Kw)this.definition.recommendations.includes(t)||this.definition.recommendations.push(t);return this.definition}async load(){if(!(this._file===void 0||this._isLoaded)&&(await this._file.loadContent(),!(this._file.content===null||this._file.content instanceof Uint8Array))){this.id=this._file.name;try{let e=JSON.parse(this._file.content);this.definition=e}catch(e){C.fail("Could not parse vscode launch JSON "+e)}this._isLoaded=!0}}};var Zw=Le(Je()),wd={"[javascript]":{"editor.defaultFormatter":"esbenp.prettier-vscode"},"[typescript]":{"editor.defaultFormatter":"esbenp.prettier-vscode"},"[typescriptreact]":{"editor.defaultFormatter":"esbenp.prettier-vscode"},"[json]":{"editor.defaultFormatter":"esbenp.prettier-vscode"},"git.ignoreLimitWarning":!0,"editor.formatOnSave":!0,"search.exclude":{"**/.git":!0,"**/node_modules":!0,"**/dist":!0,"**/lib":!0},"files.exclude":{"**/.git":!0,"**/.DS_Store":!0,"**/node_modules":!0},"cSpell.words":["gametest","gametests","mcaddon"],"editor.tabSize":2,"eslint.experimental.useFlatConfig":!0},Nl=class r{constructor(){this._isLoaded=!1;this._onLoaded=new Zw.EventDispatcher}get isLoaded(){return this._isLoaded}get file(){return this._file}set file(e){this._file=e}get onLoaded(){return this._onLoaded.asEvent()}get id(){return this._id}set id(e){this._id=e}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}async persist(){if(this._file===void 0)return;let e=JSON.stringify(this.definition,null,2);this._file.setContent(e)}async save(){this._file!==void 0&&(this.persist(),await this._file.saveContent(!1))}async hasMinContent(){if(await this.load(),!this.definition)return!1;for(let e in wd)if(!this.definition[e])return!1;return!0}async ensureMinContent(){if(await this.hasMinContent())return!0;this.definition||(this.definition=wd);for(let t in wd)this.definition[t]||(this.definition[t]=wd[t]);return this.definition}async load(){if(!(this._file===void 0||this._isLoaded)&&(await this._file.loadContent(),!(this._file.content===null||this._file.content instanceof Uint8Array))){this.id=this._file.name;try{let e=JSON.parse(this._file.content);this.definition=e}catch(e){C.fail("Could not parse vscode launch JSON "+e)}this._isLoaded=!0}}};var Yw=Le(Je()),_d={trailingComma:"es5",tabWidth:2,semi:!0,singleQuote:!1,bracketSpacing:!0,arrowParens:"always",printWidth:120,endOfLine:"auto"},jl=class r{constructor(){this._isLoaded=!1;this._onLoaded=new Yw.EventDispatcher}get isLoaded(){return this._isLoaded}get file(){return this._file}set file(e){this._file=e}get onLoaded(){return this._onLoaded.asEvent()}get id(){return this._id}set id(e){this._id=e}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}async persist(){if(this._file===void 0)return;let e=JSON.stringify(this.definition,null,2);this._file.setContent(e)}async save(){this._file!==void 0&&(this.persist(),await this._file.saveContent(!1))}async hasMinContent(){if(await this.load(),!this.definition)return!1;for(let e in _d)if(!this.definition[e])return!1;return!0}async ensureMinContent(){if(await this.hasMinContent())return!0;this.definition||(this.definition=_d);for(let t in _d)this.definition[t]||(this.definition[t]=_d[t]);return this.definition}async load(){if(!(this._file===void 0||this._isLoaded)&&(await this._file.loadContent(),!(this._file.content===null||this._file.content instanceof Uint8Array))){this.id=this._file.name;try{let e=JSON.parse(this._file.content);this.definition=e}catch(e){C.fail("Could not parse vscode launch JSON "+e)}this._isLoaded=!0}}};var ci=class r{static async updateProjectAutogeneration(e){let t=0,i=0,n=0,s=!1,o=!1,a=0,l=0,u=0,c=0,d=0,h=0,f=e.getItemsCopy();for(let m=0;m<f.length;m++){let p=f[m];p.itemType===59?(t++,p.file&&(await p.file.loadContent(),p.file.content&&typeof p.file.content=="string"&&(p.file.content.indexOf("just-scripts")>0&&(s=!0),p.file.content.indexOf("eslint")>0&&(o=!0)))):p.itemType===121?i++:p.itemType===75?l++:p.itemType===122?h++:p.itemType===120?a++:p.itemType===119&&n++}i===0&&(n>0||s)&&e.ensureItemByProjectPath("/.env",0,".env",121,void 0,1),h===0&&t>0&&e.ensureItemByProjectPath("/.prettierrc.json",0,".prettierrc.json",122,void 0,1),n===0&&s&&e.ensureItemByProjectPath("/just.config.ts",0,"just.config.ts",119,void 0,1),a===0&&o&&e.ensureItemByProjectPath("/eslint.config.mjs",0,"eslint.config.mjs",120,void 0,1),l===0&&t>0&&e.projectFolder&&e.ensureItemByProjectPath("/.vscode/launch.json",0,"launch.json",75,void 0,1),c===0&&t>0&&e.projectFolder&&e.ensureItemByProjectPath("/.vscode/settings.json",0,"settings.json",77,void 0,1),d===0&&t>0&&e.projectFolder&&e.ensureItemByProjectPath("/.vscode/tasks.json",0,"tasks.json",76,void 0,1),u===0&&t>0&&e.projectFolder&&e.ensureItemByProjectPath("/.vscode/extensions.json",0,"extensions.json",78,void 0,1);for(let m=0;m<f.length;m++){let p=f[m];p.creationType===1&&await r.updateItemAutogeneration(p),await r.updateItemAutogeneratedSideFiles(p)}}static async updateItemAutogeneratedSideFiles(e){!e.file||e.project}static async updateItemAutogeneration(e,t){if(t||await e.load(),!(e.file==null||e.creationType!==1)){if(e.itemType===3)await e.file.loadContent(),r.updateCatalogJsContent(e,await r.getCatalogJsContent(e.project));else if(e.itemType===121)e.file.setContent(await As.getContent(e.project,typeof e.file.content=="string"?e.file.content:void 0));else if(e.itemType===119){let i=await qn.ensureOnFile(e.file);i&&(await i.ensureDefault(),await i.save())}else if(e.itemType===75){let i=await Hn.ensureOnFile(e.file);i&&(await i.ensureMinContent(),await i.save())}else if(e.itemType===76){let i=await $n.ensureOnFile(e.file);i&&(await i.ensureMinContent(),await i.save())}else if(e.itemType===78){let i=await Ml.ensureOnFile(e.file);i&&(await i.ensureMinContent(),await i.save())}else if(e.itemType===77){let i=await Nl.ensureOnFile(e.file);i&&(await i.ensureMinContent(),await i.save())}else if(e.itemType===122){let i=await jl.ensureOnFile(e.file);i&&(await i.ensureMinContent(),await i.save())}else if(e.itemType===5)e.file.setContent(await Et.getContent(e.project,t));else if(e.itemType===11){let i=await r.getGeneratedTypeJavaScript(e);i.javaScript!==void 0&&e.file.setContent(i.javaScript),e.project.preferredScriptLanguage===1&&i.typeScript!==void 0&&e.file.parentFolder.ensureFile(S.getBaseFromName(e.file.name)+".ts").setContent(i.typeScript),e.project.preferredScriptLanguage===1&&i.typeScript!==void 0&&e.file.parentFolder.ensureFile(S.getBaseFromName(e.file.name)+".ts").setContent(i.typeScript)}else if(e.itemType===70){let i=await r.getGeneratedTypeJavaScript(e);i.typeScript!==void 0&&e.file.setContent(i.typeScript)}}}static async getCatalogJsContent(e){let t=[],i=await e.ensureDefaultBehaviorPackFolder(),n=e.getItemsCopy();for(let s=0;s<n.length;s++){let o=n[s];if(o.itemType===15){let a=await o.ensureFileStorage();if(a){let l=S.getBaseFromName(a.name)+".gen.js";t.push('import "scripts/'+l+'";')}}else if(o.itemType===2||o.itemType===69||o.itemType===11||o.itemType===1){let a=await o.ensureFileStorage();if(a){let l=a.getFolderRelativePath(i);a.isContentLoaded||await a.loadContent(!1),(a.content!==null||l!==null)&&l!==void 0&&(l.startsWith("/scripts/")&&(l=l.substring(9,l.length)),l.startsWith("/")&&(l=l.substring(1,l.length)),t.push('import "'+l+'";'))}}}return e0+`\r
\r
`+t.join(`\r
`)}static async updateCatalogJsContent(e,t){if(e.file==null||e.file.content instanceof Uint8Array){C.unexpectedContentState();return}if(e.file.content===void 0||e.file.content===null||e.file.content.trim()===""){e.file.setContent(t);return}let i=e.file.content,n=i.indexOf(pp);if(n>=0){let s=i.lastIndexOf("\r",n);s<0&&(s=i.lastIndexOf(`
`,n),s<0&&(s=0));let o=i.lastIndexOf("//",n);o>s+2&&(s=o),s>=0&&(i=i.substring(0,s))}i+=t,e.file.setContent(i)}static async getGeneratedTypeJavaScript(e){if(e.projectPath===null||e.projectPath===void 0)return{javaScript:"",typeScript:void 0};let t=S.getBaseFromName(S.getLeafName(e.projectPath));t.endsWith(".base")&&(t=t.substring(0,t.length-5));let i=e.project.getItemsCopy();for(let n=0;n<i.length;n++){let s=i[n];if(s.itemType===10&&s.projectPath!==null&&s.projectPath!==void 0&&S.getBaseFromName(S.getLeafName(s.projectPath))===t){let a=await s.ensureFileStorage();if(a!=null&&(a.manager===void 0&&await Ii.ensureOnFile(a),a.manager)){let l=a.manager,u=l.getScript(!1),c;return e.project.preferredScriptLanguage===1&&(c=l.getScript(!0)),{javaScript:u,typeScript:c}}}}return{javaScript:"",typeScript:void 0}}};var di=class r{static async getDefaultFolderForPack(e,t){if(t===1)return await e.getDefaultBehaviorPackFolder();if(t===0)return await e.getDefaultResourcePackFolder();if(t===2)return await e.getDefaultSkinPackFolder();throw new Error}static async ensureJsonItem(e,t,i){if(!e.projectFolder)return;let n=Zt.inferTypeFromJsonContent(t,i),s=n.packType;s===void 0&&(s=1);let o=await Zt.getDefaultFolderForType(e,n.itemType);if(!o||o.getFolderRelativePath(e.projectFolder)===void 0)return;i=S.getUniqueChildFolderName(i,o);let l=o.ensureFile(i);l.setContent(t),l.saveContent();let u=l.getFolderRelativePath(e.projectFolder);if(u!==void 0)return e.ensureItemByProjectPath(u,0,i,n.itemType,void 0,0)}static getItemsFromSearch(e,t){if(t===void 0)return[];let i=[];for(let n of t)for(let s of e.items)s.projectPath&&n.value===s.projectPath&&i.push(s);return i}static getItemFromAnnotatedValue(e,t){for(let i of e.items)if(i.projectPath===t.value)return i}static async hasDocumentationMetadata(e,t){await e.load();for(let i in e.folders)if(i==="checkpoint_input"||i==="metadata"||i==="type_definitions"||i==="typedefs"||(t===void 0||t<5)&&await r.hasDocumentationMetadata(e,t?t+1:1))return!0;return!1}static async prepareProjectForDocumentation(e){if(await e.ensureProjectFolder(),!e.projectFolder||await r.hasDocumentationMetadata(e.projectFolder))return;let i=await oe.loadPreviewMetadataFolder();i&&(e.accessoryFolders=[i])}static async getBaseBehaviorPackPath(e){let t=await e.ensureDefaultBehaviorPackFolder();return e.projectFolder===null?void 0:t.getFolderRelativePath(e.projectFolder)}static async getBaseResourcePackPath(e){let t=await e.ensureDefaultResourcePackFolder();return e.projectFolder===null?void 0:t.getFolderRelativePath(e.projectFolder)}static async applyScriptEntryPoint(e,t){if(e.scriptEntryPoint=t,e.editPreference===0&&e.defaultBehaviorPackUniqueId){let i=e.getItemsCopy();for(let n of i)if(n.itemType===5&&(await n.ensureFileStorage(),n.file)){let s=await Et.ensureOnFile(n.file);if(s&&s.definition&&B.uuidEqual(s.definition.header.uuid,e.defaultBehaviorPackUniqueId)){let o=s.ensureScriptModule(e.title,e.description);o.entry=e.scriptEntryPoint,s.save()}}}}static async applyDescription(e,t){if(e.description=t,e.editPreference===0&&e.defaultBehaviorPackUniqueId){let i=e.getItemsCopy();for(let n of i)if(n.itemType===59){if(await n.ensureFileStorage(),n.file){let s=await Hr.ensureOnFile(n.file);s&&s.definition&&(s.definition.description=t,await s.save())}}else if(n.itemType===5){if(await n.ensureFileStorage(),n.file){let s=await Et.ensureOnFile(n.file);if(s&&s.definition&&B.uuidEqual(s.definition.header.uuid,e.defaultBehaviorPackUniqueId)){let o=s.ensureHeader(e.title,e.description);o.description=t,await s.save()}}}else if(n.itemType===14&&(await n.ensureFileStorage(),n.file)){let s=await jt.ensureOnFile(n.file);if(s&&s.definition&&B.uuidEqual(s.definition.header.uuid,e.defaultResourcePackUniqueId)){let o=s.ensureHeader(e.title,e.description);o.description=t,await s.save()}}}}static async applyCreator(e,t){e.creator=t}static async applyShortName(e,t){e.shortName=t}static async applyTitle(e,t){if(e.title=t,e.editPreference===0&&e.defaultBehaviorPackUniqueId){let i=e.getItemsCopy();for(let n of i)if(n.file&&n.itemType===59){let s=await Hr.ensureOnFile(n.file);s&&s.definition&&(s.definition.name=t,await s.save())}else if(n.itemType===5){if(await n.ensureFileStorage(),n.file){let s=await Et.ensureOnFile(n.file);if(s&&s.definition&&B.uuidEqual(s.definition.header.uuid,e.defaultBehaviorPackUniqueId)){let o=s.ensureHeader(e.title,e.description);o.name=t,await s.save()}}}else if(n.itemType===14&&(await n.ensureFileStorage(),n.file)){let s=await jt.ensureOnFile(n.file);if(s&&s.definition&&B.uuidEqual(s.definition.header.uuid,e.defaultResourcePackUniqueId)){let o=s.ensureHeader(e.title,e.description);o.name=t,await s.save()}}}}static async applyBehaviorPackUniqueId(e,t){let i=e.defaultBehaviorPackUniqueId;if(await e.setDefaultBehaviorPackUniqueIdAndUpdateDependencies(t),e.editPreference===0&&e.defaultBehaviorPackUniqueId){let n=0,s=e.getItemsCopy();for(let o of s)o.itemType===5&&n++;for(let o of s)if(o.itemType===5&&(await o.ensureFileStorage(),o.file)){let a=await Et.ensureOnFile(o.file);if(a&&a.definition&&(n<=1||B.uuidEqual(a.definition.header.uuid,e.defaultBehaviorPackUniqueId)||B.uuidEqual(a.definition.header.uuid,i))){let l=a.ensureHeader(e.title,e.description);l.uuid=t,a.save()}}}}static async applyResourcePackUniqueId(e,t){let i=e.defaultResourcePackUniqueId;if(await e.setDefaultResourcePackUniqueIdAndUpdateDependencies(t),e.editPreference===0&&e.defaultResourcePackUniqueId){let n=0,s=e.getItemsCopy();for(let o of s)o.itemType===14&&n++;for(let o of s)if(o.itemType===14&&(await o.ensureFileStorage(),o.file)){let a=await jt.ensureOnFile(o.file);if(a&&a.definition&&(n<=1||B.uuidEqual(a.definition.header.uuid,e.defaultResourcePackUniqueId)||B.uuidEqual(a.definition.header.uuid,i))){let l=a.ensureHeader(e.title,e.description);l.uuid=t,a.save()}}}}static getSuggestedProjectShortName(e,t){return this.getSuggestedShortName(e)+"_"+this.getSuggestedShortName(t)}static getSuggestedShortName(e){e=e.trim().replace(/-/g,""),e=e.replace(/_/g,""),e=e.replace(/ /g,""),e=e.replace(/:/g,""),e=e.replace(/;/g,""),e=e.replace(/=/g,"");let t="";for(let i=0;i<e.length;i++)e[i]>="A"&&e[i]<="Z"&&(t+=e[i].toLowerCase());return t.length>1?t:e.length<=4?e.toLowerCase():e.substring(0,4).toLowerCase()}static getSuggestedProjectName(e){return this.getSuggestedProjectNameFromElements(e.id,e.gitHubFolder,e.gitHubRepoName)}static getSuggestedProjectNameFromElements(e,t,i){let n="my";return e?n+=e:t!==void 0?(n+=t,n=n.replace(" behavior_packs","")):n+=i,n=n.replace(/_/gi,""),n=n.replace(/\//gi,""),n=n.replace(/\\/gi,""),n=n.replace(/ /gi,""),n}static async getBaseScriptsPath(e){let t=await e.ensureDefaultScriptsFolder();if(e.projectFolder!==null)return t.getFolderRelativePath(e.projectFolder)}static async processNewProject(e,t,i,n){await e.inferProjectItemsFromFiles(),n&&await wn.renameDefaultFolders(e,n),await ci.updateProjectAutogeneration(e),await r.randomizeAllUids(e),await r.applyTitle(e,t),await r.applyDescription(e,i),await Ol.ensureIsStandard(e),await new Kr(e).updateProject(),await e.save(!0)}static async setNewModuleId(e,t,i){let n=e.getItemsCopy(),s=!1;for(let o=0;o<n.length;o++){let a=n[o];if(a.file){if(a.itemType===14&&!s){let l=await jt.ensureOnFile(a.file);if(l&&l.definition&&l.definition.modules){let u=l.definition.modules;for(let c of u)c.uuid===i&&(c.uuid=t)}}else if(a.itemType===5){let l=await jt.ensureOnFile(a.file);if(l&&l.definition&&l.definition.modules){let u=l.definition.modules;for(let c of u)c.uuid===i&&(c.uuid=t)}}}}}static async getDefaultSpawnRulesFolder(e){let t=await e.getDefaultBehaviorPackFolder();if(!t)return;let i=t.ensureFolder("spawn_rules");return await i.ensureExists(),i}static async getDefaultLootTableFolder(e){let t=await e.getDefaultBehaviorPackFolder();if(!t)return;let i=t.ensureFolder("loot_table");return await i.ensureExists(),i}static async getIsAddon(e){let t=e.getItemsCopy(),i=0,n=0;for(let s=0;s<t.length;s++){let o=t[s];if(o.file){if(o.itemType===14){i++;let a=await jt.ensureOnFile(o.file);if(a&&!a.hasAddonProperties())return!1}else if(o.itemType===5){n++;let a=await Et.ensureOnFile(o.file);if(a&&!a.hasAddonProperties())return!1}}}return n===1&&i===1}static async setIsAddon(e){let t=e.getItemsCopy();for(let i=0;i<t.length;i++){let n=t[i];if(n.file){if(n.itemType===14){let s=await jt.ensureOnFile(n.file);s&&s.setAddonProperties()}else if(n.itemType===5){let s=await Et.ensureOnFile(n.file);s&&s.setAddonProperties()}}}}static async randomizeAllUids(e){let t={};t.defaultBehaviorPack=e.defaultBehaviorPackUniqueId,t.defaultResourcePack=e.defaultResourcePackUniqueId,t.defaultDataPack=e.defaultDataUniqueId,t.defaultScriptModulePack=e.defaultScriptModuleUniqueId,await e.setDefaultResourcePackUniqueIdAndUpdateDependencies(B.createUuid()),await e.setDefaultBehaviorPackUniqueIdAndUpdateDependencies(B.createUuid()),e.defaultDataUniqueId=B.createUuid(),e.defaultScriptModuleUniqueId=B.createUuid();let i=e.getItemsCopy();for(let n=0;n<i.length;n++){let s=i[n];if(s.file){if(s.itemType===5){let o=await Et.ensureOnFile(s.file);o&&(o.randomizeModuleUuids(e.defaultScriptModuleUniqueId,t.defaultScriptModulePack),o.id!==t.defaultBehaviorPack&&o.id!==e.defaultBehaviorPackUniqueId&&await o.setUuid(B.createUuid(),e))}else if(s.itemType===14){let o=await jt.ensureOnFile(s.file);o&&(o.randomizeModuleUuids(e.defaultDataUniqueId,t.defaultDataModulePack),o.id!==t.defaultResourcePack&&o.id!==e.defaultResourcePackUniqueId&&await o.setUuid(B.createUuid(),e))}}}await e.save()}static async addEntityTypeFromGallery(e,t,i,n,s,o){await r.copyGalleryPackFilesAndFixupIds(e,t,i,s,o),await e.inferProjectItemsFromFiles(!0);let a=e.getItemsCopy();for(let l of a)if(l.itemType===10){let u=await xi.get(l);if(u){let c=i||t.id;u.id?.endsWith(c)&&(u.runtimeIdentifier=t.targetRuntimeIdentifier?t.targetRuntimeIdentifier:"minecraft:"+t.id,u.persist())}}await e.save()}static async addBlockTypeFromGallery(e,t,i){await r.copyGalleryPackFilesAndFixupIds(e,t,i),await e.inferProjectItemsFromFiles(!0),await e.save()}static async addItemTypeFromGallery(e,t,i){await r.copyGalleryPackFilesAndFixupIds(e,t,i),await e.inferProjectItemsFromFiles(!0),await e.save()}static async copyGalleryPackFilesAndFixupIds(e,t,i,n,s){let o=t.fileList;if(o===void 0){C.unexpectedUndefined("AETFLS");return}i===void 0&&(i=t.id);let a,l;if(t.gitHubRepoName==="bedrock-samples")a=await oe.getReleaseVanillaBehaviorPackFolder(),l=await oe.getReleaseVanillaResourcePackFolder();else{let h=new li(Ne.contentRoot+"res/samples/"+t.gitHubOwner+"/"+t.gitHubRepoName+"-"+(t.gitHubBranch?t.gitHubBranch:"main")+"/"+t.gitHubFolder);await h.rootFolder.load();let f=h.rootFolder.folders.behavior_packs,m=h.rootFolder.folders.resource_packs;if(!f||!m){C.unexpectedUndefined("AETFLT");return}if(await m.load(),await f.load(),m.folderCount<1||f.folderCount<1){C.unexpectedUndefined("AETFLY");return}a=f.getFolderByIndex(0),l=m.getFolderByIndex(0)}let u=await e.ensureDefaultBehaviorPackFolder(),c=await e.ensureDefaultResourcePackFolder();if(!a||!l||!a||!l||!u||!c){C.unexpectedUndefined("AETVA");return}let d=['"identifier"','"materials"'];t.type===7&&(d=['"materials"']);for(let h of o)if(h.startsWith("/behavior_pack")){let f;if(h.startsWith("/behavior_pack/"))f=h.substring(14);else{let g=h.indexOf("/",16);if(g<0){C.unexpectedUndefined("AETVB");return}f=h.substring(g)}let m=r.replaceNamesInPath(f,e,t,i),p=await a.getFileFromRelativePath(f);if(!p)C.debugAlert("Could not find file '"+f+"'");else{let g=await u.ensureFileFromRelativePath(m),b=!0;if(s&&await g.exists()&&(b=!1),b){await p.loadContent();let F=p.content;typeof F=="string"&&(F=r.replaceNamesInContent(F,e,t,i,d)),F!==null&&(n&&n("Updating '"+g.fullPath+"'"),g.setContent(F))}}}else if(h.startsWith("/resource_pack")){let f;if(h.startsWith("/resource_pack/"))f=h.substring(14);else{let g=h.indexOf("/",16);if(g<0){C.unexpectedUndefined("AETVC");return}f=h.substring(g)}let m=r.replaceNamesInPath(f,e,t,i),p=await l.getFileFromRelativePath(f);if(!p)C.debugAlert("Could not find file '"+f+"'");else{let g=await c.ensureFileFromRelativePath(m),b=!0;if(b){s&&await g.exists()&&(b=!1),await p.loadContent();let F=p.content;typeof F=="string"&&(F=r.replaceNamesInContent(F,e,t,i,d)),F!==null&&(n&&n("Updating '"+g.fullPath+"'"),g.setContent(F))}}}}static replaceNamesInPath(e,t,i,n){return e=B.replaceAll(e,"/"+i.id+".","/"+n+"."),e=B.replaceAll(e,"\\"+i.id+".","\\"+n+"."),e=B.replaceAll(e,"/"+i.id+"/","/"+n+"/"),e=B.replaceAll(e,"\\"+i.id+"\\","\\"+n+"\\"),e=B.replaceAll(e,"/"+i.id+"_ico.","/"+n+"_ico."),e=B.replaceAll(e,"\\"+i.id+"_ico.","\\"+n+"_ico."),e=B.replaceAll(e,"/"+i.id+"_ico/","/"+n+"_ico/"),e=B.replaceAll(e,"\\"+i.id+"_ico\\","\\"+n+"_ico\\"),e}static replaceNamesInContent(e,t,i,n,s){return e=B.replaceAll(e,"minecraft:"+i.id,t.effectiveDefaultNamespace+":"+n),e=B.replaceAllExceptInLines(e,":"+i.id,":"+n,s),e=B.replaceAllExceptInLines(e,"/"+i.id,"/"+n,s),e=B.replaceAllExceptInLines(e,"."+i.id,"."+n,s),e}static{this.CodeReplaceTokens=["say Hello",'sendMessage("Hello world']}static{this.ImportTypes={vanilla:["MinecraftDimensionTypes","MinecraftBlockTypes","MinecraftItemTypes","MinecraftEntityTypes","MinecraftEffectTypes","MinecraftEnchantmentTypes","MinecraftBiomeTypes","MinecraftFeatureTypes","MinecraftPotionEffectTypes","MinecraftPotionLiquidTypes","MinecraftPotionModifierTypes","MinecraftCooldownCategoryTypes"],math:["Vector3Utils"],mcui:["MessageFormResponse","MessageFormData","ActionFormData","ActionFormResponse","ModalFormData","ModalFormResponse"],mc:["system","BlockPermutation","BlockSignComponent","CompoundBlockVolume","SignSide","DyeColor","ItemDurabilityComponent","RawMessage","RawText","EntityProjectileComponent","EntityQueryOptions","ButtonPushAfterEvent","ItemStack","MolangVariableMap","EntityInventoryComponent","BlockInventoryComponent","Enchantment","ItemEnchantsComponent","EntityHealthComponent","EntityOnFireComponent","EntityEquippableComponent","EquipmentSlot","EntityItemComponent","EntitySpawnAfterEvent","PistonActivateBeforeEvent","PistonActivateAfterEvent","MusicOptions","WorldSoundOptions","PlayerSoundOptions","DisplaySlotId","ObjectiveSortOrder","TripWireTripAfterEvent","BlockComponentTypes","EntityComponentTypes","ItemComponentTypes","LeverActionAfterEvent","Vector3"],mced:["IPlayerUISession","ExtensionContext","IModalToolContainer","registerEditorExtension","ActionManager","IModalTool","ActionTypes","MouseProps","MouseActionType","MouseInputType","KeyboardKey","InputModifier","EditorInputContext","IPropertyPane"]}}static getTopicUrl(e){let t=e.split(".");if(!(t.length<1)){if(this.ImportTypes.mc.includes(t[0])||t[0]==="World"||t[0]==="System"||t[0]==="Dimension")return"https://learn.microsoft.com/minecraft/creator/scriptapi/minecraft/server/"+e.toLowerCase().replace(".","#");if(this.ImportTypes.mcui.includes(t[0]))return"https://learn.microsoft.com/minecraft/creator/scriptapi/minecraft/server-ui/"+e.toLowerCase().replace(".","#");if(this.ImportTypes.mced.includes(t[0]))return"https://learn.microsoft.com/minecraft/creator/scriptapi/minecraft/server-editor/"+e.toLowerCase().replace(".","#")}}static adaptFullSample(e){let t=e.indexOf("export function register");if(t>=0){let i=e.indexOf("Extension(",t);i>t&&(e=e.substring(0,t+24)+e.substring(i))}return e}static adaptSample(e,t){return e.indexOf(" mc.")>=0&&t.indexOf(" as mc")<=0&&(e=e.replace(/mc./gi,"")),e.indexOf(" mcui.")>=0&&t.indexOf(" as mcui")<=0&&(e=e.replace(/mcui./gi,"")),e}static modifyImports(e){let t=e.indexOf("("),i=e.indexOf("function");i>=0&&i<t&&(t=i),i=e.indexOf("class"),i>=0&&i<t&&(t=i);let n=e.lastIndexOf(`
`,t);if(n>=0&&(t=n),t>0){let s=e.substring(0,t),o=e.substring(t);s=r.ensureImportLines(s,o,"@minecraft/server",this.ImportTypes.mc),s=r.ensureImportLines(s,o,"@minecraft/server-ui",this.ImportTypes.mcui),s=r.ensureImportLines(s,o,"@minecraft/vanilla-data",this.ImportTypes.vanilla),s=r.ensureImportLines(s,o,"@minecraft/math",this.ImportTypes.math),e=s+o}return e}static ensureImportLines(e,t,i,n){for(let s of n)if(t.indexOf(s)>=0){let o=e.indexOf('from "'+i+'";');o<0&&(e='import {} from "'+i+`";\r
`+e,o=10);let a=e.lastIndexOf(`
`,o);a<0&&(a=0);let l=e.indexOf(`
`,o);if(l>a){let u=e.substring(a,l),c=u.indexOf("{"),d=u.indexOf("}");if(c>0&&d>c){let h=u.substring(c+1,d).trim(),f=s;h.length>0&&(f=", "+f),u=u.substring(0,d)+f+u.substring(d)}e=e.substring(0,a)+u+e.substring(l)}}return e}static async injectSnippet(e,t,i){let n=`\r
`+t.body.join(`
`)+`\r
`,s=await e.ensureDefaultScriptsFolder();await s.load();for(let o in s.files){let a=s.files[o];if(a!==void 0)if(i&&o==="ScriptBox.ts")n=r.adaptFullSample(n),a.setContent(n);else{let l=S.getTypeFromName(a.name);if((l==="ts"||l==="js")&&(await a.loadContent(),a.content&&typeof a.content=="string")){let u=a.content;for(let c=0;c<this.CodeReplaceTokens.length;c++){let d=u.indexOf(this.CodeReplaceTokens[c]);if(d>=0){let h=u.lastIndexOf(`
`,d),f=u.indexOf(`
`,d);if(h>=0&&f>h){if(n=r.adaptSample(n,u),u=u.substring(0,h)+n+u.substring(f+1),n.indexOf("overworld")>=0&&n.indexOf("const overworld")<=0){let m=u.indexOf("//");m>=0&&(u=u.substring(0,m)+`  const overworld = mc.world.getDimension("overworld");\r
`+u.substring(m,u.length))}u=r.modifyImports(u),a.setContent(u)}}}}}}}static async addBlockType(e,t,i){let n=await r.getBaseBehaviorPackPath(e),s=await r.getBaseScriptsPath(e);if(n===void 0||s===void 0)return;if(await oe.getReleaseVanillaBehaviorPackFolder(),oe.releaseVanillaBehaviorPackFolder===null){C.fail("Could not find default behavior pack folder");return}let o=oe.releaseVanillaBehaviorPackFolder.ensureFolder("blocks").ensureFile(t+".json");if(await o.loadContent(!0),!o.content||o.content===""||o.content==="null"||o.content instanceof Uint8Array){C.fail("Block at '"+o.fullPath+"' is empty.");return}let a=t?Be.canonicalizeName(t):"block",l=i||a,u=await r.getFileName(e,n+"blocks/",l,"json",!0);if(u===void 0)return;let d=await e.ensureItemByProjectPath(u,0,l,21,void 0,0).ensureFileStorage();if(d!==null){let h=B.fixJsonContent(o.content);d.setContent(h);let f=await yn.ensureOnFile(d,void 0);f&&(f.id=l.indexOf(":")>=0?l:e.effectiveDefaultNamespace+":"+l,f.persist()),await d.saveContent(!0)}}static canonicalizeStoragePath(e){return e?(e=e.toLowerCase(),e):""}static canonicalizeNamespace(e){return e?(e=e.toLowerCase(),e=e.replace(/ /gi,""),e=e.replace(/:/gi,""),e):""}static async getFileName(e,t,i,n,s){if(e.projectFolder===null)return;let o=0;s&&(o=-1);let a="",l=e.projectFolder,u=null;await l.ensureFolderFromRelativePath(t),await l.ensureExists();do o++,o===0?a=t+i+"."+n:a=t+i+o+"."+n,u=await l.getFileFromRelativePath(a);while(u!=null);return a}};var Zt=class r{static inferTypeFromContent(e,t){let i=S.getTypeFromName(t);if(typeof e=="string")switch(i){case"json":return r.inferTypeFromJsonContent(e,t)}else switch(i){case"png":return{itemType:99,packType:0,path:"/textures/ "}}return{itemType:0,packType:1,path:"/"}}static inferTypeFromJsonContent(e,t){let i=S.getBaseFromName(t);if(i){if(i.endsWith(".mci"))return{itemType:112};if(i.endsWith(".mcr"))return{itemType:113}}let n=e.substring(0,100);if(n.indexOf('"minecraft:recipe_shaped"')>=0||n.indexOf('"minecraft:recipe_shapeless"')>=0)return{itemType:43};if(n.indexOf('"minecraft:entity"')>=0)return{itemType:10};if(n.indexOf('"minecraft:item"')>=0)return{itemType:23};if(n.indexOf('"pools"')>=0)return{itemType:23};if(n.indexOf('"minecraft:spawn_rules"')>=0)return{itemType:44};if(n.indexOf('"tiers"')>=0)return{itemType:45};if(n.indexOf('"animation_controllers"')>=0)return{itemType:29,packType:0};if(n.indexOf('"animations"')>=0)return{itemType:28,packType:0};if(n.indexOf('"animations"')>=0)return{itemType:28,packType:0};if(n.indexOf('"minecraft:attachable"')>=0)return{itemType:47,packType:0};if(n.indexOf('"minecraft:client_entity"')>=0)return{itemType:30,packType:0};if(n.indexOf('"minecraft:fog_settings"')>=0)return{itemType:31,packType:0};if(n.indexOf('"minecraft:geometry"')>=0)return{itemType:32,packType:0};if(n.indexOf('"particle_effect"')>=0)return{itemType:33,packType:0};if(n.indexOf('"render_controllers"')>=0)return{itemType:34,packType:0};if(n.indexOf('"block_culling"')>=0)return{itemType:127,packType:0};if(n.indexOf('"item_catalog"')>=0)return{itemType:128,packType:1};if(n.indexOf('"namespace"')>=0)return{itemType:36,packType:0};if(n.indexOf('"sound_definitions"')>=0)return{itemType:51,packType:0};if(i==="manifest"){let s=B.getJsonObject(e);if(s!==void 0&&s.modules){for(let o of s.modules)if(o&&o.type)switch(o.type){case"script":case"data":return{itemType:5};case"resources":return{itemType:14}}}}return{itemType:0}}static getSortOrder(e){switch(e){case 14:return 510;case 10:return 1851;case 21:return 1852;case 23:return 1853;case 43:return 1860;case 33:return 1870;case 81:return 903;case 27:return 9901;case 32:return 5001;case 34:return 5003;case 4:case 7:case 8:case 55:case 73:case 54:return 1600+e}return e*100}static getCategory(e){switch(e){case 9:case 1:case 12:case 19:case 20:case 81:case 2:case 13:case 69:case 3:return 1;case 74:case 99:case 101:case 100:case 102:case 103:case 51:case 27:case 14:case 18:case 34:case 88:case 89:case 32:case 83:case 84:case 29:case 28:case 92:case 91:case 93:case 94:case 36:case 79:case 37:case 35:case 47:case 108:return 0;case 10:case 30:case 11:case 70:case 21:case 26:case 52:case 23:case 31:case 45:case 33:case 4:case 43:case 38:case 25:case 24:case 44:case 39:case 7:case 68:case 48:case 41:case 40:return 2;case 120:case 121:case 119:case 60:case 64:case 122:case 58:case 65:case 66:case 78:case 75:case 77:case 76:return 3;case 54:case 53:case 55:case 8:case 73:case 109:case 110:case 111:return 6}return 7}static isImageType(e){return e===74||e===99||e===101||e===100||e===102||e===103}static isAudioType(e){return e===108}static isPackageType(e){return e===54||e===53||e===55||e===73||e===7||e===8}static isBinaryType(e){return!!(this.isImageType(e)||this.isPackageType(e)||this.isAudioType(e))}static getMimeTypes(e){switch(e.itemType){case 2:case 1:case 11:case 69:case 3:case 70:case 120:case 71:return["application/javascript"];case 119:case 13:case 72:return["application/typescript"];case 6:case 5:case 14:case 10:case 81:case 82:case 12:case 15:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 105:case 26:case 27:case 28:case 29:case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 48:case 49:case 50:case 51:case 112:case 113:case 58:case 122:case 64:case 65:case 66:case 59:case 60:case 61:case 62:case 106:case 107:case 63:case 67:case 127:case 128:case 125:case 75:case 76:case 77:case 78:case 68:case 89:case 104:case 88:case 91:case 92:case 93:case 94:case 95:case 96:case 97:case 98:return["application/json"];case 7:case 8:case 73:case 53:case 55:case 54:return["application/zip"];case 4:return["application/octet-stream"];case 9:case 83:case 87:case 86:case 84:case 85:case 121:case 79:return["text/plain"];case 108:return["audio/wav","audio/mp3","audio/ogg"];case 74:case 99:case 102:case 103:case 100:case 101:return["image/png","image/tiff"];default:return["application/octet-stream"]}}static getDescriptionForType(e){switch(e){case 2:return"JavaScript";case 69:return"Built JavaScript";case 13:return"TypeScript";case 6:return"General json file";case 5:return"Behavior pack manifest";case 14:return"Resource pack manifest";case 1:return"Test JavaScript file";case 11:return"Entity type JavaScript";case 70:return"Entity type TypeScript";case 10:return"Entity type";case 8:return"Minecraft template";case 7:return"Minecraft world";case 73:return"Minecraft project";case 53:return"Minecraft addon";case 55:return"Minecraft pack";case 54:return"Minecraft zip";case 16:return"Minecraft world";case 4:return"Structure";case 9:return"Function";case 81:return"Tick";case 83:return"Material";case 84:return"Material Set";case 87:return"Geometry";case 86:return"Fragment";case 85:return"Vertex";case 82:return"Camera";case 3:return"Catalog index";case 109:return"Behavior pack";case 110:return"Resource pack";case 111:return"Skin pack";case 12:return"Action Set";case 15:return"World test";case 17:return"World behavior pack list";case 18:return"World resource pack list";case 19:return"Behavior pack animation";case 20:return"Behavior pack animation controller";case 21:return"Block type";case 22:return"Block type materials";case 23:return"Item type";case 24:return"Loot table";case 25:return"Biome resources";case 105:return"File list";case 128:return"Crafting Item catalog";case 26:return"Block resource catalog";case 27:return"Sound catalog";case 28:return"Animation";case 29:return"Animation controller";case 30:return"Entity type visuals/audio";case 31:return"Fog";case 32:return"Model";case 33:return"Particle";case 34:return"Render controller";case 127:return"Block culling";case 36:return"User interface";case 37:return"Language catalog";case 38:return"Biome";case 39:return"Entity dialogue";case 40:return"World feature rule";case 41:return"Feature";case 42:return"Function event";case 43:return"Recipe";case 44:return"Spawn rule";case 45:return"Trading";case 46:return"Volume";case 47:return"Attachable";case 48:return"Item type resources";case 49:return"Materials";case 50:return"Music catalog";case 51:return"Sound catalog";case 108:return"Audio";case 112:return"Content Description";case 113:return"Content Report";case 58:return"TypeScript config";case 122:return"Prettier JavaScript/JSON style config";case 64:return"JavaScript config";case 65:return"DocFX definition";case 66:return"JSDoc definition";case 59:return"NPM package definition";case 60:return"NPM package lock definition";case 121:return"Environment File";case 120:return"ESLint config";case 119:return"Just config";case 61:return"Doc info json";case 35:return"Nine-slice scaling config";case 62:return"Script types definition";case 106:return"Vanilla data definition";case 107:return"Engine ordering definition";case 63:return"Command definition";case 67:return"Skin pack manifest";case 125:return"Persona manifest";case 71:return"Block type base JavaScript";case 72:return"Block type base TypeScript";case 74:return"Image";case 99:return"Texture";case 102:return"UI texture";case 103:return"Icon";case 100:return"Marketing image";case 101:return"Store image";case 75:return"VS Code launch file";case 76:return"VS Code tasks";case 77:return"VS Code settings";case 78:return"VS Code extensions";case 79:return"Language translations";case 68:return"World template manifest";case 89:return"Texture set";case 104:return"Texture list";case 88:return"Lighting";case 91:return"Flipbook texture set";case 92:return"Item texture";case 93:return"Terrain texture";case 94:return"UI global variables";case 95:return"Form";case 96:return"Dimension";case 97:return"Behavior pack history";case 98:return"Resource pack history";default:return"Unknown"}}static getNewItemName(e){return r.getDescriptionForType(e).toLowerCase()}static getColorForType(e){switch(r.getCategory(e)){case 1:return{red:e%4*24+160,green:Math.floor(e/4)%4*12+104,blue:Math.floor(e/16)%4*12+104};case 0:return{red:Math.floor(e/4)%4*12+104,green:e%4*24+160,blue:Math.floor(e/16)%4*12+104};case 2:return{red:Math.floor(e/16)%4*12+104,green:Math.floor(e/4)%4*12+104,blue:e%4*24+160};default:return{red:Math.floor(e/4)%4*24+128,green:Math.floor(e/4)%4*24+128,blue:Math.floor(e/4)%4*24+128}}}static getPluralDescriptionForType(e){switch(e){case 108:return"Audio";case 13:return"TypeScript files";case 2:return"JavaScript files";case 76:return"VS Code task sets";case 77:return"VS Code settings sets";case 94:return"UI global variable sets";case 48:return"Item type visuals and audio";case 87:return"Model shapes";case 30:return"Entity type visuals/audio";case 3:return"Catalog indexes";case 97:return"Behavior pack histories";case 98:return"Resource pack histories";default:return this.getDescriptionForType(e)+"s"}}static async getDefaultFolderForType(e,t){let i=r.getFolderRootsForType(t);if(!(i===void 0||i.length===0)&&(await e.ensureLoadedProjectFolder(),!!e.projectFolder))switch(t){case 2:case 13:return await e.getMainScriptsFolder();case 10:case 9:let s=await e.getDefaultBehaviorPackFolder();return s?s.ensureFolderFromRelativePath(i[0]):void 0;case 30:case 32:let o=await e.getDefaultResourcePackFolder();return o?o.ensureFolderFromRelativePath(i[0]):void 0;case 44:return await di.getDefaultSpawnRulesFolder(e);case 24:return await di.getDefaultLootTableFolder(e);case 102:let a=await e.getDefaultResourcePackFolder();return a?a.ensureFolderFromRelativePath(i.join("/")):void 0}}static getFolderRootsForType(e){switch(e){case 9:return["functions"];case 2:case 13:return["scripts"];case 74:return["subpacks"];case 88:return["lighting"];case 81:return["functions"];case 102:return["textures","ui"];case 99:case 93:case 92:case 91:return["textures"];case 103:return["resource_packs","rps","development_resource_packs","behavior_packs","bps","development_behavior_packs"];case 32:return["models"];case 27:return["resource_packs","rps","development_resource_packs"];case 51:return["sounds"];case 30:return["entity"];case 34:return["render_controllers"];case 47:return["attachables"];case 10:return["entities"];case 23:case 48:return["items"];case 21:return["blocks"];case 56:return["script_modules"];case 63:return["command_modules"];case 24:return["loot_tables"];case 43:return["recipes"];case 44:return["spawn_rules"];case 33:return["particles"];case 4:return["structures"];case 16:case 7:return["worlds"];case 82:return["cameras"];case 96:return["dimensions"];case 31:return["fogs"];case 95:return["forms"];case 62:return["checkpoint_input","script_modules"];case 107:return["checkpoint_input","engine_modules"];case 106:return["checkpoint_input","vanilladata_modules"];case 100:return["marketing art"];case 101:return["store art"];case 108:return["sounds"];case 84:case 49:case 83:return["materials"]}return[]}};var r0=Le(Je());var Gi=class r{constructor(){this._isLoaded=!1;this._onLoaded=new r0.EventDispatcher}get isLoaded(){return this._isLoaded}get file(){return this._file}get onLoaded(){return this._onLoaded.asEvent()}set file(e){this._file=e}get soundDefinitionSoundInstanceList(){if(!this._data)return;let e=[];if(this._data.sound_definitions)for(let t in this._data.sound_definitions){let i=this._data.sound_definitions[t];for(let n of i.sounds)e.push(n)}else for(let t in this._data)if(t!=="format_version"&&t!=="sound_definitions"){let i=this._data[t];if(i&&i.sounds&&Array.isArray(i.sounds))for(let n of i.sounds)e.push(n)}return e}get soundDefinitionPathList(){if(!this._data||!this._data.sound_definitions)return;let e=[];for(let t in this._data.sound_definitions){let i=this._data.sound_definitions[t];for(let n of i.sounds)typeof n=="string"?e.push(n):e.push(n.name)}return e}get soundDefinitionSetNameList(){if(!this._data||!this._data.sound_definitions)return;let e=[];for(let t in this._data.sound_definitions)e.push(t);return e}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}persist(){if(this._file===void 0)return;let e=JSON.stringify(this._data,null,2);this._file.setContent(e)}async load(){if(this._isLoaded)return;if(this._file===void 0){C.unexpectedUndefined("TTCDF");return}if(await this._file.loadContent(),!this._file.content||this._file.content instanceof Uint8Array)return;let e={},t=S.getJsonObject(this._file);t&&(e=t),this._data=e,this._isLoaded=!0,this._onLoaded.dispatch(this,this)}async deleteLinkToChild(e){let t=this.getPackRootFolder();if(this._data===void 0&&await this.load(),e.itemType===99&&this._data&&this._data.sound_definitions&&(await e.ensureStorage(),e.file&&t)){let i=this.getRelativePath(e.file,t);if(i)for(let n in this._data.sound_definitions){let s=this._data.sound_definitions[n];for(let o of s.sounds)typeof o=="string"?o===i&&(s.sounds=B.removeItemInArray(o,s.sounds)):o.name===i&&(s.sounds=B.removeItemInArray(o,s.sounds))}}this.persist()}getPackRootFolder(){let e;if(this.file&&this.file.parentFolder){let t=this.file.parentFolder;for(;t.name!=="sounds"&&t.parentFolder;)t=t.parentFolder;t.parentFolder&&(e=t.parentFolder)}return e}getRelativePath(e,t){let i=e.getFolderRelativePath(t);if(i){let n=i?.lastIndexOf(".");n>=0&&(i=i?.substring(0,n).toLowerCase()),i=S.ensureNotStartsWithDelimiter(i)}return i}ensureDefintionForFile(e,t){let i=this.getPackRootFolder();if(!i||!this._data)return;let n=this.getRelativePath(t,i);if(!n)return;let s=S.getBaseFromName(t.name).toLowerCase(),o=this._data.sound_definitions[s];o||(o={category:"neutral",sounds:[]},this._data.sound_definitions[s]=o),o&&!this.hasSoundByPath(o,n)&&o.sounds.push({is3D:!1,name:n,volume:1,weight:10})}hasSoundByPath(e,t){for(let i of e.sounds){if(typeof i=="string"&&i===t)return i;if(typeof i!="string"&&i.name===t)return i}}getSoundReferenceMatchesByPath(e){let t=this.getPackRootFolder();if(!t)return;let i=this.getRelativePath(e,t),n={};if(i&&this._data)for(let s in this._data.sound_definitions){let o=this._data.sound_definitions[s];if(o&&o.sounds)for(let a of o.sounds)typeof a=="string"?S.isPathEqual(a,i)&&(n[s]||(n[s]=[]),n[s].push({name:a})):S.isPathEqual(a.name,i)&&(n[s]||(n[s]=[]),n[s].push(a))}return n}getSoundDefinitionMatchesByPath(e){let t=this.getPackRootFolder();if(!t)return;let i=this.getRelativePath(e,t),n={};if(i&&this._data)for(let s in this._data.sound_definitions){let o=this._data.sound_definitions[s];if(o&&o.sounds)for(let a of o.sounds)typeof a=="string"?S.isPathEqual(a,i)&&(n[s]=o):S.isPathEqual(a.name,i)&&(n[s]=o)}return n}async addChildItems(e,t){let i=e.getItemsCopy(),n=this.getPackRootFolder(),s=this.soundDefinitionSoundInstanceList;for(let o of i)if(o.itemType===108&&n&&s&&(await o.ensureStorage(),o.file)){let a=this.getRelativePath(o.file,n);if(a){for(let l of s)if(typeof l=="string"){if(S.isPathEqual(l,a)&&(t.addChildItem(o),s)){let u=[];for(let c of s)(typeof c!="string"||!S.isPathEqual(c,a))&&u.push(c);s=u}}else if(S.isPathEqual(l.name,a)&&(t.addChildItem(o),s)){let u=[];for(let c of s)(typeof c=="string"||!S.isPathEqual(c.name,a))&&u.push(c);s=u}}}if(s)for(let o of s)typeof o=="string"?t.addUnfulfilledRelationship(o,108,await oe.isVanillaToken(o)):t.addUnfulfilledRelationship(o.name,108,await oe.isVanillaToken(o.name))}};var n0=Le(Je());var Xr=class r{constructor(){this._isLoaded=!1;this._onLoaded=new n0.EventDispatcher}get isLoaded(){return this._isLoaded}get file(){return this._file}get onLoaded(){return this._onLoaded.asEvent()}get data(){return this._data}set file(e){this._file=e}get entityIdList(){if(!this._data)return;let e=[];if(this._data.entity_sounds&&this._data.entity_sounds.entities)for(let t in this._data.entity_sounds.entities)e.includes(t)||e.push(t);return e}get soundEventNameList(){if(!this._data)return;let e=[];if(this._data.entity_sounds&&this._data.entity_sounds.entities)for(let t in this._data.entity_sounds.entities){let i=this._data.entity_sounds.entities[t];if(i&&i.events){for(let n in i.events)if(i.events[n])for(let o in i.events){let a=i.events[o];typeof a=="string"?e.includes(a)||e.push(a):a.sound&&(e.includes(a.sound)||e.push(a.sound))}}}if(this._data.entity_sounds&&this._data.entity_sounds.defaults&&this._data.entity_sounds.defaults.events)for(let t in this._data.entity_sounds.defaults.events){let i=this._data.entity_sounds.defaults.events[t];typeof i=="string"?e.includes(i)||e.push(i):i.sound&&(e.includes(i.sound)||e.push(i.sound))}if(this._data.block_sounds)for(let t in this._data.block_sounds){let i=this._data.block_sounds[t];if(i&&i.events){for(let n in i.events)if(i.events[n])for(let o in i.events){let a=i.events[o];typeof a=="string"?e.includes(a)||e.push(a):a.sound&&(e.includes(a.sound)||e.push(a.sound))}}}if(this._data.individual_event_sounds&&this._data.individual_event_sounds.events)for(let t in this._data.individual_event_sounds.events){let i=this._data.individual_event_sounds.events[t];typeof i=="string"?e.includes(i)||e.push(i):i.sound&&(e.includes(i.sound)||e.push(i.sound))}return e}ensureEntityEvent(e){if(this.ensureDefault(),!this._data)return;let t=this._data.entity_sounds;t===void 0&&(t={entities:{}},this._data.entity_sounds=t);let i=t.entities;i===void 0&&(i={},t.entities=i);let n=i[e];return n||(e.startsWith("minecraft:")&&(n=i[e.substring(10)]),n||(n={events:{}}),i[e]=n,n)}ensureDefault(){this._data===void 0&&(this._data={})}static async ensureForProject(e){let t=e.getItemsCopy();for(let n of t)if(n.itemType===27&&(await n.ensureFileStorage(),n.file)){let s=await r.ensureOnFile(n.file);if(s)return s}let i=await e.getDefaultResourcePackFolder();if(i){let n=i.ensureFile("sounds.json"),s=await r.ensureOnFile(n);if(s){if(s.ensureDefault(),e.projectFolder){let o=n.getFolderRelativePath(e.projectFolder);o&&e.ensureItemByProjectPath(o,0,n.name,27,void 0,0,n)}return s}}}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}persist(){if(this._file===void 0)return;let e=JSON.stringify(this._data,null,2);this._file.setContent(e)}async load(){if(this._isLoaded)return;if(this._file===void 0){C.unexpectedUndefined("TTCDF");return}if(await this._file.loadContent(),!this._file.content||this._file.content instanceof Uint8Array)return;let e={},t=S.getJsonObject(this._file);t&&(e=t),this._data=e,this._isLoaded=!0,this._onLoaded.dispatch(this,this)}async addChildItems(e,t){let i=e.getItemsCopy(),n=this.soundEventNameList,s=this.entityIdList;for(let o of i)if((o.itemType===30||o.itemType===10)&&s){let a=await xi.get(o);a&&a.id&&s?.includes(a?.id)&&(t.addChildItem(o),s=B.removeItemInArray(a.id,s))}else if(o.itemType===51&&n&&(await o.ensureStorage(),o.file)){let l=(await Gi.ensureOnFile(o.file))?.soundDefinitionSetNameList;if(l)for(let u of n)l.includes(u)&&(t.addChildItem(o),n=B.removeItemInArray(u,n))}if(n)for(let o of n)t.addUnfulfilledRelationship(o,51,await oe.isVanillaToken(o));if(s)for(let o of s)t.addUnfulfilledRelationship(o,10,await oe.isVanillaToken(o))}};var Ul=class r{static async _getDefaultBehaviorPackPath(e){let t=await e.ensureDefaultBehaviorPackFolder();return e.projectFolder===null?void 0:t.getFolderRelativePath(e.projectFolder)}static async _getDefaultBehaviorPackFolderPath(e,t){let i=await e.ensureDefaultBehaviorPackFolder();if(e.projectFolder===null)return;let n=i.ensureFolder(t);return await n.ensureExists(),n.getFolderRelativePath(e.projectFolder)}static async _getDefaultResourcePackPath(e){let t=await e.ensureDefaultResourcePackFolder();return e.projectFolder===null?void 0:t.getFolderRelativePath(e.projectFolder)}static async _getDefaultResourcePackFolderPath(e,t){let i=await e.ensureDefaultResourcePackFolder();if(e.projectFolder===null)return;let n=i.ensureFolder(t);return await n.ensureExists(),n.getFolderRelativePath(e.projectFolder)}static async _getDefaultScriptsFolderPath(e){let t=await e.ensureMainScriptsFolder();return e.projectFolder===null?void 0:t.getFolderRelativePath(e.projectFolder)}static async createNewItem(e,t){if((t.name===""||t.name===void 0)&&(t.name=Zt.getNewItemName(t.itemType)),t.itemType)switch(t.itemType){case 2:case 13:return r.createNewScript(e,t.itemType,t.name,t.folder);case 95:return r.createNewForm(e,t.name,t.folder);case 44:return r.createNewSpawnRule(e,t.name,t.folder);case 108:return r.createNewAudio(e,t.name,t.folder)}}static async createNewScript(e,t,i,n){let s;if(n&&e.projectFolder?s=n.getFolderRelativePath(e.projectFolder):s=await r._getDefaultScriptsFolderPath(e),s===void 0)return;let o=await r._generateFileNameForNewItem(e,s,i,t===2?"js":"ts");if(o===void 0)return;let a=e.ensureItemByProjectPath(o,0,S.getLeafName(o),t===2?2:13,void 0,0),l=await a.ensureFileStorage();if(l!==null){let u=S.getBaseFromName(l.name);e.preferredScriptLanguage===1?l.setContent(Ui.getEmptyTypeScript(e.name,u)):l.setContent(Ui.getEmptyJavaScript(e.name,u))}return await ci.updateProjectAutogeneration(e),await e.save(),a}static async _generateFolderNameForNewItem(e,t,i){if(e.projectFolder===null)return;let n=0,s="",o="",a=e.projectFolder,l=null,u=t.indexOf("#"),c=a;for(;u>0;){let d=t.substring(0,u);t=t.substring(u+1),u=t.indexOf("#"),d.startsWith(c.fullPath)&&(d=d.substring(c.fullPath.length)),o+=d+"#";let h=await c.getFileFromRelativePath(d);if(!h)return;let f=h.type;if(f!=="zip"&&f!=="mcworld"&&f!=="mctemplate")return;if(!h.fileContainerStorage){let m=new yt;if(await h.loadContent(),!h.content||!(h.content instanceof Uint8Array))return;await m.loadFromUint8Array(h.content,h.name),h.fileContainerStorage=m,h.fileContainerStorage.storagePath=d+"#"}c=h.fileContainerStorage.rootFolder}await c.ensureFolderFromRelativePath(t),await c.ensureExists();do n++,s=t+i+n,l=await c.getFolderFromRelativePath(s);while(l!=null);return o+s}static async _generateFileNameForNewItem(e,t,i,n){if(e.projectFolder===null)return;let s=0,o="",a="",l=e.projectFolder,u=null,c=t.indexOf("#"),d=l;for(;c>0;){let h=t.substring(0,c);t=t.substring(c+1),c=t.indexOf("#"),h.startsWith(d.fullPath)&&(h=h.substring(d.fullPath.length)),a+=h+"#";let f=await d.getFileFromRelativePath(h);if(!f)return;let m=f.type;if(m!=="zip"&&m!=="mcworld"&&m!=="mctemplate")return;if(!f.fileContainerStorage){let p=new yt;if(await f.loadContent(),!f.content||!(f.content instanceof Uint8Array))return;await p.loadFromUint8Array(f.content),f.fileContainerStorage=p,f.fileContainerStorage.storagePath=h+"#"}d=f.fileContainerStorage.rootFolder}if(await d.ensureFolderFromRelativePath(t),await d.ensureExists(),o=t+i+"."+n,u=await d.getFileFromRelativePath(o),u)do s++,o=t+i+s+"."+n,u=await d.getFileFromRelativePath(o);while(u!=null);return a+o}static async createNewGameTestScript(e){let t=await r._getDefaultBehaviorPackFolderPath(e,"scripts");if(t===void 0)return;let i=await r._generateFileNameForNewItem(e,t,"test","js");if(i===void 0)return;let s=await e.ensureItemByProjectPath(i,0,S.getLeafName(i),1,void 0,0).ensureFileStorage();if(s!==null){let o=S.getBaseFromName(s.name);if(e.preferredScriptLanguage===1){let l=s.parentFolder.ensureFile(o+".ts");if(l!==null){let u=Ui.getEmptyTestTypeScript(e.name,o);l.setContent(u)}}let a=Ui.getEmptyTestJavaScript(e.name,o);s.setContent(a)}await e.save()}static async createNewFunction(e){let t=await this._getDefaultBehaviorPackFolderPath(e,"functions");if(t===void 0)return;let i=await r._generateFileNameForNewItem(e,t,"action","mcfunction");if(i===void 0)return;let s=await e.ensureItemByProjectPath(i,0,S.getLeafName(i),9,void 0,0).ensureFileStorage();s!==null&&s.setContent("say hello"),await e.save()}static async createNewStructure(e){let t=await r._getDefaultBehaviorPackFolderPath(e,"structures");if(t===void 0)return;let i=await r._generateFileNameForNewItem(e,t,"structure","mcstructure");if(i===void 0)return;let s=await e.ensureItemByProjectPath(i,0,S.getLeafName(i),4,void 0,0).ensureFileStorage();if(s!==null){let o=Ui.generateDefaultStructure();o!==void 0&&s.setContent(o)}await e.save()}static async createNewActionSet(e){let t=await this._getDefaultBehaviorPackFolderPath(e,"actions");if(t===void 0)return;let i=await r._generateFileNameForNewItem(e,t,"actionset","json");if(i===void 0)return;let s=await e.ensureItemByProjectPath(i,0,S.getLeafName(i),12,void 0,0).ensureFileStorage();if(s!==null){let o=S.getBaseFromName(s.name),a=Ui.getEmptyActionSet(e.name,o);s.setContent(a)}await ci.updateProjectAutogeneration(e)}static async createNewDocumentedType(e){let t=await this._getDefaultBehaviorPackFolderPath(e,"docs");if(t===void 0)return;let i=await r._generateFolderNameForNewItem(e,t,"type");if(i===void 0)return;await e.ensureItemByProjectPath(i,1,i,56,void 0,0).ensureFolderStorage(),await ci.updateProjectAutogeneration(e),await e.save()}static getExistingPath(e,t){if(e.projectFolder){for(let i of e.items)if(i.itemType===t&&i.file)return i.file.parentFolder.getFolderRelativePath(e.projectFolder)}}static async createNewForm(e,t,i){let n;if(!e.projectFolder)return;if(i)n=i.getFolderRelativePath(e.projectFolder);else if(n=r.getExistingPath(e,95),n===void 0&&(n=await this._getDefaultBehaviorPackFolderPath(e,"forms"),n===void 0))return;if(!n)return;t||(t="form");let s=await r._generateFileNameForNewItem(e,n,t,"form.json");if(s===void 0)return;let o=e.ensureItemByProjectPath(s,0,S.getLeafName(s),95,void 0,0),a=await o.ensureFileStorage();return a!==null&&a.setContent("{}"),await ci.updateProjectAutogeneration(e),await e.save(),o}static async ensureSoundDefinitionCatalogDefinition(e){let t=e.getItemByType(51);if(t.length>0&&(await t[0].ensureStorage(),t[0].file))return await t[0].file.loadContent(),t[0].file.content||this.setFileToDefaultContent(t[0].file),await Gi.ensureOnFile(t[0].file);let i;if(!e.projectFolder||(i=await this._getDefaultResourcePackFolderPath(e,"sounds"),i===void 0))return;let n=await r._generateFileNameForNewItem(e,i,"sound_definitions","json");if(n===void 0)return;let o=await e.ensureItemByProjectPath(n,0,S.getLeafName(n),51,void 0,0).ensureFileStorage();if(o!==null)return this.setFileToDefaultContent(o),await ci.updateProjectAutogeneration(e),await e.save(),await Gi.ensureOnFile(o)}static setFileToDefaultContent(e){e.setContent(`{\r
   "format_version" : "1.20.20",\r
   "sound_definitions" : {}\r
}`),e.saveContent()}static async ensureSoundCatalogDefinition(e){let t=e.getItemByType(27);if(t.length>0&&(await t[0].ensureStorage(),t[0].file))return await Xr.ensureOnFile(t[0].file);let i;if(!e.projectFolder||(i=await this._getDefaultResourcePackFolderPath(e,"sounds"),i===void 0))return;let n=await r._generateFileNameForNewItem(e,i,"sounds","json");if(n===void 0)return;let o=await e.ensureItemByProjectPath(n,0,S.getLeafName(n),27,void 0,0).ensureFileStorage();return o===null?void 0:(o.setContent(`{\r
}`),await ci.updateProjectAutogeneration(e),await e.save(),await Xr.ensureOnFile(o))}static async createNewSpawnRule(e,t,i){let n;if(!e.projectFolder)return;if(i)n=i.getFolderRelativePath(e.projectFolder);else if(n=r.getExistingPath(e,44),n===void 0&&(n=await this._getDefaultBehaviorPackFolderPath(e,"spawn_rules"),n===void 0))return;if(!n)return;t||(t="spawn_rule");let s=await r._generateFileNameForNewItem(e,n,t,"json");if(s===void 0)return;let o=e.ensureItemByProjectPath(s,0,S.getLeafName(s),44,void 0,0),a=await o.ensureFileStorage();return a!==null&&a.setContent("{}"),await ci.updateProjectAutogeneration(e),await e.save(),o}static async createNewAudio(e,t,i){let n;if(!e.projectFolder)return;if(await oe.loadContent(),oe.contentFolder===null){C.unexpectedContentState();return}let s=oe.contentFolder.ensureFile("blank.ogg");if(await s.loadContent(),!(s.content instanceof Uint8Array)){C.error("Could not find source OGG file content.");return}if(i)n=i.getFolderRelativePath(e.projectFolder);else if(n=r.getExistingPath(e,108),n===void 0&&(n=await this._getDefaultResourcePackFolderPath(e,"sounds"),n===void 0))return;if(!n)return;t||(t="sound");let o=await r._generateFileNameForNewItem(e,n,t,"mp3");if(o===void 0)return;let a=e.ensureItemByProjectPath(o,0,S.getLeafName(o),108,void 0,0),l=await a.ensureFileStorage();return l!==null&&l.setContent(s.content),await ci.updateProjectAutogeneration(e),await e.save(),a}static async createNewWorldTest(e,t,i){let n;if(!e.projectFolder)return;if(i)n=i.getFolderRelativePath(e.projectFolder);else if(n=r.getExistingPath(e,95),n===void 0&&(n=await this._getDefaultBehaviorPackFolderPath(e,"forms"),n===void 0))return;if(!n)return;t||(t="form");let s=await r._generateFileNameForNewItem(e,n+"tests/","worldtest","json");if(s===void 0)return;let a=await e.ensureItemByProjectPath(s,0,S.getLeafName(s),15,void 0,0).ensureFileStorage();if(a!==null){let l=S.getBaseFromName(a.name),u=Ui.getEmptyWorldTest(e.name,l);a.setContent(u)}await ci.updateProjectAutogeneration(e),await e.save()}};var Gl=class r{constructor(){this._isLoaded=!1;this._onLoaded=new s0.EventDispatcher}get isLoaded(){return this._isLoaded}get file(){return this._file}get onLoaded(){return this._onLoaded.asEvent()}set file(e){this._file=e}get id(){return this._file?this._file.name:this._id}set id(e){this._id=e}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}persist(){this._file}async ensureSoundDefinitionsForFile(e){if(!this._file)return;let t=await Ul.ensureSoundDefinitionCatalogDefinition(e);if(this._file&&t){let i=t.getSoundDefinitionMatchesByPath(this._file);if(i){let n=0;for(let s in i)s&&n++;n===0&&t.ensureDefintionForFile(e,this._file)}t.persist()}}async load(){this._file===void 0||this._isLoaded||(await this._file.loadContent(),!(this._file.content===null||this._file.content instanceof Uint8Array)&&(this._isLoaded=!0))}};var o0=Le(Je());var js=class r{constructor(){this._isLoaded=!1;this._onLoaded=new o0.EventDispatcher}get data(){return this._data}get texturesList(){if(!this._data)return;let e=[];for(let t of this._data){let i=t.flipbook_texture;i&&e.push(i.toLowerCase())}return e}get isLoaded(){return this._isLoaded}get file(){return this._file}get onLoaded(){return this._onLoaded.asEvent()}set file(e){this._file=e}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}persist(){if(this._file===void 0)return;let e=JSON.stringify(this._data,null,2);this._file.setContent(e)}async load(){if(this._isLoaded)return;if(this._file===void 0){C.unexpectedUndefined("FBTCDF");return}if(await this._file.loadContent(),!this._file.content||this._file.content instanceof Uint8Array)return;let e=[],t=S.getJsonObject(this._file);t&&(e=t),this._data=e,this._isLoaded=!0,this._onLoaded.dispatch(this,this)}async deleteLinkToChild(e){let t=this.getPackRootFolder();if(this._data===void 0&&await this.load(),!!this._data){if(e.childItem.itemType===99&&(await e.childItem.ensureStorage(),e.childItem.file&&t)){let i=this.getRelativePath(e.childItem.file,t);if(i){let n=[];for(let s of this._data)s.flipbook_texture!==i&&n.push(s);this._data=n}}this.persist()}}getPackRootFolder(){let e;if(this.file&&this.file.parentFolder){let t=this.file.parentFolder;for(;t.name!=="textures"&&t.parentFolder;)t=t.parentFolder;t.parentFolder&&(e=t.parentFolder)}return e}getRelativePath(e,t){let i=e.getFolderRelativePath(t);if(i){let n=i?.lastIndexOf(".");n>=0&&(i=i?.substring(0,n).toLowerCase()),i=S.ensureNotStartsWithDelimiter(i)}return i}async addChildItems(e,t){let i=e.getItemsCopy(),n=this.getPackRootFolder(),s=this.texturesList;for(let o of i)if(o.itemType===99&&n&&s&&(await o.ensureStorage(),o.file)){let a=this.getRelativePath(o.file,n);a&&s&&s.includes(a)&&(t.addChildItem(o),s=B.removeItemInArray(a,s))}if(s)for(let o of s)t.addUnfulfilledRelationship(o,99,await oe.matchesVanillaPath(o))}};var a0=Le(Je());var Us=class r{constructor(){this._isLoaded=!1;this._onLoaded=new a0.EventDispatcher}get isLoaded(){return this._isLoaded}get file(){return this._file}get onLoaded(){return this._onLoaded.asEvent()}set file(e){this._file=e}get musicDefinitionNameList(){if(!this._data)return;let e=[];for(let t in this._data)e.push(t);return e}get musicDefinitionEventNameList(){if(!this._data)return;let e=[];for(let t in this._data){let i=this._data[t];i&&i.event_name&&(e.includes(i.event_name)||e.push(i.event_name))}return e}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}persist(){if(this._file===void 0)return;let e=JSON.stringify(this._data,null,2);this._file.setContent(e)}async load(){if(this._isLoaded)return;if(this._file===void 0){C.unexpectedUndefined("TTCDF");return}if(await this._file.loadContent(),!this._file.content||this._file.content instanceof Uint8Array)return;let e={},t=S.getJsonObject(this._file);t&&(e=t),this._data=e,this._isLoaded=!0,this._onLoaded.dispatch(this,this)}async addChildItems(e,t){let i=e.getItemsCopy(),n=this.musicDefinitionEventNameList;for(let s of i)if(s.itemType===51&&n&&(await s.ensureStorage(),s.file)){let a=(await Gi.ensureOnFile(s.file))?.soundDefinitionSetNameList;if(a){for(let l of n)if(a.includes(l)){t.addChildItem(s);let u=[];for(let c of n)c!==l&&u.push(c);n=u}}}if(n)for(let s of n)t.addUnfulfilledRelationship(s,51,await oe.isVanillaToken(s))}};var xi=class r{static async get(e){if(!((!e.file||!e.file.content||typeof e.file.content!="string")&&(await e.ensureFileStorage(),!e.file||(await e.file.loadContent(),!e.file.content||typeof e.file.content!="string"))))switch(e.itemType){case 10:return await Ii.ensureOnFile(e.file);case 30:return await Zi.ensureOnFile(e.file);case 23:return await pr.ensureOnFile(e.file);case 21:return await yn.ensureOnFile(e.file);case 91:return await js.ensureOnFile(e.file);case 5:return await Et.ensureOnFile(e.file);case 14:return await jt.ensureOnFile(e.file);case 20:return await gn.ensureOnFile(e.file);case 29:return await Tr.ensureOnFile(e.file);case 19:return await cr.ensureOnFile(e.file);case 28:return await ji.ensureOnFile(e.file);case 51:return await Gi.ensureOnFile(e.file);case 27:return await Xr.ensureOnFile(e.file);case 50:return await Us.ensureOnFile(e.file);case 34:return await xr.ensureOnFile(e.file)}}static async ensureFoundationalDependencies(e){if(e.itemType===108&&(await e.ensureStorage(),e.file)){let t=await Gl.ensureOnFile(e.file);t&&await t.ensureSoundDefinitionsForFile(e.project)}}static async formatVersionIsCurrent(e){let t=await r.get(e);return t&&t.getFormatVersionIsCurrent?await t.getFormatVersionIsCurrent():!0}static async getFormatVersion(e){let t=await r.get(e);if(t&&t.getFormatVersion){let i=await t.getFormatVersion();return i instanceof Array?i:void 0}}};var Zi=class r{constructor(){this._isLoaded=!1;this._onLoaded=new l0.EventDispatcher}get isLoaded(){return this._isLoaded}get dataWrapper(){return this._data}get data(){return this._data}get file(){return this._file}get onLoaded(){return this._onLoaded.asEvent()}set file(e){this._file=e}get id(){if(this._data)return this._data.identifier}get textures(){if(this._data)return this._data.textures===void 0&&(this._data.textures={}),this._data.textures}get texturesList(){if(!this._data||!this._data.textures)return;let e=[];for(let t in this._data.textures){let i=this._data.textures[t];i&&e.push(i.toLowerCase())}return e}get texturesIdList(){if(!this._data||!this._data.textures)return;let e=[];for(let t in this._data.textures)e.push(t);return e}get renderControllerIdList(){if(!(!this._data||!this._data.render_controllers))return this._data.render_controllers}get animationControllerIdList(){if(!this._data||!this._data.animation_controllers)return;let e=[];for(let t in this._data.animation_controllers)e.push(t);return e}get animationControllerList(){if(!this._data||!this._data.animation_controllers)return;let e=[];for(let t in this._data.animation_controllers){let i=this._data.animation_controllers[t];i&&e.push(i)}return e}get animationIdList(){if(!this._data||!this._data.animations)return;let e=[];for(let t in this._data.animations)e.push(t);return e}get animationList(){if(!this._data||!this._data.animations)return;let e=[];for(let t in this._data.animations){let i=this._data.animations[t];i&&e.push(i)}return e}get geometry(){if(this._data)return this._data.geometry}get geometryList(){if(!this._data||!this._data.geometry)return;let e=[];for(let t in this._data.geometry){let i=this._data.geometry[t];i&&e.push(i)}return e}getTextureItems(e){if(!this._data||!this._data.geometry||!e.childItems)return;let t={};for(let i in this._data.textures){let n=this._data.textures[i];if(n){n=S.canonicalizePath(n);for(let s of e.childItems)if(s.childItem.itemType===99&&s.childItem.projectPath){let o=S.canonicalizePath(s.childItem.projectPath),a=o.lastIndexOf(".");a>=0&&(o=o.substring(0,a).toLowerCase()),o.endsWith(n)&&(t[i]=s.childItem)}}}return t}getFormatVersion(){if(!this._dataWrapper)return;let e=this._dataWrapper.format_version;if(typeof e=="number")return[e];if(typeof e=="string"){let t=this._dataWrapper.format_version.split("."),i=[];for(let n=0;n<t.length;n++)try{i.push(parseInt(t[n]))}catch{}return i}}get formatVersion(){if(!(!this._dataWrapper||!this._dataWrapper.format_version))return this._dataWrapper.format_version}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}ensureData(){if(this._data)return this._data;let e={description:{identifier:"",materials:{},textures:{},geometry:{},animation_controllers:{},particle_effects:{},animations:{},render_controllers:[],scripts:{}}};return this._dataWrapper?((this._dataWrapper["minecraft:client_entity"]===void 0||this._dataWrapper["minecraft:client_entity"].description===void 0)&&(this._dataWrapper["minecraft:client_entity"]=e),this._data=this._dataWrapper["minecraft:client_entity"].description,this._data):(this._dataWrapper={format_version:"1.10.0","minecraft:client_entity":e},this._data=this._dataWrapper["minecraft:client_entity"].description,this._data)}persist(){if(this._file===void 0)return;let e=JSON.stringify(this._dataWrapper,null,2);this._file.setContent(e)}async load(){if(this._isLoaded)return;if(this._file===void 0){C.unexpectedUndefined("ETRPF");return}if(await this._file.loadContent(),!this._file.content||this._file.content instanceof Uint8Array)return;let e={},t=S.getJsonObject(this._file);t&&(e=t),this._dataWrapper=e,this._dataWrapper&&this._dataWrapper["minecraft:client_entity"]&&(this._data=this._dataWrapper["minecraft:client_entity"].description),this._isLoaded=!0,this._onLoaded.dispatch(this,this)}async deleteLinkToChild(e){let t=this.getPackRootFolder();this._data===void 0&&await this.load();let i=e.parentItem.childItems;if(e.childItem.itemType===99&&this._data&&this._data.textures&&(await e.childItem.ensureStorage(),e.childItem.file&&t)){let n=this.getRelativePath(e.childItem.file,t);if(n){for(let s in this._data.textures)if(this._data.textures[s]===n&&(this._data.textures[s]=void 0,i))for(let a of i)a.childItem.itemType===34&&(await xi.get(a.childItem)).removeTexture(s)}}this.persist()}getPackRootFolder(){let e;if(this.file&&this.file.parentFolder){let t=this.file.parentFolder;for(;t.name!=="entity"&&t.parentFolder;)t=t.parentFolder;t.parentFolder&&(e=t.parentFolder)}return e}getRelativePath(e,t){let i=e.getFolderRelativePath(t);if(i){let n=i?.lastIndexOf(".");n>=0&&(i=i?.substring(0,n).toLowerCase()),i=S.ensureNotStartsWithDelimiter(i)}return i}async addChildItems(e,t){let i=e.getItemsCopy(),n=this.getPackRootFolder(),s=this.texturesList,o=this.geometryList,a=this.renderControllerIdList,l=this.animationControllerIdList,u=this.animationIdList;for(let c of i)if(c.itemType===28&&u){if(await c.ensureStorage(),c.file){let h=(await ji.ensureOnFile(c.file))?.idList;if(h){for(let f of u)if(h.includes(f)){t.addChildItem(c);continue}}}}else if(c.itemType===29&&l){if(await c.ensureStorage(),c.file){let h=(await Tr.ensureOnFile(c.file))?.idList;if(h){for(let f of l)if(h.includes(f)){t.addChildItem(c);continue}}}}else if(c.itemType===34&&a){if(await c.ensureStorage(),c.file){let h=(await xr.ensureOnFile(c.file))?.idList;if(h){for(let f of a)if(h.includes(f)){t.addChildItem(c);continue}}}}else if(c.itemType===99&&n&&s){if(await c.ensureStorage(),c.file){let d=this.getRelativePath(c.file,n);d&&s&&s.includes(d)&&(t.addChildItem(c),s=B.removeItemInArray(d,s))}}else if(c.itemType===32&&o&&(await c.ensureStorage(),c.file)){let d=await Ir.ensureOnFile(c.file);if(d){let h=!1;for(let f of d.identifiers)o&&o.includes(f)&&(h=!0,o=B.removeItemInArray(f,o));h&&t.addChildItem(c)}}if(s)for(let c of s)t.addUnfulfilledRelationship(c,99,await oe.isVanillaToken(c));if(o)for(let c of o)t.addUnfulfilledRelationship(c,32,await oe.isVanillaToken(c))}};var u0=Le(Je());var Gs=class r{constructor(){this._isLoaded=!1;this._onLoaded=new u0.EventDispatcher}get isLoaded(){return this._isLoaded}get file(){return this._file}get onLoaded(){return this._onLoaded.asEvent()}set file(e){this._file=e}get id(){return this._id}set id(e){this._id=e,this.dataInner&&this.dataInner.description&&e&&(this.dataInner.description.identifier=e)}get shortId(){if(this._id!==void 0)return this._id.startsWith("minecraft:")?this._id.substring(10,this._id.length):this._id}async getFormatVersionIsCurrent(){let e=this.getFormatVersion();return e===void 0||e.length!==3?!1:await oe.isRecentVersionFromVersionArray(e)}getFormatVersion(){if(!(!this.data||!this.data.format_version))return Be.getVersionArrayFrom(this.data.format_version)}setFormatVersion(e){this._ensureDataInitialized(),this.data&&(this.data.format_version=e)}_ensureDataInitialized(){this.data===void 0&&(this.data={"minecraft:spawn_rules":{description:{identifier:this._id?this._id:""}}})}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}persist(){if(this._file===void 0)return;let e=JSON.stringify(this.data,null,2);this._file.setContent(e)}async load(){this._file===void 0||this._isLoaded||(await this._file.loadContent(),!(this._file.content===null||this._file.content instanceof Uint8Array)&&(this.data=S.getJsonObject(this._file),this.dataInner=this.data?.["minecraft:spawn_rules"],this.dataInner&&this.dataInner.description&&(this._id=this.dataInner.description.identifier),this._isLoaded=!0))}};var c0={"minecraft:body_rotation_blocked":"b","minecraft:can_climb":"b","minecraft:can_fly":"b","minecraft:can_power_jump":"b","minecraft:cannot_be_attacked":"b","minecraft:color":"s","minecraft:color2":"s","minecraft:default_look_angle":"f","minecraft:fire_immune":"b","minecraft:floats_in_liquid":"b","minecraft:flying_speed":"f","minecraft:friction_modifier":"f","minecraft:ground_offset":"f","minecraft:ignore_cannot_be_attacked":"b","minecraft:input_ground_controlled":"b","minecraft:is_baby":"b","minecraft:is_charged":"b","minecraft:is_chested":"b","minecraft:is_dyeable":"b","minecraft:is_hidden_when_invisible":"b","minecraft:is_ignited":"b","minecraft:is_illager_captain":"b","minecraft:is_pregnant":"b","minecraft:is_saddled":"b","minecraft:is_sheared":"b","minecraft:is_stackable":"b","minecraft:is_stunned":"b","minecraft:is_tamed":"b","minecraft:mark_variant":"i","minecraft:movement_sound_distance_offset":"f","minecraft:push_through":"f","minecraft:renders_when_invisible":"b","minecraft:scale":"f","minecraft:skin_id":"i","minecraft:sound_volume":"f","minecraft:type_family":"family","minecraft:variant":"i","minecraft:walk_animation_speed":"f","minecraft:wants_jockey":"b"};var Ii=class r{constructor(){this._isLoaded=!1;this._managedComponents={};this._componentGroups={};this._events={};this._onLoaded=new zl.EventDispatcher;this._onComponentAdded=new zl.EventDispatcher;this._onComponentRemoved=new zl.EventDispatcher;this._onComponentChanged=new zl.EventDispatcher}get data(){return this._data}static getFormIdFromComponentId(e){return e.replace(/:/gi,"_").replace(/\./gi,"_")}static getComponentCategory(e){return e.startsWith("minecraft:behavior")?2:e.startsWith("minecraft:on_")?3:c0[e]!==void 0?0:1}static getExtendedComponentCategory(e){return e.startsWith("minecraft:behavior.move")||e.startsWith("minecraft:behavior.jump")||e.startsWith("minecraft:behavior.go")||e.startsWith("minecraft:behavior.follow")||e.startsWith("minecraft:behavior.circle")?4:e.startsWith("minecraft:behavior.dragon")||e.startsWith("minecraft:behavior.enderman")||e.startsWith("minecraft:behavior.guardian")||e.startsWith("minecraft:behavior.ocelot")||e.startsWith("minecraft:behavior.silverfish")||e.startsWith("minecraft:behavior.skeleton")||e.startsWith("minecraft:behavior.slime")||e.startsWith("minecraft:behavior.squid")||e.startsWith("minecraft:behavior.vex")||e.startsWith("minecraft:behavior.wither")?5:e.startsWith("minecraft:behavior")?2:e.startsWith("minecraft:on_")?3:c0[e]!==void 0?0:e.indexOf("sensor")>=0?8:e.indexOf("jump")>=0||e.indexOf("climb")>=0||e.indexOf("move")>=0||e.startsWith("minecraft:navigation")||e.startsWith("minecraft:flying")||e.startsWith("minecraft:friction")||e.startsWith("minecraft:walk_animation")?6:e.indexOf("attack")>=0||e.indexOf("combat")>=0||e.indexOf("damage")>=0||e.startsWith("minecraft:health")||e.startsWith("minecraft:healable")||e.startsWith("minecraft:hurt_on")?7:1}static getComponentFromBaseFileName(e){let t=e;return t.startsWith("minecraft_")&&(t=t.substring(10),t.startsWith("behavior_")&&(t="behavior."+t.substring(9)),t.startsWith("movement_")&&(t="movement."+t.substring(9)),t.startsWith("navigation_")&&(t="navigation."+t.substring(11)),t.startsWith("player_")&&(t="player."+t.substring(8)),t.startsWith("jump_")&&(t="jump."+t.substring(5))),t}static getComponentCategoryDescription(e){switch(e){case 2:return"Behavior";case 0:return"Attribute";case 3:return"Trigger";default:return"Component"}}static getPluralComponentCategoryDescription(e){switch(e){case 2:return"Behaviors (AI)";case 0:return"Attributes";case 3:return"Triggers";default:return"Components"}}get onComponentAdded(){return this._onComponentAdded.asEvent()}get onComponentRemoved(){return this._onComponentRemoved.asEvent()}get onComponentChanged(){return this._onComponentChanged.asEvent()}get isLoaded(){return this._isLoaded}get behaviorPackFile(){return this._behaviorPackFile}get onLoaded(){return this._onLoaded.asEvent()}set behaviorPackFile(e){this._behaviorPackFile=e}get id(){return this._id}set id(e){this._id=e}get runtimeIdentifier(){if(this._data&&this._data.description)return this._data.description.runtime_identifier}set runtimeIdentifier(e){this._data&&this._data.description&&(this._data.description.runtime_identifier=e)}get aliases(){if(!(!this._data||!this._data.description))return this._data.description.aliases}get properties(){if(!(!this._data||!this._data.description))return this._data.description.properties}async getFormatVersionIsCurrent(){let e=this.getFormatVersion();return e===void 0||e.length!==3?!1:await oe.isRecentVersionFromVersionArray(e)}getFormatVersion(){if(this.behaviorPackWrapper)return Be.getVersionArrayFrom(this.behaviorPackWrapper.format_version)}removeProperty(e){this._data?.description?.properties&&(this._data.description.properties[e]=void 0)}get shortId(){if(this._id!==void 0){let e=this._id;if(e.startsWith("minecraft:"))return e.substring(10,this._id.length);let t=e.indexOf(":");return t>=0&&(e=e.substring(t+1)),e}}getComponent(e){if(!(this._data===void 0||this._data.components===void 0)){if(!this._managedComponents[e]){let t=this._data.components[e];t&&(this._managedComponents[e]=new ei(e,t))}return this._managedComponents[e]}}getComponentsInBaseAndGroups(e){if(this._data===void 0)return[];let t=[],i=this.getComponent(e);i&&t.push(i);for(let n in this._componentGroups){let s=this._componentGroups[n];s&&(i=s.getComponent(e),i&&t.push(i))}return t}getAllComponents(){if(this._data===void 0)return[];let e=this.getComponents();for(let t in this._componentGroups){let i=this._componentGroups[t];if(i)for(let n of i.getComponents())n&&e.push(n)}return e}get behaviorPackFormatVersion(){if(!(!this.behaviorPackWrapper||!this.behaviorPackWrapper.format_version))return this.behaviorPackWrapper.format_version}setBehaviorPackFormatVersion(e){this._ensureBehaviorPackDataInitialized(),this.behaviorPackWrapper&&(this.behaviorPackWrapper.format_version=e)}notifyComponentUpdated(e){let t=this.getComponent(e);t===void 0?C.unexpectedUndefined("ETNCU"):this._onComponentChanged.dispatch(this,t)}getComponents(){let e=[];if(this._data!==void 0)for(let t in this._data.components){let i=this.getComponent(t);i!==void 0&&e.push(i)}return e}getComponentGroup(e){if(this._data!==void 0){if(!this._componentGroups[e]){let t=this._data.component_groups[e],i=new _s(t,e);this._componentGroups[e]=i}return this._componentGroups[e]}}getComponentGroups(){let e=[];if(this._data!==void 0)for(let t in this._data.component_groups)if(this._componentGroups[t])e.push(this._componentGroups[t]);else{let i=this._data.component_groups[t],n=new _s(i,t);this._componentGroups[t]=n,e.push(n)}return e}getEvent(e){if(this._data!==void 0){if(!this._events[e]){let t=this._data.events[e];this._events[e]=t}return this._events[e]}}getEvents(){let e=[];if(this._data!==void 0)for(let t in this._data.events)if(this._events[t])e.push({id:t,event:this._events[t]});else{let i=this._data.events[t];this._events[t]=i,e.push({id:t,event:i})}return e}addComponent(e,t){this._ensureBehaviorPackDataInitialized();let i=new ei(e,t),n=this._data;n.components[e]=t,this._managedComponents[e]=i,this._onComponentAdded.dispatch(this,i)}removeComponent(e){if(this._data===void 0)return;let t={},i={};for(let n in this._data.components)if(n!==e){let s=this._data.components[n];t[n]=s}for(let n in this._managedComponents)n!==e&&this._managedComponents[n]&&(i[n]=this._managedComponents[n]);this._data.components=t,this._managedComponents=i}_ensureBehaviorPackDataInitialized(){this.behaviorPackWrapper||(this.behaviorPackWrapper={format_version:"1.20.0"}),this._data===void 0&&(this._data={description:{identifier:"unknown",is_experimental:!1,is_spawnable:!1,is_summonable:!1},components:{},component_groups:{},events:{}},this.behaviorPackWrapper&&(this.behaviorPackWrapper["minecraft:entity"]=this._data))}getProperties(){if(!(!this._data||!this._data?.description))return this._data.description.properties}getPropertyList(){let e=this.getProperties();if(!e)return[];let t=[];for(let i in e)e[i]!==void 0&&t.push(i);return t}addProperty(e,t){if(!this._data||!this._data.description)return;let i=[];t===1?i=[!1,!0]:t===2?i=[0,1,2]:t===0&&(i=["value1","value2"]),this._data.description.properties||(this._data.description.properties={}),this._data.description.properties[e]=i}addEvent(e){this._data&&(this._data.events||(this._data.events={}),this._data.events[e]={})}async addChildItems(e,t){let i=[],n=this.getComponentsInBaseAndGroups("minecraft:loot");for(let o of n){let a=o.getProperty("table");a&&i.push(a)}let s=e.getItemsCopy();for(let o of s)if(o.itemType===30){if(await o.ensureStorage(),o.file){let a=await Zi.ensureOnFile(o.file);a&&a.id===this.id&&t.addChildItem(o)}}else if(o.itemType===44){if(await o.ensureStorage(),o.file){let a=await Gs.ensureOnFile(o.file);a&&a.id===this.id&&t.addChildItem(o)}}else if(o.itemType===24)for(let a of i)o.projectPath?.endsWith(a)&&t.addChildItem(o)}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.behaviorPackFile=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}getScript(e){if(this.shortId===void 0)return;let t=ws.getClassName(this.shortId),i=[];return i.push("import * as mc from '@minecraft/server';"),i.push("export default class "+t+"Base"),i.push("{"),e?(i.push("  _entity : mc.Entity;"),i.push("  constructor(entity : mc.Entity) {")):(i.push(`  _entity;\r
`),i.push("  constructor(entity) {")),i.push("    this._entity = entity;"),i.push(`  }\r
\r
`),e?i.push("  static spawn(location : mc.Vector3) {"):i.push("  static spawn(location) {"),i.push('    const entity = world.getDimension("overworld").spawnEntity("'+this.id+'", location);'),i.push("    const "+ws.getInstanceName(this.shortId)+" = new "+t+"(entity);"),i.push("    return "+ws.getInstanceName(this.shortId)+";"),i.push(`  }\r
`),this._data!==void 0&&(this._data.components["minecraft:health"]!==void 0&&(i.push("  fullyHeal() {"),i.push('    this._entity.getComponent("minecraft:health").resetToMaxValue();'),i.push(`  }\r
`),e?i.push("  setHealth(newValue : number) {"):i.push("  setHealth(newValue) {"),i.push('    this._entity.getComponent("minecraft:health").setCurrent(newValue);'),i.push(`  }\r
`)),this._data.components["minecraft:rideable"]!==void 0&&(e?i.push("  addRider(newRider : mc.Entity) {"):i.push("  addRider(newRider) {"),i.push('    this._entity.getComponent("minecraft:rideable").addRider(newRider);'),i.push(`  }\r
`),e?i.push("  ejectRider(rider : mc.Entity) {"):i.push("  ejectRider(rider) {"),i.push('    this._entity.getComponent("minecraft:rideable").addRider(rider);'),i.push(`  }\r
`)),this._data.components["minecraft:tameable"]!==void 0&&(i.push("  tame() {"),i.push('    return this._entity.getComponent("minecraft:tameable").tame();'),i.push(`  }\r
`))),i.push("}"),i.join(`\r
`)}persist(){if(this._behaviorPackFile===void 0)return;let e=JSON.stringify(this.behaviorPackWrapper,null,2);this._behaviorPackFile.setContent(e)}async load(){if(this._isLoaded)return;if(this._behaviorPackFile===void 0){C.unexpectedUndefined("ETBPF");return}if(await this._behaviorPackFile.loadContent(),!this._behaviorPackFile.content||this._behaviorPackFile.content instanceof Uint8Array)return;let e={},t=S.getJsonObject(this._behaviorPackFile);t&&(e=t),this.behaviorPackWrapper=e;let i=e["minecraft:entity"];if(i&&i.description&&(this.id=i.description.identifier),this._data=i,this._data){if(this._data.components)for(let n in this._data.components){let s=this._data.components[n];s&&(this._managedComponents[n]=new ei(n,s))}if(this._data.component_groups)for(let n in this._data.component_groups){let s=this._data.component_groups[n];s&&(this._componentGroups[n]=new _s(s,n))}}this._isLoaded=!0,this._onLoaded.dispatch(this,this)}};var d0=Le(Je());var Zr=class r{constructor(){this._isLoaded=!1;this._onLoaded=new d0.EventDispatcher}get isLoaded(){return this._isLoaded}get file(){return this._file}get data(){return this._data}get onLoaded(){return this._onLoaded.asEvent()}set file(e){this._file=e}get id(){if(this._data)return this._data.identifier}get textures(){if(this._data)return this._data.textures===void 0&&(this._data.textures={}),this._data.textures}get texturesList(){if(!this._data||!this._data.textures)return;let e=[];for(let t in this._data.textures){let i=this._data.textures[t];i&&e.push(i.toLowerCase())}return e}get texturesIdList(){if(!this._data||!this._data.textures)return;let e=[];for(let t in this._data.textures)e.push(t);return e}get renderControllerIdList(){if(!(!this._data||!this._data.render_controllers))return this._data.render_controllers}get animationIdList(){if(!this._data||!this._data.animations)return;let e=[];for(let t in this._data.animations)e.push(t);return e}get animationList(){if(!this._data||!this._data.animations)return;let e=[];for(let t in this._data.animations){let i=this._data.animations[t];i&&e.push(i)}return e}get geometry(){if(this._data)return this._data.geometry}get geometryList(){if(!this._data||!this._data.geometry)return;let e=[];for(let t in this._data.geometry){let i=this._data.geometry[t];i&&e.push(i)}return e}getTextureItems(e){if(!this._data||!this._data.geometry||!e.childItems)return;let t={};for(let i in this._data.textures){let n=this._data.textures[i];if(n){n=S.canonicalizePath(n);for(let s of e.childItems)if(s.childItem.itemType===99&&s.childItem.projectPath){let o=S.canonicalizePath(s.childItem.projectPath),a=o.lastIndexOf(".");a>=0&&(o=o.substring(0,a).toLowerCase()),o.endsWith(n)&&(t[i]=s.childItem)}}}return t}getFormatVersion(){if(!this._dataWrapper)return;let e=this._dataWrapper.format_version;if(typeof e=="number")return[e];if(typeof e=="string"){let t=this._dataWrapper.format_version.split("."),i=[];for(let n=0;n<t.length;n++)try{i.push(parseInt(t[n]))}catch{}return i}}get formatVersion(){if(!(!this._dataWrapper||!this._dataWrapper.format_version))return this._dataWrapper.format_version}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}persist(){if(this._file===void 0)return;let e=JSON.stringify(this._dataWrapper,null,2);this._file.setContent(e)}async load(){if(this._isLoaded)return;if(this._file===void 0){C.unexpectedUndefined("ATTRPF");return}if(await this._file.loadContent(),!this._file.content||this._file.content instanceof Uint8Array)return;let e={},t=S.getJsonObject(this._file);t&&(e=t),this._dataWrapper=e,this._dataWrapper&&this._dataWrapper["minecraft:attachable"]&&(this._data=this._dataWrapper["minecraft:attachable"].description),this._isLoaded=!0,this._onLoaded.dispatch(this,this)}async deleteLinkToChild(e){let t=this.getPackRootFolder();this._data===void 0&&await this.load();let i=e.parentItem.childItems;if(e.childItem.itemType===99&&this._data&&this._data.textures&&(await e.childItem.ensureStorage(),e.childItem.file&&t)){let n=this.getRelativePath(e.childItem.file,t);if(n){for(let s in this._data.textures)if(this._data.textures[s]===n&&(this._data.textures[s]=void 0,i))for(let a of i)a.childItem.itemType===34&&(await xi.get(a.childItem)).removeTexture(s)}}this.persist()}getPackRootFolder(){let e;if(this.file&&this.file.parentFolder){let t=this.file.parentFolder;for(;t.name!=="attachables"&&t.parentFolder;)t=t.parentFolder;t.parentFolder&&(e=t.parentFolder)}return e}getRelativePath(e,t){let i=e.getFolderRelativePath(t);if(i){let n=i?.lastIndexOf(".");n>=0&&(i=i?.substring(0,n).toLowerCase()),i=S.ensureNotStartsWithDelimiter(i)}return i}async addChildItems(e,t){let i=e.getItemsCopy(),n=this.getPackRootFolder(),s=this.texturesList,o=this.geometryList,a=this.renderControllerIdList,l=this.animationIdList;for(let u of i)if(u.itemType===28&&l){if(await u.ensureStorage(),u.file){let d=(await ji.ensureOnFile(u.file))?.idList;if(d){for(let h of l)if(d.includes(h)){t.addChildItem(u);continue}}}}else if(u.itemType===34&&a){if(await u.ensureStorage(),u.file){let d=(await xr.ensureOnFile(u.file))?.idList;if(d){for(let h of a)if(d.includes(h)){t.addChildItem(u);continue}}}}else if(u.itemType===99&&n&&s){if(await u.ensureStorage(),u.file){let c=this.getRelativePath(u.file,n);c&&s&&s.includes(c)&&(t.addChildItem(u),s=B.removeItemInArray(c,s))}}else if(u.itemType===32&&o&&(await u.ensureStorage(),u.file)){let c=await Ir.ensureOnFile(u.file);if(c){let d=!1;for(let h of c.identifiers)o&&o.includes(h)&&(d=!0,o=B.removeItemInArray(h,o));d&&t.addChildItem(u)}}if(s)for(let u of s)t.addUnfulfilledRelationship(u,99,await oe.isVanillaToken(u));if(o)for(let u of o)t.addUnfulfilledRelationship(u,32,await oe.isVanillaToken(u))}};var f0=Le(Je());var zs=class r{constructor(){this._isLoaded=!1;this._onLoaded=new f0.EventDispatcher}get isLoaded(){return this._isLoaded}get file(){return this._file}get data(){return this._data}get onLoaded(){return this._onLoaded.asEvent()}set file(e){this._file=e}get textureData(){if(this._data)return this._data.texture_data===void 0&&(this._data.texture_data={}),this._data.texture_data}get texturePathList(){if(!this._data||!this._data.texture_data)return;let e=[];for(let t in this._data.texture_data){let i=this._data.texture_data[t];if(i&&i.textures){if(typeof i.textures=="string")e.push(i.textures.toLowerCase());else if(Array.isArray(i))for(let n of i.textures)e.push(n.toLowerCase())}}return e}get texturesIdList(){if(!this._data||!this._data.texture_data)return;let e=[];for(let t in this._data.texture_data)e.push(t);return e}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}persist(){if(this._file===void 0)return;let e=JSON.stringify(this._data,null,2);this._file.setContent(e)}getPackRootFolder(){let e;if(this.file&&this.file.parentFolder){let t=this.file.parentFolder;for(;t.name!=="textures"&&t.parentFolder;)t=t.parentFolder;t.parentFolder&&(e=t.parentFolder)}return e}getRelativePath(e,t){let i=e.getFolderRelativePath(t);if(i){let n=i?.lastIndexOf(".");n>=0&&(i=i?.substring(0,n).toLowerCase()),i=S.ensureNotStartsWithDelimiter(i)}return i}async addChildItems(e,t){let i=e.getItemsCopy(),n=this.getPackRootFolder(),s=this.texturePathList;for(let o of i)if(o.itemType===99&&n&&s&&(await o.ensureStorage(),o.file)){let a=this.getRelativePath(o.file,n);a&&s&&s.includes(a)&&(t.addChildItem(o),s=B.removeItemInArray(a,s))}if(s)for(let o of s)t.addUnfulfilledRelationship(o,99,await oe.isVanillaToken(o))}async load(){if(this._isLoaded)return;if(this._file===void 0){C.unexpectedUndefined("ITCDF");return}if(await this._file.loadContent(),!this._file.content||this._file.content instanceof Uint8Array)return;let e={},t=S.getJsonObject(this._file);t&&(e=t),this._data=e,this._isLoaded=!0,this._onLoaded.dispatch(this,this)}};var h0=Le(Je());var Kn=class r{constructor(){this._isLoaded=!1;this._onLoaded=new h0.EventDispatcher}get data(){return this._data}get isLoaded(){return this._isLoaded}get file(){return this._file}get onLoaded(){return this._onLoaded.asEvent()}set file(e){this._file=e}get id(){if(!(!this._data||!this._data.particle_effect||!this._data.particle_effect.description))return this._data.particle_effect.description.identifier}get description(){if(!(!this._data||!this._data.particle_effect||!this._data.particle_effect.description))return this._data.particle_effect.description}get texturesList(){if(!(!this.description||!this.description.basic_render_parameters||!this.description.basic_render_parameters.texture))return[this.description.basic_render_parameters.texture]}async getFormatVersionIsCurrent(){let e=this.getFormatVersion();return e===void 0||e.length!==3?!1:e[0]>1||e[1]>=10}getFormatVersion(){if(this._data)return Be.getVersionArrayFrom(this._data.format_version)}get formatVersion(){if(!(!this._data||!this._data.format_version))return this._data.format_version}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}persist(){if(this._file===void 0)return;let e=JSON.stringify(this._data,null,2);this._file.setContent(e)}async load(){if(this._isLoaded)return;if(this._file===void 0){C.unexpectedUndefined("PERPF");return}if(await this._file.loadContent(),!this._file.content||this._file.content instanceof Uint8Array)return;let e={},t=S.getJsonObject(this._file);t&&(e=t),this._data=e,this._isLoaded=!0,this._onLoaded.dispatch(this,this)}async deleteLinkToChild(e){let t=this.getPackRootFolder();if(this._data===void 0&&await this.load(),!this.description||!this.description.basic_render_parameters||!this.description.basic_render_parameters.texture)return;let i=this.description.basic_render_parameters.texture;if(e.childItem.itemType===99&&(await e.childItem.ensureStorage(),e.childItem.file&&t)){let n=this.getRelativePath(e.childItem.file,t);n&&i===n&&(this.description.basic_render_parameters.texture=void 0)}this.persist()}getPackRootFolder(){let e;if(this.file&&this.file.parentFolder){let t=this.file.parentFolder;for(;t.name!=="particles"&&t.parentFolder;)t=t.parentFolder;t.parentFolder&&(e=t.parentFolder)}return e}getRelativePath(e,t){let i=e.getFolderRelativePath(t);if(i){let n=i?.lastIndexOf(".");n>=0&&(i=i?.substring(0,n).toLowerCase()),i=S.ensureNotStartsWithDelimiter(i)}return i}async addChildItems(e,t){let i=e.getItemsCopy(),n=this.getPackRootFolder(),s=this.texturesList;for(let o of i)if(o.itemType===99&&n&&s&&(await o.ensureStorage(),o.file)){let a=this.getRelativePath(o.file,n);a&&s&&s.includes(a)&&(t.addChildItem(o),s=B.removeItemInArray(a,s))}if(s)for(let o of s)t.addUnfulfilledRelationship(o,99,await oe.isVanillaToken(o))}};var p0=Le(Je());var Vs=class r{constructor(){this._isLoaded=!1;this._onLoaded=new p0.EventDispatcher}get isLoaded(){return this._isLoaded}get data(){return this._data}get file(){return this._file}get onLoaded(){return this._onLoaded.asEvent()}set file(e){this._file=e}get textureData(){if(this._data)return this._data.texture_data===void 0&&(this._data.texture_data={}),this._data.texture_data}get texturePathList(){if(!this._data||!this._data.texture_data)return;let e=[];for(let t in this._data.texture_data){let i=this._data.texture_data[t];if(i&&i.textures){if(typeof i.textures=="string")e.push(i.textures.toLowerCase());else if(Array.isArray(i))for(let n of i.textures)typeof n=="string"?e.push(n.toLowerCase()):n.path&&e.push(n.path.toLowerCase())}}return e}get texturesIdList(){if(!this._data||!this._data.texture_data)return;let e=[];for(let t in this._data.texture_data)e.push(t);return e}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}persist(){if(this._file===void 0)return;let e=JSON.stringify(this._data,null,2);this._file.setContent(e)}getPackRootFolder(){let e;if(this.file&&this.file.parentFolder){let t=this.file.parentFolder;for(;t.name!=="textures"&&t.parentFolder;)t=t.parentFolder;t.parentFolder&&(e=t.parentFolder)}return e}getRelativePath(e,t){let i=e.getFolderRelativePath(t);if(i){let n=i?.lastIndexOf(".");n>=0&&(i=i?.substring(0,n).toLowerCase()),i=S.ensureNotStartsWithDelimiter(i)}return i}async addChildItems(e,t){let i=e.getItemsCopy(),n=this.getPackRootFolder(),s=this.texturePathList;for(let o of i)if(o.itemType===99&&n&&s&&(await o.ensureStorage(),o.file)){let a=this.getRelativePath(o.file,n);a&&s&&s.includes(a)&&(t.addChildItem(o),s=B.removeItemInArray(a,s))}if(s)for(let o of s)t.addUnfulfilledRelationship(o,99,await oe.isVanillaToken(o))}async load(){if(this._isLoaded)return;if(this._file===void 0){C.unexpectedUndefined("TTCDF");return}if(await this._file.loadContent(),!this._file.content||this._file.content instanceof Uint8Array)return;let e={},t=S.getJsonObject(this._file);t&&(e=t),this._data=e,this._isLoaded=!0,this._onLoaded.dispatch(this,this)}};var mr=class{static async calculate(e){let t=e.getItemsCopy();for(let i of t)i.childItems=void 0,i.parentItems=void 0;for(let i of t)if(i.itemType===10){if(await i.ensureStorage(),i.file){let n=await Ii.ensureOnFile(i.file);n&&await n.addChildItems(e,i)}}else if(i.itemType===30){if(await i.ensureStorage(),i.file){let n=await Zi.ensureOnFile(i.file);n&&await n.addChildItems(e,i)}}else if(i.itemType===33){if(await i.ensureStorage(),i.file){let n=await Kn.ensureOnFile(i.file);n&&await n.addChildItems(e,i)}}else if(i.itemType===47){if(await i.ensureStorage(),i.file){let n=await Zr.ensureOnFile(i.file);n&&await n.addChildItems(e,i)}}else if(i.itemType===92){if(await i.ensureStorage(),i.file){let n=await zs.ensureOnFile(i.file);n&&await n.addChildItems(e,i)}}else if(i.itemType===93){if(await i.ensureStorage(),i.file){let n=await Vs.ensureOnFile(i.file);n&&await n.addChildItems(e,i)}}else if(i.itemType===51){if(await i.ensureStorage(),i.file){let n=await Gi.ensureOnFile(i.file);n&&await n.addChildItems(e,i)}}else if(i.itemType===50){if(await i.ensureStorage(),i.file){let n=await Us.ensureOnFile(i.file);n&&await n.addChildItems(e,i)}}else if(i.itemType===27&&(await i.ensureStorage(),i.file)){let n=await Xr.ensureOnFile(i.file);n&&await n.addChildItems(e,i)}}static async deleteLinksFromParents(e){if(!(!e.parentItems||e.parentItems.length===0)){for(let t of e.parentItems)if(t.parentItem&&t.childItem){if(t.parentItem.itemType===30){if(await e.ensureStorage(),t.parentItem.file){let i=await Zi.ensureOnFile(t.parentItem.file);i&&await i.deleteLinkToChild(t)}}else if(t.parentItem.itemType===33){if(await e.ensureStorage(),t.parentItem.file){let i=await Kn.ensureOnFile(t.parentItem.file);i&&await i.deleteLinkToChild(t)}}else if(t.parentItem.itemType===47){if(await e.ensureStorage(),t.parentItem.file){let i=await Zr.ensureOnFile(t.parentItem.file);i&&await i.deleteLinkToChild(t)}}else if(t.parentItem.itemType===27&&(await e.ensureStorage(),t.parentItem.file)){let i=await Gi.ensureOnFile(t.parentItem.file);i&&await i.deleteLinkToChild(t.childItem)}}await this.calculate(e.project)}}};var Ro=class r{constructor(e,t){this._onPropertyChanged=new Vl.EventDispatcher;this._onFileRetrieved=new Vl.EventDispatcher;this._onFolderRetrieved=new Vl.EventDispatcher;this._onLoaded=new Vl.EventDispatcher;this._pendingLoadRequests=[];this._isLoading=!1;this._isFileContentProcessed=!1;this._project=e,this._file=null,this._folder=null,this._isFileContentProcessed=!1,this._handleMCWorldLoaded=this._handleMCWorldLoaded.bind(this),t?this._data=t:this._data={itemType:0,projectPath:null,storageType:0,tags:[],name:""}}get parentItemCount(){return this.parentItems===void 0?0:this.parentItems.length}get childItemCount(){return this.childItems===void 0?0:this.childItems.length}get unfulfilledRelationshipsCount(){return this.unfulfilledRelationships===void 0?0:this.unfulfilledRelationships.length}get isInWorld(){return this._data.isInWorld}set isInWorld(e){this._data.isInWorld=e}get project(){return this._project}get onPropertyChanged(){return this._onPropertyChanged.asEvent()}get onLoaded(){return this._onLoaded.asEvent()}get onFileRetrieved(){return this._onFileRetrieved.asEvent()}get onFolderRetrieved(){return this._onFolderRetrieved.asEvent()}get gitHubReference(){return this._data.gitHubReference}get isInFileContainer(){return this.projectPath?this.projectPath.indexOf("#")>=0:!1}get isFileContainerStorageItem(){return this.itemType===54||this.itemType===7||this.itemType===73||this.itemType===53||this.itemType===55||this.itemType===8}get isWorld(){return this.itemType===73||this.itemType===7||this.itemType===8||this.itemType===16}static getGitHubSignature(e){let t=e.owner+"|"+e.repoName+"|";return e.branch!==void 0&&(t+=e.branch),e.folder!==void 0&&(t+="|"+e.folder),t}getPack(){if(this._pack)return this._pack;let e;if(this._file?e=this._file.storageRelativePath:this._folder&&(e=this._folder.storageRelativePath),e!==void 0){this.project.ensurePacks();for(let t of this.project.packs)if(e.startsWith(t.folder.storageRelativePath))return this._pack=t,this._pack}}addUnfulfilledRelationship(e,t,i){let n={parentItem:this,path:e,itemType:t,isVanillaDependent:i===!0};this.unfulfilledRelationships===void 0&&(this.unfulfilledRelationships=[]),this.unfulfilledRelationships.push(n)}addChildItem(e){let t={parentItem:this,childItem:e};this.childItems===void 0&&(this.childItems=[]),e.parentItems===void 0&&(e.parentItems=[]),this.childItems.push(t),e.parentItems.push(t)}toString(){return this.itemType+": "+this.projectPath}getPackRelativePath(){let e=this.getPack();if(e){if(this._file)return this._file.getFolderRelativePath(e.folder);if(this._folder)return this._folder.getFolderRelativePath(e.folder)}}static gitHubReferencesEqual(e,t){return e===t||e===void 0&&t===void 0||e!==void 0&&t!==void 0&&e.owner===t.owner&&e.repoName===t.repoName&&e.folder===t.folder&&e.branch===t.branch}set gitHubReference(e){r.gitHubReferencesEqual(this._data.gitHubReference,e)||(this._data.gitHubReference=e,this._project.notifyProjectItemChanged(this))}get title(){return S.getContaineredFileLeafPath(this.projectPath)+" ("+Zt.getDescriptionForType(this._data.itemType).toLowerCase()+")"}get typeTitle(){return Zt.getDescriptionForType(this._data.itemType)}getFolderGroupingPath(){if(this.projectPath===void 0||this.projectPath===null)return;let e=S.getFolderPath(this.projectPath);if(e===void 0)return;let t=e.toLowerCase(),i=Zt.getFolderRootsForType(this.itemType);i.push("zip");for(let n of i){let s=t.indexOf("/"+n+"/");s>=0&&(e=e.substring(s+2+n.length),t=e.toLowerCase())}return e=e.replace(/#/gi," ").trim(),e}getSchemaPath(){switch(this._data.itemType){case 5:return"general/manifest.json";case 17:return"general/world_x_packs.json";case 18:return"general/world_x_packs.json";case 20:return"behavior/animation_controllers/animation_controller.json";case 19:return"behavior/animations/animations.json";case 21:return"behavior/blocks/blocks.json";case 23:return"behavior/items/items.json";case 24:return"behavior/loot_tables/loot_tables.json";case 38:return"behavior/blocks/blocks.json";case 39:return"behavior/dialogue/dialogue.json";case 10:return"behavior/entities/entities.json";case 26:return"resource/blocks.json";case 27:return"resource/sounds.json";case 28:return"resource/animations/actor_animation.json";case 29:return"resource/animation_controllers/animation_controller.json";case 30:return"resource/entity/entity.json";case 31:return"resource/fog/fog.json";case 32:return"resource/models/entity/model_entity.json";case 25:return"resource/biomes_client.json";case 33:return"resource/particles/particles.json";case 34:return"resource/render_controllers/render_controllers.json";case 127:return"resource/block_culling/block_culling.json";case 128:return"behavior/item_catalog/crafting_item_catalog.json";case 37:return"language/languages.json";case 41:return"behavior/features/features.json";case 40:return"behavior/feature_rules/feature_rules.json";case 42:return"behavior/functions/tick.json";case 43:return"behavior/recipes/recipes.json";case 44:return"behavior/spawn_rules/spawn_rules.json";case 45:return"behavior/trading/trading.json";case 47:return"resource/attachables/attachables.json";case 48:return"resource/items/items.json";case 49:return"resource/materials/materials.json";case 50:return"resource/sounds/music_definitions.json";case 51:return"resource/sounds/sound_definitions.json";case 52:return"resource/blocks.json";case 36:return"resource/ui/ui.json";case 81:return"behavior/functions/tick.json";case 91:return"resource/textures/flipbook_textures.json";case 92:return"resource/textures/item_texture.json";case 93:return"resource/textures/terrain_texture.json";case 94:return"resource/ui/_global_variables.json";default:return}}get errorStatus(){return this._data.errorStatus}set errorStatus(e){this._data.errorStatus=e}get source(){return this._data.source}set source(e){this._data.source=e}get errorMessage(){return this._data.errorMessage}set errorMessage(e){this._data.errorMessage=e}get projectPath(){return this._data.projectPath===void 0&&this._data.storagePath?(this._data.projectPath=this._data.storagePath,this._data.storagePath):this._data.projectPath}set projectPath(e){this._data.projectPath=e}get effectiveEditPreference(){let e=this.editPreference;return e===0?this._project.editPreference:e===2?2:0}get editPreference(){return this._data.editPreference===void 0?0:this._data.editPreference}set editPreference(e){this._data.editPreference=e}get storageType(){return this._data.storageType===void 0?0:this._data.storageType}set storageType(e){this._data.storageType=e}get creationType(){return this._data.creationType}set creationType(e){this._data.creationType=e}get itemType(){return this._data.itemType}get file(){return this._file}get folder(){return this._folder}set itemType(e){this._data.itemType=e,this._onPropertyChanged.dispatch(this,"itemType"),this._project.notifyProjectItemChanged(this)}get isLoaded(){return this.storageType===1?!this.folder||!this.folder.isLoaded?!1:this.itemType===16?!this.folder.manager||!(this.folder.manager instanceof Vt)?!1:this.folder.manager.isLoaded:!0:this.storageType===0?!this.file||!this.file.isContentLoaded?!1:this.isWorld?!this.file.manager||!(this.file.manager instanceof Vt)?!1:this.file.manager.isLoaded:this._isFileContentProcessed:(C.unexpectedContentState(),!1)}get tags(){return this._data.tags}setFile(e){e!==this._file&&(this._file=e,this._isFileContentProcessed=!1)}get needsSave(){if(this._file===null&&this.creationType===1&&this.storageType===0)return!0;if(this._file===null)return!1;let e=this._file.needsSave;if(!e&&(this.isFileContainerStorageItem&&this._file.fileContainerStorage&&this._file.fileContainerStorage instanceof yt&&(e=this._file.fileContainerStorage.isContentUpdated),!e)){let t=this.getJavaScriptLibTwin();t!==void 0&&(e=t.needsSave)}return e}updateProjectPath(){this._project&&this._project.projectFolder&&(this._file?this.projectPath=this._file.getFolderRelativePath(this._project.projectFolder):this._folder&&(this.projectPath=this._folder.getFolderRelativePath(this._project.projectFolder)))}async rename(e){await this.load(),await this._project.ensureProjectFolder(),!(this._project.projectFolder===void 0||this._project.projectFolder===null)&&(this._file!==null?(await this._file.moveTo(this._file.parentFolder.storageRelativePath+e+"."+this._file.type),this._data.name=e+"."+this._file.type,this.projectPath=this._file.getFolderRelativePath(this._project.projectFolder),this.storageType=0):this._data.name=e,this._onPropertyChanged.dispatch(this,"name"),this._project.notifyProjectItemChanged(this))}async deleteItem(){await this.load(),await mr.deleteLinksFromParents(this),this._file!==null&&await this._file.deleteThisFile(),this._project.removeItem(this)}get imageUrl(){if(this.itemType===16){if(this.folder&&this.folder.manager instanceof Vt){let e=this.folder.manager;if(e.isLoaded)return"data:image/jpg;base64, "+e.imageBase64}}else if(this.isWorld){if(this.file&&this.file.manager instanceof Vt){let e=this.file.manager;if(e.isLoaded)return"data:image/jpg;base64, "+e.imageBase64}}else if(Zt.isImageType(this.itemType)){if(this._imageUrlBase64Cache)return this._imageUrlBase64Cache;if(this._file&&this._file.content&&this._file.content instanceof Uint8Array)return this._imageUrlBase64Cache="data:image/jpg;base64, "+B.uint8ArrayToBase64(this._file.content),this._imageUrlBase64Cache}}get name(){if(this.itemType===16){if(this.folder&&this.folder.manager instanceof Vt){let e=this.folder.manager;if(e.isLoaded)return e.name}}else if((this.itemType===7||this.itemType===8)&&this.file&&this.file.manager instanceof Vt){let e=this.file.manager;if(e.isLoaded)return e.name}return this.projectPath&&(this.itemType===2||this.itemType===13||this.itemType===1||this.itemType===4)?S.getLeafName(this.projectPath):this._data.name!==void 0?this._data.name:this.projectPath?S.getLeafName(this.projectPath):"untitled"}async ensureFolderStorage(){if(this.storageType===1){if(this._folder===null&&this.projectPath!==null&&this.projectPath!==void 0&&this.projectPath.startsWith("/")&&this._project.projectFolder!==null&&this._project.projectFolder!==void 0){let e=this.projectPath.split("#");if(e.length>1){let t=this._project.projectFolder;for(let i=0;i<e.length-1;i++)if(t){let n=await t.ensureFileFromRelativePath(e[i]);if(await n.loadContent(),n.content&&n.content instanceof Uint8Array){if(!n.fileContainerStorage){let s=new yt;s.storagePath=n.storageRelativePath+"#",await s.loadFromUint8Array(n.content,n.name),n.fileContainerStorage=s}t=n.fileContainerStorage.rootFolder}else t=void 0}if(t)this._folder=await t.ensureFolderFromRelativePath(e[e.length-1]);else return null}else this._folder=await this._project.projectFolder.ensureFolderFromRelativePath(this.projectPath);if(await this._folder.load(),this._onFolderRetrieved.dispatch(this,this._folder),this.itemType===16){let t=await Vt.ensureMCWorldOnFolder(this._folder,this._project,this._handleMCWorldLoaded);t&&(this.errorMessage=t.storageErrorMessage,t.storageErrorStatus===1?this.errorStatus=1:this.errorStatus=0)}else this._fireLoadedEvent()}return this._folder}}_handleMCWorldLoaded(e,t){this._fireLoadedEvent()}_fireLoadedEvent(){this._onLoaded&&this.isLoaded&&this._onLoaded.dispatch(this,this)}async getManager(){if(await this.load(),this.storageType===0&&this._file)return this._file.manager;if(this.storageType===1&&this._folder)return this._folder.manager}async ensureStorage(){this.storageType===1?await this.ensureFolderStorage():this.storageType===0&&await this.ensureFileStorage()}async ensureFileStorage(){if(this.storageType===0&&this._file===null&&this.projectPath!==null&&this.projectPath!==void 0&&this.projectPath.startsWith("/")&&this._project.projectFolder!==null&&this._project.projectFolder!==void 0){let e=this.projectPath.split("#");if(e.length>1){let t=this._project.projectFolder;for(let i=0;i<e.length-1;i++)if(t){let n=await t.ensureFileFromRelativePath(e[i]);if(await n.loadContent(),n.content&&n.content instanceof Uint8Array){if(!n.fileContainerStorage){let s=new yt;s.storagePath=n.storageRelativePath+"#",await s.loadFromUint8Array(n.content,n.name),n.fileContainerStorage=s}t=n.fileContainerStorage.rootFolder}else t=void 0}if(t)this._file=await t.ensureFileFromRelativePath(e[e.length-1]),this._isFileContentProcessed=!1;else return C.debugAlert("Unable to parse a containerized file path of '"+this.projectPath+"'"),null}else this._file=await this._project.projectFolder.ensureFileFromRelativePath(this.projectPath),this._isFileContentProcessed=!1}if(!this._isFileContentProcessed&&this._file)if(this._data.creationType===1?await ci.updateItemAutogeneration(this,!0):await this._file.loadContent(),await ci.updateItemAutogeneratedSideFiles(this),this._isFileContentProcessed=!0,this._onFileRetrieved.dispatch(this,this._file),this.itemType===7||this.itemType===8){let e=await Vt.ensureOnFile(this._file,this._project,this._handleMCWorldLoaded);e&&(this.errorMessage=e.storageErrorMessage,e.storageErrorStatus===1?this.errorStatus=1:this.errorStatus=0)}else this.itemType===10?(await Ii.ensureOnFile(this._file),this._fireLoadedEvent()):this._fireLoadedEvent();return this._file}async getJsonObject(){let e=await this.getStringContent();if(!e)return;let t;try{e=B.fixJsonContent(e),t=JSON.parse(e)}catch(i){C.debug("Could not parse content '"+e+"': "+i,this.project.name)}return t}async getStringContent(){if(await this.load(),!!this._file&&(await this._file.loadContent(),!(this._file.content instanceof Uint8Array||this._file.content===null)))return this._file.content}async load(){if(this.isLoaded)return!0;if(this._isLoading){let e=this._pendingLoadRequests,t=(i,n)=>{e.push(i)};return await new Promise(t),!0}else{this._isLoading=!0,await this.ensureStorage(),this._isLoading=!1;let e=this._pendingLoadRequests;this._pendingLoadRequests=[];for(let t of e)t(void 0);return!0}}async prepareToSave(){if(await this.load(),await ci.updateItemAutogeneration(this),await ci.updateItemAutogeneratedSideFiles(this),!this.isInFileContainer&&this.isFileContainerStorageItem&&this.file&&this.file.fileContainerStorage&&this.file.fileContainerStorage instanceof yt){let e=this.file.fileContainerStorage;if(e.isContentUpdated&&(e.errorStatus===void 0||e.errorStatus===0)){let t=await this._project.carto.notifyOperationStarted("Zipping file '"+this.file.storageRelativePath+"'..."),i=await e.generateUint8ArrayAsync();await this._project.carto.notifyOperationEnded(t,"Done zipping file '"+this.file.storageRelativePath+"'."),this.file.setContent(i)}}}getJavaScriptLibTwin(){if(this._file&&this.itemType===13){let e=this.project.getLibScriptsFolder();if(!e)return;let t=S.canonicalizeName(S.getBaseFromName(this._file.name)+".js");return e.ensureFile(t)}}getFunctionTwin(){if(this._file&&this.itemType===12){let e=S.canonicalizeName(S.getBaseFromName(this._file.name)+".mcfunction"),t=this._file.parentFolder;return t.name==="scripts"&&t.parentFolder&&(t=t.parentFolder.ensureFolder("functions")),t.files[e]}}async saveContent(){if(this._file){await this._file.saveContent();let e=this.getJavaScriptLibTwin();e!==void 0&&e.needsSave&&await e.saveContent();let t=this.getFunctionTwin();t!==void 0&&t.needsSave&&await t.saveContent()}}hasTag(e){return this.tags.includes(e)}ensureTag(e){this.hasTag(e)||this.tags.push(e)}};var In=Le(Je());var m0=Le(Je());var Wl=class r{constructor(){this._isLoaded=!1;this.tokens={};this._onLoaded=new m0.EventDispatcher}get isLoaded(){return this._isLoaded}get file(){return this._file}set file(e){this._file=e}get onLoaded(){return this._onLoaded.asEvent()}get containerName(){return this._containerName}get language(){return this._language}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}persist(){if(this._file===void 0)return;let e=this._file.content;(e==null||e instanceof Uint8Array)&&(e="");for(let t in this.tokens){let i=this.tokens[t];if(i&&i.isModified){let n=e.indexOf(t+"=");if(n>=0){let s=e.indexOf("\r",n+t.length+1),o=e.indexOf(`
`,n+t.length+1);s>n&&s===o-1&&(o=s),o<0&&(o=e.length),e=e.substring(0,n+t.length+1)+i.value+e.substring(o)}else{let s=t.lastIndexOf("."),o=!1;if(s>=0){let a=e.lastIndexOf(`
`+t.substring(0,s+1));a>=0&&(e=e.substring(0,a+1)+t+"="+i.value+`\r
`+e.substring(a+1),o=!0)}o||(e+=`\r
`+t+"="+i.value)}i.isModified=!1}}this._file.setContent(e)}async save(){this._file!==void 0&&(this.persist(),await this._file.saveContent(!1))}async load(){if(this._file===void 0||this._isLoaded||(await this._file.loadContent(),this._file.content===null||this._file.content instanceof Uint8Array))return;let e=this._file.content;this._language=S.getBaseFromName(this._file.name);let t=this._file.parentFolder;t&&(t.name==="texts"&&t.parentFolder&&(t=t.parentFolder),t.name===""&&!t.parentFolder&&t.storage.name?this._containerName=t.storage.name:this._containerName=t.name);let i=e.split(`
`);for(let n of i){n=n.trim();let s=n.indexOf("=");if(s>0&&s<n.length-1){let o=n.substring(0,s),a=n.substring(s+1);this.tokens[o]={value:a,isModified:!1}}}this._isLoaded=!0}};var Jl=class{constructor(e){this.tokens={};this._project=e,this._isLoaded=!1}async getTokenValue(e){return this._isLoaded||await this.load(),this.getTokenValueOrDefault(e)}getExpandedValue(e){if(!this._isLoaded)return e;let t=this.getToken(e);return t?t.value+" - ("+e+")":e}getTokenValueOrDefault(e){if(!this._isLoaded)return e;let t=this.getToken(e);return t?t.value:e}getToken(e,t,i){let n=this.tokens[e];if(n){t||(t="en_US");let s=n[t];if(s){if(i)return s[i];for(let o in s)return s[o]}}}async load(e){if(this._isLoaded&&!e)return;await this._project.ensureLoadedProjectFolder(),this.tokens={};let t=this._project.getItemsCopy();for(let i of t)if(i.itemType===79&&(await i.ensureFileStorage(),i.file)){let n=await Wl.ensureOnFile(i.file);if(n&&(await n.load(),n.language&&n.containerName!==void 0))for(let s in n.tokens)this.tokens[s]===void 0&&(this.tokens[s]={}),this.tokens[s][n.language]===void 0&&(this.tokens[s][n.language]={}),this.tokens[s][n.language][n.containerName]=n.tokens[s]}this._isLoaded=!0}};var Yr={version:"0.2.9",name:"Minecraft Creator Tools",disclaimer:"Alpha software. License at https://github.com/mojang/minecraft-creator-tools.",copyright:"Copyright 2024 Mojang AB. All rights reserved.",homeUrl:"https://mctools.dev",repositoryUrl:"https://github.com/mojang/minecraft-creator-tools"};var $l=class{constructor(){this.id="PACKMETADATA";this.title="General info"}getTopicData(e){return{title:e.toString()}}summarize(e,t){}async generate(e){return[]}};var Oe=class{static getTitleFromEnum(e,t){return e[t]?B.humanifyJsName(e[t]):"General Item "+t}static async getDerivedStates(e,t){let i=await di.getIsAddon(e),n=[];if(i){let o=new Xn(e,2);await o.generateForProject();let a={projectContainerName:e.containerName,projectPath:e.projectFolder?.storageRelativePath,projectName:e.name,projectTitle:e.title,infoSetData:o.getDataObject(),suite:2};n.push(a)}if(t.info.CWave!==void 0){let o=new Xn(e,1);await o.generateForProject();let a={projectContainerName:e.containerName,projectPath:e.projectFolder?.storageRelativePath,projectName:e.name,projectTitle:e.title,infoSetData:o.getDataObject(),suite:1};n.push(a)}return n}};var Ux=new RegExp(/[a-zA-Z0-9]{2,}_[a-zA-Z0-9]{2,}:[\w]+/),g0=["abilities","actions","adventure","animals","anims","armor","assets","attachables","banners","base","blocks","book","boss","bosses","bridge","camping","cars","characters","chests","cinema","cinematics","cloud","collectables","collectibles","custom_ui","cut_scene","cutscene","deco","decor","dev","dialogue","dinos","dinosaurs","doors","dragon","dragons","dummy","effects","enemies","enemy","entities","entity","env","equipment","events","food","furniture","furnitures","fx","game_menu","gameplay","general","glow","guide","guidebook","inanimate","interface","internal","intro","item","items","launchers","machines","magic","markers","market","marketing_banners","mastermind","mechanics","menu","menus","minigames","misc","miscellaneous","mob","mobs","monsters","morphs","mutant","neutral","npc","npcs","objectives","particles","passive","passive_mobs","pets","platform","player","players","portal","portals","preset","projectile","projectiles","properties","props","recipe_models","scanner","script","security","sequences","sfx","shop","skills","sounds","static_entity","store","structure","structures","systems","tasks","teams","teleporter","tnt","tools","towers","trinkets","tutorial","ui","user_interface","util","utilities","vanilla","vanilla_mob","vehicle","vehicles","vr","weapon","weapons","wrench","opaque","map","on","item","player","map","charged","beacon","conduit","moving","banner","bed","cow","chicken","dragon","ender","enderman","fang","fireball","mob","warden","village","pattern","wandering","trial","stray","spider","slime","chest","silverfish","polar","shield","husk","blaze","axolotl"],b0=(b=>(b[b.NoLooseFileInTypeFolder=101]="NoLooseFileInTypeFolder",b[b.NoCommonNamesInCreatorFolderName=102]="NoCommonNamesInCreatorFolderName",b[b.NoLooseFileInCreatorFolder=104]="NoLooseFileInCreatorFolder",b[b.MoreThanOneFolderInCreatorFolderBesidesMaybeCommon=108]="MoreThanOneFolderInCreatorFolderBesidesMaybeCommon",b[b.NoUnsupportedFolderNameInTypeFolder=109]="NoUnsupportedFolderNameInTypeFolder",b[b.MoreThanOneFolderInTypeFolder=110]="MoreThanOneFolderInTypeFolder",b[b.NoLooseFilesInTypeFolder=111]="NoLooseFilesInTypeFolder",b[b.NoDimensionElements=131]="NoDimensionElements",b[b.NoUiElements=133]="NoUiElements",b[b.NotOneBehaviorPackManifest=160]="NotOneBehaviorPackManifest",b[b.NotOneResourcePackManifest=161]="NotOneResourcePackManifest",b[b.BehaviorPackManifestNotValid=163]="BehaviorPackManifestNotValid",b[b.ResourcePackManifestNotValid=164]="ResourcePackManifestNotValid",b[b.NotOneDependencyFromBehaviorPackToResourcePack=165]="NotOneDependencyFromBehaviorPackToResourcePack",b[b.DependencyFromBehaviorPackToResourcePackNotValid=166]="DependencyFromBehaviorPackToResourcePackNotValid",b[b.NotOneDependencyFromResourcePackToBehaviorPack=168]="NotOneDependencyFromResourcePackToBehaviorPack",b[b.DependencyFromResourcePackToBehaviorPackNotValid=169]="DependencyFromResourcePackToBehaviorPackNotValid",b))(b0||{}),zi=class r{constructor(){this.id="CADDONREQ";this.title="Cooperative Add-On Requirements"}getTopicData(e){return{title:Oe.getTitleFromEnum(b0,e)}}async generate(e,t){let i=[],n,s,o,a,l=e.getItemsCopy();for(let d of l)d.file&&(d.itemType===5?(n&&i.push(new j(1,this.id,160,"Found more than one behavior pack manifest in a cooperative add-on, which is not a best practice",d)),n=await Et.ensureOnFile(d.file),s=d,await n?.load()):d.itemType===14&&(o&&i.push(new j(1,this.id,161,"Found more than one resource pack manifest in a cooperative add-on, which is not a best practice",d)),o=await jt.ensureOnFile(d.file),a=d,await o?.load()));if((!n||!n.definition)&&i.push(new j(1,this.id,163,"Did not find a valid behavior pack manifest.",void 0)),(!o||!o.definition)&&i.push(new j(1,this.id,164,"Did not find a valid resource pack manifest.",void 0)),n&&o&&n.definition&&o.definition){let d=n.getFirstNonScriptModuleDependency();!n.definition.dependencies||n.getNonScriptModuleDependencyCount()!==1?i.push(new j(1,this.id,165,"Did not find exactly one dependency on the corresponding resource pack in the behavior pack manifest.",s,n.getNonScriptModuleDependencyCount())):(!d||!d.uuid||!B.uuidEqual(d.uuid,o.definition.header.uuid))&&i.push(new j(1,this.id,166,"Behavior pack manifest does not have a proper dependency on the resource pack identifier.",s)),!o.definition.dependencies||o.definition.dependencies.length!==1?i.push(new j(1,this.id,168,"Did not find exactly one dependency on the corresponding behavior pack in the resource pack manifest.",a)):(!o.definition.dependencies[0].uuid||!B.uuidEqual(o.definition.dependencies[0].uuid,n.definition.header.uuid))&&i.push(new j(1,this.id,169,"Resource pack manifest does not have a proper dependency on the behavior pack identifier.",s))}let u=await e.getDefaultBehaviorPackFolder();u&&await this.generateFromBehaviorPackFolder(e,u,i);let c=await e.getDefaultResourcePackFolder();return c&&await this.generateFromResourcePackFolder(e,c,i),i}summarize(e,t){}async generateFromBehaviorPackFolder(e,t,i){await t.load();for(let n in t.folders){let s=t.folders[n],o=S.canonicalizeName(n);o==="dimensions"&&i.push(new j(1,this.id,131,"Found dimensions in a cooperative add-on, which is not a best practice.",void 0)),s&&!t.errorStatus&&(o==="structures"?await this.generateFromFirstLevelFolderCreator_Game(e,s,i):o!=="texts"&&o!=="entities"&&o!=="features"&&o!=="feature_rules"&&o!=="particles"&&o!=="items"&&o!=="scripts"&&o!=="recipes"&&o!=="spawn_rules"&&o!=="animations"&&o!=="animation_controllers"&&o!=="render_controllers"&&o!=="blocks"&&await this.generateFromFirstLevelFolderCreatorNameGameName(e,s,i))}}async generateFromResourcePackFolder(e,t,i){await t.load();for(let n in t.folders){let s=t.folders[n],o=S.canonicalizeName(n);o==="ui"&&i.push(new j(1,this.id,133,"Found ui elements in a cooperative add-on, which is not supported",void 0)),s&&!t.errorStatus&&o!=="texts"&&o!=="entity"&&o!=="items"&&o!=="particles"&&o!=="materials"&&o!=="blocks"&&o!=="models"&&o!=="attachables"&&o!=="render_controllers"&&o!=="animation_controllers"&&o!=="animations"&&await this.generateFromFirstLevelFolderCreatorNameGameName(e,s,i)}}static isNameGenericTerm(e){return e=S.canonicalizeName(e),g0.includes(e)}static isNamespacedIdentifier(e){let t=e.split(":");return t.length!==2||t[0].length<2||t[1].length<2?!1:this.isNamespacedString(t[0])}static isNamespacedString(e){let t=e.split("_");return t.length<2?!1:t[0].length>=2&&t[1].length>=2}static isCommonMaterialName(e){let t=e.split("_");return t.length<3?!0:g0.includes(t[0])}static isUniqueNamespaceOrShortName(e){return e=S.canonicalizeName(e),e.length<3?!1:Ux.test(e)}async generateFromFirstLevelFolderCreator_Game(e,t,i){await t.load();for(let s in t.files)if(!this.isPerPackCatalogFile(t.name,s)){let o=t.files[s],a=o?.extendedPath?e.getItemByExtendedOrProjectPath(o?.extendedPath):void 0;i.push(new j(1,this.id,111,`Found a loose file in the ${t.name} folder. Should only see files in the folder ${t.name}\\creatorshortname_gamename\\`,a,s))}let n=0;for(let s in t.folders){let o=S.canonicalizeName(s);n++,r.isUniqueNamespaceOrShortName(o)&&i.push(new j(1,this.id,109,`Found an add-on-blocked folder '${s}' in a parent folder pack\\${t.name}. Should be named 'creatorshortname' and not a common term`,void 0,s))}n>1&&i.push(new j(1,this.id,110,`Folder '${t.name}' has more than one subfolder, which is not supported. There should only be one folder in pack\\${t.name}\\<studioname>_<mygamename>`,void 0,t.name))}isPerPackCatalogFile(e,t){let i=S.canonicalizeName(t);return!((e!=="functions"||i!=="tick.json")&&(e!=="textures"||i!=="flipbook_textures.json"&&i!=="item_textures.json"&&i!=="blocks.json"&&i!=="block.json"&&i!=="textures_list.json"&&i!=="texture_list.json"&&i!=="terrain_textures.json"&&i!=="item_texture.json"&&i!=="terrain_texture.json")&&(e!=="sounds"||i!=="sound_definitions.json"&&i!=="sounds.json"&&i!=="music_definitions.json"))}async generateFromFirstLevelFolderCreatorNameGameName(e,t,i){await t.load();for(let n in t.files)if(!this.isPerPackCatalogFile(t.name,n)){let s=t.files[n],o=s?.extendedPath?e.getItemByExtendedOrProjectPath(s?.extendedPath):void 0;i.push(new j(1,this.id,101,`Found a loose file in the ${t.name} folder. Should only see files in the folder ${t.name}\\creatorshortname\\gamename\\`,o,n))}for(let n in t.folders){let s=S.canonicalizeName(n);r.isNameGenericTerm(s)&&i.push(new j(1,this.id,102,`Found an cooperative add-on common name folder '${n}' in a parent folder pack\\${t.name}. Should be named 'creatorshortname' and not a common term`,void 0,n));let o=t.folders[n];o&&await this.generateFromSecondLevelFolderGameName(e,t.name,o,i)}}async generateFromSecondLevelFolderGameName(e,t,i,n){await i.load();for(let o in i.files){let a=i.files[o],l=a?.extendedPath?e.getItemByExtendedOrProjectPath(a.extendedPath):void 0;n.push(new j(1,this.id,104,`Found a loose file '${o}' in ${t}\\${i.name}. Files should only be in the folder ${t}\\${i.name}\\<mygamename>`,l,o))}let s=0;for(let o in i.folders)S.canonicalizeName(o)!=="common"&&s++;s>1&&n.push(new j(1,this.id,108,`Secondary folder '${i.name}' in ${t} has more than one subfolder (besides 'common'), which is not supported. There should only be one folder (plus optionally 'common') in pack\\${t}\\${i.name}\\<mygamename>`,void 0,i.name))}};var y0=(i=>(i[i.entityTypeUsesAMinecraftIdentifier=100]="entityTypeUsesAMinecraftIdentifier",i[i.entityTypeUsesAMinecraftRuntimeIdentifier=101]="entityTypeUsesAMinecraftRuntimeIdentifier",i[i.itemTypeUsesAMinecraftIdentifier=104]="itemTypeUsesAMinecraftIdentifier",i))(y0||{}),Hl=class{constructor(){this.id="STRICT";this.title="Strict Platform Info Generator"}getTopicData(e){return{title:Oe.getTitleFromEnum(y0,e)}}summarize(e,t){}async generate(e,t){let i=[],n=e.getItemsCopy();for(let s=0;s<n.length;s++){let o=n[s];if(o.itemType===10){if(await o.ensureFileStorage(),o.file){let a=await Ii.ensureOnFile(o.file);if(a&&(await a.load(),a&&a._data&&a._data.description)){let l=a._data.description;l.identifier!==void 0&&l.identifier.toLowerCase().startsWith("minecraft:")&&i.push(new j(1,this.id,100,"Uses a minecraft: identifier override",o,l.identifier)),l.runtime_identifier!==void 0&&l.runtime_identifier.toLowerCase!==void 0&&l.runtime_identifier.toLowerCase().startsWith("minecraft:")&&i.push(new j(1,this.id,101,"Uses a runtime_identifier override",o,l.runtime_identifier))}}}else if(o.itemType===23&&(await o.ensureFileStorage(),o.file)){let a=await pr.ensureOnFile(o.file);if(a&&(await a.load(),a&&a.data&&a.data.description)){let l=a.data.description;l.identifier!==void 0&&l.identifier.toLowerCase().startsWith("minecraft:")&&i.push(new j(1,this.id,104,"Uses a minecraft: identifier override",o,l.identifier))}}}return i}};var v0=Le(Je());var ql=class r{constructor(){this._isLoaded=!1;this._onLoaded=new v0.EventDispatcher}get isLoaded(){return this._isLoaded}get file(){return this._file}set file(e){this._file=e}get onLoaded(){return this._onLoaded.asEvent()}get version(){if(!(!this.definition||!this.definition.materials))return this.definition.materials.version}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}persist(){if(this._file===void 0)return;let e=JSON.stringify(this.definition,null,2);this._file.setContent(e)}async save(){this._file!==void 0&&(this.persist(),await this._file.saveContent(!1))}async load(){this._file===void 0||this._isLoaded||(await this._file.loadContent(),!(this._file.content===null||this._file.content instanceof Uint8Array)&&(this.definition=S.getJsonObject(this._file),this._isLoaded=!0))}};var w0=(b=>(b[b.BehaviorAnimationControllerIdNotInExpectedForm=100]="BehaviorAnimationControllerIdNotInExpectedForm",b[b.BehaviorAnimationControllerNameNotInExpectedForm=101]="BehaviorAnimationControllerNameNotInExpectedForm",b[b.BehaviorAnimationIdNotInExpectedForm=110]="BehaviorAnimationIdNotInExpectedForm",b[b.BehaviorAnimationNameNotInExpectedForm=111]="BehaviorAnimationNameNotInExpectedForm",b[b.JsonIdentifierNotInExpectedForm=112]="JsonIdentifierNotInExpectedForm",b[b.ResourceAnimationControllerIdNotInExpectedForm=120]="ResourceAnimationControllerIdNotInExpectedForm",b[b.ResourceAnimationControllerNameNotInExpectedForm=121]="ResourceAnimationControllerNameNotInExpectedForm",b[b.ResourceAnimationIdNotInExpectedForm=130]="ResourceAnimationIdNotInExpectedForm",b[b.ResourceAnimationNameNotInExpectedForm=131]="ResourceAnimationNameNotInExpectedForm",b[b.RenderControllerIdNotInExpectedForm=140]="RenderControllerIdNotInExpectedForm",b[b.RenderControllerNameNotInExpectedForm=141]="RenderControllerNameNotInExpectedForm",b[b.GeometryIdNotInExpectedForm=150]="GeometryIdNotInExpectedForm",b[b.GeometryNameNotInExpectedForm=151]="GeometryNameNotInExpectedForm",b[b.MaterialsIdentifierNotInExpectedForm=160]="MaterialsIdentifierNotInExpectedForm",b[b.MaterialsFirstSegmentNotInExpectedForm=161]="MaterialsFirstSegmentNotInExpectedForm",b[b.ResourcePackDoesNotHavePackScopeWorld=170]="ResourcePackDoesNotHavePackScopeWorld",b[b.NoDimensionJson=191]="NoDimensionJson",b))(w0||{}),Kl=class{constructor(){this.id="CADDONIREQ";this.title="Cooperative Add-On Item Requirements Generator"}getTopicData(e){return{title:Oe.getTitleFromEnum(w0,e)}}summarize(e,t){}async generate(e,t){let i=[];if(e.itemType===96)i.push(new j(1,this.id,191,"Dimension definition resources are not permitted in an add-on targeted behavior pack",e));else if(e.itemType===14){if(await e.ensureFileStorage(),e.file){let n=await jt.ensureOnFile(e.file);n&&(await n.load(),n.packScope||i.push(new j(1,this.id,170,"Resource pack manifest does not specify that header/pack_scope that should be 'world'",e)))}}else if(e.itemType===20){if(await e.ensureFileStorage(),e.file){let n=await gn.ensureOnFile(e.file);if(n&&n.data&&n.data.animation_controllers)for(let s in n.data.animation_controllers){let o=s.split(".");o.length<3||o[0]!=="controller"||o[1]!=="animation"?i.push(new j(1,this.id,100,"Behavior pack animation controller identifier is not in the expected form of controller.animation.xyz",e,s)):zi.isNamespacedString(o[2])||i.push(new j(1,this.id,101,"Behavior pack animation controller name section is not in the expected form of controller.animation.creatorshortname_projectshortname",e,s))}}}else if(e.itemType===19){if(await e.ensureFileStorage(),e.file){let n=await cr.ensureOnFile(e.file);if(n&&n.data&&n.data.animations)for(let s in n.data.animations){let o=s.split(".");o.length<2||o[0]!=="animation"?i.push(new j(1,this.id,110,"Behavior animation identifier is not in the expected form of animation.xyz.animation_name",e,s)):zi.isNamespacedString(o[1])||i.push(new j(1,this.id,111,"Behavior pack animation name section is not in the expected form of animation.creatorshortname_projectshortname.animation_name",e,s))}}}else if(e.itemType===29){if(await e.ensureFileStorage(),e.file){let n=await Tr.ensureOnFile(e.file);if(n&&n.data&&n.data.animation_controllers)for(let s in n.data.animation_controllers){let o=s.split(".");o.length<3||o[0]!=="controller"||o[1]!=="animation"?i.push(new j(1,this.id,120,"Resource pack animation controller identifier is not in the expected form of controller.animation.xyz",e,s)):zi.isNamespacedString(o[2])||i.push(new j(1,this.id,121,"Resource pack animation controller name section is not in the expected form of controller.animation.creatorshortname_projectshortname",e,s))}}}else if(e.itemType===28){if(await e.ensureFileStorage(),e.file){let n=await ji.ensureOnFile(e.file);if(n&&n.animations)for(let s in n.animations){let o=s.split(".");o.length<2||o[0]!=="animation"?i.push(new j(1,this.id,130,"Resource animation identifier is not in the expected form of animation.xyz.animation_name",e,s)):zi.isNamespacedString(o[1])||i.push(new j(1,this.id,131,"Resource animation name section is not in the expected form of animation.creatorshortname_projectshortname.animation_name",e,s))}}}else if(e.itemType===34){if(await e.ensureFileStorage(),e.file){let n=await xr.ensureOnFile(e.file);if(n&&n.data&&n.data.render_controllers)for(let s in n.data.render_controllers){let o=s.split(".");o.length<3||o[0]!=="controller"||o[1]!=="render"?i.push(new j(1,this.id,140,"Resource pack render controller identifier is not in the expected form of controller.render.creatorshortname_projectshortname.other",e,s)):zi.isNamespacedString(o[2])||i.push(new j(1,this.id,141,"Resource pack render controller name section is not in the expected form of controller.render.creatorshortname_projectshortname",e,s))}}}else if(e.itemType===32){if(await e.ensureFileStorage(),e.file){let n=await Ir.ensureOnFile(e.file);if(n){for(let s of n.identifiers)if(n&&s){let o=s.split(".");o.length<2||o[0]!=="geometry"?i.push(new j(1,this.id,150,"Geometry is not in the expected form of geometry.creatorshortname_projectshortname.other",e,s)):zi.isNamespacedString(o[1])||i.push(new j(1,this.id,151,"Geometry identifier section is not in the expected form of geometry.creatorshortname_projectshortname",e,s))}}}}else if(e.itemType===43||e.itemType===10||e.itemType===21||e.itemType===23){if(await e.ensureFileStorage(),e.file){let n=await xi.get(e);n&&n.id&&(zi.isNamespacedString(n.id)||i.push(new j(1,this.id,112,"JSON namespaced identifier is not in the expected form of creatorshortname_projectshortname:myitem",e,n.id)))}}else if(e.itemType===83&&(await e.ensureFileStorage(),e.file)){let n=await ql.ensureOnFile(e.file);if(n&&n.definition&&n.definition.materials)for(let s in n.definition.materials){let o=s.split(":");o.length<1?i.push(new j(1,this.id,160,"Materials section identifier is not in the expected form of creatorshortname_projectshortname:other",e,s)):o[0]!=="version"&&(!zi.isNamespacedString(o[0])||zi.isCommonMaterialName(o[0]))&&i.push(new j(1,this.id,161,"First segment of a Materials section identifier is not in the expected form of creatorshortname_projectshortname_materialname or creatorshortname_projectshortname_materialname:baseitem",e,s))}}return i}};var Xl=class{constructor(){this.id="PATHLENGTH";this.title="Path Length"}getTopicData(e){return{title:e.toString()}}summarize(e,t){}async generate(e,t,i){let n=[],s=t.storageRelativePath,o=["bp","rp","resource pack","resource packs","content/resource_packs","behavior pack","behavior packs","content/behavior_packs","skin pack","skin packs","content/skin_packs","world_template"];for(let c of o){let d=s.toLowerCase().indexOf("/"+c+"/");d>=0&&(s=s.substring(d+c.length+2))}let a=["resource_packs","behavior_packs","world_templates","skin_packs"];for(let c of a)s.toLowerCase().startsWith(c+"/")&&(s=s.substring(c.length+1));let l=s.split("/"),u=s.split("\\");return(l.length>9||u.length>9)&&n.push(new j(1,this.id,2,"File path contains 8 or more directory segments, and may not run on all devices",e.getItemByExtendedOrProjectPath(t.extendedPath),s)),s.length>80&&n.push(new j(1,this.id,3,"File path contains more than 80 characters, and may not run on all devices",e.getItemByExtendedOrProjectPath(t.extendedPath),s)),n}};var Vi=100,Zl=class{constructor(){this.id="ITEMS";this.title="Minimum Definition of a Pack"}getTopicData(e){return e>Vi&&e<Vi+Gn?{title:Zt.getDescriptionForType(e-Vi)+" count"}:{title:e.toString()}}summarize(e,t){e.behaviorPackManifestCount=t.getFirstNumberValue(this.id,Vi+5),e.unknownJsonCount=t.getFirstNumberValue(this.id,Vi+6),e.entityTypeManifestCount=t.getFirstNumberValue(this.id,Vi+10),e.itemTypeManifestCount=t.getFirstNumberValue(this.id,Vi+23),e.blockTypeManifestCount=t.getFirstNumberValue(this.id,Vi+21),e.resourcePackManifestCount=t.getFirstNumberValue(this.id,Vi+14),e.worldCount=t.getFirstNumberValue(this.id,Vi+7)+t.getFirstNumberValue(this.id,Vi+16),e.entityTypeResourceCount=t.getFirstNumberValue(this.id,Vi+30),e.behaviorPackAnimationCount=t.getFirstNumberValue(this.id,Vi+19),e.behaviorPackAnimationControllerCount=t.getFirstNumberValue(this.id,Vi+20)}async generate(e,t){let i=[],n=[];for(let o=0;o<Gn;o++)n[o]=0;let s=e.getItemsCopy();for(let o=0;o<s.length;o++){let a=s[o];n[a.itemType]++,a.itemType===5?i.push(new j(2,this.id,2,"Behavior pack manifest found",a)):a.itemType===14&&i.push(new j(2,this.id,3,"Resource pack manifest found",a))}for(let o=0;o<Gn;o++)n[o]>0&&i.push(new j(2,this.id,Vi+o,Zt.getDescriptionForType(o)+" item count",void 0,n[o]));return i}};var _0=40,Ti=(_=>(_[_.behaviorPackMinEngineVersion=1]="behaviorPackMinEngineVersion",_[_.behaviorPackUuid=2]="behaviorPackUuid",_[_.behaviorPackManfiest=3]="behaviorPackManfiest",_[_.behaviorPackName=4]="behaviorPackName",_[_.behaviorPackDescription=5]="behaviorPackDescription",_[_.behaviorPackId=6]="behaviorPackId",_[_.resourcePackMinEngineVersion=11]="resourcePackMinEngineVersion",_[_.resourcePackUuid=12]="resourcePackUuid",_[_.resourcePackManifest=13]="resourcePackManifest",_[_.resourcePackName=14]="resourcePackName",_[_.resourcePackDescription=15]="resourcePackDescription",_[_.resourcePackId=16]="resourcePackId",_[_.resourcePackFormatVersion=17]="resourcePackFormatVersion",_[_.subPacks=18]="subPacks",_[_.resourcePackIcon=21]="resourcePackIcon",_[_.behaviorPackIcon=22]="behaviorPackIcon",_[_.skinPackIcon=23]="skinPackIcon",_[_.subpackTier1Count=41]="subpackTier1Count",_[_.subpackTier40Count=80]="subpackTier40Count",_[_.subpackTiers=145]="subpackTiers",_))(Ti||{}),Yl=class{constructor(){this.id="PACK";this.title="General info"}getTopicData(e){return{title:e.toString()}}summarize(e,t){e.defaultBehaviorPackUuid=t.getFirstStringValue(this.id,2),e.defaultIcon=t.getFirstStringValue(this.id,21),e.defaultIcon===void 0&&(e.defaultIcon=t.getFirstStringValue(this.id,22)),t.removeItems(this.id,[21,22]),e.defaultBehaviorPackMinEngineVersion=t.getFirstNumberArrayValue(this.id,1),e.defaultBehaviorPackName=t.getFirstNumberArrayValue(this.id,4),e.defaultBehaviorPackDescription=t.getFirstNumberArrayValue(this.id,5),e.defaultResourcePackUuid=t.getFirstStringValue(this.id,12),e.defaultResourcePackMinEngineVersion=t.getFirstNumberArrayValue(this.id,11),e.defaultResourcePackName=t.getFirstNumberArrayValue(this.id,14),e.defaultResourcePackDescription=t.getFirstNumberArrayValue(this.id,15),e.subpackCount=t.getFirstNumberValue(this.id,18);for(let i=1;i<41;i++)e["subpackTier"+i+"Count"]=t.getCount(this.id,_0+i)}async generate(e,t){let i=new j(7,this.id,145,"Entity Geometry"),n=[i],s=e.getItemsCopy();for(let o=0;o<s.length;o++){let a=s[o];if(a.itemType===103){if(a.file&&S.getBaseFromName(a.file.name)==="pack_icon"&&S.getTypeFromName(a.file.name)==="png"&&(await a.file.loadContent(!1),a.file.content&&typeof a.file.content!="string")){let l=21;Be.pathLooksLikeBehaviorPackName(a.file.storageRelativePath)?l=22:Be.pathLooksLikeSkinPackName(a.file.storageRelativePath)&&(l=23),n.push(new j(2,this.id,l,Oe.getTitleFromEnum(Ti,l),a,B.uint8ArrayToBase64(a.file.content)))}}else if(a.itemType===5){let l=await a.getJsonObject();l&&(n.push(new j(2,this.id,3,Oe.getTitleFromEnum(Ti,3),a,l)),l.format_version&&n.push(new j(2,this.id,1,Oe.getTitleFromEnum(Ti,1),a,l.format_version)),l.header&&(l.header.uuid&&n.push(new j(2,this.id,2,Oe.getTitleFromEnum(Ti,2),a,l.header.uuid)),l.header.uuid&&l.header.version&&l.header.version.length===3&&n.push(new j(2,this.id,6,Oe.getTitleFromEnum(Ti,6),a,l.header.uuid+"|"+l.header.version[0]+"."+l.header.version[1]+"."+l.header.version[2])),l.header.name&&n.push(new j(2,this.id,4,Oe.getTitleFromEnum(Ti,4),a,e.loc.getExpandedValue(l.header.name))),l.header.description&&n.push(new j(2,this.id,5,Oe.getTitleFromEnum(Ti,5),a,e.loc.getExpandedValue(l.header.description))),l.header.min_engine_version&&n.push(new j(2,this.id,1,Oe.getTitleFromEnum(Ti,1),a,l.header.min_engine_version))))}else if(a.itemType===14){let l=await a.getJsonObject();if(l){if(n.push(new j(2,this.id,13,Oe.getTitleFromEnum(Ti,13),a,l)),l.subpacks&&Array.isArray(l.subpacks)){n.push(new j(2,this.id,18,"Subpacks",a,l.subpacks.length));for(let u of l.subpacks)u.memory_tier&&(i.spectrumIntFeature("Memory Tier",u.memory_tier),n.push(new j(2,this.id,_0+u.memory_tier,"Subpack Memory Tier "+u.memory_tier,a,u.name)))}l.format_version&&n.push(new j(2,this.id,17,Oe.getTitleFromEnum(Ti,17),a,l.format_version)),l.header&&(l.header.uuid&&n.push(new j(2,this.id,12,Oe.getTitleFromEnum(Ti,12),a,l.header.uuid)),l.header.uuid&&l.header.version&&l.header.version.length===3&&n.push(new j(2,this.id,16,Oe.getTitleFromEnum(Ti,16),a,l.header.uuid+"|"+l.header.version[0]+"."+l.header.version[1]+"."+l.header.version[2])),l.header.name&&n.push(new j(2,this.id,14,Oe.getTitleFromEnum(Ti,14),a,e.loc.getExpandedValue(l.header.name))),l.header.description&&n.push(new j(2,this.id,15,Oe.getTitleFromEnum(Ti,15),a,e.loc.getExpandedValue(l.header.description))),l.header.min_engine_version&&n.push(new j(2,this.id,11,Oe.getTitleFromEnum(Ti,11),a,l.header.min_engine_version)))}}}return n}};var gp=100,Ql=class{constructor(){this.id="LINESIZE";this.title="File Line/Size Information"}getTopicData(e){return e>=gp?{title:Zt.getDescriptionForType(e-gp)}:{title:e.toString()}}summarize(e,t){}async generate(e,t){let i=[],n={},s=[];for(let a=0;a<Gn;a++)s[a]=0;let o=e.getItemsCopy();for(let a=0;a<o.length;a++){let l=o[a],u;if(n[l.itemType]!==void 0)u=n[l.itemType];else{let c=Zt.getDescriptionForType(l.itemType)+" file "+(Zt.isBinaryType(l.itemType)?"size":"lines");u=new j(7,this.id,gp+l.itemType,c,l),n[l.itemType]=u,i.push(u)}if(l.storageType===0){let c=await l.ensureFileStorage();if(c){await c.loadContent(),u.spectrumIntFeature("Size",c.coreContentLength);let d=c.content;d&&typeof d=="string"&&u.spectrumIntFeature("Lines",B.countSignificantLines(d))}}}return i}};var tk=Le(ek());var cR=100,dR=1100;var Iu=class{constructor(){this.id="JSON";this.title="JSON Schema Validation";this._validatorsByPath={};this._schemaContentByPath={};this.uuidRegex=new RegExp("[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}");this.loadSchema=this.loadSchema.bind(this),this.testUuid=this.testUuid.bind(this),this.testUri=this.testUri.bind(this)}getTopicData(e){return{title:e.toString()}}summarize(e,t){}async loadSchema(e){console.log("Retrieving "+e);let t=await zt.get(Ne.contentRoot+e);return console.log("Loading error: "+JSON.stringify(t.data)),t.data}async generate(e,t){let i=[];if(e.file&&e.file.content&&typeof e.file.content=="string"){let n=e.getSchemaPath();if(n){let s=this._validatorsByPath[n];if(await xi.formatVersionIsCurrent(e)){if(!s){let a=await oe.getSchema(n);if(a){let l=new tk.default({allErrors:!0,loadSchema:this.loadSchema,strict:!1,unicodeRegExp:!1,verbose:!0});l.addFormat("uuid",this.testUuid),l.addFormat("uri",this.testUri),l.addFormat("color-hex",this.testUnknownFormat),l.addFormat("colox-hex",this.testUnknownFormat),l.addFormat("molang",this.testUnknownFormat),s=l.compile(a),this._validatorsByPath[n]=s,this._schemaContentByPath[n]=a}}if(s){let a=e.file.content,l;a=B.fixJsonContent(a);try{l=JSON.parse(a)}catch(u){let c=u;u.message&&(c=u.message),i.push(new j(3,this.id,1,"Could not parse JSON - "+c,e))}if(l&&!s(l)&&s.errors)for(let c=0;c<s.errors.length;c++){let d=s.errors[c];this.addError(i,e,d)}}}else{let a="",l=await xi.getFormatVersion(e);l&&(a=" (is at "+l.join(".")+")"),i.push(new j(2,this.id,dR+e.itemType,Zt.getDescriptionForType(e.itemType)+" is not at a current format version"+a,e))}}}return i}addError(e,t,i){var n="";switch(i.keyword){case"required":n='Property "'+i.params.missingProperty+'" missing';break;case"type":n="Wrong type: "+i.instancePath+" "+i.keyword+" "+i.message;break;default:n=i.keyword+" "+i.instancePath+" "+i.message;break}let s;if(typeof i.data=="string")s=i.data;else if(typeof i.data=="object"){let a;try{a=JSON.stringify(i.data,null,2)}catch{}s=a}s&&s.length>100&&(s=s.substring(0,99));let o;if(i.params)for(let a in i.params){let l=i.params[a];typeof l=="string"&&a!=="type"&&a!=="pattern"&&a!=="missingProperty"&&a!=="comparison"&&a!=="failingKeyword"&&(l.length>80&&l.indexOf(" ")<0&&(l=l.replace(/,/gi,", ")),o===void 0?o="":o+=" ",o.length<100&&l.length<100&&a.length<100&&(o+="("+a+": "+l+")"))}e.push(new j(4,this.id,cR+t.itemType,n,t,o,void 0,s))}testUuid(e){return this.uuidRegex.test(e)}testUnknownFormat(e){return!0}testUri(e){return e.indexOf("://")>=0}};var ik=(e=>(e[e.unknownItemTypeFound=0]="unknownItemTypeFound",e))(ik||{}),xu=class{constructor(){this.id="UNKJSON";this.title="Unknown JSON"}getTopicData(e){return{title:Oe.getTitleFromEnum(ik,e)}}summarize(e,t){}async generate(e,t){let i=[];return e.itemType===6&&i.push(new j(1,this.id,0,"Unknown JSON file found",e)),i}};var Tu=class{constructor(){this.id="UNKFILE";this.title="Unknown files"}getTopicData(e){return{title:e.toString()}}summarize(e,t){}async generate(e,t,i){let n=[];if(!S.isUsableFile(t.storageRelativePath)){let s=S.getTypeFromName(t.name);n.push(new j(1,this.id,2,`Unknown type ${s} file found`,e.getItemByExtendedOrProjectPath(t.extendedPath),t.extendedPath))}return n}};var qo=(s=>(s[s.betaApisExperiment=101]="betaApisExperiment",s[s.dataDrivenItemsExperiment=102]="dataDrivenItemsExperiment",s[s.deferredTechnicalPreviewExperiment=103]="deferredTechnicalPreviewExperiment",s[s.worldName=108]="worldName",s[s.worldDescription=109]="worldDescription",s))(qo||{}),Du=class{constructor(){this.id="WORLD";this.title="World Validation"}getTopicData(e){return{title:e.toString()}}summarize(e,t){e.baseGameVersion=t.getFirstStringValue(this.id,107)}async generate(e){let t=[];if(e.itemType===7||e.itemType===8||e.itemType===16){let i=await Vt.ensureOnItem(e);if(!i)return C.debugAlert("Could not find respective world."),t;if(await i.load(!1),t.push(new j(2,this.id,101,Oe.getTitleFromEnum(qo,101),e,i.betaApisExperiment,i.name)),t.push(new j(2,this.id,102,Oe.getTitleFromEnum(qo,102),e,i.dataDrivenItemsExperiment,i.name)),t.push(new j(2,this.id,103,Oe.getTitleFromEnum(qo,103),e,i.deferredTechnicalPreviewExperiment,i.name)),i.manifest&&i.manifest.header&&i.manifest.header.base_game_version){let n=i.manifest.header.base_game_version;n.join&&(n=n.join(".")),n=n.toString(),t.push(new j(2,this.id,107,"Base game version",e,n,i.name)),t.push(new j(2,"WORLD",108,Oe.getTitleFromEnum(qo,108),e,i.manifest.header.name,i.name)),t.push(new j(2,"WORLD",109,Oe.getTitleFromEnum(qo,109),e,i.manifest.header.description,i.name))}}return t}};var rk=["render_method","min_difficulty","cause","effect_name","entity_type","event_name"],nk=["max_stack_size"],sk=["fire_immune","burns_in_daylight","hand_equipped","stacked_by_data"],eg=["minecraft:behavior.follow_mob","minecraft:behavior.float_wander","minecraft:behavior.tempt"],ok=(l=>(l[l.entityType=1]="entityType",l[l.blockType=2]="blockType",l[l.itemType=3]="itemType",l[l.terrainTexture=4]="terrainTexture",l[l.itemTexture=5]="itemTexture",l[l.soundDefinition=6]="soundDefinition",l[l.musicDefinition=7]="musicDefinition",l[l.sound=8]="sound",l))(ok||{}),Au=class{constructor(){this.id="JSONTAGS";this.title="JSON Tags"}getTopicData(e){return{title:Oe.getTitleFromEnum(ok,e)}}async generate(e,t){let i=[];return e.projectFolder&&await this.generateFromFolder(e,e.projectFolder,i,t),i}summarize(e,t){}async generateFromFolder(e,t,i,n){await t.load();for(let s in t.files){let o=S.getTypeFromName(s),a=t.files[s];if(o==="json"&&a)await this.generateFromFile(e,a,i,n);else if(S.isContainerFile(s)&&a&&(await a.loadContent(),a.content&&a.content instanceof Uint8Array)){if(!a.fileContainerStorage){let l=new yt;l.storagePath=a.storageRelativePath+"#",await l.loadFromUint8Array(a.content,a.name),a.fileContainerStorage=l}a.fileContainerStorage&&await this.generateFromFolder(e,a.fileContainerStorage.rootFolder,i,n)}}for(let s in t.folders){let o=t.folders[s];o&&!t.errorStatus&&await this.generateFromFolder(e,o,i,n)}}async generateFromFile(e,t,i,n){let s=t.storageRelativePath.toLowerCase();if(s.indexOf("/entities/")>=0&&!s.endsWith(".entity.json")){let o=new j(2,this.id,1,"Entity file",e.getItemByProjectPath(t.storageRelativePath),t.storageRelativePath);await t.loadContent(!1);let a=S.getJsonObject(t);if(a!==void 0){let l=a["minecraft:entity"];if(l){this.addSubTags(o,"Default Components",n,"c",l.components);let u=l.component_groups;if(u)for(let d in u)this.addSubTags(o,"Components Used in Component Groups",n,"g",u[d]);let c=l.events;if(c)for(let d in c)this.addSubTags(o,"Entity Events",n,"v",c[d])}}i.push(o)}if(s.indexOf("/items/")>=0){let o=new j(2,this.id,3,"Item file",e.getItemByProjectPath(t.storageRelativePath),t.storageRelativePath);await t.loadContent(!1);let a=S.getJsonObject(t);if(a!==void 0){let l=a["minecraft:item"];l&&this.addSubTags(o,"Components",n,"j",l.components)}i.push(o)}if(s.indexOf("/blocks/")>=0){let o=new j(2,this.id,2,"Block file",e.getItemByProjectPath(t.storageRelativePath),t.storageRelativePath);await t.loadContent(!1);let a=S.getJsonObject(t);if(a){let l=a["minecraft:block"];if(l){this.addSubTags(o,"Block Default Components",n,"d",l.components);let u=l.description;if(u){let d=u.states;if(d){let h=0;for(let f in d){let m=d[f];m&&m.length&&(h===0?h=m.length:h*=m.length,o.maxFeature("Permutation","Values per property",m.length))}o.maxFeature("Permutation","Values per type",h),o.incrementFeature("Permutation","Values",h)}}let c=l.permutations;if(c)for(let d of c){let h=d.components;h&&this.addSubTags(o,"Block Permutation Components",n,"p",h)}}}i.push(o)}if(s.indexOf("/textures/terrain_texture.json")>=0){let o=new j(2,this.id,4,"Terrrain texture file",e.getItemByProjectPath(t.storageRelativePath),t.storageRelativePath);await t.loadContent(!1);let a=S.getJsonObject(t);a&&this.addSubTags(o,"Terrain Texture Elements",n,"T",a),i.push(o)}else if(s.indexOf("/textures/item_texture.json")>=0){let o=new j(2,this.id,5,"Item texture file",e.getItemByProjectPath(t.storageRelativePath),t.storageRelativePath);await t.loadContent(!1);let a=S.getJsonObject(t);a&&this.addSubTags(o,"Item Texture Elements",n,"J",a),i.push(o)}else if(s.indexOf("/sounds/sound_definitions.json")>=0){let o=new j(2,this.id,6,"Sound definitions file",e.getItemByProjectPath(t.storageRelativePath),t.storageRelativePath);await t.loadContent(!1);let a=S.getJsonObject(t);if(a){let l=a.sound_definitions;l&&this.addSubTags(o,"Sound definition elements",n,"U",l)}i.push(o)}else if(s.indexOf("/sounds/music_definitions.json")>=0){let o=new j(2,this.id,7,"Music definitions file",e.getItemByProjectPath(t.storageRelativePath),t.storageRelativePath);await t.loadContent(!1);let a=S.getJsonObject(t);a&&this.addSubTags(o,"Music definition elements",n,"M",a),i.push(o)}else if(s.indexOf("/sounds.json")>=0){let o=new j(2,this.id,8,"Sounds file",e.getItemByProjectPath(t.storageRelativePath),t.storageRelativePath);await t.loadContent(!1);let a=S.getJsonObject(t);if(a){let l=a.block_sounds;l&&this.addSubTags(o,"Block sounds",n,"L",l);let u=a.entity_sounds;u&&this.addSubTags(o,"Entity sounds",n,"N",u);let c=a.individual_event_sounds;c&&this.addSubTags(o,"Individual sounds",n,"V",c);let d=a.interactive_sounds;d&&this.addSubTags(o,"Interactive sounds",n,"R",d)}i.push(o)}}addSubTags(e,t,i,n,s){if(s){for(let o in s)if(o){let a=o.indexOf(":"),l=s[o];if(a<=0||o.substring(0,a)==="minecraft"){e.incrementFeature(t,o);let u=o;if(a>1&&a<o.length-2&&(u=o.substring(a+1)),e.projectItem&&e.projectItem.projectPath){let c=e.projectItem.getPackRelativePath();c&&(c=S.getBaseFromName(S.ensureNotStartsWithDelimiter(c)),i.insert(u,c,n)),i.insert(u,e.projectItem.projectPath,n),typeof l=="number"?nk.includes(u)&&i.insert(u+"=="+Math.round(l),e.projectItem.projectPath,n):typeof l=="boolean"?sk.includes(u)&&i.insert(u+"=="+(l?"t":"f"),e.projectItem.projectPath,n):Array.isArray(l)?this.addSubTagsForArray(e,u,i,n,l):typeof l=="string"&&l.length>0?rk.includes(u)&&(i.insert(u+"=="+l,e.projectItem.projectPath,n),i.insert(l,e.projectItem.projectPath,n)):l&&l.constructor!==Array&&this.addDescendentSubTags(e,u,i,n,l,o)}}}}}addSubTagsForArray(e,t,i,n,s){if(s)for(let o of s)typeof o=="string"&&o.length>0?e&&e.projectItem&&e.projectItem.projectPath&&(i.insert(t+"."+o,e.projectItem.projectPath,n),i.insert(o,e.projectItem.projectPath,n)):o&&typeof o!="number"&&typeof o!="boolean"&&o.constructor!==Array&&this.addDescendentSubTags(e,t,i,n,o)}addDescendentSubTags(e,t,i,n,s,o){if(s){for(let a in s)if(a){let l=s[a];if(e.projectItem&&e.projectItem.projectPath){a==="test"&&o==="filters"&&typeof l=="string"&&i.insert(l,e.projectItem?.projectPath,"f"),i.insert(t+"."+a,e.projectItem?.projectPath,n);let u=a,c=a.indexOf(":");(c<=0||a.substring(0,c)==="minecraft")&&(c>1&&c<a.length-2&&(u=a.substring(c+1)),typeof l=="number"?(nk.includes(u)||o&&eg.includes(o))&&i.insert(t+"."+u+"=="+Math.round(l),e.projectItem.projectPath,n):typeof l=="boolean"?(sk.includes(u)||o&&eg.includes(o))&&i.insert(t+"."+u+"=="+(l?"t":"f"),e.projectItem.projectPath,n):typeof l=="string"?(rk.includes(u)||o&&eg.includes(o))&&i.insert(t+"."+u+"=="+l,e.projectItem.projectPath,n):Array.isArray(l)?this.addSubTagsForArray(e,t+"."+u,i,n,l):l&&l.constructor!==Array&&this.addDescendentSubTags(e,t+"."+u,i,n,l,a))}}}}};var ns=class r{constructor(e,t){this.name=e,this.commandArguments=t}static parse(e){let t;e=e.trim(),e.startsWith("/")&&(e=e.substring(1,e.length));let i=e.indexOf(" "),n=[];if(i<0)t=e.toLowerCase();else{t=e.substring(0,i).toLowerCase();let s=e.substring(i+1),o=s.indexOf(" "),a=s.indexOf('"'),l=s.indexOf("'"),u=0;for(;o>=0&&u<s.length;){let c=!1;if(a>=0&&a<o&&(l<0||l>a)){let d=s.indexOf('"',a+1);d>a&&(n.push(s.substring(u+1,d)),u=d+1,u<s.length&&(o=s.indexOf(" ",u),a=s.indexOf('"',u),l=s.indexOf("'",u)),c=!0)}else if(l>=0&&l<o){let d=s.indexOf("'",l+1);d>l&&(n.push(s.substring(u+1,d)),u=d+1,u<s.length&&(o=s.indexOf(" ",u),a=s.indexOf('"',u),l=s.indexOf("'",u)),c=!0)}c||(n.push(s.substring(u,o)),u=o+1,u<s.length&&(o=s.indexOf(" ",u),a=s.indexOf('"',u),l=s.indexOf("'",u)))}n.push(s.substring(u))}if(t.indexOf("#")>=0){let s=[];s.push(t);for(let o=0;o<n.length;o++)s.push(n[o]);n=s,t="#"}return new r(t,n)}};var pR=["allowlist","alwaysday","camera","camerashake","changesetting","clear","clearspawnpoint","clone","connect","damage","daylock","deop","dialogue","difficulty","effect","enchant","event","execute","fill","fog","function","gamemode","gamerule","gametest","give","help","inputpermission","kick","kill","list","locate","loot","me","msg","mobevent","music","op","ops","particle","permission","playanimation","playsound","project","recipe","reload","reloadconfig","replaceitem","ride","save","say","schedule","scoreboard","script","scriptevent","setblock","setmaxplayers","setworldspawn","simulationtype","spawnpoint","spreadplayers","stop","stopsound","structure","summon","tag","teleport","tell","tellraw","testfor","testforblock","testforblocks","tickingarea","tp","time","title","titleraw","toggledownfall","transfer","volumearea","weather","wsserver","whitelist","?","w","xp"],mR=["allowlist","alwaysday","changesetting","connect","daylock","deop","difficulty","gamemode","gamerule","gametest","help","kick","list","locate","op","ops","permission","project","reload","reloadconfig","save","script","setmaxplayers","setworldspawn","simulationtype","stop","tickingarea","time","transfer","wsserver","whitelist","?"],wi=class r{constructor(){this._commandsByName={};this._commandsByScope={}}static get main(){return this._registry||(this._registry=new r,this._registry.registerCommand("sleep",1,async(e,t,i)=>{if(i.length===1){let n=0;try{n=parseInt(i[0])}catch{}n>0&&(e.carto.notifyStatusUpdate("(Delaying commands for "+n+"ms)."),await B.sleep(n))}return{status:100}})),this._registry}registerCommand(e,t,i){e=e.toLowerCase(),this._commandsByName[e]=i,this._commandsByScope[e]=t}logHelp(){let e=[];for(let t in this._commandsByName)e.push(t);e=e.sort(),C.message("Use help <command name> for more detailed help on a command.");for(let t=0;t<e.length;t++)C.message(e[t])}static isMinecraftBuiltInCommand(e){return pR.includes(e)||e==="#"}static isAddOnBlockedCommand(e){return mR.includes(e)}async runCommand(e,t){let i=ns.parse(t);if(!i||!i.name||!i.commandArguments)return;let n=this._commandsByScope[i.name],s=this._commandsByName[i.name];if(i.name==="help")return this.logHelp(),{status:100};if(r.isMinecraftBuiltInCommand(i.name)&&e.minecraft)return C.debug("Sending '"+t+"' to Minecraft."),{data:await e.minecraft.runCommand(t),status:100};if(n&&s){if((n===10||n===11||n===12)&&!B.isDebug)return;if((n===2||n===11)&&!e.project){C.message("Could not run command '"+i.name+"'; no active project.");return}if((n===3||n===12)&&!e.minecraft){C.message("Could not run command '"+i.name+"'; no active Minecraft deploy target was set.");return}if((n===5||n===14)&&!e.host){C.message("Could not run command '"+i.name+"'; no host was set.");return}let o=await s(e,i.name,i.commandArguments);return o.status===2?C.error("'"+i.name+"' was not set up properly."):o.status===1&&C.error("'"+i.name+"' command arguments were not set up."),o}e.carto.notifyStatusUpdate("Could not find a command '"+i.name+"'.")}};var ak=Le(Je());var Ru=class r{constructor(){this._isLoaded=!1;this._onLoaded=new ak.EventDispatcher}get isLoaded(){return this._isLoaded}get file(){return this._file}set file(e){this._file=e}get onLoaded(){return this._onLoaded.asEvent()}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}getAllButtons(){let e=[];if(this.definition&&this.definition["minecraft:npc_dialogue"]){for(let t of this.definition["minecraft:npc_dialogue"].scenes)if(t&&t.buttons)for(let i of t.buttons)e.push(i)}return e}persist(){if(this._file===void 0)return;let e=JSON.stringify(this.definition,null,2);this._file.setContent(e)}ensureDefinition(e,t){this.definition||(this.definition={format_version:"1.12.0","minecraft:npc_dialogue":{scenes:[]}})}async save(){this._file!==void 0&&(this.persist(),await this._file.saveContent(!1))}async load(){this._file===void 0||this._isLoaded||(await this._file.loadContent(),!(this._file.content===null||this._file.content instanceof Uint8Array)&&(this.definition=S.getJsonObject(this._file),this._isLoaded=!0))}};var ir=(b=>(b[b.blocks=1]="blocks",b[b.blockData=2]="blockData",b[b.command=3]="command",b[b.executeSubCommand=4]="executeSubCommand",b[b.levelDat=5]="levelDat",b[b.levelDatExperiments=6]="levelDatExperiments",b[b.subchunklessChunks=7]="subchunklessChunks",b[b.chunks=8]="chunks",b[b.unexpectedCommandInMCFunction=101]="unexpectedCommandInMCFunction",b[b.minX=103]="minX",b[b.minZ=104]="minZ",b[b.maxX=105]="maxX",b[b.maxZ=106]="maxZ",b[b.unexpectedCommandInCommandBlock=102]="unexpectedCommandInCommandBlock",b[b.containsWorldImpactingCommand=112]="containsWorldImpactingCommand",b[b.commandIsFromOlderMinecraftVersion=212]="commandIsFromOlderMinecraftVersion",b[b.errorProcessingWorld=400]="errorProcessingWorld",b))(ir||{}),Bu=class{constructor(){this.id="WORLDDATA";this.title="World Data Validation";this.modernCommandVersion=33;this.performAddOnValidations=!1;this.performPlatformVersionValidations=!1}getTopicData(e){return{title:Oe.getTitleFromEnum(ir,e)}}summarize(e,t){e.chunkCount=t.getSummedNumberValue("WORLDDATA",101),e.subchunkLessChunkCount=t.getSummedNumberValue("WORLDDATA",7),e.worldLoadErrors=t.getCount("WORLDDATA",400)}processListOfCommands(e,t,i,n,s,o){for(let a=0;a<e.length;a++)if(e[a].trim().length>2&&(!o||e[a].startsWith("/"))){let l=ns.parse(e[a]);if(wi.isMinecraftBuiltInCommand(l.name)){if(this.performAddOnValidations&&wi.isAddOnBlockedCommand(l.name)&&t.push(new j(4,this.id,112,"Contains command '"+l.name+"' which is impacts the state of the entire world, and generally shouldn't be used in an add-on",i,l.name,void 0,e[a])),n.incrementFeature(l.name),l.name==="execute"){let u=!1;for(let c of l.commandArguments)if(c==="run")u=!0;else if(u&&wi.isMinecraftBuiltInCommand(c)){s.incrementFeature(c);break}}}else!this.performPlatformVersionValidations&&!this.performAddOnValidations&&t.push(new j(3,this.id,401,"Unexpected command '"+l.name+"'",i,l.name,void 0,e[a]))}}async generate(e,t){let i=[];if(e.itemType!==7&&e.itemType!==8&&e.itemType!==16&&e.itemType!==39&&e.itemType!==20&&e.itemType!==19&&e.itemType!==9)return i;let n=new j(7,this.id,1,Oe.getTitleFromEnum(ir,1),e);i.push(n);let s=new j(7,this.id,2,Oe.getTitleFromEnum(ir,2),e);i.push(s);let o=new j(7,this.id,3,Oe.getTitleFromEnum(ir,3),e);i.push(o);let a=new j(7,this.id,4,Oe.getTitleFromEnum(ir,4),e);i.push(a);let l=new j(7,this.id,5,Oe.getTitleFromEnum(ir,5),e);i.push(l);let u=new j(7,this.id,6,Oe.getTitleFromEnum(ir,6),e);if(i.push(u),e.itemType===39){if(await e.ensureFileStorage(),e.file){let c=await Ru.ensureOnFile(e.file);if(c&&c.definition&&c.definition["minecraft:npc_dialogue"]){let d=c.definition["minecraft:npc_dialogue"].scenes;for(let f of d)f.on_open_commands&&this.processListOfCommands(f.on_open_commands,i,e,o,a,!0),f.on_close_commands&&this.processListOfCommands(f.on_close_commands,i,e,o,a,!0);let h=c.getAllButtons();for(let f of h)f.commands&&this.processListOfCommands(f.commands,i,e,o,a,!0)}}}else if(e.itemType===20){if(await e.ensureFileStorage(),e.file){let c=await gn.ensureOnFile(e.file);if(c&&c.data&&c.data.animation_controllers){let d=c.getAllStates();for(let h of d)h.state.on_entry&&this.processListOfCommands(h.state.on_entry,i,e,o,a,!0),h.state.on_exit&&this.processListOfCommands(h.state.on_exit,i,e,o,a,!0)}}}else if(e.itemType===19){if(await e.ensureFileStorage(),e.file){let c=await cr.ensureOnFile(e.file);if(c&&c.data&&c.data.animations){let d=c.getAllTimeline();for(let h of d)h.timeline&&this.processListOfCommands(h.timeline,i,e,o,a,!0)}}}else if(e.itemType===9){let c=await e.getStringContent();if(c!==void 0){let d=c.split(`
`);this.processListOfCommands(d,i,e,o,a,!1)}}if(e.itemType===7||e.itemType===8||e.itemType===16){let c=await Vt.ensureOnItem(e);if(!c)return C.debugAlert("Could not find respective world."),i;if(await c.load(!1),await c.loadData(!1),c.isInErrorState&&c.errorMessages&&!this.performAddOnValidations&&!this.performPlatformVersionValidations)for(let m of c.errorMessages)i.push(new j(3,this.id,400,Oe.getTitleFromEnum(ir,400),e,m.message+(m.context?" - "+m.context:""),c.name));if(e.projectPath&&t&&c.levelData&&c.levelData.nbt&&c.levelData.nbt.singleRoot){let m=c.levelData.nbt.singleRoot.getTagChildren();for(let p of m)if(p.name==="experiments")for(let g of p.getTagChildren())(g.type===3||g.type===1||g.type===8)&&(u.incrementFeature(g.name,g.valueAsString),t.insert(g.name+"=="+g.valueAsString,e.projectPath,"X"));else(p.type===3||p.type===1||p.type===8)&&p.name!=="LevelName"&&p.name!=="FlatWorldLayers"&&p.name!=="lightningTime"&&p.name!=="EducationOid"&&p.name!=="EducationProductId"&&p.name!=="rainTime"&&p.name!=="worldTemplateUUID"&&!p.name.startsWith("LimitedWorld")&&!p.name.startsWith("SpawnX")&&!p.name.startsWith("SpawnY")&&!p.name.startsWith("SpawnZ")&&(p.name.indexOf("ersion")>=0&&!p.valueAsString.startsWith("1.")?l.incrementFeature(p.name,"(unknown version)"):l.incrementFeature(p.name,p.valueAsString),t.insert(p.name+"=="+p.valueAsString,e.projectPath,"W"))}i.push(new j(2,this.id,8,Oe.getTitleFromEnum(ir,8),e,c.chunkCount,c.name));let d=0,h=0,f=0;for(let m in c.chunks){let p=c.chunks[m];for(let g in p){let b=p[g];if(b)for(let F in b){let w=b[F];if(w){h++,w.subChunks.length<=0&&f++,h%1e3===0&&await e.project.carto.notifyStatusUpdate("World data validation: scanned "+h/1e3+"K of "+Math.floor(c.chunkCount/1e3)+"K chunks in "+c.name,1);let _=w.blockActors;for(let A=0;A<_.length;A++){let T=_[A];if(T.id&&s.incrementFeature(T.id),T instanceof xs){let E=T;if(E.version&&s.spectrumIntFeature("Command Version",E.version),E.version&&E.version<this.modernCommandVersion&&i.push(new j(6,this.id,212,"Command '"+E.command+"' is from an older Minecraft version ("+E.version+") ",e,"(Command at location "+E.x+", "+E.y+", "+E.z+")",void 0,E.command)),E.command&&E.command.trim().length>2){let K=ns.parse(E.command);if(wi.isMinecraftBuiltInCommand(K.name)){if(this.performAddOnValidations&&wi.isAddOnBlockedCommand(K.name)&&i.push(new j(4,this.id,112,"Contains command '"+K.name+"' which is impacts the state of the entire world, and generally shouldn't be used in an add-on",e,K.name,void 0,E.command)),o.incrementFeature(K.name),K.name==="execute"){let P=!1;for(let G of K.commandArguments)if(G==="run")P=!0;else if(P&&wi.isMinecraftBuiltInCommand(G)){a.incrementFeature(G);break}}}else!this.performAddOnValidations&&!this.performPlatformVersionValidations&&i.push(new j(3,this.id,102,"Unexpected command '"+K.name+"'",e,K.name,void 0,E.command))}}}let I=w.getBlockList();for(let A=0;A<I.length;A++){let T=I[A];if(T&&(d++,T.typeName)){let E=T.typeName;E.indexOf(":")>=0&&E.indexOf("minecraft:")<0&&(E="(custom)"),n.incrementFeature(E)}}w.clearCachedData()}}}}n.data=d,i.push(new j(2,this.id,103,Oe.getTitleFromEnum(ir,103),e,c.minX,c.name)),i.push(new j(2,this.id,104,Oe.getTitleFromEnum(ir,104),e,c.minZ,c.name)),i.push(new j(2,this.id,105,Oe.getTitleFromEnum(ir,105),e,c.maxX,c.name)),i.push(new j(2,this.id,106,Oe.getTitleFromEnum(ir,106),e,c.maxZ,c.name)),i.push(new j(2,this.id,7,"Subchunkless Chunks",e,f,c.name))}return i}};var lk=Le(Je());var Lu=class r{constructor(){this._isLoaded=!1;this._onLoaded=new lk.EventDispatcher}get isLoaded(){return this._isLoaded}get file(){return this._file}get onLoaded(){return this._onLoaded.asEvent()}set file(e){this._file=e}static async ensureBlocksCatalogResourceDefinitionOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}persist(){if(this._file===void 0)return;let e=JSON.stringify(this.blocksCatalog,null,2);this._file.setContent(e)}async load(){if(this._isLoaded)return;if(this._file===void 0){C.unexpectedUndefined("BCRDF");return}if(await this._file.loadContent(),!this._file.content||this._file.content instanceof Uint8Array)return;let e={},t=S.getJsonObject(this._file);t&&(e=t),this.blocksCatalog=e,this._isLoaded=!0,this._onLoaded.dispatch(this,this)}};var uk=Le(Je());var Ou=class r{constructor(){this._isLoaded=!1;this._onLoaded=new uk.EventDispatcher}get isLoaded(){return this._isLoaded}get file(){return this._file}get onLoaded(){return this._onLoaded.asEvent()}set file(e){this._file=e}get namespaceId(){if(!(!this.jsonUIScreen||!this.jsonUIScreen.namespace))return this.jsonUIScreen.namespace}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}persist(){if(this._file===void 0)return;let e=JSON.stringify(this.jsonUIScreen,null,2);this._file.setContent(e)}async load(){if(this._isLoaded)return;if(this._file===void 0){C.unexpectedUndefined("PERPF");return}if(await this._file.loadContent(),!this._file.content||this._file.content instanceof Uint8Array)return;let e={},t=S.getJsonObject(this._file);t&&(e=t),this.jsonUIScreen=e,this._isLoaded=!0,this._onLoaded.dispatch(this,this)}};var ck=(e=>(e[e.textures=1]="textures",e))(ck||{}),Mu=class{constructor(){this.id="TEXTURE";this.title="Texture Validation";this.performAddOnValidations=!1}getTopicData(e){return{title:Oe.getTitleFromEnum(ck,e)}}summarize(e,t){e.textureCount=t.getSummedNumberValue("TEXTURE",1)}async generate(e,t){let i=[],n=[],s=[],o=[],a=[],l=[],u=[],c=[],d=[],h=[],f=[],m=[],p=[],g=[],b=[],F=[],w=[],_=[],I=[],A=[],T=[],E=new j(7,this.id,1,"Textures");i.push(E);let K=e.getItemsCopy();for(let P of K){if(P.itemType===26){if(await P.ensureFileStorage(),P.file){let G=await Lu.ensureBlocksCatalogResourceDefinitionOnFile(P.file);if(G&&G.blocksCatalog)for(let y in G.blocksCatalog){let z=G.blocksCatalog[y];z&&z.textures&&(E.incrementFeature("Block Resource Count"),o.includes(y)||o.push(y),s.includes(z.textures)||s.push(z.textures),a.includes(z.textures)||a.push(z.textures))}}}else if(P.itemType===33){if(await P.ensureFileStorage(),P.file){let y=(await Kn.ensureOnFile(P.file))?.data?.particle_effect?.description;if(y&&y.identifier&&y.basic_render_parameters?.texture){let z=y.basic_render_parameters.texture;await oe.matchesVanillaPath(y.basic_render_parameters.texture)?f.includes(z)||f.push(z):(n.includes(z)||n.push(z),d.includes(y.identifier)||d.push(y.identifier),s.includes(z)||s.push(z),h.includes(z)||h.push(z))}}}else if(P.itemType===36){if(await P.ensureFileStorage(),P.file){let G=await Ou.ensureOnFile(P.file);if(G?.namespaceId&&G.jsonUIScreen)for(let z in G.jsonUIScreen){let Fe=G.jsonUIScreen[z];if(z!=="namespace"&&Fe&&Fe.texture){let re=Fe.texture;await oe.matchesVanillaPath(re)?g.includes(re)||g.push(re):(n.includes(re)||n.push(re),m.includes(z)||m.push(z),s.includes(re)||s.push(re),p.includes(re)||p.push(re))}}}}else if(P.itemType===93){if(await P.ensureFileStorage(),P.file){let G=await Vs.ensureOnFile(P.file);if(G&&G.data&&G.data.texture_data)for(let y in G.data.texture_data){let z=G.data.texture_data[y];z&&z.textures&&(E.incrementFeature("Terrain Texture Resource Count"),b.includes(y)||b.push(y),typeof z.textures=="string"&&(F.includes(z.textures)||F.push(z.textures)))}}}else if(P.itemType===91){if(await P.ensureFileStorage(),P.file){let G=await js.ensureOnFile(P.file);if(G&&G&&G.data){let y=P.file.storageRelativePath+"_flipbooktextures";s.includes(y)||s.push(y);for(let z of G.data)z&&z.flipbook_texture&&(E.incrementFeature("Flipbook Texture Resource Count"),n.includes(z.flipbook_texture)||n.push(z.flipbook_texture),w.includes(z.atlas_tile)||w.push(z.atlas_tile),_.includes(z.flipbook_texture)||_.push(z.flipbook_texture))}}}else if(P.itemType===92){if(await P.ensureFileStorage(),P.file){let G=await zs.ensureOnFile(P.file);if(G&&G.data&&G.data.texture_data)for(let y in G.data.texture_data){let z=G.data.texture_data[y];if(z&&z.textures&&(E.incrementFeature("Item Texture Resource Count"),z.textures)){if(typeof z.textures=="string"){let Fe=await oe.matchesVanillaPath(z.textures);!Fe&&!I.includes(z.textures)?I.push(z.textures):Fe&&!A.includes(z.textures)&&A.push(z.textures)}else if(z.textures.constructor===Array)for(let Fe of z.textures){let re=await oe.matchesVanillaPath(Fe);!re&&!I.includes(Fe)?I.push(Fe):re&&!A.includes(Fe)&&A.push(Fe)}else if(z.textures.path){let Fe=z.textures.path,re=await oe.matchesVanillaPath(Fe);!re&&!I.includes(Fe)?I.push(Fe):re&&!A.includes(Fe)&&A.push(Fe)}}}}}else if(P.itemType===30){if(E.incrementFeature("Entity Resource Count"),await P.ensureFileStorage(),P.file){let G=await Zi.ensureOnFile(P.file);if(G?.data){let z=G.data.textures;if(z){let Fe=0;for(let re in z){let Re=z[re];if(Re)if(await oe.matchesVanillaPath(Re))u.includes(Re)||u.push(Re);else{n.includes(Re)||n.push(Re),l.includes(Re)||l.push(Re);let ze=z[re];ze&&!s.includes(ze)&&s.push(ze)}Fe++}E.incrementFeature("Texture References","Count",Fe),E.incrementFeature("Entity References","Count",Fe)}}}}else if(P.itemType===47&&(E.incrementFeature("Attachable Resource Count"),await P.ensureFileStorage(),P.file)){let G=await Zr.ensureOnFile(P.file);if(G?.data){let z=G.data.textures;if(z){let Fe=0;for(let re in z){let Re=z[re];Re&&(n.includes(Re)||n.push(Re),c.includes(Re)||c.push(Re),s.includes(Re)||s.push(Re),Fe++)}E.incrementFeature("Texture References","Count",Fe),E.incrementFeature("Attachable References","Count",Fe)}}}(P.itemType===99||P.itemType===102)&&(await P.ensureFileStorage(),P.file&&E.incrementFeature("File Count"))}return n.length>0&&E.incrementFeature("Unique Texture Handles (estimated)","Count",n.length),s.length>0&&E.incrementFeature("Unique Texture Paths","Count",s.length),d.length>0&&E.incrementFeature("Unique Particle Texture References","Count",d.length),f.length>0&&E.incrementFeature("Unique Particle Texture Paths","Count",h.length),f.length>0&&E.incrementFeature("Unique Particle Texture Vanilla Paths","Count",f.length),m.length>0&&E.incrementFeature("Unique JSON UI Texture References","Count",m.length),p.length>0&&E.incrementFeature("Unique JSON UI Texture Paths","Count",p.length),g.length>0&&E.incrementFeature("Unique JSON UI Texture Vanilla Paths","Count",g.length),l.length>0&&E.incrementFeature("Unique Entity Texture Paths","Count",l.length),u.length>0&&E.incrementFeature("Unique Entity Texture Vanilla Paths","Count",u.length),c.length>0&&E.incrementFeature("Unique Attachable Texture References","Count",c.length),b.length>0&&E.incrementFeature("Unique Terrain Texture References","Count",b.length),F.length>0&&E.incrementFeature("Unique Terrain Texture Paths","Count",F.length),I.length>0&&E.incrementFeature("Unique Item Texture Paths","Count",I.length),w.length>0&&E.incrementFeature("Unique Flipbook Texture References","Count",w.length),_.length>0&&E.incrementFeature("Unique Flipbook Texture Paths","Count",_.length),o.length>0&&E.incrementFeature("Unique Block Texture References","Count",o.length),a.length>0&&E.incrementFeature("Unique Block Texture Paths","Count",a.length),T.length>0&&E.incrementFeature("Unique Entity Spawn Egg Texture References","Count",T.length),this.performAddOnValidations&&n.length>800&&i.push(new j(3,this.id,100,"Uses more than 800 texture handles, which could impact overall Minecraft usage",void 0,n.length)),i}};var nn=(l=>(l[l.overallSize=1]="overallSize",l[l.fileCount=2]="fileCount",l[l.folderCount=3]="folderCount",l[l.contentSize=4]="contentSize",l[l.contentFileCount=5]="contentFileCount",l[l.contentFolderCount=6]="contentFolderCount",l[l.exceedsRecommendedAddonSize=401]="exceedsRecommendedAddonSize",l[l.exceedsRecommendedPackageSize=402]="exceedsRecommendedPackageSize",l))(nn||{}),Nu=class{constructor(){this.id="PACKSIZE";this.title="Pack Size Information";this.performAddOnValidations=!1}getTopicData(e){return{title:Oe.getTitleFromEnum(nn,e)}}summarize(e,t){e.overallSize=t.getFirstNumberValue(this.id,1),e.fileCounts=t.getFirstNumberValue(this.id,2),e.folderCounts=t.getFirstNumberValue(this.id,3),e.contentSize=t.getFirstNumberValue(this.id,4),e.contentFileCounts=t.getFirstNumberValue(this.id,5),e.contentFolderCounts=t.getFirstNumberValue(this.id,6)}async generate(e,t){let i=[],n={size:0,fileCounts:0,folderCounts:0,contentSize:0,contentFileCounts:0,contentFolderCounts:0};return await this.processFolder(e,await e.ensureProjectFolder(),i,t,n,0,!1),i.push(new j(7,this.id,1,Oe.getTitleFromEnum(nn,1),void 0,n.size)),i.push(new j(7,this.id,2,Oe.getTitleFromEnum(nn,2),void 0,n.fileCounts)),i.push(new j(7,this.id,3,Oe.getTitleFromEnum(nn,3),void 0,n.folderCounts)),i.push(new j(7,this.id,4,Oe.getTitleFromEnum(nn,4),void 0,n.contentSize)),i.push(new j(7,this.id,5,Oe.getTitleFromEnum(nn,5),void 0,n.contentFileCounts)),i.push(new j(7,this.id,6,Oe.getTitleFromEnum(nn,6),void 0,n.contentFolderCounts)),this.performAddOnValidations&&n.contentSize>25e6?i.push(new j(3,this.id,401,Oe.getTitleFromEnum(nn,401),void 0,n.contentSize)):!this.performAddOnValidations&&n.contentSize>25e7&&i.push(new j(3,this.id,402,Oe.getTitleFromEnum(nn,402),void 0,n.contentSize)),i}async processFolder(e,t,i,n,s,o,a){await t.load(),!a&&t.files["manifest.json"]&&(a=!0);for(let l in t.files){let u=t.files[l];if(u)if(await u.loadContent(),s.fileCounts++,S.isContainerFile(u.fullPath)){let c=await S.getFileStorageFolder(u);c&&await this.processFolder(e,c,i,n,s,o+1,a)}else a&&(s.contentFileCounts++,s.contentSize+=u.coreContentLength),s.size+=u.coreContentLength}if(a&&o<15||!a&&o<8)for(let l in t.folders){let u=t.folders[l];u&&!u.errorStatus&&u.name&&(s.folderCounts++,a&&s.contentFolderCounts++,await this.processFolder(e,u,i,n,s,o+1,a))}}};var yf=typeof self<"u"?self:global,Wu=typeof navigator<"u",gR=Wu&&typeof HTMLImageElement>"u",sf=!(typeof global>"u"||typeof process>"u"||!process.versions||!process.versions.node),vf=yf.Buffer,rf=yf.BigInt,wf=!!vf,bR=r=>r;function of(r,e=bR){if(sf)try{return typeof rr=="function"?Promise.resolve(e(rr(r))):import(r).then(e)}catch{console.warn(`Couldn't load ${r}`)}}var mg=yf.fetch,yR=r=>mg=r;if(!yf.fetch){let r=of("http",i=>i),e=of("https",i=>i),t=(i,{headers:n}={})=>new Promise(async(s,o)=>{let{port:a,hostname:l,pathname:u,protocol:c,search:d}=new URL(i),h={method:"GET",hostname:l,path:encodeURI(u)+d,headers:n};a!==""&&(h.port=Number(a));let f=(c==="https:"?await e:await r).request(h,m=>{if(m.statusCode===301||m.statusCode===302){let p=new URL(m.headers.location,i).toString();return t(p,{headers:n}).then(s).catch(o)}s({status:m.statusCode,arrayBuffer:()=>new Promise(p=>{let g=[];m.on("data",b=>g.push(b)),m.on("end",()=>p(Buffer.concat(g)))})})});f.on("error",o),f.end()});yR(t)}function it(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}var af=r=>Ck(r)?void 0:r,vR=r=>r!==void 0;function Ck(r){return r===void 0||(r instanceof Map?r.size===0:Object.values(r).filter(vR).length===0)}function hi(r){let e=new Error(r);throw delete e.stack,e}function to(r){return(r=function(e){for(;e.endsWith("\0");)e=e.slice(0,-1);return e}(r).trim())===""?void 0:r}function ng(r){let e=function(t){let i=0;return t.ifd0.enabled&&(i+=1024),t.exif.enabled&&(i+=2048),t.makerNote&&(i+=2048),t.userComment&&(i+=1024),t.gps.enabled&&(i+=512),t.interop.enabled&&(i+=100),t.ifd1.enabled&&(i+=1024),i+2048}(r);return r.jfif.enabled&&(e+=50),r.xmp.enabled&&(e+=2e4),r.iptc.enabled&&(e+=14e3),r.icc.enabled&&(e+=6e3),e}var sg=r=>String.fromCharCode.apply(null,r),dk=typeof TextDecoder<"u"?new TextDecoder("utf-8"):void 0;function Sk(r){return dk?dk.decode(r):wf?Buffer.from(r).toString("utf8"):decodeURIComponent(escape(sg(r)))}var sn=class r{static from(e,t){return e instanceof this&&e.le===t?e:new r(e,void 0,void 0,t)}constructor(e,t=0,i,n){if(typeof n=="boolean"&&(this.le=n),Array.isArray(e)&&(e=new Uint8Array(e)),e===0)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){i===void 0&&(i=e.byteLength-t);let s=new DataView(e,t,i);this._swapDataView(s)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof r){i===void 0&&(i=e.byteLength-t),(t+=e.byteOffset)+i>e.byteOffset+e.byteLength&&hi("Creating view outside of available memory in ArrayBuffer");let s=new DataView(e.buffer,t,i);this._swapDataView(s)}else if(typeof e=="number"){let s=new DataView(new ArrayBuffer(e));this._swapDataView(s)}else hi("Invalid input argument for BufferView: "+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,t,i=r){return e instanceof DataView||e instanceof r?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||hi("BufferView.set(): Invalid data argument."),this.toUint8().set(e,t),new i(this,t,e.byteLength)}subarray(e,t){return t=t||this._lengthToEnd(e),new r(this,e,t)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}getString(e=0,t=this.byteLength){return Sk(this.getUint8Array(e,t))}getLatin1String(e=0,t=this.byteLength){let i=this.getUint8Array(e,t);return sg(i)}getUnicodeString(e=0,t=this.byteLength){let i=[];for(let n=0;n<t&&e+n<this.byteLength;n+=2)i.push(this.getUint16(e+n));return sg(i)}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,t=this.le){return this.dataView.getInt16(e,t)}getInt32(e,t=this.le){return this.dataView.getInt32(e,t)}getUint16(e,t=this.le){return this.dataView.getUint16(e,t)}getUint32(e,t=this.le){return this.dataView.getUint32(e,t)}getFloat32(e,t=this.le){return this.dataView.getFloat32(e,t)}getFloat64(e,t=this.le){return this.dataView.getFloat64(e,t)}getFloat(e,t=this.le){return this.dataView.getFloat32(e,t)}getDouble(e,t=this.le){return this.dataView.getFloat64(e,t)}getUintBytes(e,t,i){switch(t){case 1:return this.getUint8(e,i);case 2:return this.getUint16(e,i);case 4:return this.getUint32(e,i);case 8:return this.getUint64&&this.getUint64(e,i)}}getUint(e,t,i){switch(t){case 8:return this.getUint8(e,i);case 16:return this.getUint16(e,i);case 32:return this.getUint32(e,i);case 64:return this.getUint64&&this.getUint64(e,i)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}};function og(r,e){hi(`${r} '${e}' was not loaded, try using full build of exifr.`)}var Ju=class extends Map{constructor(e){super(),this.kind=e}get(e,t){return this.has(e)||og(this.kind,e),t&&(e in t||function(i,n){hi(`Unknown ${i} '${n}'.`)}(this.kind,e),t[e].enabled||og(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}},on=new Ju("file parser"),fi=new Ju("segment parser"),an=new Ju("file reader");function wR(r,e){return typeof r=="string"?fk(r,e):Wu&&!gR&&r instanceof HTMLImageElement?fk(r.src,e):r instanceof Uint8Array||r instanceof ArrayBuffer||r instanceof DataView?new sn(r):Wu&&r instanceof Blob?ag(r,e,"blob",so):void hi("Invalid input argument")}function fk(r,e){return(t=r).startsWith("data:")||t.length>1e4?lg(r,e,"base64"):sf&&r.includes("://")?ag(r,e,"url",no):sf?lg(r,e,"fs"):Wu?ag(r,e,"url",no):void hi("Invalid input argument");var t}async function ag(r,e,t,i){return an.has(t)?lg(r,e,t):i?async function(n,s){let o=await s(n);return new sn(o)}(r,i):void hi(`Parser ${t} is not loaded`)}async function lg(r,e,t){let i=new(an.get(t))(r,e);return await i.read(),i}var no=r=>mg(r).then(e=>e.arrayBuffer()),so=r=>new Promise((e,t)=>{let i=new FileReader;i.onloadend=()=>e(i.result||new ArrayBuffer),i.onerror=t,i.readAsArrayBuffer(r)}),ug=class extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}};function ri(r,e,t){let i=new ug;for(let[n,s]of t)i.set(n,s);if(Array.isArray(e))for(let n of e)r.set(n,i);else r.set(e,i);return i}function oo(r,e,t){let i,n=r.get(e);for(i of t)n.set(i[0],i[1])}var _i=new Map,Or=new Map,us=new Map,ss=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],Qo=["jfif","xmp","icc","iptc","ihdr"],ao=["tiff",...Qo],Yt=["ifd0","ifd1","exif","gps","interop"],os=[...ao,...Yt],as=["makerNote","userComment"],ea=["translateKeys","translateValues","reviveValues","multiSegment"],ls=[...ea,"sanitize","mergeOutput","silentErrors"],lf=class{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}},eo=class extends lf{get needed(){return this.enabled||this.deps.size>0}constructor(e,t,i,n){if(super(),it(this,"enabled",!1),it(this,"skip",new Set),it(this,"pick",new Set),it(this,"deps",new Set),it(this,"translateKeys",!1),it(this,"translateValues",!1),it(this,"reviveValues",!1),this.key=e,this.enabled=t,this.parse=this.enabled,this.applyInheritables(n),this.canBeFiltered=Yt.includes(e),this.canBeFiltered&&(this.dict=_i.get(e)),i!==void 0)if(Array.isArray(i))this.parse=this.enabled=!0,this.canBeFiltered&&i.length>0&&this.translateTagSet(i,this.pick);else if(typeof i=="object"){if(this.enabled=!0,this.parse=i.parse!==!1,this.canBeFiltered){let{pick:s,skip:o}=i;s&&s.length>0&&this.translateTagSet(s,this.pick),o&&o.length>0&&this.translateTagSet(o,this.skip)}this.applyInheritables(i)}else i===!0||i===!1?this.parse=this.enabled=i:hi(`Invalid options argument: ${i}`)}applyInheritables(e){let t,i;for(t of ea)i=e[t],i!==void 0&&(this[t]=i)}translateTagSet(e,t){if(this.dict){let i,n,{tagKeys:s,tagValues:o}=this.dict;for(i of e)typeof i=="string"?(n=o.indexOf(i),n===-1&&(n=s.indexOf(Number(i))),n!==-1&&t.add(Number(s[n]))):t.add(i)}else for(let i of e)t.add(i)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,uf(this.pick,this.deps)):this.enabled&&this.pick.size>0&&uf(this.pick,this.deps)}},$i={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},hk=new Map,En=class extends lf{static useCached(e){let t=hk.get(e);return t!==void 0||(t=new this(e),hk.set(e,t)),t}constructor(e){super(),e===!0?this.setupFromTrue():e===void 0?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):typeof e=="object"?this.setupFromObject(e):hi(`Invalid options argument ${e}`),this.firstChunkSize===void 0&&(this.firstChunkSize=Wu?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of ss)this[e]=$i[e];for(e of ls)this[e]=$i[e];for(e of as)this[e]=$i[e];for(e of os)this[e]=new eo(e,$i[e],void 0,this)}setupFromTrue(){let e;for(e of ss)this[e]=$i[e];for(e of ls)this[e]=$i[e];for(e of as)this[e]=!0;for(e of os)this[e]=new eo(e,!0,void 0,this)}setupFromArray(e){let t;for(t of ss)this[t]=$i[t];for(t of ls)this[t]=$i[t];for(t of as)this[t]=$i[t];for(t of os)this[t]=new eo(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,Yt)}setupFromObject(e){let t;for(t of(Yt.ifd0=Yt.ifd0||Yt.image,Yt.ifd1=Yt.ifd1||Yt.thumbnail,Object.assign(this,e),ss))this[t]=tg(e[t],$i[t]);for(t of ls)this[t]=tg(e[t],$i[t]);for(t of as)this[t]=tg(e[t],$i[t]);for(t of ao)this[t]=new eo(t,$i[t],e[t],this);for(t of Yt)this[t]=new eo(t,$i[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,Yt,os),e.tiff===!0?this.batchEnableWithBool(Yt,!0):e.tiff===!1?this.batchEnableWithUserValue(Yt,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,Yt):typeof e.tiff=="object"&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,Yt)}batchEnableWithBool(e,t){for(let i of e)this[i].enabled=t}batchEnableWithUserValue(e,t){for(let i of e){let n=t[i];this[i].enabled=n!==!1&&n!==void 0}}setupGlobalFilters(e,t,i,n=i){if(e&&e.length){for(let o of n)this[o].enabled=!1;let s=pk(e,i);for(let[o,a]of s)uf(this[o].pick,a),this[o].enabled=!0}else if(t&&t.length){let s=pk(t,i);for(let[o,a]of s)uf(this[o].skip,a)}}filterNestedSegmentTags(){let{ifd0:e,exif:t,xmp:i,iptc:n,icc:s}=this;this.makerNote?t.deps.add(37500):t.skip.add(37500),this.userComment?t.deps.add(37510):t.skip.add(37510),i.enabled||e.skip.add(700),n.enabled||e.skip.add(33723),s.enabled||e.skip.add(34675)}traverseTiffDependencyTree(){let{ifd0:e,exif:t,gps:i,interop:n}=this;n.needed&&(t.deps.add(40965),e.deps.add(40965)),t.needed&&e.deps.add(34665),i.needed&&e.deps.add(34853),this.tiff.enabled=Yt.some(s=>this[s].enabled===!0)||this.makerNote||this.userComment;for(let s of Yt)this[s].finalizeFilters()}get onlyTiff(){return!Qo.map(e=>this[e].enabled).some(e=>e===!0)&&this.tiff.enabled}checkLoadedPlugins(){for(let e of ao)this[e].enabled&&!fi.has(e)&&og("segment parser",e)}};function pk(r,e){let t,i,n,s,o=[];for(n of e){for(s of(t=_i.get(n),i=[],t))(r.includes(s[0])||r.includes(s[1]))&&i.push(s[0]);i.length&&o.push([n,i])}return o}function tg(r,e){return r!==void 0?r:e!==void 0?e:void 0}function uf(r,e){for(let t of e)r.add(t)}it(En,"default",$i);var wr=class{constructor(e){it(this,"parsers",{}),it(this,"output",{}),it(this,"errors",[]),it(this,"pushToErrors",t=>this.errors.push(t)),this.options=En.useCached(e)}async read(e){this.file=await wR(e,this.options)}setup(){if(this.fileParser)return;let{file:e}=this,t=e.getUint16(0);for(let[i,n]of on)if(n.canHandle(e,t))return this.fileParser=new n(this.options,this.file,this.parsers),e[i]=!0;this.file.close&&this.file.close(),hi("Unknown file format")}async parse(){let{output:e,errors:t}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),t.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&t.length>0&&(e.errors=t),af(e)}async executeParsers(){let{output:e}=this;await this.fileParser.parse();let t=Object.values(this.parsers).map(async i=>{let n=await i.parse();i.assignToOutput(e,n)});this.options.silentErrors&&(t=t.map(i=>i.catch(this.pushToErrors))),await Promise.all(t)}async extractThumbnail(){this.setup();let{options:e,file:t}=this,i=fi.get("tiff",e);var n;if(t.tiff?n={start:0,type:"tiff"}:t.jpeg&&(n=await this.fileParser.getOrFindSegment("tiff")),n===void 0)return;let s=await this.fileParser.ensureSegmentChunk(n),o=this.parsers.tiff=new i(s,e,t),a=await o.extractThumbnail();return t.close&&t.close(),a}};async function _f(r,e){let t=new wr(e);return await t.read(r),t.parse()}var _R=Object.freeze({__proto__:null,parse:_f,Exifr:wr,fileParsers:on,segmentParsers:fi,fileReaders:an,tagKeys:_i,tagValues:Or,tagRevivers:us,createDictionary:ri,extendDictionary:oo,fetchUrlAsArrayBuffer:no,readBlobAsArrayBuffer:so,chunkedProps:ss,otherSegments:Qo,segments:ao,tiffBlocks:Yt,segmentsAndBlocks:os,tiffExtractables:as,inheritables:ea,allFormatters:ls,Options:En}),Zo=class{constructor(e,t,i){it(this,"errors",[]),it(this,"ensureSegmentChunk",async n=>{let s=n.start,o=n.size||65536;if(this.file.chunked)if(this.file.available(s,o))n.chunk=this.file.subarray(s,o);else try{n.chunk=await this.file.readChunk(s,o)}catch(a){hi(`Couldn't read segment: ${JSON.stringify(n)}. ${a.message}`)}else this.file.byteLength>s+o?n.chunk=this.file.subarray(s,o):n.size===void 0?n.chunk=this.file.subarray(s):hi("Segment unreachable: "+JSON.stringify(n));return n.chunk}),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=t,this.parsers=i}injectSegment(e,t){this.options[e].enabled&&this.createParser(e,t)}createParser(e,t){let i=new(fi.get(e))(t,this.options,this.file);return this.parsers[e]=i}createParsers(e){for(let t of e){let{type:i,chunk:n}=t,s=this.options[i];if(s&&s.enabled){let o=this.parsers[i];o&&o.append||o||this.createParser(i,n)}}}async readSegments(e){let t=e.map(this.ensureSegmentChunk);await Promise.all(t)}},or=class{static findPosition(e,t){let i=e.getUint16(t+2)+2,n=typeof this.headerLength=="function"?this.headerLength(e,t,i):this.headerLength,s=t+n,o=i-n;return{offset:t,length:i,headerLength:n,start:s,size:o,end:s+o}}static parse(e,t={}){return new this(e,new En({[this.type]:t}),e).parse()}normalizeInput(e){return e instanceof sn?e:new sn(e)}constructor(e,t={},i){it(this,"errors",[]),it(this,"raw",new Map),it(this,"handleError",n=>{if(!this.options.silentErrors)throw n;this.errors.push(n.message)}),this.chunk=this.normalizeInput(e),this.file=i,this.type=this.constructor.type,this.globalOptions=this.options=t,this.localOptions=t[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,t){let i=us.get(t),n=Or.get(t),s=_i.get(t),o=this.options[t],a=o.reviveValues&&!!i,l=o.translateValues&&!!n,u=o.translateKeys&&!!s,c={};for(let[d,h]of e)a&&i.has(d)?h=i.get(d)(h):l&&n.has(d)&&(h=this.translateValue(h,n.get(d))),u&&s.has(d)&&(d=s.get(d)||d),c[d]=h;return c}translateValue(e,t){return t[e]||t.DEFAULT||e}assignToOutput(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}assignObjectToOutput(e,t,i){if(this.globalOptions.mergeOutput)return Object.assign(e,i);e[t]?Object.assign(e[t],i):e[t]=i}};it(or,"headerLength",4),it(or,"type",void 0),it(or,"multiSegment",!1),it(or,"canHandle",()=>!1);function FR(r){return r===192||r===194||r===196||r===219||r===221||r===218||r===254}function kR(r){return r>=224&&r<=239}function CR(r,e,t){for(let[i,n]of fi)if(n.canHandle(r,e,t))return i}var cf=class extends Zo{constructor(...e){super(...e),it(this,"appSegments",[]),it(this,"jpegSegments",[]),it(this,"unknownSegments",[])}static canHandle(e,t){return t===65496}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(e){e===!0?(this.findAll=!0,this.wanted=new Set(fi.keyList())):(e=e===void 0?fi.keyList().filter(t=>this.options[t].enabled):e.filter(t=>this.options[t].enabled&&fi.has(t)),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,t){this.setupSegmentFinderArgs(t);let{file:i,findAll:n,wanted:s,remaining:o}=this;if(!n&&this.file.chunked&&(n=Array.from(s).some(a=>{let l=fi.get(a),u=this.options[a];return l.multiSegment&&u.multiSegment}),n&&await this.file.readWhole()),e=this.findAppSegmentsInRange(e,i.byteLength),!this.options.onlyTiff&&i.chunked){let a=!1;for(;o.size>0&&!a&&(i.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:l}=i,u=this.appSegments.some(c=>!this.file.available(c.offset||c.start,c.length||c.size));if(a=e>l&&!u?!await i.readNextChunk(e):!await i.readNextChunk(l),(e=this.findAppSegmentsInRange(e,i.byteLength))===void 0)return}}}findAppSegmentsInRange(e,t){t-=2;let i,n,s,o,a,l,{file:u,findAll:c,wanted:d,remaining:h,options:f}=this;for(;e<t;e++)if(u.getUint8(e)===255){if(i=u.getUint8(e+1),kR(i)){if(n=u.getUint16(e+2),s=CR(u,e,n),s&&d.has(s)&&(o=fi.get(s),a=o.findPosition(u,e),l=f[s],a.type=s,this.appSegments.push(a),!c&&(o.multiSegment&&l.multiSegment?(this.unfinishedMultiSegment=a.chunkNumber<a.chunkCount,this.unfinishedMultiSegment||h.delete(s)):h.delete(s),h.size===0)))break;f.recordUnknownSegments&&(a=or.findPosition(u,e),a.marker=i,this.unknownSegments.push(a)),e+=n+1}else if(FR(i)){if(n=u.getUint16(e+2),i===218&&f.stopAfterSos!==!1)return;f.recordJpegSegments&&this.jpegSegments.push({offset:e,length:n,marker:i}),e+=n+1}}return e}mergeMultiSegments(){if(!this.appSegments.some(t=>t.multiSegment))return;let e=function(t,i){let n,s,o,a=new Map;for(let l=0;l<t.length;l++)n=t[l],s=n[i],a.has(s)?o=a.get(s):a.set(s,o=[]),o.push(n);return Array.from(a)}(this.appSegments,"type");this.mergedAppSegments=e.map(([t,i])=>{let n=fi.get(t,this.options);return n.handleMultiSegments?{type:t,chunk:n.handleMultiSegments(i)}:i[0]})}getSegment(e){return this.appSegments.find(t=>t.type===e)}async getOrFindSegment(e){let t=this.getSegment(e);return t===void 0&&(await this.findAppSegments(0,[e]),t=this.getSegment(e)),t}};it(cf,"type","jpeg"),on.set("jpeg",cf);var SR=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4],cg=class extends or{parseHeader(){var e=this.chunk.getUint16();e===18761?this.le=!0:e===19789&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,t,i=new Map){let{pick:n,skip:s}=this.options[t];n=new Set(n);let o=n.size>0,a=s.size===0,l=this.chunk.getUint16(e);e+=2;for(let u=0;u<l;u++){let c=this.chunk.getUint16(e);if(o){if(n.has(c)&&(i.set(c,this.parseTag(e,c,t)),n.delete(c),n.size===0))break}else!a&&s.has(c)||i.set(c,this.parseTag(e,c,t));e+=12}return i}parseTag(e,t,i){let{chunk:n}=this,s=n.getUint16(e+2),o=n.getUint32(e+4),a=SR[s];if(a*o<=4?e+=8:e=n.getUint32(e+8),(s<1||s>13)&&hi(`Invalid TIFF value type. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${s}, offset ${e}`),e>n.byteLength&&hi(`Invalid TIFF value offset. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${s}, offset ${e} is outside of chunk size ${n.byteLength}`),s===1)return n.getUint8Array(e,o);if(s===2)return to(n.getString(e,o));if(s===7)return n.getUint8Array(e,o);if(o===1)return this.parseTagValue(s,e);{let l=new(function(c){switch(c){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}}(s))(o),u=a;for(let c=0;c<o;c++)l[c]=this.parseTagValue(s,e),e+=u;return l}}parseTagValue(e,t){let{chunk:i}=this;switch(e){case 1:return i.getUint8(t);case 3:return i.getUint16(t);case 4:return i.getUint32(t);case 5:return i.getUint32(t)/i.getUint32(t+4);case 6:return i.getInt8(t);case 8:return i.getInt16(t);case 9:return i.getInt32(t);case 10:return i.getInt32(t)/i.getInt32(t+4);case 11:return i.getFloat(t);case 12:return i.getDouble(t);case 13:return i.getUint32(t);default:hi(`Invalid tiff type ${e}`)}}},Uu=class extends cg{static canHandle(e,t){return e.getUint8(t+1)===225&&e.getUint32(t+4)===1165519206&&e.getUint16(t+8)===0}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse("parseExifBlock"),e.gps.enabled&&await this.safeParse("parseGpsBlock"),e.interop.enabled&&await this.safeParse("parseInteropBlock"),e.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(e){let t=this[e]();return t.catch!==void 0&&(t=t.catch(this.handleError)),t}findIfd0Offset(){this.ifd0Offset===void 0&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(this.ifd1Offset===void 0){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}parseBlock(e,t){let i=new Map;return this[t]=i,this.parseTags(e,t,i),i}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&hi("Malformed EXIF data"),!e.chunked&&this.ifd0Offset>e.byteLength&&hi(`IFD0 offset points to outside of file.
this.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${e.byteLength}`),e.tiff&&await e.ensureChunk(this.ifd0Offset,ng(this.options));let t=this.parseBlock(this.ifd0Offset,"ifd0");return t.size!==0?(this.exifOffset=t.get(34665),this.interopOffset=t.get(40965),this.gpsOffset=t.get(34853),this.xmp=t.get(700),this.iptc=t.get(33723),this.icc=t.get(34675),this.options.sanitize&&(t.delete(34665),t.delete(40965),t.delete(34853),t.delete(700),t.delete(33723),t.delete(34675)),t):void 0}async parseExifBlock(){if(this.exif||(this.ifd0||await this.parseIfd0Block(),this.exifOffset===void 0))return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,ng(this.options));let e=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=e.get(40965)),this.makerNote=e.get(37500),this.userComment=e.get(37510),this.options.sanitize&&(e.delete(40965),e.delete(37500),e.delete(37510)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,t){let i=e.get(t);i&&i.length===1&&e.set(t,i[0])}async parseGpsBlock(){if(this.gps||(this.ifd0||await this.parseIfd0Block(),this.gpsOffset===void 0))return;let e=this.parseBlock(this.gpsOffset,"gps");return e&&e.has(2)&&e.has(4)&&(e.set("latitude",mk(...e.get(2),e.get(1))),e.set("longitude",mk(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),this.interopOffset!==void 0||this.exif||await this.parseExifBlock(),this.interopOffset!==void 0))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),this.ifd1===void 0)return;let e=this.ifd1.get(513),t=this.ifd1.get(514);return this.chunk.getUint8Array(e,t)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,t,i,n={};for(t of Yt)if(e=this[t],!Ck(e))if(i=this.canTranslate?this.translateBlock(e,t):Object.fromEntries(e),this.options.mergeOutput){if(t==="ifd1")continue;Object.assign(n,i)}else n[t]=i;return this.makerNote&&(n.makerNote=this.makerNote),this.userComment&&(n.userComment=this.userComment),n}assignToOutput(e,t){if(this.globalOptions.mergeOutput)Object.assign(e,t);else for(let[i,n]of Object.entries(t))this.assignObjectToOutput(e,i,n)}};function mk(r,e,t,i){var n=r+e/60+t/3600;return i!=="S"&&i!=="W"||(n*=-1),n}it(Uu,"type","tiff"),it(Uu,"headerLength",10),fi.set("tiff",Uu);var PR=Object.freeze({__proto__:null,default:_R,Exifr:wr,fileParsers:on,segmentParsers:fi,fileReaders:an,tagKeys:_i,tagValues:Or,tagRevivers:us,createDictionary:ri,extendDictionary:oo,fetchUrlAsArrayBuffer:no,readBlobAsArrayBuffer:so,chunkedProps:ss,otherSegments:Qo,segments:ao,tiffBlocks:Yt,segmentsAndBlocks:os,tiffExtractables:as,inheritables:ea,allFormatters:ls,Options:En,parse:_f}),gg={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},bg=Object.assign({},gg,{firstChunkSize:4e4,gps:[1,2,3,4]});async function Pk(r){let e=new wr(bg);await e.read(r);let t=await e.parse();if(t&&t.gps){let{latitude:i,longitude:n}=t.gps;return{latitude:i,longitude:n}}}var yg=Object.assign({},gg,{tiff:!1,ifd1:!0,mergeOutput:!1});async function Ek(r){let e=new wr(yg);await e.read(r);let t=await e.extractThumbnail();return t&&wf?vf.from(t):t}async function Ik(r){let e=await this.thumbnail(r);if(e!==void 0){let t=new Blob([e]);return URL.createObjectURL(t)}}var vg=Object.assign({},gg,{firstChunkSize:4e4,ifd0:[274]});async function wg(r){let e=new wr(vg);await e.read(r);let t=await e.parse();if(t&&t.ifd0)return t.ifd0[274]}var _g=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}}),io=!0,ro=!0;if(typeof navigator=="object"){let r=navigator.userAgent;if(r.includes("iPad")||r.includes("iPhone")){let e=r.match(/OS (\d+)_(\d+)/);if(e){let[,t,i]=e;io=Number(t)+.1*Number(i)<13.4,ro=!1}}else if(r.includes("OS X 10")){let[,e]=r.match(/OS X 10[_.](\d+)/);io=ro=Number(e)<15}if(r.includes("Chrome/")){let[,e]=r.match(/Chrome\/(\d+)/);io=ro=Number(e)<81}else if(r.includes("Firefox/")){let[,e]=r.match(/Firefox\/(\d+)/);io=ro=Number(e)<77}}async function xk(r){let e=await wg(r);return Object.assign({canvas:io,css:ro},_g[e])}var dg=class extends sn{constructor(...e){super(...e),it(this,"ranges",new fg),this.byteLength!==0&&this.ranges.add(0,this.byteLength)}_tryExtend(e,t,i){if(e===0&&this.byteLength===0&&i){let n=new DataView(i.buffer||i,i.byteOffset,i.byteLength);this._swapDataView(n)}else{let n=e+t;if(n>this.byteLength){let{dataView:s}=this._extend(n);this._swapDataView(s)}}}_extend(e){let t;t=wf?vf.allocUnsafe(e):new Uint8Array(e);let i=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:i}}subarray(e,t,i=!1){return t=t||this._lengthToEnd(e),i&&this._tryExtend(e,t),this.ranges.add(e,t),super.subarray(e,t)}set(e,t,i=!1){i&&this._tryExtend(t,e.byteLength,e);let n=super.set(e,t);return this.ranges.add(t,n.byteLength),n}async ensureChunk(e,t){this.chunked&&(this.ranges.available(e,t)||await this.readChunk(e,t))}available(e,t){return this.ranges.available(e,t)}},fg=class{constructor(){it(this,"list",[])}get length(){return this.list.length}add(e,t,i=0){let n=e+t,s=this.list.filter(o=>gk(e,o.offset,n)||gk(e,o.end,n));if(s.length>0){e=Math.min(e,...s.map(a=>a.offset)),n=Math.max(n,...s.map(a=>a.end)),t=n-e;let o=s.shift();o.offset=e,o.length=t,o.end=n,this.list=this.list.filter(a=>!s.includes(a))}else this.list.push({offset:e,length:t,end:n})}available(e,t){let i=e+t;return this.list.some(n=>n.offset<=e&&i<=n.end)}};function gk(r,e,t){return r<=e&&e<=t}var Yo=class extends dg{constructor(e,t){super(0),it(this,"chunksRead",0),this.input=e,this.options=t}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let t=this.options.chunkSize,i=await this.readChunk(e,t);return!!i&&i.byteLength===t}async readChunk(e,t){if(this.chunksRead++,(t=this.safeWrapAddress(e,t))!==0)return this._readChunk(e,t)}safeWrapAddress(e,t){return this.size!==void 0&&e+t>this.size?Math.max(0,this.size-e):t}get nextChunkOffset(){if(this.ranges.list.length!==0)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return this.size!==void 0&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}};an.set("blob",class extends Yo{async readWhole(){this.chunked=!1;let r=await so(this.input);this._swapArrayBuffer(r)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(r,e){let t=e?r+e:void 0,i=this.input.slice(r,t),n=await so(i);return this.set(n,r,!0)}});var ER=Object.freeze({__proto__:null,default:PR,Exifr:wr,fileParsers:on,segmentParsers:fi,fileReaders:an,tagKeys:_i,tagValues:Or,tagRevivers:us,createDictionary:ri,extendDictionary:oo,fetchUrlAsArrayBuffer:no,readBlobAsArrayBuffer:so,chunkedProps:ss,otherSegments:Qo,segments:ao,tiffBlocks:Yt,segmentsAndBlocks:os,tiffExtractables:as,inheritables:ea,allFormatters:ls,Options:En,parse:_f,gpsOnlyOptions:bg,gps:Pk,thumbnailOnlyOptions:yg,thumbnail:Ek,thumbnailUrl:Ik,orientationOnlyOptions:vg,orientation:wg,rotations:_g,get rotateCanvas(){return io},get rotateCss(){return ro},rotation:xk});an.set("url",class extends Yo{async readWhole(){this.chunked=!1;let r=await no(this.input);r instanceof ArrayBuffer?this._swapArrayBuffer(r):r instanceof Uint8Array&&this._swapBuffer(r)}async _readChunk(r,e){let t=e?r+e-1:void 0,i=this.options.httpHeaders||{};(r||t)&&(i.range=`bytes=${[r,t].join("-")}`);let n=await mg(this.input,{headers:i}),s=await n.arrayBuffer(),o=s.byteLength;if(n.status!==416)return o!==e&&(this.size=r+o),this.set(s,r,!0)}});sn.prototype.getUint64=function(r){let e=this.getUint32(r),t=this.getUint32(r+4);return e<1048575?e<<32|t:typeof rf!==void 0?(console.warn("Using BigInt because of type 64uint but JS can only handle 53b numbers."),rf(e)<<rf(32)|rf(t)):void hi("Trying to read 64b value but JS can only handle 53b numbers.")};var hg=class extends Zo{parseBoxes(e=0){let t=[];for(;e<this.file.byteLength-4;){let i=this.parseBoxHead(e);if(t.push(i),i.length===0)break;e+=i.length}return t}parseSubBoxes(e){e.boxes=this.parseBoxes(e.start)}findBox(e,t){return e.boxes===void 0&&this.parseSubBoxes(e),e.boxes.find(i=>i.kind===t)}parseBoxHead(e){let t=this.file.getUint32(e),i=this.file.getString(e+4,4),n=e+8;return t===1&&(t=this.file.getUint64(e+8),n+=8),{offset:e,length:t,kind:i,start:n}}parseBoxFullHead(e){if(e.version!==void 0)return;let t=this.file.getUint32(e.start);e.version=t>>24,e.start+=4}},df=class extends hg{static canHandle(e,t){if(t!==0)return!1;let i=e.getUint16(2);if(i>50)return!1;let n=16,s=[];for(;n<i;)s.push(e.getString(n,4)),n+=4;return s.includes(this.type)}async parse(){let e=this.file.getUint32(0),t=this.parseBoxHead(e);for(;t.kind!=="meta";)e+=t.length,await this.file.ensureChunk(e,16),t=this.parseBoxHead(e);await this.file.ensureChunk(t.offset,t.length),this.parseBoxFullHead(t),this.parseSubBoxes(t),this.options.icc.enabled&&await this.findIcc(t),this.options.tiff.enabled&&await this.findExif(t)}async registerSegment(e,t,i){await this.file.ensureChunk(t,i);let n=this.file.subarray(t,i);this.createParser(e,n)}async findIcc(e){let t=this.findBox(e,"iprp");if(t===void 0)return;let i=this.findBox(t,"ipco");if(i===void 0)return;let n=this.findBox(i,"colr");n!==void 0&&await this.registerSegment("icc",n.offset+12,n.length)}async findExif(e){let t=this.findBox(e,"iinf");if(t===void 0)return;let i=this.findBox(e,"iloc");if(i===void 0)return;let n=this.findExifLocIdInIinf(t),s=this.findExtentInIloc(i,n);if(s===void 0)return;let[o,a]=s;await this.file.ensureChunk(o,a);let l=4+this.file.getUint32(o);o+=l,a-=l,await this.registerSegment("tiff",o,a)}findExifLocIdInIinf(e){this.parseBoxFullHead(e);let t,i,n,s,o=e.start,a=this.file.getUint16(o);for(o+=2;a--;){if(t=this.parseBoxHead(o),this.parseBoxFullHead(t),i=t.start,t.version>=2&&(n=t.version===3?4:2,s=this.file.getString(i+n+2,4),s==="Exif"))return this.file.getUintBytes(i,n);o+=t.length}}get8bits(e){let t=this.file.getUint8(e);return[t>>4,15&t]}findExtentInIloc(e,t){this.parseBoxFullHead(e);let i=e.start,[n,s]=this.get8bits(i++),[o,a]=this.get8bits(i++),l=e.version===2?4:2,u=e.version===1||e.version===2?2:0,c=a+n+s,d=e.version===2?4:2,h=this.file.getUintBytes(i,d);for(i+=d;h--;){let f=this.file.getUintBytes(i,l);i+=l+u+2+o;let m=this.file.getUint16(i);if(i+=2,f===t)return m>1&&console.warn(`ILOC box has more than one extent but we're only processing one
Please create an issue at https://github.com/MikeKovarik/exifr with this file`),[this.file.getUintBytes(i+a,n),this.file.getUintBytes(i+a+n,s)];i+=m*c}}},ff=class extends df{};it(ff,"type","heic");var hf=class extends df{};it(hf,"type","avif"),on.set("heic",ff),on.set("avif",hf),ri(_i,["ifd0","ifd1"],[[256,"ImageWidth"],[257,"ImageHeight"],[258,"BitsPerSample"],[259,"Compression"],[262,"PhotometricInterpretation"],[270,"ImageDescription"],[271,"Make"],[272,"Model"],[273,"StripOffsets"],[274,"Orientation"],[277,"SamplesPerPixel"],[278,"RowsPerStrip"],[279,"StripByteCounts"],[282,"XResolution"],[283,"YResolution"],[284,"PlanarConfiguration"],[296,"ResolutionUnit"],[301,"TransferFunction"],[305,"Software"],[306,"ModifyDate"],[315,"Artist"],[316,"HostComputer"],[317,"Predictor"],[318,"WhitePoint"],[319,"PrimaryChromaticities"],[513,"ThumbnailOffset"],[514,"ThumbnailLength"],[529,"YCbCrCoefficients"],[530,"YCbCrSubSampling"],[531,"YCbCrPositioning"],[532,"ReferenceBlackWhite"],[700,"ApplicationNotes"],[33432,"Copyright"],[33723,"IPTC"],[34665,"ExifIFD"],[34675,"ICC"],[34853,"GpsIFD"],[330,"SubIFD"],[40965,"InteropIFD"],[40091,"XPTitle"],[40092,"XPComment"],[40093,"XPAuthor"],[40094,"XPKeywords"],[40095,"XPSubject"]]),ri(_i,"exif",[[33434,"ExposureTime"],[33437,"FNumber"],[34850,"ExposureProgram"],[34852,"SpectralSensitivity"],[34855,"ISO"],[34858,"TimeZoneOffset"],[34859,"SelfTimerMode"],[34864,"SensitivityType"],[34865,"StandardOutputSensitivity"],[34866,"RecommendedExposureIndex"],[34867,"ISOSpeed"],[34868,"ISOSpeedLatitudeyyy"],[34869,"ISOSpeedLatitudezzz"],[36864,"ExifVersion"],[36867,"DateTimeOriginal"],[36868,"CreateDate"],[36873,"GooglePlusUploadCode"],[36880,"OffsetTime"],[36881,"OffsetTimeOriginal"],[36882,"OffsetTimeDigitized"],[37121,"ComponentsConfiguration"],[37122,"CompressedBitsPerPixel"],[37377,"ShutterSpeedValue"],[37378,"ApertureValue"],[37379,"BrightnessValue"],[37380,"ExposureCompensation"],[37381,"MaxApertureValue"],[37382,"SubjectDistance"],[37383,"MeteringMode"],[37384,"LightSource"],[37385,"Flash"],[37386,"FocalLength"],[37393,"ImageNumber"],[37394,"SecurityClassification"],[37395,"ImageHistory"],[37396,"SubjectArea"],[37500,"MakerNote"],[37510,"UserComment"],[37520,"SubSecTime"],[37521,"SubSecTimeOriginal"],[37522,"SubSecTimeDigitized"],[37888,"AmbientTemperature"],[37889,"Humidity"],[37890,"Pressure"],[37891,"WaterDepth"],[37892,"Acceleration"],[37893,"CameraElevationAngle"],[40960,"FlashpixVersion"],[40961,"ColorSpace"],[40962,"ExifImageWidth"],[40963,"ExifImageHeight"],[40964,"RelatedSoundFile"],[41483,"FlashEnergy"],[41486,"FocalPlaneXResolution"],[41487,"FocalPlaneYResolution"],[41488,"FocalPlaneResolutionUnit"],[41492,"SubjectLocation"],[41493,"ExposureIndex"],[41495,"SensingMethod"],[41728,"FileSource"],[41729,"SceneType"],[41730,"CFAPattern"],[41985,"CustomRendered"],[41986,"ExposureMode"],[41987,"WhiteBalance"],[41988,"DigitalZoomRatio"],[41989,"FocalLengthIn35mmFormat"],[41990,"SceneCaptureType"],[41991,"GainControl"],[41992,"Contrast"],[41993,"Saturation"],[41994,"Sharpness"],[41996,"SubjectDistanceRange"],[42016,"ImageUniqueID"],[42032,"OwnerName"],[42033,"SerialNumber"],[42034,"LensInfo"],[42035,"LensMake"],[42036,"LensModel"],[42037,"LensSerialNumber"],[42080,"CompositeImage"],[42081,"CompositeImageCount"],[42082,"CompositeImageExposureTimes"],[42240,"Gamma"],[59932,"Padding"],[59933,"OffsetSchema"],[65e3,"OwnerName"],[65001,"SerialNumber"],[65002,"Lens"],[65100,"RawFile"],[65101,"Converter"],[65102,"WhiteBalance"],[65105,"Exposure"],[65106,"Shadows"],[65107,"Brightness"],[65108,"Contrast"],[65109,"Saturation"],[65110,"Sharpness"],[65111,"Smoothness"],[65112,"MoireFilter"],[40965,"InteropIFD"]]),ri(_i,"gps",[[0,"GPSVersionID"],[1,"GPSLatitudeRef"],[2,"GPSLatitude"],[3,"GPSLongitudeRef"],[4,"GPSLongitude"],[5,"GPSAltitudeRef"],[6,"GPSAltitude"],[7,"GPSTimeStamp"],[8,"GPSSatellites"],[9,"GPSStatus"],[10,"GPSMeasureMode"],[11,"GPSDOP"],[12,"GPSSpeedRef"],[13,"GPSSpeed"],[14,"GPSTrackRef"],[15,"GPSTrack"],[16,"GPSImgDirectionRef"],[17,"GPSImgDirection"],[18,"GPSMapDatum"],[19,"GPSDestLatitudeRef"],[20,"GPSDestLatitude"],[21,"GPSDestLongitudeRef"],[22,"GPSDestLongitude"],[23,"GPSDestBearingRef"],[24,"GPSDestBearing"],[25,"GPSDestDistanceRef"],[26,"GPSDestDistance"],[27,"GPSProcessingMethod"],[28,"GPSAreaInformation"],[29,"GPSDateStamp"],[30,"GPSDifferential"],[31,"GPSHPositioningError"]]),ri(Or,["ifd0","ifd1"],[[274,{1:"Horizontal (normal)",2:"Mirror horizontal",3:"Rotate 180",4:"Mirror vertical",5:"Mirror horizontal and rotate 270 CW",6:"Rotate 90 CW",7:"Mirror horizontal and rotate 90 CW",8:"Rotate 270 CW"}],[296,{1:"None",2:"inches",3:"cm"}]]);var Gu=ri(Or,"exif",[[34850,{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"}],[37121,{0:"-",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}],[37383,{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"}],[37384,{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"}],[37385,{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"}],[41495,{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"}],[41728,{1:"Film Scanner",2:"Reflection Print Scanner",3:"Digital Camera"}],[41729,{1:"Directly photographed"}],[41985,{0:"Normal",1:"Custom",2:"HDR (no original saved)",3:"HDR (original saved)",4:"Original (for HDR)",6:"Panorama",7:"Portrait HDR",8:"Portrait"}],[41986,{0:"Auto",1:"Manual",2:"Auto bracket"}],[41987,{0:"Auto",1:"Manual"}],[41990,{0:"Standard",1:"Landscape",2:"Portrait",3:"Night",4:"Other"}],[41991,{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"}],[41996,{0:"Unknown",1:"Macro",2:"Close",3:"Distant"}],[42080,{0:"Unknown",1:"Not a Composite Image",2:"General Composite Image",3:"Composite Image Captured While Shooting"}]]),bk={1:"No absolute unit of measurement",2:"Inch",3:"Centimeter"};Gu.set(37392,bk),Gu.set(41488,bk);var ig={0:"Normal",1:"Low",2:"High"};function yk(r){return typeof r=="object"&&r.length!==void 0?r[0]:r}function vk(r){let e=Array.from(r).slice(1);return e[1]>15&&(e=e.map(t=>String.fromCharCode(t))),e[2]!=="0"&&e[2]!==0||e.pop(),e.join(".")}function rg(r){if(typeof r=="string"){var[e,t,i,n,s,o]=r.trim().split(/[-: ]/g).map(Number),a=new Date(e,t-1,i);return Number.isNaN(n)||Number.isNaN(s)||Number.isNaN(o)||(a.setHours(n),a.setMinutes(s),a.setSeconds(o)),Number.isNaN(+a)?r:a}}function ju(r){if(typeof r=="string")return r;let e=[];if(r[1]===0&&r[r.length-1]===0)for(let t=0;t<r.length;t+=2)e.push(wk(r[t+1],r[t]));else for(let t=0;t<r.length;t+=2)e.push(wk(r[t],r[t+1]));return to(String.fromCodePoint(...e))}function wk(r,e){return r<<8|e}Gu.set(41992,ig),Gu.set(41993,ig),Gu.set(41994,ig),ri(us,["ifd0","ifd1"],[[50827,function(r){return typeof r!="string"?Sk(r):r}],[306,rg],[40091,ju],[40092,ju],[40093,ju],[40094,ju],[40095,ju]]),ri(us,"exif",[[40960,vk],[36864,vk],[36867,rg],[36868,rg],[40962,yk],[40963,yk]]),ri(us,"gps",[[0,r=>Array.from(r).join(".")],[7,r=>Array.from(r).join(":")]]);var zu=class extends or{static canHandle(e,t){return e.getUint8(t+1)===225&&e.getUint32(t+4)===1752462448&&e.getString(t+4,20)==="http://ns.adobe.com/"}static headerLength(e,t){return e.getString(t+4,34)==="http://ns.adobe.com/xmp/extension/"?79:33}static findPosition(e,t){let i=super.findPosition(e,t);return i.multiSegment=i.extended=i.headerLength===79,i.multiSegment?(i.chunkCount=e.getUint8(t+72),i.chunkNumber=e.getUint8(t+76),e.getUint8(t+77)!==0&&i.chunkNumber++):(i.chunkCount=1/0,i.chunkNumber=-1),i}static handleMultiSegments(e){return e.map(t=>t.chunk.getString()).join("")}normalizeInput(e){return typeof e=="string"?e:sn.from(e).getString()}parse(e=this.chunk){if(!this.localOptions.parse)return e;e=function(s){let o={},a={};for(let l of Rk)o[l]=[],a[l]=0;return s.replace(DR,(l,u,c)=>{if(u==="<"){let d=++a[c];return o[c].push(d),`${l}#${d}`}return`${l}#${o[c].pop()}`})}(e);let t=pf.findAll(e,"rdf","Description");t.length===0&&t.push(new pf("rdf","Description",void 0,e));let i,n={};for(let s of t)for(let o of s.properties)i=TR(o.ns,n),Tk(o,i);return function(s){let o;for(let a in s)o=s[a]=af(s[a]),o===void 0&&delete s[a];return af(s)}(n)}assignToOutput(e,t){if(this.localOptions.parse)for(let[i,n]of Object.entries(t))switch(i){case"tiff":this.assignObjectToOutput(e,"ifd0",n);break;case"exif":this.assignObjectToOutput(e,"exif",n);break;case"xmlns":break;default:this.assignObjectToOutput(e,i,n)}else e.xmp=t}};it(zu,"type","xmp"),it(zu,"multiSegment",!0),fi.set("xmp",zu);var pg=class r{static findAll(e){return Dk(e,/([a-zA-Z0-9-]+):([a-zA-Z0-9-]+)=("[^"]*"|'[^']*')/gm).map(r.unpackMatch)}static unpackMatch(e){let t=e[1],i=e[2],n=e[3].slice(1,-1);return n=Ak(n),new r(t,i,n)}constructor(e,t,i){this.ns=e,this.name=t,this.value=i}serialize(){return this.value}},pf=class r{static findAll(e,t,i){if(t!==void 0||i!==void 0){t=t||"[\\w\\d-]+",i=i||"[\\w\\d-]+";var n=new RegExp(`<(${t}):(${i})(#\\d+)?((\\s+?[\\w\\d-:]+=("[^"]*"|'[^']*'))*\\s*)(\\/>|>([\\s\\S]*?)<\\/\\1:\\2\\3>)`,"gm")}else n=/<([\w\d-]+):([\w\d-]+)(#\d+)?((\s+?[\w\d-:]+=("[^"]*"|'[^']*'))*\s*)(\/>|>([\s\S]*?)<\/\1:\2\3>)/gm;return Dk(e,n).map(r.unpackMatch)}static unpackMatch(e){let t=e[1],i=e[2],n=e[4],s=e[8];return new r(t,i,n,s)}constructor(e,t,i,n){this.ns=e,this.name=t,this.attrString=i,this.innerXml=n,this.attrs=pg.findAll(i),this.children=r.findAll(n),this.value=this.children.length===0?Ak(n):void 0,this.properties=[...this.attrs,...this.children]}get isPrimitive(){return this.value!==void 0&&this.attrs.length===0&&this.children.length===0}get isListContainer(){return this.children.length===1&&this.children[0].isList}get isList(){let{ns:e,name:t}=this;return e==="rdf"&&(t==="Seq"||t==="Bag"||t==="Alt")}get isListItem(){return this.ns==="rdf"&&this.name==="li"}serialize(){if(this.properties.length===0&&this.value===void 0)return;if(this.isPrimitive)return this.value;if(this.isListContainer)return this.children[0].serialize();if(this.isList)return xR(this.children.map(IR));if(this.isListItem&&this.children.length===1&&this.attrs.length===0)return this.children[0].serialize();let e={};for(let t of this.properties)Tk(t,e);return this.value!==void 0&&(e.value=this.value),af(e)}};function Tk(r,e){let t=r.serialize();t!==void 0&&(e[r.name]=t)}var IR=r=>r.serialize(),xR=r=>r.length===1?r[0]:r,TR=(r,e)=>e[r]?e[r]:e[r]={};function Dk(r,e){let t,i=[];if(!r)return i;for(;(t=e.exec(r))!==null;)i.push(t);return i}function Ak(r){if(function(i){return i==null||i==="null"||i==="undefined"||i===""||i.trim()===""}(r))return;let e=Number(r);if(!Number.isNaN(e))return e;let t=r.toLowerCase();return t==="true"||t!=="false"&&r.trim()}var Rk=["rdf:li","rdf:Seq","rdf:Bag","rdf:Alt","rdf:Description"],DR=new RegExp(`(<|\\/)(${Rk.join("|")})`,"g"),EX=Object.freeze({__proto__:null,default:ER,Exifr:wr,fileParsers:on,segmentParsers:fi,fileReaders:an,tagKeys:_i,tagValues:Or,tagRevivers:us,createDictionary:ri,extendDictionary:oo,fetchUrlAsArrayBuffer:no,readBlobAsArrayBuffer:so,chunkedProps:ss,otherSegments:Qo,segments:ao,tiffBlocks:Yt,segmentsAndBlocks:os,tiffExtractables:as,inheritables:ea,allFormatters:ls,Options:En,parse:_f,gpsOnlyOptions:bg,gps:Pk,thumbnailOnlyOptions:yg,thumbnail:Ek,thumbnailUrl:Ik,orientationOnlyOptions:vg,orientation:wg,rotations:_g,get rotateCanvas(){return io},get rotateCss(){return ro},rotation:xk});var _k=of("fs",r=>r.promises);an.set("fs",class extends Yo{async readWhole(){this.chunked=!1,this.fs=await _k;let r=await this.fs.readFile(this.input);this._swapBuffer(r)}async readChunked(){this.chunked=!0,this.fs=await _k,await this.open(),await this.readChunk(0,this.options.firstChunkSize)}async open(){this.fh===void 0&&(this.fh=await this.fs.open(this.input,"r"),this.size=(await this.fh.stat(this.input)).size)}async _readChunk(r,e){this.fh===void 0&&await this.open(),r+e>this.size&&(e=this.size-r);var t=this.subarray(r,e,!0);return await this.fh.read(t.dataView,0,e,r),t}async close(){if(this.fh){let r=this.fh;this.fh=void 0,await r.close()}}});an.set("base64",class extends Yo{constructor(...r){super(...r),this.input=this.input.replace(/^data:([^;]+);base64,/gim,""),this.size=this.input.length/4*3,this.input.endsWith("==")?this.size-=2:this.input.endsWith("=")&&(this.size-=1)}async _readChunk(r,e){let t,i,n=this.input;r===void 0?(r=0,t=0,i=0):(t=4*Math.floor(r/3),i=r-t/4*3),e===void 0&&(e=this.size);let s=r+e,o=t+4*Math.ceil(s/3);n=n.slice(t,o);let a=Math.min(e,this.size-r);if(wf){let l=vf.from(n,"base64").slice(i,i+a);return this.set(l,r,!0)}{let l=this.subarray(r,a,!0),u=atob(n),c=l.toUint8();for(let d=0;d<a;d++)c[d]=u.charCodeAt(i+d);return l}}});var mf=class extends Zo{static canHandle(e,t){return t===18761||t===19789}extendOptions(e){let{ifd0:t,xmp:i,iptc:n,icc:s}=e;i.enabled&&t.deps.add(700),n.enabled&&t.deps.add(33723),s.enabled&&t.deps.add(34675),t.finalizeFilters()}async parse(){let{tiff:e,xmp:t,iptc:i,icc:n}=this.options;if(e.enabled||t.enabled||i.enabled||n.enabled){let s=Math.max(ng(this.options),this.options.chunkSize);await this.file.ensureChunk(0,s),this.createParser("tiff",this.file),this.parsers.tiff.parseHeader(),await this.parsers.tiff.parseIfd0Block(),this.adaptTiffPropAsSegment("xmp"),this.adaptTiffPropAsSegment("iptc"),this.adaptTiffPropAsSegment("icc")}}adaptTiffPropAsSegment(e){if(this.parsers.tiff[e]){let t=this.parsers.tiff[e];this.injectSegment(e,t)}}};it(mf,"type","tiff"),on.set("tiff",mf);var AR=of("zlib"),RR=["ihdr","iccp","text","itxt","exif"],gf=class extends Zo{constructor(...e){super(...e),it(this,"catchError",t=>this.errors.push(t)),it(this,"metaChunks",[]),it(this,"unknownChunks",[])}static canHandle(e,t){return t===35152&&e.getUint32(0)===2303741511&&e.getUint32(4)===218765834}async parse(){let{file:e}=this;await this.findPngChunksInRange(8,e.byteLength),await this.readSegments(this.metaChunks),this.findIhdr(),this.parseTextChunks(),await this.findExif().catch(this.catchError),await this.findXmp().catch(this.catchError),await this.findIcc().catch(this.catchError)}async findPngChunksInRange(e,t){let{file:i}=this;for(;e<t;){let n=i.getUint32(e),s=i.getUint32(e+4),o=i.getString(e+4,4).toLowerCase(),a=n+4+4+4,l={type:o,offset:e,length:a,start:e+4+4,size:n,marker:s};RR.includes(o)?this.metaChunks.push(l):this.unknownChunks.push(l),e+=a}}parseTextChunks(){let e=this.metaChunks.filter(t=>t.type==="text");for(let t of e){let[i,n]=this.file.getString(t.start,t.size).split("\0");this.injectKeyValToIhdr(i,n)}}injectKeyValToIhdr(e,t){let i=this.parsers.ihdr;i&&i.raw.set(e,t)}findIhdr(){let e=this.metaChunks.find(t=>t.type==="ihdr");e&&this.options.ihdr.enabled!==!1&&this.createParser("ihdr",e.chunk)}async findExif(){let e=this.metaChunks.find(t=>t.type==="exif");e&&this.injectSegment("tiff",e.chunk)}async findXmp(){let e=this.metaChunks.filter(t=>t.type==="itxt");for(let t of e)t.chunk.getString(0,17)==="XML:com.adobe.xmp"&&this.injectSegment("xmp",t.chunk)}async findIcc(){let e=this.metaChunks.find(a=>a.type==="iccp");if(!e)return;let{chunk:t}=e,i=t.getUint8Array(0,81),n=0;for(;n<80&&i[n]!==0;)n++;let s=n+2,o=t.getString(0,n);if(this.injectKeyValToIhdr("ProfileName",o),sf){let a=await AR,l=t.getUint8Array(s);l=a.inflateSync(l),this.injectSegment("icc",l)}}};it(gf,"type","png"),on.set("png",gf),ri(_i,"interop",[[1,"InteropIndex"],[2,"InteropVersion"],[4096,"RelatedImageFileFormat"],[4097,"RelatedImageWidth"],[4098,"RelatedImageHeight"]]),oo(_i,"ifd0",[[11,"ProcessingSoftware"],[254,"SubfileType"],[255,"OldSubfileType"],[263,"Thresholding"],[264,"CellWidth"],[265,"CellLength"],[266,"FillOrder"],[269,"DocumentName"],[280,"MinSampleValue"],[281,"MaxSampleValue"],[285,"PageName"],[286,"XPosition"],[287,"YPosition"],[290,"GrayResponseUnit"],[297,"PageNumber"],[321,"HalftoneHints"],[322,"TileWidth"],[323,"TileLength"],[332,"InkSet"],[337,"TargetPrinter"],[18246,"Rating"],[18249,"RatingPercent"],[33550,"PixelScale"],[34264,"ModelTransform"],[34377,"PhotoshopSettings"],[50706,"DNGVersion"],[50707,"DNGBackwardVersion"],[50708,"UniqueCameraModel"],[50709,"LocalizedCameraModel"],[50736,"DNGLensInfo"],[50739,"ShadowScale"],[50740,"DNGPrivateData"],[33920,"IntergraphMatrix"],[33922,"ModelTiePoint"],[34118,"SEMInfo"],[34735,"GeoTiffDirectory"],[34736,"GeoTiffDoubleParams"],[34737,"GeoTiffAsciiParams"],[50341,"PrintIM"],[50721,"ColorMatrix1"],[50722,"ColorMatrix2"],[50723,"CameraCalibration1"],[50724,"CameraCalibration2"],[50725,"ReductionMatrix1"],[50726,"ReductionMatrix2"],[50727,"AnalogBalance"],[50728,"AsShotNeutral"],[50729,"AsShotWhiteXY"],[50730,"BaselineExposure"],[50731,"BaselineNoise"],[50732,"BaselineSharpness"],[50734,"LinearResponseLimit"],[50735,"CameraSerialNumber"],[50741,"MakerNoteSafety"],[50778,"CalibrationIlluminant1"],[50779,"CalibrationIlluminant2"],[50781,"RawDataUniqueID"],[50827,"OriginalRawFileName"],[50828,"OriginalRawFileData"],[50831,"AsShotICCProfile"],[50832,"AsShotPreProfileMatrix"],[50833,"CurrentICCProfile"],[50834,"CurrentPreProfileMatrix"],[50879,"ColorimetricReference"],[50885,"SRawType"],[50898,"PanasonicTitle"],[50899,"PanasonicTitle2"],[50931,"CameraCalibrationSig"],[50932,"ProfileCalibrationSig"],[50933,"ProfileIFD"],[50934,"AsShotProfileName"],[50936,"ProfileName"],[50937,"ProfileHueSatMapDims"],[50938,"ProfileHueSatMapData1"],[50939,"ProfileHueSatMapData2"],[50940,"ProfileToneCurve"],[50941,"ProfileEmbedPolicy"],[50942,"ProfileCopyright"],[50964,"ForwardMatrix1"],[50965,"ForwardMatrix2"],[50966,"PreviewApplicationName"],[50967,"PreviewApplicationVersion"],[50968,"PreviewSettingsName"],[50969,"PreviewSettingsDigest"],[50970,"PreviewColorSpace"],[50971,"PreviewDateTime"],[50972,"RawImageDigest"],[50973,"OriginalRawFileDigest"],[50981,"ProfileLookTableDims"],[50982,"ProfileLookTableData"],[51043,"TimeCodes"],[51044,"FrameRate"],[51058,"TStop"],[51081,"ReelName"],[51089,"OriginalDefaultFinalSize"],[51090,"OriginalBestQualitySize"],[51091,"OriginalDefaultCropSize"],[51105,"CameraLabel"],[51107,"ProfileHueSatMapEncoding"],[51108,"ProfileLookTableEncoding"],[51109,"BaselineExposureOffset"],[51110,"DefaultBlackRender"],[51111,"NewRawImageDigest"],[51112,"RawToPreviewGain"]]);var Fk=[[273,"StripOffsets"],[279,"StripByteCounts"],[288,"FreeOffsets"],[289,"FreeByteCounts"],[291,"GrayResponseCurve"],[292,"T4Options"],[293,"T6Options"],[300,"ColorResponseUnit"],[320,"ColorMap"],[324,"TileOffsets"],[325,"TileByteCounts"],[326,"BadFaxLines"],[327,"CleanFaxData"],[328,"ConsecutiveBadFaxLines"],[330,"SubIFD"],[333,"InkNames"],[334,"NumberofInks"],[336,"DotRange"],[338,"ExtraSamples"],[339,"SampleFormat"],[340,"SMinSampleValue"],[341,"SMaxSampleValue"],[342,"TransferRange"],[343,"ClipPath"],[344,"XClipPathUnits"],[345,"YClipPathUnits"],[346,"Indexed"],[347,"JPEGTables"],[351,"OPIProxy"],[400,"GlobalParametersIFD"],[401,"ProfileType"],[402,"FaxProfile"],[403,"CodingMethods"],[404,"VersionYear"],[405,"ModeNumber"],[433,"Decode"],[434,"DefaultImageColor"],[435,"T82Options"],[437,"JPEGTables"],[512,"JPEGProc"],[515,"JPEGRestartInterval"],[517,"JPEGLosslessPredictors"],[518,"JPEGPointTransforms"],[519,"JPEGQTables"],[520,"JPEGDCTables"],[521,"JPEGACTables"],[559,"StripRowCounts"],[999,"USPTOMiscellaneous"],[18247,"XP_DIP_XML"],[18248,"StitchInfo"],[28672,"SonyRawFileType"],[28688,"SonyToneCurve"],[28721,"VignettingCorrection"],[28722,"VignettingCorrParams"],[28724,"ChromaticAberrationCorrection"],[28725,"ChromaticAberrationCorrParams"],[28726,"DistortionCorrection"],[28727,"DistortionCorrParams"],[29895,"SonyCropTopLeft"],[29896,"SonyCropSize"],[32781,"ImageID"],[32931,"WangTag1"],[32932,"WangAnnotation"],[32933,"WangTag3"],[32934,"WangTag4"],[32953,"ImageReferencePoints"],[32954,"RegionXformTackPoint"],[32955,"WarpQuadrilateral"],[32956,"AffineTransformMat"],[32995,"Matteing"],[32996,"DataType"],[32997,"ImageDepth"],[32998,"TileDepth"],[33300,"ImageFullWidth"],[33301,"ImageFullHeight"],[33302,"TextureFormat"],[33303,"WrapModes"],[33304,"FovCot"],[33305,"MatrixWorldToScreen"],[33306,"MatrixWorldToCamera"],[33405,"Model2"],[33421,"CFARepeatPatternDim"],[33422,"CFAPattern2"],[33423,"BatteryLevel"],[33424,"KodakIFD"],[33445,"MDFileTag"],[33446,"MDScalePixel"],[33447,"MDColorTable"],[33448,"MDLabName"],[33449,"MDSampleInfo"],[33450,"MDPrepDate"],[33451,"MDPrepTime"],[33452,"MDFileUnits"],[33589,"AdventScale"],[33590,"AdventRevision"],[33628,"UIC1Tag"],[33629,"UIC2Tag"],[33630,"UIC3Tag"],[33631,"UIC4Tag"],[33918,"IntergraphPacketData"],[33919,"IntergraphFlagRegisters"],[33921,"INGRReserved"],[34016,"Site"],[34017,"ColorSequence"],[34018,"IT8Header"],[34019,"RasterPadding"],[34020,"BitsPerRunLength"],[34021,"BitsPerExtendedRunLength"],[34022,"ColorTable"],[34023,"ImageColorIndicator"],[34024,"BackgroundColorIndicator"],[34025,"ImageColorValue"],[34026,"BackgroundColorValue"],[34027,"PixelIntensityRange"],[34028,"TransparencyIndicator"],[34029,"ColorCharacterization"],[34030,"HCUsage"],[34031,"TrapIndicator"],[34032,"CMYKEquivalent"],[34152,"AFCP_IPTC"],[34232,"PixelMagicJBIGOptions"],[34263,"JPLCartoIFD"],[34306,"WB_GRGBLevels"],[34310,"LeafData"],[34687,"TIFF_FXExtensions"],[34688,"MultiProfiles"],[34689,"SharedData"],[34690,"T88Options"],[34732,"ImageLayer"],[34750,"JBIGOptions"],[34856,"Opto-ElectricConvFactor"],[34857,"Interlace"],[34908,"FaxRecvParams"],[34909,"FaxSubAddress"],[34910,"FaxRecvTime"],[34929,"FedexEDR"],[34954,"LeafSubIFD"],[37387,"FlashEnergy"],[37388,"SpatialFrequencyResponse"],[37389,"Noise"],[37390,"FocalPlaneXResolution"],[37391,"FocalPlaneYResolution"],[37392,"FocalPlaneResolutionUnit"],[37397,"ExposureIndex"],[37398,"TIFF-EPStandardID"],[37399,"SensingMethod"],[37434,"CIP3DataFile"],[37435,"CIP3Sheet"],[37436,"CIP3Side"],[37439,"StoNits"],[37679,"MSDocumentText"],[37680,"MSPropertySetStorage"],[37681,"MSDocumentTextPosition"],[37724,"ImageSourceData"],[40965,"InteropIFD"],[40976,"SamsungRawPointersOffset"],[40977,"SamsungRawPointersLength"],[41217,"SamsungRawByteOrder"],[41218,"SamsungRawUnknown"],[41484,"SpatialFrequencyResponse"],[41485,"Noise"],[41489,"ImageNumber"],[41490,"SecurityClassification"],[41491,"ImageHistory"],[41494,"TIFF-EPStandardID"],[41995,"DeviceSettingDescription"],[42112,"GDALMetadata"],[42113,"GDALNoData"],[44992,"ExpandSoftware"],[44993,"ExpandLens"],[44994,"ExpandFilm"],[44995,"ExpandFilterLens"],[44996,"ExpandScanner"],[44997,"ExpandFlashLamp"],[46275,"HasselbladRawImage"],[48129,"PixelFormat"],[48130,"Transformation"],[48131,"Uncompressed"],[48132,"ImageType"],[48256,"ImageWidth"],[48257,"ImageHeight"],[48258,"WidthResolution"],[48259,"HeightResolution"],[48320,"ImageOffset"],[48321,"ImageByteCount"],[48322,"AlphaOffset"],[48323,"AlphaByteCount"],[48324,"ImageDataDiscard"],[48325,"AlphaDataDiscard"],[50215,"OceScanjobDesc"],[50216,"OceApplicationSelector"],[50217,"OceIDNumber"],[50218,"OceImageLogic"],[50255,"Annotations"],[50459,"HasselbladExif"],[50547,"OriginalFileName"],[50560,"USPTOOriginalContentType"],[50656,"CR2CFAPattern"],[50710,"CFAPlaneColor"],[50711,"CFALayout"],[50712,"LinearizationTable"],[50713,"BlackLevelRepeatDim"],[50714,"BlackLevel"],[50715,"BlackLevelDeltaH"],[50716,"BlackLevelDeltaV"],[50717,"WhiteLevel"],[50718,"DefaultScale"],[50719,"DefaultCropOrigin"],[50720,"DefaultCropSize"],[50733,"BayerGreenSplit"],[50737,"ChromaBlurRadius"],[50738,"AntiAliasStrength"],[50752,"RawImageSegmentation"],[50780,"BestQualityScale"],[50784,"AliasLayerMetadata"],[50829,"ActiveArea"],[50830,"MaskedAreas"],[50935,"NoiseReductionApplied"],[50974,"SubTileBlockSize"],[50975,"RowInterleaveFactor"],[51008,"OpcodeList1"],[51009,"OpcodeList2"],[51022,"OpcodeList3"],[51041,"NoiseProfile"],[51114,"CacheVersion"],[51125,"DefaultUserCrop"],[51157,"NikonNEFInfo"],[65024,"KdcIFD"]];oo(_i,"ifd0",Fk),oo(_i,"exif",Fk),ri(Or,"gps",[[23,{M:"Magnetic North",T:"True North"}],[25,{K:"Kilometers",M:"Miles",N:"Nautical Miles"}]]);var Vu=class extends or{static canHandle(e,t){return e.getUint8(t+1)===224&&e.getUint32(t+4)===1246120262&&e.getUint8(t+8)===0}parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint16(0)],[2,this.chunk.getUint8(2)],[3,this.chunk.getUint16(3)],[5,this.chunk.getUint16(5)],[7,this.chunk.getUint8(7)],[8,this.chunk.getUint8(8)]])}};it(Vu,"type","jfif"),it(Vu,"headerLength",9),fi.set("jfif",Vu),ri(_i,"jfif",[[0,"JFIFVersion"],[2,"ResolutionUnit"],[3,"XResolution"],[5,"YResolution"],[7,"ThumbnailWidth"],[8,"ThumbnailHeight"]]);var bf=class extends or{parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint32(0)],[4,this.chunk.getUint32(4)],[8,this.chunk.getUint8(8)],[9,this.chunk.getUint8(9)],[10,this.chunk.getUint8(10)],[11,this.chunk.getUint8(11)],[12,this.chunk.getUint8(12)],...Array.from(this.raw)])}};it(bf,"type","ihdr"),fi.set("ihdr",bf),ri(_i,"ihdr",[[0,"ImageWidth"],[4,"ImageHeight"],[8,"BitDepth"],[9,"ColorType"],[10,"Compression"],[11,"Filter"],[12,"Interlace"]]),ri(Or,"ihdr",[[9,{0:"Grayscale",2:"RGB",3:"Palette",4:"Grayscale with Alpha",6:"RGB with Alpha",DEFAULT:"Unknown"}],[10,{0:"Deflate/Inflate",DEFAULT:"Unknown"}],[11,{0:"Adaptive",DEFAULT:"Unknown"}],[12,{0:"Noninterlaced",1:"Adam7 Interlace",DEFAULT:"Unknown"}]]);var Xo=class extends or{static canHandle(e,t){return e.getUint8(t+1)===226&&e.getUint32(t+4)===1229144927}static findPosition(e,t){let i=super.findPosition(e,t);return i.chunkNumber=e.getUint8(t+16),i.chunkCount=e.getUint8(t+17),i.multiSegment=i.chunkCount>1,i}static handleMultiSegments(e){return function(t){let i=function(n){let s=n[0].constructor,o=0;for(let u of n)o+=u.length;let a=new s(o),l=0;for(let u of n)a.set(u,l),l+=u.length;return a}(t.map(n=>n.chunk.toUint8()));return new sn(i)}(e)}parse(){return this.raw=new Map,this.parseHeader(),this.parseTags(),this.translate(),this.output}parseHeader(){let{raw:e}=this;this.chunk.byteLength<84&&hi("ICC header is too short");for(let[t,i]of Object.entries(BR)){t=parseInt(t,10);let n=i(this.chunk,t);n!=="\0\0\0\0"&&e.set(t,n)}}parseTags(){let e,t,i,n,s,{raw:o}=this,a=this.chunk.getUint32(128),l=132,u=this.chunk.byteLength;for(;a--;){if(e=this.chunk.getString(l,4),t=this.chunk.getUint32(l+4),i=this.chunk.getUint32(l+8),n=this.chunk.getString(t,4),t+i>u)return void console.warn("reached the end of the first ICC chunk. Enable options.tiff.multiSegment to read all ICC segments.");s=this.parseTag(n,t,i),s!==void 0&&s!=="\0\0\0\0"&&o.set(e,s),l+=12}}parseTag(e,t,i){switch(e){case"desc":return this.parseDesc(t);case"mluc":return this.parseMluc(t);case"text":return this.parseText(t,i);case"sig ":return this.parseSig(t)}if(!(t+i>this.chunk.byteLength))return this.chunk.getUint8Array(t,i)}parseDesc(e){let t=this.chunk.getUint32(e+8)-1;return to(this.chunk.getString(e+12,t))}parseText(e,t){return to(this.chunk.getString(e+8,t-8))}parseSig(e){return to(this.chunk.getString(e+8,4))}parseMluc(e){let{chunk:t}=this,i=t.getUint32(e+8),n=t.getUint32(e+12),s=e+16,o=[];for(let a=0;a<i;a++){let l=t.getString(s+0,2),u=t.getString(s+2,2),c=t.getUint32(s+4),d=t.getUint32(s+8)+e,h=to(t.getUnicodeString(d,c));o.push({lang:l,country:u,text:h}),s+=n}return i===1?o[0].text:o}translateValue(e,t){return typeof e=="string"?t[e]||t[e.toLowerCase()]||e:t[e]||e}};it(Xo,"type","icc"),it(Xo,"multiSegment",!0),it(Xo,"headerLength",18);var BR={4:Pn,8:function(r,e){return[r.getUint8(e),r.getUint8(e+1)>>4,r.getUint8(e+1)%16].map(t=>t.toString(10)).join(".")},12:Pn,16:Pn,20:Pn,24:function(r,e){let t=r.getUint16(e),i=r.getUint16(e+2)-1,n=r.getUint16(e+4),s=r.getUint16(e+6),o=r.getUint16(e+8),a=r.getUint16(e+10);return new Date(Date.UTC(t,i,n,s,o,a))},36:Pn,40:Pn,48:Pn,52:Pn,64:(r,e)=>r.getUint32(e),80:Pn};function Pn(r,e){return to(r.getString(e,4))}fi.set("icc",Xo),ri(_i,"icc",[[4,"ProfileCMMType"],[8,"ProfileVersion"],[12,"ProfileClass"],[16,"ColorSpaceData"],[20,"ProfileConnectionSpace"],[24,"ProfileDateTime"],[36,"ProfileFileSignature"],[40,"PrimaryPlatform"],[44,"CMMFlags"],[48,"DeviceManufacturer"],[52,"DeviceModel"],[56,"DeviceAttributes"],[64,"RenderingIntent"],[68,"ConnectionSpaceIlluminant"],[80,"ProfileCreator"],[84,"ProfileID"],["Header","ProfileHeader"],["MS00","WCSProfiles"],["bTRC","BlueTRC"],["bXYZ","BlueMatrixColumn"],["bfd","UCRBG"],["bkpt","MediaBlackPoint"],["calt","CalibrationDateTime"],["chad","ChromaticAdaptation"],["chrm","Chromaticity"],["ciis","ColorimetricIntentImageState"],["clot","ColorantTableOut"],["clro","ColorantOrder"],["clrt","ColorantTable"],["cprt","ProfileCopyright"],["crdi","CRDInfo"],["desc","ProfileDescription"],["devs","DeviceSettings"],["dmdd","DeviceModelDesc"],["dmnd","DeviceMfgDesc"],["dscm","ProfileDescriptionML"],["fpce","FocalPlaneColorimetryEstimates"],["gTRC","GreenTRC"],["gXYZ","GreenMatrixColumn"],["gamt","Gamut"],["kTRC","GrayTRC"],["lumi","Luminance"],["meas","Measurement"],["meta","Metadata"],["mmod","MakeAndModel"],["ncl2","NamedColor2"],["ncol","NamedColor"],["ndin","NativeDisplayInfo"],["pre0","Preview0"],["pre1","Preview1"],["pre2","Preview2"],["ps2i","PS2RenderingIntent"],["ps2s","PostScript2CSA"],["psd0","PostScript2CRD0"],["psd1","PostScript2CRD1"],["psd2","PostScript2CRD2"],["psd3","PostScript2CRD3"],["pseq","ProfileSequenceDesc"],["psid","ProfileSequenceIdentifier"],["psvm","PS2CRDVMSize"],["rTRC","RedTRC"],["rXYZ","RedMatrixColumn"],["resp","OutputResponse"],["rhoc","ReflectionHardcopyOrigColorimetry"],["rig0","PerceptualRenderingIntentGamut"],["rig2","SaturationRenderingIntentGamut"],["rpoc","ReflectionPrintOutputColorimetry"],["sape","SceneAppearanceEstimates"],["scoe","SceneColorimetryEstimates"],["scrd","ScreeningDesc"],["scrn","Screening"],["targ","CharTarget"],["tech","Technology"],["vcgt","VideoCardGamma"],["view","ViewingConditions"],["vued","ViewingCondDesc"],["wtpt","MediaWhitePoint"]]);var nf={"4d2p":"Erdt Systems",AAMA:"Aamazing Technologies",ACER:"Acer",ACLT:"Acolyte Color Research",ACTI:"Actix Sytems",ADAR:"Adara Technology",ADBE:"Adobe",ADI:"ADI Systems",AGFA:"Agfa Graphics",ALMD:"Alps Electric",ALPS:"Alps Electric",ALWN:"Alwan Color Expertise",AMTI:"Amiable Technologies",AOC:"AOC International",APAG:"Apago",APPL:"Apple Computer",AST:"AST","AT&T":"AT&T",BAEL:"BARBIERI electronic",BRCO:"Barco NV",BRKP:"Breakpoint",BROT:"Brother",BULL:"Bull",BUS:"Bus Computer Systems","C-IT":"C-Itoh",CAMR:"Intel",CANO:"Canon",CARR:"Carroll Touch",CASI:"Casio",CBUS:"Colorbus PL",CEL:"Crossfield",CELx:"Crossfield",CGS:"CGS Publishing Technologies International",CHM:"Rochester Robotics",CIGL:"Colour Imaging Group, London",CITI:"Citizen",CL00:"Candela",CLIQ:"Color IQ",CMCO:"Chromaco",CMiX:"CHROMiX",COLO:"Colorgraphic Communications",COMP:"Compaq",COMp:"Compeq/Focus Technology",CONR:"Conrac Display Products",CORD:"Cordata Technologies",CPQ:"Compaq",CPRO:"ColorPro",CRN:"Cornerstone",CTX:"CTX International",CVIS:"ColorVision",CWC:"Fujitsu Laboratories",DARI:"Darius Technology",DATA:"Dataproducts",DCP:"Dry Creek Photo",DCRC:"Digital Contents Resource Center, Chung-Ang University",DELL:"Dell Computer",DIC:"Dainippon Ink and Chemicals",DICO:"Diconix",DIGI:"Digital","DL&C":"Digital Light & Color",DPLG:"Doppelganger",DS:"Dainippon Screen",DSOL:"DOOSOL",DUPN:"DuPont",EPSO:"Epson",ESKO:"Esko-Graphics",ETRI:"Electronics and Telecommunications Research Institute",EVER:"Everex Systems",EXAC:"ExactCODE",Eizo:"Eizo",FALC:"Falco Data Products",FF:"Fuji Photo Film",FFEI:"FujiFilm Electronic Imaging",FNRD:"Fnord Software",FORA:"Fora",FORE:"Forefront Technology",FP:"Fujitsu",FPA:"WayTech Development",FUJI:"Fujitsu",FX:"Fuji Xerox",GCC:"GCC Technologies",GGSL:"Global Graphics Software",GMB:"Gretagmacbeth",GMG:"GMG",GOLD:"GoldStar Technology",GOOG:"Google",GPRT:"Giantprint",GTMB:"Gretagmacbeth",GVC:"WayTech Development",GW2K:"Sony",HCI:"HCI",HDM:"Heidelberger Druckmaschinen",HERM:"Hermes",HITA:"Hitachi America",HP:"Hewlett-Packard",HTC:"Hitachi",HiTi:"HiTi Digital",IBM:"IBM",IDNT:"Scitex",IEC:"Hewlett-Packard",IIYA:"Iiyama North America",IKEG:"Ikegami Electronics",IMAG:"Image Systems",IMI:"Ingram Micro",INTC:"Intel",INTL:"N/A (INTL)",INTR:"Intra Electronics",IOCO:"Iocomm International Technology",IPS:"InfoPrint Solutions Company",IRIS:"Scitex",ISL:"Ichikawa Soft Laboratory",ITNL:"N/A (ITNL)",IVM:"IVM",IWAT:"Iwatsu Electric",Idnt:"Scitex",Inca:"Inca Digital Printers",Iris:"Scitex",JPEG:"Joint Photographic Experts Group",JSFT:"Jetsoft Development",JVC:"JVC Information Products",KART:"Scitex",KFC:"KFC Computek Components",KLH:"KLH Computers",KMHD:"Konica Minolta",KNCA:"Konica",KODA:"Kodak",KYOC:"Kyocera",Kart:"Scitex",LCAG:"Leica",LCCD:"Leeds Colour",LDAK:"Left Dakota",LEAD:"Leading Technology",LEXM:"Lexmark International",LINK:"Link Computer",LINO:"Linotronic",LITE:"Lite-On",Leaf:"Leaf",Lino:"Linotronic",MAGC:"Mag Computronic",MAGI:"MAG Innovision",MANN:"Mannesmann",MICN:"Micron Technology",MICR:"Microtek",MICV:"Microvitec",MINO:"Minolta",MITS:"Mitsubishi Electronics America",MITs:"Mitsuba",MNLT:"Minolta",MODG:"Modgraph",MONI:"Monitronix",MONS:"Monaco Systems",MORS:"Morse Technology",MOTI:"Motive Systems",MSFT:"Microsoft",MUTO:"MUTOH INDUSTRIES",Mits:"Mitsubishi Electric",NANA:"NANAO",NEC:"NEC",NEXP:"NexPress Solutions",NISS:"Nissei Sangyo America",NKON:"Nikon",NONE:"none",OCE:"Oce Technologies",OCEC:"OceColor",OKI:"Oki",OKID:"Okidata",OKIP:"Okidata",OLIV:"Olivetti",OLYM:"Olympus",ONYX:"Onyx Graphics",OPTI:"Optiquest",PACK:"Packard Bell",PANA:"Matsushita Electric Industrial",PANT:"Pantone",PBN:"Packard Bell",PFU:"PFU",PHIL:"Philips Consumer Electronics",PNTX:"HOYA",POne:"Phase One A/S",PREM:"Premier Computer Innovations",PRIN:"Princeton Graphic Systems",PRIP:"Princeton Publishing Labs",QLUX:"Hong Kong",QMS:"QMS",QPCD:"QPcard AB",QUAD:"QuadLaser",QUME:"Qume",RADI:"Radius",RDDx:"Integrated Color Solutions",RDG:"Roland DG",REDM:"REDMS Group",RELI:"Relisys",RGMS:"Rolf Gierling Multitools",RICO:"Ricoh",RNLD:"Edmund Ronald",ROYA:"Royal",RPC:"Ricoh Printing Systems",RTL:"Royal Information Electronics",SAMP:"Sampo",SAMS:"Samsung",SANT:"Jaime Santana Pomares",SCIT:"Scitex",SCRN:"Dainippon Screen",SDP:"Scitex",SEC:"Samsung",SEIK:"Seiko Instruments",SEIk:"Seikosha",SGUY:"ScanGuy.com",SHAR:"Sharp Laboratories",SICC:"International Color Consortium",SONY:"Sony",SPCL:"SpectraCal",STAR:"Star",STC:"Sampo Technology",Scit:"Scitex",Sdp:"Scitex",Sony:"Sony",TALO:"Talon Technology",TAND:"Tandy",TATU:"Tatung",TAXA:"TAXAN America",TDS:"Tokyo Denshi Sekei",TECO:"TECO Information Systems",TEGR:"Tegra",TEKT:"Tektronix",TI:"Texas Instruments",TMKR:"TypeMaker",TOSB:"Toshiba",TOSH:"Toshiba",TOTK:"TOTOKU ELECTRIC",TRIU:"Triumph",TSBT:"Toshiba",TTX:"TTX Computer Products",TVM:"TVM Professional Monitor",TW:"TW Casper",ULSX:"Ulead Systems",UNIS:"Unisys",UTZF:"Utz Fehlau & Sohn",VARI:"Varityper",VIEW:"Viewsonic",VISL:"Visual communication",VIVO:"Vivo Mobile Communication",WANG:"Wang",WLBR:"Wilbur Imaging",WTG2:"Ware To Go",WYSE:"WYSE Technology",XERX:"Xerox",XRIT:"X-Rite",ZRAN:"Zoran",Zebr:"Zebra Technologies",appl:"Apple Computer",bICC:"basICColor",berg:"bergdesign",ceyd:"Integrated Color Solutions",clsp:"MacDermid ColorSpan",ds:"Dainippon Screen",dupn:"DuPont",ffei:"FujiFilm Electronic Imaging",flux:"FluxData",iris:"Scitex",kart:"Scitex",lcms:"Little CMS",lino:"Linotronic",none:"none",ob4d:"Erdt Systems",obic:"Medigraph",quby:"Qubyx Sarl",scit:"Scitex",scrn:"Dainippon Screen",sdp:"Scitex",siwi:"SIWI GRAFIKA",yxym:"YxyMaster"},kk={scnr:"Scanner",mntr:"Monitor",prtr:"Printer",link:"Device Link",abst:"Abstract",spac:"Color Space Conversion Profile",nmcl:"Named Color",cenc:"ColorEncodingSpace profile",mid:"MultiplexIdentification profile",mlnk:"MultiplexLink profile",mvis:"MultiplexVisualization profile",nkpf:"Nikon Input Device Profile (NON-STANDARD!)"};ri(Or,"icc",[[4,nf],[12,kk],[40,Object.assign({},nf,kk)],[48,nf],[80,nf],[64,{0:"Perceptual",1:"Relative Colorimetric",2:"Saturation",3:"Absolute Colorimetric"}],["tech",{amd:"Active Matrix Display",crt:"Cathode Ray Tube Display",kpcd:"Photo CD",pmd:"Passive Matrix Display",dcam:"Digital Camera",dcpj:"Digital Cinema Projector",dmpc:"Digital Motion Picture Camera",dsub:"Dye Sublimation Printer",epho:"Electrophotographic Printer",esta:"Electrostatic Printer",flex:"Flexography",fprn:"Film Writer",fscn:"Film Scanner",grav:"Gravure",ijet:"Ink Jet Printer",imgs:"Photo Image Setter",mpfr:"Motion Picture Film Recorder",mpfs:"Motion Picture Film Scanner",offs:"Offset Lithography",pjtv:"Projection Television",rpho:"Photographic Paper Printer",rscn:"Reflective Scanner",silk:"Silkscreen",twax:"Thermal Wax Printer",vidc:"Video Camera",vidm:"Video Monitor"}]]);var Ko=class extends or{static canHandle(e,t,i){return e.getUint8(t+1)===237&&e.getString(t+4,9)==="Photoshop"&&this.containsIptc8bim(e,t,i)!==void 0}static headerLength(e,t,i){let n,s=this.containsIptc8bim(e,t,i);if(s!==void 0)return n=e.getUint8(t+s+7),n%2!=0&&(n+=1),n===0&&(n=4),s+8+n}static containsIptc8bim(e,t,i){for(let n=0;n<i;n++)if(this.isIptcSegmentHead(e,t+n))return n}static isIptcSegmentHead(e,t){return e.getUint8(t)===56&&e.getUint32(t)===943868237&&e.getUint16(t+4)===1028}parse(){let{raw:e}=this,t=this.chunk.byteLength-1,i=!1;for(let n=0;n<t;n++)if(this.chunk.getUint8(n)===28&&this.chunk.getUint8(n+1)===2){i=!0;let s=this.chunk.getUint16(n+3),o=this.chunk.getUint8(n+2),a=this.chunk.getLatin1String(n+5,s);e.set(o,this.pluralizeValue(e.get(o),a)),n+=4+s}else if(i)break;return this.translate(),this.output}pluralizeValue(e,t){return e!==void 0?e instanceof Array?(e.push(t),e):[e,t]:t}};it(Ko,"type","iptc"),it(Ko,"translateValues",!1),it(Ko,"reviveValues",!1),fi.set("iptc",Ko),ri(_i,"iptc",[[0,"ApplicationRecordVersion"],[3,"ObjectTypeReference"],[4,"ObjectAttributeReference"],[5,"ObjectName"],[7,"EditStatus"],[8,"EditorialUpdate"],[10,"Urgency"],[12,"SubjectReference"],[15,"Category"],[20,"SupplementalCategories"],[22,"FixtureIdentifier"],[25,"Keywords"],[26,"ContentLocationCode"],[27,"ContentLocationName"],[30,"ReleaseDate"],[35,"ReleaseTime"],[37,"ExpirationDate"],[38,"ExpirationTime"],[40,"SpecialInstructions"],[42,"ActionAdvised"],[45,"ReferenceService"],[47,"ReferenceDate"],[50,"ReferenceNumber"],[55,"DateCreated"],[60,"TimeCreated"],[62,"DigitalCreationDate"],[63,"DigitalCreationTime"],[65,"OriginatingProgram"],[70,"ProgramVersion"],[75,"ObjectCycle"],[80,"Byline"],[85,"BylineTitle"],[90,"City"],[92,"Sublocation"],[95,"State"],[100,"CountryCode"],[101,"Country"],[103,"OriginalTransmissionReference"],[105,"Headline"],[110,"Credit"],[115,"Source"],[116,"CopyrightNotice"],[118,"Contact"],[120,"Caption"],[121,"LocalCaption"],[122,"Writer"],[125,"RasterizedCaption"],[130,"ImageType"],[131,"ImageOrientation"],[135,"LanguageIdentifier"],[150,"AudioType"],[151,"AudioSamplingRate"],[152,"AudioSamplingResolution"],[153,"AudioDuration"],[154,"AudioOutcue"],[184,"JobID"],[185,"MasterDocumentID"],[186,"ShortDocumentID"],[187,"UniqueDocumentID"],[188,"OwnerID"],[200,"ObjectPreviewFileFormat"],[201,"ObjectPreviewFileVersion"],[202,"ObjectPreviewData"],[221,"Prefs"],[225,"ClassifyState"],[228,"SimilarityIndex"],[230,"DocumentNotes"],[231,"DocumentHistory"],[232,"ExifCameraInfo"],[255,"CatalogSets"]]),ri(Or,"iptc",[[10,{0:"0 (reserved)",1:"1 (most urgent)",2:"2",3:"3",4:"4",5:"5 (normal urgency)",6:"6",7:"7",8:"8 (least urgent)",9:"9 (user-defined priority)"}],[75,{a:"Morning",b:"Both Morning and Evening",p:"Evening"}],[131,{L:"Landscape",P:"Portrait",S:"Square"}]]);var Bk=(n=>(n[n.textureImages=1]="textureImages",n[n.imageProcessingError=401]="imageProcessingError",n[n.individualTextureMemoryExceedsBudget=402]="individualTextureMemoryExceedsBudget",n[n.totalTextureMemoryExceedsBudget=403]="totalTextureMemoryExceedsBudget",n))(Bk||{}),$u=class{constructor(){this.id="TEXTUREIMAGE";this.title="Texture Image Validation";this.performAddOnValidations=!1}getTopicData(e){return{title:Oe.getTitleFromEnum(Bk,e)}}summarize(e,t){e.textureCount=t.getSummedNumberValue(this.id,1)}async generate(e,t){let i=[],n=new j(7,this.id,1,"Texture Images");i.push(n);let s=e.getItemsCopy(),o=0;for(let l of s)if(l.itemType===99&&(await l.ensureFileStorage(),l.file)){let u=l.getPackRelativePath(),c=!1;if(u?(u=S.getBaseFromName(S.ensureNotStartsWithDelimiter(u)),await oe.matchesVanillaPath(u)?(n.incrementFeature("Vanilla Override Texture"),c=!0):n.incrementFeature("Custom Texture")):n.incrementFeature("Custom Texture"),l.file.type!=="tga"){if(await l.file.loadContent(),l.file.content&&l.file.content instanceof Uint8Array){let d=new wr({});try{await d.read(l.file.content);let h=await d.parse();if(h.ImageWidth&&h.ImageHeight){let f=Math.pow(2,Math.ceil(Math.log2(h.ImageWidth*h.ImageHeight*4)));n.spectrumIntFeature("Image Width",h.ImageWidth),n.spectrumIntFeature("Image Height",h.ImageHeight),n.spectrumIntFeature("Image Texels",h.ImageWidth*h.ImageHeight),n.spectrumIntFeature("Texture Memory",f),c||(n.spectrumIntFeature("Non-Vanilla Image Texels",h.ImageWidth*h.ImageHeight),n.spectrumIntFeature("Non-Vanilla Texture Memory",f)),o+=f;let m=16e6;if(l.parentItems){for(let p of l.parentItems)if(p.parentItem.itemType===93||p.parentItem.itemType===92){m=2e5;break}}f>m&&i.push(new j(4,this.id,402,`Individual texture memory exceeds budget of ${m} bytes. Memory used`,l,f))}}catch(h){i.push(new j(3,this.id,401,"Error processing image",l,h.toString()))}}l.file.unload()}}let a=1e8;return o>a&&i.push(new j(3,this.id,403,`Total texture memory exceeds budget of ${a} bytes. Total memory used`,void 0,o)),i}};var Lk=Le(Je());var Hu=class r{constructor(){this._isLoaded=!1;this._onLoaded=new Lk.EventDispatcher}get data(){return this._data}set data(e){this._data=e,this._data&&this._data["minecraft:recipe_shaped"]?this._interior=this._data["minecraft:recipe_shaped"]:this._data&&this._data["minecraft:recipe_shapeless"]?this._interior=this._data["minecraft:recipe_shapeless"]:this._interior=void 0}get isLoaded(){return this._isLoaded}get file(){return this._file}get onLoaded(){return this._onLoaded.asEvent()}set file(e){this._file=e}get id(){return this._interior&&this._interior.description&&this._interior.description.identifier?this._interior.description.identifier:this._id}set id(e){this._interior&&this._interior.description&&(this._interior.description.identifier=e),this._id=e}get shortId(){if(this._id!==void 0)return this._id.startsWith("minecraft:")?this._id.substring(10,this._id.length):this._id}async getFormatVersionIsCurrent(){let e=this.getFormatVersion();return e===void 0||e.length!==3?!1:await oe.isRecentVersionFromVersionArray(e)}getFormatVersion(){if(!(!this._data||!this._data.format_version))return Be.getVersionArrayFrom(this._data.format_version)}setBehaviorPackFormatVersion(e){this._ensureDataInitialized(),this._data&&(this._data.format_version=e)}_ensureDataInitialized(){this._data===void 0&&(this._data={})}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}persist(){if(this._file===void 0)return;let e=JSON.stringify(this._data,null,2);this._file.setContent(e)}async load(){this._file===void 0||this._isLoaded||(await this._file.loadContent(),!(this._file.content===null||this._file.content instanceof Uint8Array)&&(this.data=S.getJsonObject(this._file),this._isLoaded=!0))}};var Ok=Le(Je());var qu=class r{constructor(){this._isLoaded=!1;this._onLoaded=new Ok.EventDispatcher}get isLoaded(){return this._isLoaded}get file(){return this._file}get onLoaded(){return this._onLoaded.asEvent()}set file(e){this._file=e}get id(){return this._id}set id(e){this._id=e}get shortId(){if(this._id!==void 0)return this._id.startsWith("minecraft:")?this._id.substring(10,this._id.length):this._id}async getFormatVersionIsCurrent(){let e=this.getFormatVersion();return e===void 0||e.length!==3?!1:await oe.isRecentVersionFromVersionArray(e)}getFormatVersion(){if(!(!this.data||!this.data.format_version))return Be.getVersionArrayFrom(this.data.format_version)}setFormatVersion(e){this._ensureDataInitialized(),this.data&&(this.data.format_version=e)}_ensureDataInitialized(){this.data===void 0&&(this.data={})}static async ensureOnFile(e,t){let i;return e.manager===void 0&&(i=new r,i.file=e,e.manager=i),e.manager!==void 0&&e.manager instanceof r&&(i=e.manager,!i.isLoaded&&t&&i.onLoaded.subscribe(t),await i.load()),i}persist(){if(this._file===void 0)return;let e=JSON.stringify(this.data,null,2);this._file.setContent(e)}async load(){this._file===void 0||this._isLoaded||(await this._file.loadContent(),!(this._file.content===null||this._file.content instanceof Uint8Array)&&(this.data=S.getJsonObject(this._file),this._isLoaded=!0))}};var Ku=class{constructor(){this.id="FORMATVER";this.title="Format Version";this.performPlatformVersionValidations=!1}getTopicData(e){let t={updaterId:this.id,updaterIndex:1,action:"Set format_versions to latest version."},i=this.getTypeFormatVersionDescriptor(e,110,"Block type",t);if(i)return i;let n=this.getTypeFormatVersionDescriptor(e,130,"Item type",t);if(n)return n;let s=this.getTypeFormatVersionDescriptor(e,150,"Recipe",t);if(s)return s;let o=this.getTypeFormatVersionDescriptor(e,170,"Behavior animation",t);if(o)return o;let a=this.getTypeFormatVersionDescriptor(e,190,"Behavior animation controller",t);if(a)return a;let l=this.getTypeFormatVersionDescriptor(e,210,"Resource animation",t);if(l)return l;let u=this.getTypeFormatVersionDescriptor(e,230,"Resource animation controller",t);if(u)return u;switch(e){case 100:return{title:"Format Version Defined"};case 500:return{title:"Retrieve Latest Minecraft Version"};case 501:return{title:"Parse Latest Minecraft Version"}}return{title:e.toString()}}getTypeFormatVersionDescriptor(e,t,i,n){switch(e){case t:return{title:i+" Version Major Version Lower than Current",updaters:[n]};case t+2:return{title:i+" Version Major Version Higher than Current",updaters:[n]};case t+4:return{title:i+" Version Minor Version Lower than Current",updaters:[n]};case t+6:return{title:i+" Version Minor Version Higher than Current",updaters:[n]};case t+8:return{title:i+" Version Patch Version Lower than Current",updaters:[n]};case t+10:return{title:i+" Version Patch Version Higher than Current",updaters:[n]}}}getUpdaterData(e){return{title:e.toString()}}summarize(e,t){}async generate(e,t){let i=[],n=await oe.getLatestVersionInfo(e.effectiveTrack),s=!1;if(!n)return i.push(new j(5,this.id,500,"Could not retrieve version.")),i;let o=n.split(".");if(o.length<3||o.length>4)return i.push(new j(5,this.id,501,"Could not latest product retrieve version.",void 0,n)),i;let a=e.getItemsCopy();for(let l=0;l<a.length;l++){let u=a[l];if(u.itemType===21){if(await u.ensureFileStorage(),u.file){let c=await yn.ensureOnFile(u.file);if(c){let d=c.getFormatVersion();this.checkVersions(d,o,i,u,"Block type",110)&&(s=!0)}}}else if(u.itemType===23){if(await u.ensureFileStorage(),u.file){let c=await pr.ensureOnFile(u.file);if(c){let d=c.getFormatVersion();this.checkVersions(d,o,i,u,"Item type",130)&&(s=!0)}}}else if(u.itemType===43){if(await u.ensureFileStorage(),u.file){let c=await Hu.ensureOnFile(u.file);if(c){let d=c.getFormatVersion();this.checkVersions(d,o,i,u,"Recipe",150)&&(s=!0)}}}else if(u.itemType===19){if(await u.ensureFileStorage(),u.file){let c=await cr.ensureOnFile(u.file);if(c){let d=c.getFormatVersion();this.checkVersions(d,["1","10","0"],i,u,"Behavior animation",170)&&(s=!0)}}}else if(u.itemType===20){if(await u.ensureFileStorage(),u.file){let c=await cr.ensureOnFile(u.file);if(c){let d=c.getFormatVersion();this.checkVersions(d,["1","10","0"],i,u,"Behavior animation controller",190)&&(s=!0)}}}else if(u.itemType===28){if(await u.ensureFileStorage(),u.file){let c=await ji.ensureOnFile(u.file);if(c){let d=c.getFormatVersion();this.checkVersions(d,["1","10","0"],i,u,"Resource animation",210)&&(s=!0)}}}else if(u.itemType===29){if(await u.ensureFileStorage(),u.file){let c=await Tr.ensureOnFile(u.file);if(c){let d=c.getFormatVersion();this.checkVersions(d,["1","10","0"],i,u,"Resource animation controller",230)&&(s=!0)}}}else if(u.itemType===44){if(await u.ensureFileStorage(),u.file){let c=await Gs.ensureOnFile(u.file);if(c){let d=c.getFormatVersion();this.checkVersions(d,["1","12","0"],i,u,"Spawn rules",250)&&(s=!0)}}}else if(u.itemType===47){if(await u.ensureFileStorage(),u.file){let c=await Zr.ensureOnFile(u.file);if(c){let d=c.getFormatVersion();this.checkVersions(d,["1","10","0"],i,u,"Attachables",270)&&(s=!0)}}}else if(u.itemType===30){if(await u.ensureFileStorage(),u.file){let c=await Zi.ensureOnFile(u.file);if(c){let d=c.getFormatVersion();this.checkVersions(d,o,i,u,"Entity type resource",290)&&(s=!0)}}}else if(u.itemType===31&&(await u.ensureFileStorage(),u.file)){let c=await qu.ensureOnFile(u.file);if(c){let d=c.getFormatVersion();this.checkVersions(d,o,i,u,"Fog resource",310)&&(s=!0)}}}return s?i.push(new j(1,this.id,461,"Format version check fails.")):s&&i.push(new j(0,this.id,462,"Format version check passes.")),i}checkVersions(e,t,i,n,s,o){let a=t[0]+"."+t[1]+"."+t[2];if(!e||e.length!==3)return i.push(new j(3,this.id,o,s+" does not define a format_version.",n)),!0;if(e[0]<parseInt(t[0]))i.push(new j(this.performPlatformVersionValidations?3:6,this.id,o+2,s+" version ("+e.join(".")+") has a lower major version number compared to current version ("+a+")",n));else{if(e[0]>parseInt(t[0]))return i.push(new j(3,this.id,o+4,s+" version ("+e.join(".")+") has a higher major version number compared to current version ("+a+")",n)),!0;if(e[1]<parseInt(t[1])-1)i.push(new j(this.performPlatformVersionValidations?3:6,this.id,o+6,s+" version ("+e.join(".")+") has a lower minor version number compared to the current version or the previous current minor version ("+a+")",n));else{if(e[1]>parseInt(t[1])&&!this.performPlatformVersionValidations)return i.push(new j(4,this.id,o+8,s+" version ("+e.join(".")+") has a higher minor version number compared to current version ("+a+")",n)),!0;if(e[2]<parseInt(t[2]))i.push(new j(6,this.id,o+10,s+" version ("+e.join(".")+") has a lower patch version number compared to current version ("+a+")",n));else if(e[2]>parseInt(t[2])&&e[1]===parseInt(t[1])&&!this.performPlatformVersionValidations)return i.push(new j(3,this.id,o+12,s+" version ("+e.join(".")+") has a higher patch version number compared to current version ("+a+")",n)),!0}}return!1}async update(e,t){let i=[];switch(t){case 1:let n=await this.updateBaseGameVersionToLatestVersion(e);i.push(...n);break}return i}getUpdateIds(){return[1]}async updateBaseGameVersionToLatestVersion(e){let t=[],i=await oe.getLatestVersionInfo(e.effectiveTrack);if(!i)return t.push(new Ot(99,this.id,199,"Could not retrieve version.")),t;let n=i.split(".");if(n.length<3||n.length>4)return t.push(new Ot(99,this.id,200,"Could not retrieve latest product version.",void 0,i)),t;let s=parseInt(n[0]),o=parseInt(n[1]),a=parseInt(n[2]),l=e.getItemsCopy();for(let u=0;u<l.length;u++){let c=l[u];if(c.itemType===68&&(await c.ensureFileStorage(),c.file)){let d=await qr.ensureOnFile(c.file);if(d){let h=d.baseGameVersion;(!h||h.length<3||h.length>4||h[0]!==s||h[1]!==o||h[2]!==a)&&(d.setBaseGameVersion([s,o,a],e),d.persist(),t.push(new Ot(1,this.id,200,"Updated world template base_game_version to '"+s+"."+o+"."+a+"'.",c,i)))}}}return t}};var Ff=(t=>(t[t.animations=1]="animations",t[t.bones=2]="bones",t))(Ff||{}),Xu=class{constructor(){this.id="RESOURCEANIMATION";this.title="Resource Animation";this.performAddOnValidations=!1}getTopicData(e){return{title:Oe.getTitleFromEnum(Ff,e)}}summarize(e,t){e.animationCount=t.getSummedNumberValue("RESOURCEANIMATION",1)}async generate(e,t){let i=[],n=new j(7,this.id,1,Oe.getTitleFromEnum(Ff,1));i.push(n);let s=new j(7,this.id,2,Oe.getTitleFromEnum(Ff,2));i.push(s);let o=e.getItemsCopy();for(let a of o)if(a.itemType===28&&(await a.ensureFileStorage(),a.file)){let l=await ji.ensureOnFile(a.file);if(l&&l.animations)for(let u in l.animations){let c=l.animations[u];if(n.incrementFeature("Resource","Count",1),c&&c.bones)for(let d in c.bones){let h=c.bones[d];h&&(s.incrementFeature("Resource Animation Bone","Count",1),h.position&&this.processAnimationValue(s,h.position,"Position"),h.rotation&&this.processAnimationValue(s,h.rotation,"Rotation"),h.scale&&this.processAnimationValue(s,h.scale,"Scale"))}}}return i}processAnimationValue(e,t,i){let n=!1;if(typeof t=="string"){e.incrementFeature("Resource Animation Bone "+i+" Expression","Count",1);return}for(let s in t)if(t[s].constructor===Array){n=!0;break}if(n){e.incrementFeature("Resource Animation Bone "+i+" Keyframe","Count",1);for(let s in t){let o=t[s];if(o.constructor===Array)for(let a of o)typeof a=="string"?e.incrementFeature("Resource Animation Bone "+i+" Keyframe with Molang","Count",1):e.incrementFeature("Resource Animation Bone "+i+" Keyframe","Count",1)}}else if(e.incrementFeature("Resource Animation Bone "+i+" Continuous","Count",1),t.constructor===Array)for(let s of t)typeof s.position=="string"?e.incrementFeature("Resource Animation Bone "+i+" Continuous with Molang","Count",1):e.incrementFeature("Resource Animation Bone "+i+" Continuous","Count",1)}};var Zu=class{constructor(){this.id="UNLINK";this.title="Unlinked item info generator"}getTopicData(e){return{title:e.toString()}}summarize(e,t){}async generate(e,t){return[]}};var Mk=(n=>(n[n.blockGeometry=1]="blockGeometry",n[n.entityGeometry=2]="entityGeometry",n[n.itemGeometry=3]="itemGeometry",n[n.overlyComplexBlockGeometry=501]="overlyComplexBlockGeometry",n))(Mk||{}),Yu=class{constructor(){this.id="GEOMETRY";this.title="Model Geometry Validation"}getTopicData(e){return{title:Oe.getTitleFromEnum(Mk,e)}}summarize(e,t){}async generate(e,t){let i=e.getItemsCopy(),n=new j(7,this.id,1,"Block Geometry"),s=new j(7,this.id,2,"Entity Geometry"),o=new j(7,this.id,3,"Items Geometry"),a=[n,s,o];for(let l of i)if(l.itemType===32&&(await l.ensureFileStorage(),l.file)){let u=l.file.storageRelativePath.toLowerCase(),c=await Ir.ensureOnFile(l.file);if(c&&c.definitions){for(let d of c.definitions)if(d.bones){let h=0;for(let f of d.bones)f.cubes&&(h+=f.cubes.length);if(u.indexOf("/blocks/")>=0){n.spectrumIntFeature("Cubes",h);let f=50;h>f&&a.push(new j(4,this.id,501,`More than ${f} cubes in custom blocks may lead to degraded performance. Cubes used`,l,h))}else u.indexOf("/items/")>=0||u.indexOf("/attachable")>=0?o.spectrumIntFeature("Cubes",h):u.indexOf("/entity/")>=0&&s.spectrumIntFeature("Cubes",h)}}}return a}};var Ei=class{static{this.projectGenerators=[new Zl,new Ql,new Nu,new Yl,new Au,new Rs,new Bs,new Ls,new Os,new Ku,new $l,new Xu,new Ms,new Ns,new zi,new Hl,new Mu,new $u,new Yu]}static{this.itemGenerators=[new xu,new Iu,new Du,new Bu,new Kl,new Zu]}static{this.fileGenerators=[new Tu,new Xl]}static configureForSuite(e,t){t===2?(e.id==="WORLDDATA"||e.id==="TEXTURE"||e.id==="PACKSIZE")&&(e.performAddOnValidations=!0):(e.id==="WORLDDATA"||e.id==="TEXTURE"||e.id==="PACKSIZE")&&(e.performAddOnValidations=!1),t===1?(e.id==="FORMATVER"||e.id==="BASEGAMEVER"||e.id==="MINENGINEVER"||e.id==="WORLDDATA")&&(e.performPlatformVersionValidations=!0):(e.id==="FORMATVER"||e.id==="BASEGAMEVER"||e.id==="MINENGINEVER"||e.id==="WORLDDATA")&&(e.performPlatformVersionValidations=!1)}};var Xn=class r{constructor(e,t,i,n,s,o){this.items=[];this.itemsByStoragePath={};this._isGenerating=!1;this._completedGeneration=!1;this._pendingGenerateRequests=[];if(this.project=e,this.info=n||{},this.contentIndex=o||new $r,s)for(let a of s){let l;if(a.p){e&&(l=e.getItemByProjectPath(a.p)),this.itemsByStoragePath[a.p]||(this.itemsByStoragePath[a.p]=[]);let u=new j(a.iTp,a.gId,a.gIx,a.m,l,a.d,a.iId,a.c,a.p);this.itemsByStoragePath[a.p]?.push(u),this.items.push(u)}else this.items.push(new j(a.iTp,a.gId,a.gIx,a.m,l,a.d,a.iId,a.c))}if(t?this.suite=t:this.suite=0,o&&n)for(let a in n){let l=n[a];l&&typeof l=="string"&&r.isAggregableFieldName(a)&&o.parseTextContent("inspector",l)}if(i){let a=[];for(let l of i){let u=l.trim().split(",");for(let c of u){let d=c.toUpperCase().trim();d.length>0&&a.push(d)}}this._excludeTests=a}}static{this._generatorsById={}}static{this.CommonCsvHeader="Test,TestId,Type,Item,Message,Data,Path"}static getSuiteFromString(e){switch(e.toLowerCase()){case"addon":case"addons":return 2;case"currentplatform":return 1;default:return 0}}static getSuiteString(e){switch(e){case 2:return"addon";case 1:return"currentplatform";default:return"all"}}get completedGeneration(){return this._completedGeneration}get errorAndFailCount(){let e=0;for(let t of this.items)(t.itemType===3||t.itemType===5||t.itemType===1)&&e++;return e}get errorFailWarnCount(){let e=0;for(let t of this.items)(t.itemType===3||t.itemType===4||t.itemType===5||t.itemType===1)&&e++;return e}get errorFailWarnString(){let e=[];for(let t of this.items)(t.itemType===3||t.itemType===4||t.itemType===5||t.itemType===1)&&e.push(t.toString());return e.join(`\r
`)}static getTopicData(e,t){let i=r._generatorsById[e];if(i)return i.getTopicData(t);for(let n of Ei.projectGenerators)if(n.id===e)return this._generatorsById[e]=n,n.getTopicData(t)}getCountByType(e){let t=0;for(let i of this.items)i.itemType===e&&t++;return t}getSummaryByType(e){let t=[];for(let i of this.items)t.length<50&&i.itemType===e&&t.push(i.toString());return t.join(`\r
`)}matchesSuite(e){return this.suite===0&&e.id.indexOf("CADDON")<0||this.suite===1&&(e.id==="MINENGINEVER"||e.id==="BASEGAMEVER"||e.id==="FORMATVER"||e.id==="WORLDDATA")||this.suite===2&&(e.id.indexOf("CADDON")>=0||e.id==="PACKSIZE"||e.id==="STRICT"||e.id==="TEXTURE"||e.id==="MINENGINEVER"||e.id==="WORLDDATA")}async generateForProject(e){if(e===!0&&this._completedGeneration&&(this._completedGeneration=!1,this._isGenerating=!1),!this._completedGeneration)if(this._isGenerating){let t=this._pendingGenerateRequests,i=(n,s)=>{t.push(n)};await new Promise(i)}else{this._isGenerating=!0;let t=await this.project?.carto.notifyOperationStarted("Validating '"+this.project.name+"'",1);this.info.summary=void 0;let i=Ei.projectGenerators,n=Ei.itemGenerators,s=Ei.fileGenerators,o=[],a={},l=new $r;if(!this.project){C.throwUnexpectedUndefined("PISGFP");return}await this.project.loc.load();for(let d=0;d<i.length;d++){let h=i[d];if((!this._excludeTests||!this._excludeTests.includes(h.id))&&h&&this.matchesSuite(h)){Ei.configureForSuite(h,this.suite);try{let f=await h.generate(this.project,l);for(let m of f)this.pushItem(o,a,m)}catch(f){o.push(new j(5,h.id,500,this.project.name+": "+f)),C.debugAlert(f)}}}let u=this.project.getItemsCopy();for(let d=0;d<u.length;d++){let h=u[d];await h.load();for(let f=0;f<n.length;f++){let m=n[f];if((!this._excludeTests||!this._excludeTests.includes(m.id))&&this.matchesSuite(m)){Ei.configureForSuite(m,this.suite);try{let p=await m.generate(h,l);for(let g of p)this.pushItem(o,a,g)}catch(p){o.push(new j(5,m.id,501,this.project.name+": "+p.toString()))}}}}await this.processFolder(this.project,await this.project.ensureProjectFolder(),o,a,l,s,0),this.addSuccesses(o,a,s,this._excludeTests),this.addSuccesses(o,a,n,this._excludeTests),this.items=o,this.itemsByStoragePath=a,this.contentIndex=l,this._completedGeneration=!0,this.generateProjectMetaInfo();let c=this._pendingGenerateRequests;this._pendingGenerateRequests=[],this._isGenerating=!1,this.info.errorCount=this.getCountByType(3),this.info.internalProcessingErrorCount=this.getCountByType(5),this.info.warningCount=this.getCountByType(4),this.info.testSuccessCount=this.getCountByType(0),this.info.testFailCount=this.getCountByType(1),this.info.errorSummary=this.getSummaryByType(3),this.info.internalProcessingErrorSummary=this.getSummaryByType(5),this.info.testFailSummary=this.getSummaryByType(1),t!==void 0&&await this.project?.carto.notifyOperationEnded(t,"Completed validation of '"+this.project.name+"'",1);for(let d of c)d(void 0)}}disconnectFromProject(){this.project=void 0;for(let e of this.items)e.disconnect()}addSuccesses(e,t,i,n){for(let s of i)(!n||!n.includes(s.id))&&this.matchesSuite(s)&&r.getItemsInCollectionByType(e,s.id,1).length===0&&this.pushItem(e,t,new j(0,s.id,1,`Test ${s.title} completed successfully.`))}pushItem(e,t,i){i.projectItem&&i.projectItem.projectPath&&i.itemType!==2&&i.itemType!==7&&(t[i.projectItem.projectPath]||(t[i.projectItem.projectPath]=[]),t[i.projectItem.projectPath]?.push(i)),e.push(i)}mergeFeatureSetsAndFieldsTo(e,t){if(!(!this.info||!this.info.featureSets)){for(let i in this.info)i!=="features"&&(t[i]=!0);for(let i in t){let n=this.info;r.isAggregableFieldName(i)&&n[i]===void 0&&(n[i]="")}for(let i in this.info.featureSets){let n=this.info.featureSets[i];if(n!==void 0){let s=e[i];s===void 0&&(s={},e[i]=s);for(let o in n){let a=n[o];if(a!==void 0){let l=s[o];l===void 0?l=a:l+=a,s[o]=l}}}}}}ensureGenerators(){if(this.info&&this.info.summary===void 0){this.info.summary={};for(let e=0;e<this.items.length;e++){let t=this.items[e].generatorId,i=this.items[e].generatorIndex,n=this.info.summary[t];n===void 0&&(n={},this.info.summary[t]=n);let s=n[i];s===void 0&&(s={},n[i]=s);let o=r.getTopicData(t,i);o&&(s.title=o.title),s.defaultMessage===void 0&&this.items[e].message!==s.title&&(s.defaultMessage=this.items[e].message)}for(let e=0;e<this.items.length;e++){let t=this.items[e],i=t.generatorId,n=t.generatorIndex,s=this.info.summary[i];s===void 0&&(s={},this.info.summary[i]=s);let o=s[n];if(o===void 0&&(o={},s[n]=o),t.itemType!==7)switch(t.itemType){case 3:o.errors=o.errors?o.errors+1:1;break;case 1:o.testCompleteFails=o.testCompleteFails?o.testCompleteFails+1:1;break;case 0:o.testCompleteSuccesses=o.testCompleteSuccesses?o.testCompleteSuccesses+1:1;break;case 4:o.warnings=o.warnings?o.warnings+1:1;break;case 6:o.recommendations=o.recommendations?o.recommendations+1:1;break;case 5:o.internalProcessingErrors=o.internalProcessingErrors?o.internalProcessingErrors+1:1;break}(this.items[e].message===o.defaultMessage||this.items[e].message===o.title)&&(this.items[e].message=void 0)}}}itemToString(e){let t=e.typeSummaryShort+": ";t+="["+e.generatorId+B.frontPadToLength(e.generatorIndex,3,"0")+"]",e.shortProjectItemPath&&(t+=" ("+e.shortProjectItemPath+")");let i=this.getEffectiveMessage(e);i.length>0&&(t+=" "+i),e.data&&(t+=": "+e.data);let n=e.contentSummary;return n&&(t+=" [in "+n+"]"),t}static getEffectiveMessageFromData(e,t){if(t.m!==void 0)return t.m;if(e.info===void 0||e.info.summary===void 0)return;let i=e.info.summary[t.gId];if(i===void 0)return;let n=i[t.gIx];if(n!==void 0)return n.defaultMessage}getEffectiveMessage(e){if(e.message!==void 0)return e.message;if(this.info===void 0||this.info.summary===void 0)return"";let t=this.info.summary[e.generatorId];if(t===void 0)return"";let i=t[e.generatorIndex];return i===void 0?"":i.defaultMessage?i.defaultMessage:""}shouldIncludeInIndex(e){return!(e.gId==="JSON"||e.gId==="ESLINT")}getDataObject(e,t,i,n,s){let o=[];this.ensureGenerators();for(let a=0;a<this.items.length;a++){let l=this.items[a].dataObject;(!n||this.shouldIncludeInIndex(l))&&o.push(l)}return B.encodeObjectWithSequentialRunLengthEncodeUsingNegative(this.contentIndex.data.trie),{info:this.info,items:o,index:this.contentIndex.data,generatorName:Yr.name,suite:this.suite,subsetReports:s,generatorVersion:Yr.version,sourceName:e,sourcePath:t,sourceHash:i}}static isAggregableFieldName(e){return e!=="features"&&e!=="summary"&&e!=="featureSets"&&e!=="defaultIcon"}static isAggregableFeatureMeasureName(e){return!e.startsWith("#")}static getSummaryCsvHeaderLine(e,t){let i="Name,Title,Reds,Area,",n=[];for(let s in e)r.isAggregableFieldName(s)&&n.push(s);n=n.sort(r.sortMinecraftFeatures);for(let s of n)i+=B.humanifyJsName(s)+",";for(let s in e)r.isAggregableFieldName(s)&&n.push(s);for(let s in t){let o=t[s];if(o)for(let a in o)r.isAggregableFeatureMeasureName(a)&&o[a]!==void 0&&(i+=r.getDataSummary(s+" "+a)+",")}return i}getIndexJson(e,t,i){return JSON.stringify(this.getDataObject(e,t,i,!0))}getStrictIndexJson(e,t,i){let n=this.getDataObject(e,t,i,!0);return n&&(n.info=void 0,n.items=void 0),JSON.stringify(n)}getReportHtml(e,t,i){let n=[];n.push("<html><head>"),n.push("<script>"),n.push(`const _reportObjects = [];

function _addReportJson(data) {
  _reportObjects.push(data);
}
`);let s=this.getDataObject(e,t,i);return s.index=void 0,n.push("_addReportJson("+JSON.stringify(s)+");"),n.push("<\/script><script>"),n.push(`
    function getDataName(name) {
      if (typeof name === "boolean" || typeof name === "number") {
        return name.toString();
      }
    
      let retVal = "";
    
      for (let i = 0; i < name.length; i++) {
        if (i === 0) {
          retVal += name[i].toUpperCase();
        } else {
          if (name[i] >= "A" && name[i] <= "Z") {
            retVal += " ";
          }
          retVal += name[i];
        }
      }
      return retVal;
    }
    
    function getDataSummary(data) {
      if (data) {
        return data;
      }
      
      if (typeof data === "number" || typeof data === "boolean") {
        return data.toString();
      }
      
      if (typeof data === "object") {
        return JSON.stringify(data);
      }
    
      return "(not defined)";
    }  
    
    function getEmptySummary(data) {
    
      if (typeof data === "object") {
        return JSON.stringify(data);
      }
      
      if (typeof data === "number" || typeof data === "boolean") {
        return data.toString();
      }
    
      if (data) {
        return data;
      }
      
      return "";
    }  

    function getEffectiveMessage(reportObj, item) {
      if (item.m !== undefined) {
        return item.m;
      }

      if (reportObj.info === undefined || reportObj.info.summary === undefined) {
        return undefined;
      }

      let gen = reportObj.info.summary[item.gId];

      if (gen === undefined) {
        return undefined;
      }

      let genI = gen[item.gIx];
 
      if (genI === undefined) {
        return undefined;
      }

      return genI.defaultMessage;
    }	    
    
    function generateReports() {
      for (let i=0; i<_reportObjects.length; i++) {
        document.write("<h1>" + _reportObjects[i].sourceName + "</h1>");
        document.write("<h3>Summary</h3>");
    
        document.write("<table class='summary-table'>");
        document.write("<tr><th>Measure</th><th>Value</th></tr>");
        const info = _reportObjects[i].info;
    
        if (info) {
          for (const key in info) {
            const val = info[key];
    
            if (key !== 'featureSets' && key !== 'defaultIcon' && key !== 'summary') {
              document.write("<tr>");
              document.write("<td class='summary-key items-cell'>" + getDataName(key) + "</td>");
              document.write("<td class='summary-value items-cell'>" + getDataSummary(val) + "</td>");
              document.write("</tr>");
            }
          }
    
          if (info["featureSets"]) {
            for (const featureName in info.featureSets) {
              const feature = info.featureSets[featureName];
    
              for (const measureName in feature) {
                const val = feature[measureName];

                 document.write("<tr>");
                document.write("<td class='summary-key items-cell'>" + featureName + " " + measureName + "</td>");
                document.write("<td class='summary-value items-cell'>" + getDataSummary(val) + "</td>");
                document.write("</tr>");
              }
            }
          }
        }
        document.write("</table>");
      }
    
      for (let i=0; i<_reportObjects.length; i++) {
        document.write("<h3>Items</h3>");
        document.write("<table class='items-table'>");
        document.write("<tr><th>Type</th><th>Test Category</th><th>Category Id</th><th>Message</th><th>Data</th><th>Path</th></tr>");
        const info = _reportObjects[i].info;
        
        const items = _reportObjects[i].items;
    
        if (items && items.length) {
          for (const item of items) {
            if (item.itemType !== 2) {
              document.write("<tr>");
              document.write("<td class='items-type items-cell'>" + getDescriptionForItemType(item.iTp) + "</td>");
              document.write("<td class='items-generator items-cell'>" + item.gId + "</td>");
              document.write("<td class='items-generatorIndex items-cell'>" + item.gIx + "</td>");
              document.write("<td class='items-message items-cell'>" + getEmptySummary(getEffectiveMessage(_reportObjects[i], item)) + "</td>");
              document.write("<td class='items-data items-cell'>" + getEmptySummary(item.d) + "</td>");
              document.write("<td class='items-path items-cell'>" + getEmptySummary(item.p) + "</td>");
              document.write("</tr>");
            }
          }
        }
        document.write("</table>");
      }
    } 

    function getDescriptionForItemType(itemType) {
      switch (itemType) {
        case 0: 
          return "SUCCESS";
          break;
        case 1: 
          return "FAIL";
          break;
        case 3: 
          return "ERROR";
          break;
        case 4: 
          return "WARN";
          break;
        case 5: 
          return "INTERNALERR";
          break;
        case 6: 
          return "RECOMMEND";
          break;          
      }
      return "INFO";
    }

    <\/script>
    <style>
      body {
        font-family: Noto Sans, Arial, Helvetica, sans-serif;
        padding: 8px;
      }
    
      .items-table {
        border: solid 1px #606060;
        padding: 0px;
        max-width: 100vw;
      }
    
      .items-cell {
        border: solid 1px #606060;
        padding: 4px;
        vertical-align: top;
        font-size: x-small;
        overflow-wrap: anywhere;
        max-width: 25vw;
      }
    
      .summary-table {
        border: solid 1px #606060;
        padding: 0px;
        max-width: 100vw;
      }
    </style>
    </head><body> 
`),n.push("<script>"),n.push("generateReports();"),n.push("<\/script>"),n.push("</body></html>"),n.join(`
`)}static getDataSummary(e){return typeof e=="number"||typeof e=="boolean"?e.toString():e?'"'+e.replace(/"/gi,"'")+'"':"(not defined)"}static sortMinecraftFeatures(e,t){return e=e.replace("minecraft:","_"),t=t.replace("minecraft:","_"),e.localeCompare(t)}getArea(e){return e=e.toLowerCase(),e.indexOf("furniture")>=0?"Furniture":e.indexOf("skyblock")>=0||e.indexOf("sky block")>=0?"Skyblock":e.indexOf("oneblock")>=0||e.indexOf("one block")>=0?"One block":e.indexOf("lucky")>=0?"Lucky":e.indexOf("parkour")>=0?"Parkour":e.indexOf("surviv")>=0?"Survival":e.indexOf("weapon")>=0||e.indexOf("potion")>=0||e.indexOf("tool")>=0||e.indexOf("hook")>=0?"Tools":e.indexOf("roleplay")>=0||e.indexOf("teen")>=0||e.indexOf("illionair")>=0||e.indexOf("hacker")>=0?"Roleplay":e.indexOf("mob")>=0||e.indexOf("pirate")>=0||e.indexOf("unicorn")>=0||e.indexOf("alien")>=0||e.indexOf("animals")>=0||e.indexOf("cats")>=0||e.indexOf("dogs")>=0||e.indexOf("dragon")>=0?"Mob":e.indexOf("vehicles")>=0||e.indexOf("car")>=0||e.indexOf("plane")>=0?"Vehicles":e.indexOf("island")>=0||e.indexOf("kingdom")>=0||e.indexOf("tower")>=0||e.indexOf("mansion")>=0||e.indexOf("village")>=0||e.indexOf("resort")>=0||e.indexOf("castle")>=0||e.indexOf("base")>=0||e.indexOf("town")>=0||e.indexOf("city")>=0||e.indexOf("fortress")>=0||e.indexOf("citadel")>=0||e.indexOf("outpost")>=0||e.indexOf("farm")>=0||e.indexOf("hotel")>=0||e.indexOf("castle")>=0?"Area":e.indexOf("simulat")>=0?"Simulator":"General"}getRed(){let e=0;return!this.info||!this.info.featureSets?0:e}getSummaryCsvLine(e,t,i){let n=r.getDataSummary(e)+","+r.getDataSummary(t)+","+this.getRed()+","+this.getArea(t)+",",s=[];for(let o in this.info)r.isAggregableFieldName(o)&&s.push(o);s=s.sort(r.sortMinecraftFeatures);for(let o of s)n+=r.getDataSummary(this.info[o])+",";if(this.info.featureSets)for(let o in i){let a=i[o],l=this.info.featureSets[o];if(a){for(let u in a)if(r.isAggregableFeatureMeasureName(u)){if(l){let c=l[u];c!==void 0&&typeof c=="number"&&(n+=c)}n+=","}}}return n}getItemCsvLines(){let e=[];for(let t=0;t<this.items.length;t++){let i=this.items[t];if(i.itemType!==7){let n="";i.projectItem&&i.projectItem.projectPath&&(n=i.projectItem.projectPath);let s=i.generatorId+","+i.generatorIndex+","+i.typeSummary+","+(i.projectItem?i.projectItem.name:"")+',"'+this.getEffectiveMessage(i)+'",';if(i.data&&(typeof i.data=="string"?s+='"'+i.data+'"':s+=i.data.toString()),s+=","+n+",",i.featureSets)for(let o in i.featureSets){let a=i.featureSets[o];if(a){for(let l in a)if(r.isAggregableFeatureMeasureName(l)){let u=a[l];u!==void 0&&(typeof u=="number"?s+=o+" "+l+","+u+",":typeof u=="string"&&(s+=o+" "+l+',"'+u+'",'))}}}e.push(s)}}return e}getItems(e,t){let i=[];for(let n of this.items)n.generatorId===e&&n.generatorIndex===t&&i.push(n);return i}getItemsByType(e,t){return r.getItemsInCollectionByType(this.items,e,t)}getItemsByStoragePath(e){if(this.itemsByStoragePath)return this.itemsByStoragePath[e]}static getItemsInCollectionByType(e,t,i){let n=[];for(let s of e)s.generatorId===t&&s.itemType===i&&n.push(s);return n}async processFolder(e,t,i,n,s,o,a){await t.load();for(let l in t.files){let u=t.files[l];if(u){let c=e.getItemByFile(u);if(c&&c.projectPath){if(s.insert(S.getBaseFromName(l),c.projectPath),s.insert(u.storageRelativePath,c.projectPath),await u.loadContent(),u.content&&typeof u.content=="string"){let d=S.getTypeFromName(l);if(c&&c.projectPath)switch(d){case"json":s.parseJsonContent(c.projectPath,u.content);break;case"ts":case"js":case"mjs":s.parseJsContent(c.projectPath,u.content);break}}for(let d of o)if(this.matchesSuite(d))try{let h=await d.generate(e,u,s);for(let f of h)this.pushItem(i,n,f)}catch(h){i.push(new j(5,d.id,502,u.fullPath+": "+h.toString()))}if(S.isContainerFile(u.storageRelativePath)){let d=await S.getFileStorageFolder(u);d&&await this.processFolder(e,d,i,n,s,o,a+1)}}}}if(a<15)for(let l in t.folders){let u=t.folders[l];if(u&&!u.errorStatus&&u.name){let c=u.name.toLowerCase();(!c.startsWith(".")||c.startsWith(".vscode"))&&!c.startsWith("node_modules")&&await this.processFolder(e,u,i,n,s,o,a+1)}}}generateProjectMetaInfo(){this.info={};let e=Ei.projectGenerators,t=Ei.itemGenerators,i=Ei.fileGenerators;for(let n=0;n<e.length;n++)e[n].summarize(this.info,this);for(let n=0;n<t.length;n++)t[n].summarize(this.info,this);for(let n=0;n<i.length;n++)i[n].summarize(this.info,this);this.aggregateFeatures()}addObjectsToArray(e,t,i){for(let n of this.items)n.generatorId===e&&n.generatorIndex===t&&n.data&&typeof n.data=="object"&&i.push(n.data)}getFirstStringValue(e,t){for(let i of this.items)if(i.generatorId===e&&i.generatorIndex===t&&i.data&&typeof i.data=="string")return i.data}removeItems(e,t){let i=[];for(let n of this.items)(n.generatorId!==e||!t.includes(n.generatorIndex))&&i.push(n);this.items=i}getGeneratorForItem(e){let t=Ei.itemGenerators;for(let s of t)if(s.id===e.generatorId)return s;let i=Ei.fileGenerators;for(let s of i)if(s.id===e.generatorId)return s;let n=Ei.projectGenerators;for(let s of n)if(s.id===e.generatorId)return s}getItemSummary(e){let t=this.getGeneratorForItem(e);if(t){let i=t.getTopicData(e.generatorIndex);if(i)return i.title}return e.generatorId+"-"+e.generatorIndex}aggregateFeatures(){if(this.info!==void 0){this.info.featureSets={};for(let e of this.items)if(e.featureSets)for(let t in e.featureSets){let i=e.featureSets[t],n=this.getItemSummary(e)+" "+t;for(let s in i){let o=i[s];if(typeof o=="number"){let a=this.info.featureSets[n];a===void 0&&(a={},this.info.featureSets[n]=a);let l=a[s];l===void 0?l=o:s.startsWith("Max ")?l=Math.max(l,o):t.startsWith("Min ")?l=Math.min(l,o):l+=o,a[s]=l}}}}}getFirstNumberValue(e,t){for(let i of this.items)if(i.generatorId===e&&i.generatorIndex===t&&i.data&&typeof i.data=="number")return i.data;return 0}getSummedNumberValue(e,t){let i=0;for(let n of this.items)n.generatorId===e&&n.generatorIndex===t&&n.data&&typeof n.data=="number"&&(i+=n.data);return i}getCount(e,t){let i=0;for(let n of this.items)n.generatorId===e&&n.generatorIndex===t&&i++;return i}getFirstNumberArrayValue(e,t){for(let i of this.items)if(i.generatorId===e&&i.generatorIndex===t&&i.data){let n=i.data;if(typeof n=="string")return n;if(n instanceof Array&&n.length&&n.length>0){let s="";for(let o=0;o<n.length;o++)s.length>0&&(s+="."),s+=n[o];return s}}}async getInfoForItem(e,t){let i=Ei.itemGenerators,n=[];await e.load();for(let s=0;s<i.length;s++)try{let o=await i[s].generate(e,t);for(let a of o)n.push(a)}catch(o){n.push(new j(5,i[s].id,504,o.toString()))}return n}};var ta=class{constructor(e,t){this.project=e,this.folder=t}async fullIngestIntoProject(){this.project.projectFolder&&await S.syncFolderTo(this.folder,this.project.projectFolder,!0,!0,!1)}};var pp="==== AUTOGENERATED",e0=`\r
// ===== AUTOGENERATED CONTENT ===== CONTENT AT OR BELOW THIS LINE WILL BE WIPED AND UPDATED WHEN USED IN TOOLING`;var Tw="===== AUTOGENERATED FILE ===== CONTENT WITHIN THIS FILE WILL BE WIPED AND UPDATED WHEN USED IN TOOLING",cl=[{id:"@minecraft/server",module_name:"@minecraft/server",preferredVersion:"1.12.0-beta"},{id:"@minecraft/server-gametest",module_name:"@minecraft/server-gametest",preferredVersion:"1.0.0-beta"},{id:"@minecraft/server-ui",module_name:"@minecraft/server-ui",preferredVersion:"1.2.0-beta"},{id:"@minecraft/server-admin",module_name:"@minecraft/server-admin",preferredVersion:"1.0.0-beta"},{id:"@minecraft/server-net",module_name:"@minecraft/server-net",preferredVersion:"1.0.0-beta"},{id:"@minecraft/server-editor",module_name:"@minecraft/server-editor",preferredVersion:"0.1.0-beta"}];var sr=class{constructor(e,t,i){this.#_=0;this.#C=null;this.#L=!1;this.#I=null;this.#p=null;this.#a=null;this.#l=null;this.#c=null;this.#d=null;this.#f=null;this.#x=null;this.#S=!1;this.#P=[];this.#h={};this.changedFilesSinceLastSaved={};this.#D=!1;this.#A=!1;this.#R=!1;this.#B=!1;this.#w=null;this.#k=null;this._onPropertyChanged=new In.EventDispatcher;this._onLoaded=new In.EventDispatcher;this._onInflated=new In.EventDispatcher;this._onSaved=new In.EventDispatcher;this._onNeedsSaveChanged=new In.EventDispatcher;this._onItemChanged=new In.EventDispatcher;this._onItemAdded=new In.EventDispatcher;this._onItemRemoved=new In.EventDispatcher;this.#T=!1;this.#E=!1;this._handleDeployUpdated=this._handleDeployUpdated.bind(this),this._handleProjectFileContentsUpdated=this._handleProjectFileContentsUpdated.bind(this),this.applyUpdate=this.applyUpdate.bind(this),this.ensureLoadedFromFile=this.ensureLoadedFromFile.bind(this),this.ensureProjectFolder=this.ensureProjectFolder.bind(this),this._handleProjectFolderMoved=this._handleProjectFolderMoved.bind(this),this.loc=new Jl(this),this.#e={dataType:1,storageBasePath:"",contentsModified:null,dataStorageRelativePath:"/"+t+"/",editPreference:0,name:t,title:t,description:t+" description",defaultBehaviorPackUniqueId:B.createUuid(),defaultResourcePackUniqueId:B.createUuid(),defaultScriptModuleUniqueId:B.createUuid(),defaultDataUniqueId:B.createUuid(),focus:0,items:[]},this.#r=i,this.#t=null,this.#s=null,this.#F=null,this.#b=null,this.#u=null,this.#g=null,this.#m=null,this.#n=null,this.#y=null,this.#O=null,this.#f=null,this.#i=e,this.#o=[]}#e;#r;#i;#_;#C;#M;#L;#I;#t;#p;#a;#l;#c;#d;#m;#f;#x;#S;#g;#s;#O;#b;#P;#F;#u;#y;#n;#o;#h;#D;#A;#R;#B;#v;#w;#k;#T;#E;get readOnlySafety(){return this.#E}set readOnlySafety(e){this.#E=e,this.#t&&(this.#t.storage.readOnly=this.#E)}get carto(){return this.#i}get role(){return this.#e.role===void 0?0:this.#e.role}set role(e){this.#e.role=e}get errorState(){return this.#_}get file(){return this.#r}get accessoryFolders(){return this.#k}set accessoryFolders(e){this.#k=e}get accessoryFilePaths(){return this.#v}set accessoryFilePaths(e){this.#v=e}get infoSet(){return this.#C||(this.#C=new Xn(this,0)),this.#C}get collapsedStoragePaths(){return this.#e.collapsedStoragePaths||(this.#e.collapsedStoragePaths=[]),this.#e.collapsedStoragePaths}set collapsedStoragePaths(e){this.#e.collapsedStoragePaths=e}get packs(){return this.#P}hasUnsavedChanges(){for(let e in this.changedFilesSinceLastSaved)return!0;return!1}getBehaviorPackCount(){let e=0;for(let t of this.items)t.itemType===5&&e++;return e}getResourcePackCount(){let e=0;for(let t of this.items)t.itemType===14&&e++;return e}getIsPackFolderManaged(){let e=0,t=0;for(let i of this.items)i.itemType===5?t++:i.itemType===14&&e++;return t<2&&e<2}get key(){return this.localFilePath?S.canonicalizePath(this.localFilePath):this.#t?this.#t.name&&this.#t.name.length>0?this.#t.name:S.canonicalizePath(this.#t.fullPath):this.#r?S.canonicalizePath(this.#r.name):this.title}get containerName(){return this.localFilePath?S.getLeafName(this.localFilePath):this.#t?this.#t.name&&this.#t.name.length>0?this.#t.name:S.getLeafName(this.#t.fullPath):this.#r?S.getBaseFromName(this.#r.name):this.title}get defaultNamespace(){return this.#e.defaultNamespace}get effectiveDefaultNamespace(){return this.#e.defaultNamespace||this.#e.defaultNamespace===""?this.#e.defaultNamespace:this.effectiveShortName}set defaultNamespace(e){e!==this.#e.defaultNamespace&&(this.#e.defaultNamespace=e,this._onPropertyChanged.dispatch(this,"defaultNamespace"))}get scriptEntryPoint(){return this.#e.scriptEntryPoint||this.#e.scriptEntryPoint===""?this.#e.scriptEntryPoint:this.scriptEntryPoint}set scriptEntryPoint(e){e!==this.#e.scriptEntryPoint&&(this.#e.scriptEntryPoint=e,this._onPropertyChanged.dispatch(this,"scriptEntryPoint"))}get worldSettings(){return this.#e.worldSettings}get editorWorldSettings(){return this.#e.editorWorldSettings}ensureWorldSettings(){if(this.#e.worldSettings===void 0){if(this.carto.worldSettings)this.#e.worldSettings=this.carto.worldSettings;else if(this.initializeWorldSettings(),this.#e.worldSettings===void 0)throw new Error}return this.#e.worldSettings}ensureEditorWorldSettings(){if(this.#e.editorWorldSettings===void 0){if(this.carto.editorWorldSettings)this.#e.editorWorldSettings=this.carto.editorWorldSettings;else if(this.initializeEditorWorldSettings(),this.#e.editorWorldSettings===void 0)throw new Error}return this.#e.editorWorldSettings}get usesCustomWorldSettings(){return this.#e.usesCustomWorldSettings}set usesCustomWorldSettings(e){this.#e.usesCustomWorldSettings=e}get isLoaded(){return this.#D}get isInflated(){return this.#A}get distBuildFolder(){return this.#a}get libFolder(){return this.#l}get distScriptsFolder(){return this.#c}get libScriptsFolder(){return this.#d}get useProjectNameInRootProjectStorage(){return this.#B}set useProjectNameInRootProjectStorage(e){this.#B=e}get onPropertyChanged(){return this._onPropertyChanged.asEvent()}get onLoaded(){return this._onLoaded.asEvent()}get onInflated(){return this._onInflated.asEvent()}get onSaved(){return this._onSaved.asEvent()}get onNeedsSaveChanged(){return this._onNeedsSaveChanged.asEvent()}get onItemChanged(){return this._onItemChanged.asEvent()}get onItemAdded(){return this._onItemAdded.asEvent()}get onItemRemoved(){return this._onItemRemoved.asEvent()}get projectFolder(){return this.#t}get accessoryFoldersForFilePaths(){return this.#w}get localFolderPath(){return this.#e.localFolderPath}set localFolderPath(e){this.#e.localFolderPath=e}get mainDeployFolderPath(){return this.#e.mainDeployFolderPath}set mainDeployFolderPath(e){this.#e.mainDeployFolderPath=e}get localFilePath(){return this.#e.localFilePath}set localFilePath(e){this.#e.localFilePath=e}get items(){return this.#o}get gitHubReferences(){return this.#e.gitHubReferences===void 0&&(this.#e.gitHubReferences=[]),this.#e.gitHubReferences}async getBehaviorPackScriptsFolder(){return(await this.ensureDefaultBehaviorPackFolder()).folders.scripts}async ensureBehaviorPackScriptsFolder(){return(await this.ensureDefaultBehaviorPackFolder()).ensureFolder("scripts")}async getMainScriptsFolder(){if(await this.loadFolderStructure(),this.#t===void 0||this.#t===null)throw new Error("Unexpectedly could not create project folder");return this.#t.folders.scripts}async ensureMainScriptsFolder(){if(await this.loadFolderStructure(),this.#t===void 0||this.#t===null)throw new Error("Unexpectedly could not create project folder");return this.#t.ensureFolder("scripts")}get preferredScriptLanguage(){return this.#e.preferredScriptLanguage===void 0||this.#e.preferredScriptLanguage===1?1:this.#e.preferredScriptLanguage}set preferredScriptLanguage(e){this.#e.preferredScriptLanguage=e}get scriptVersion(){return this.#e.scriptVersion===void 0?0:this.#e.scriptVersion}get messages(){return this.#e.messages}set scriptVersion(e){this.#e.scriptVersion=e}get editPreference(){return this.#e.editPreference===void 0?0:this.#e.editPreference}set editPreference(e){this.#e.editPreference=e}get contentsModified(){let e=this.#e.contentsModified;return e===null?null:(e instanceof Date||(e=new Date(e)),e)}getItemsCopy(){return this.#o.slice()}initializeWorldSettings(){this.#e.worldSettings===void 0&&(this.#e.worldSettings={gameType:1,generator:1,randomSeed:"2000",isEditor:!1,backupType:2,useCustomSettings:!1},this.ensureDefaultWorldName())}ensureDefaultWorldName(){this.worldSettings&&this.worldSettings.name===void 0&&(this.worldSettings.name=this.name+" "+B.getDateStr(new Date),this.save())}initializeEditorWorldSettings(){this.#e.editorWorldSettings===void 0&&(this.#e.editorWorldSettings={gameType:1,generator:1,randomSeed:"2000",isEditor:!0,backupType:2,useCustomSettings:!1},this.ensureDefaultEditorWorldName())}ensureDefaultEditorWorldName(){this.editorWorldSettings&&this.editorWorldSettings.name===void 0&&(this.editorWorldSettings.name=this.name+" "+B.getDateStr(new Date),this.save())}addMessage(e,t,i,n,s){if(this.#e.messages===void 0&&(this.#e.messages=[]),n===void 0&&(n=0),e.trim().toLowerCase().length>1){let a={time:new Date,message:e,context:t,operation:i,topic:s,type:n};this.#e.messages.push(a)}}appendErrors(e,t){if(e.errorMessages)for(let i of e.errorMessages)this.carto.notifyStatusUpdate(i.message,0),this.addMessage(i.message,i.context,t,0)}removeItem(e){let t=[];for(let n=0;n<this.items.length;n++)this.items[n]!==e&&t.push(this.items[n]);this.#h[di.canonicalizeStoragePath(e.projectPath)]=void 0,this.#o=t;let i=[];for(let n=0;n<this.#e.items.length;n++)this.#e.items[n].projectPath!==e.projectPath&&i.push(this.#e.items[n]);this.#e.items=i,this._onItemRemoved.dispatch(this,e)}updateContentsModified(){this.#e.contentsModified=new Date}get modified(){return this.#r!=null&&this.#r.latestModified!=null?this.contentsModified!=null&&this.contentsModified>this.#r.latestModified?this.contentsModified:this.#r.latestModified:this.contentsModified}get showHiddenItems(){return this.#e.showHiddenItems===!0}set showHiddenItems(e){e!==this.showHiddenItems&&(this.#e.showHiddenItems=e,this._onPropertyChanged.dispatch(this,"showHiddenItems"))}get showFunctions(){return this.#e.showFunctions===void 0?!0:this.#e.showFunctions}set showFunctions(e){e!==this.showFunctions&&(this.#e.showFunctions=e,this._onPropertyChanged.dispatch(this,"showFunctions"))}get showAssets(){return this.#e.showAssets===void 0?!0:this.#e.showAssets}set showAssets(e){e!==this.showAssets&&(this.#e.showAssets=e,this._onPropertyChanged.dispatch(this,"showAssets"))}get showTypes(){return this.#e.showTypes===void 0?!0:this.#e.showTypes}set showTypes(e){e!==this.showTypes&&(this.#e.showTypes=e,this._onPropertyChanged.dispatch(this,"showTypes"))}get name(){return this.#e.name}set name(e){this.#e.name=e}get lastMapDeployedHash(){return this.#e.lastMapDeployedHash}get lastMapDeployedDate(){return this.#e.lastMapDeployedDate}set lastMapDeployedHash(e){this.#e.lastMapDeployedHash=e}set lastMapDeployedDate(e){this.#e.lastMapDeployedDate=e}get effectiveCreator(){return this.#e.creator&&this.#e.creator.length>0?this.#e.creator:this.carto.creator&&this.carto.creator.length>0?this.carto.creator:"contoso"}get effectiveShortName(){return this.#e.shortName&&this.#e.shortName.length>0?this.#e.shortName:this.effectiveCreator.length>0&&this.#e.name&&this.#e.name.length>0?di.getSuggestedProjectShortName(this.effectiveCreator,this.#e.name):"cont_game"}get shortName(){return this.#e.shortName}set shortName(e){this.#e.shortName!==e&&(this.#e.shortName=e,this._onPropertyChanged.dispatch(this,"shortName"))}get creator(){return this.#e.creator}set creator(e){this.#e.creator!==e&&(this.#e.creator=e,this._onPropertyChanged.dispatch(this,"creator"))}get title(){return this.#e.title?this.#e.title:this.name}set title(e){this.#e.title!==e&&(this.#e.title=e,this._onPropertyChanged.dispatch(this,"title"))}get track(){return this.#e.track}set track(e){e!==this.#e.track&&(this.#e.track=e,this._onPropertyChanged.dispatch(this,"track"))}get effectiveTrack(){return this.#e.track!==void 0?this.#e.track:this.#i.effectiveTrack}set originalFullPath(e){this.#e.originalFullPath!==e&&(this.#e.originalFullPath=e,this._onPropertyChanged.dispatch(this,"originalFullPath"))}get originalFullPath(){return this.#e.originalFullPath}set originalFileList(e){this.#e.originalFileList!==e&&(this.#e.originalFileList=e,this._onPropertyChanged.dispatch(this,"originalFileList"))}get originalFileList(){return this.#e.originalFileList}set originalGitHubOwner(e){this.#e.originalGitHubOwner!==e&&(this.#e.originalGitHubOwner=e,this._onPropertyChanged.dispatch(this,"originalGitHubOwner"))}set originalGalleryId(e){this.#e.originalGalleryId!==e&&(this.#e.originalGalleryId=e,this._onPropertyChanged.dispatch(this,"originalGalleryId"))}get originalGalleryId(){return this.#e.originalGalleryId}set originalSampleId(e){this.#e.originalSampleId!==e&&(this.#e.originalSampleId=e,this._onPropertyChanged.dispatch(this,"originalSampleId"))}get originalSampleId(){return this.#e.originalSampleId}get originalGitHubOwner(){return this.#e.originalGitHubOwner}set originalGitHubFolder(e){this.#e.originalGitHubFolder!==e&&(this.#e.originalGitHubFolder=e,this._onPropertyChanged.dispatch(this,"originalGitHubFolder"))}get originalGitHubFolder(){return this.#e.originalGitHubFolder}set originalGitHubRepoName(e){this.#e.originalGitHubRepoName!==e&&(this.#e.originalGitHubRepoName=e,this._onPropertyChanged.dispatch(this,"originalGitHubRepoName"))}get originalGitHubRepoName(){return this.#e.originalGitHubRepoName}set originalGitHubBranch(e){this.#e.originalGitHubBranch!==e&&(this.#e.originalGitHubBranch=e,this._onPropertyChanged.dispatch(this,"originalGitHubBranch"))}get originalGitHubBranch(){return this.#e.originalGitHubBranch}set gitHubOwner(e){this.#e.gitHubOwner!==e&&(this.#e.gitHubOwner=e,this._onPropertyChanged.dispatch(this,"gitHubOwner"))}get gitHubOwner(){return this.#e.gitHubOwner}set gitHubFolder(e){this.#e.gitHubFolder!==e&&(this.#e.gitHubFolder=e,this._onPropertyChanged.dispatch(this,"gitHubFolder"))}get gitHubFolder(){return this.#e.gitHubFolder}set gitHubRepoName(e){this.#e.gitHubRepoName!==e&&(this.#e.gitHubRepoName=e,this._onPropertyChanged.dispatch(this,"gitHubRepoName"))}get gitHubRepoName(){return this.#e.gitHubRepoName}set gitHubBranch(e){this.#e.gitHubBranch!==e&&(this.#e.gitHubBranch=e,this._onPropertyChanged.dispatch(this,"gitHubBranch"))}get gitHubBranch(){return this.#e.gitHubBranch}get description(){return this.#e.description}set description(e){this.#e.description!==e&&(this.#e.description=e,this._onPropertyChanged.dispatch(this,"description"))}async applyDescription(e){if(this.title=e,this.editPreference===0&&this.defaultBehaviorPackUniqueId){for(let t of this.items)if(t.file&&t.itemType===5){let i=await Et.ensureOnFile(t.file);if(i&&i.definition&&B.uuidEqual(i.definition.header.uuid,this.defaultBehaviorPackUniqueId)){let n=i.ensureHeader(this.title,this.description);n.name=e,i.save()}}}}get autoDeploymentMode(){return this.#e.autoDeploymentMode===void 0?0:this.#e.autoDeploymentMode}set autoDeploymentMode(e){this.#e.autoDeploymentMode!==e&&(this.#e.autoDeploymentMode=e,this._onPropertyChanged.dispatch(this,"autoDeploymentMode"))}get version(){let e=this.#e.versionMajor;e===void 0&&(e=0);let t=this.#e.versionMinor;t===void 0&&(t=0);let i=this.#e.versionPatch;return i===void 0&&(i=0),[e,t,i]}get versionMajor(){return this.#e.versionMajor}set versionMajor(e){this.#e.versionMajor!==e&&(this.#e.versionMajor=e,this._onPropertyChanged.dispatch(this,"versionMajor"))}get versionMinor(){return this.#e.versionMinor}set versionMinor(e){this.#e.versionMinor!==e&&(this.#e.versionMinor=e,this._onPropertyChanged.dispatch(this,"versionMinor"))}get versionPatch(){return this.#e.versionPatch}set versionPatch(e){this.#e.versionPatch!==e&&(this.#e.versionPatch=e,this._onPropertyChanged.dispatch(this,"versionPatch"))}get defaultResourcePackUniqueId(){return this.#e.defaultResourcePackUniqueId}set defaultResourcePackUniqueId(e){this.#e.defaultResourcePackUniqueId!==e&&(this.#e.defaultResourcePackUniqueId=e,this._onPropertyChanged.dispatch(this,"defaultResourcePackUniqueId"))}async setDefaultResourcePackUniqueIdAndUpdateDependencies(e){if(this.#e.defaultResourcePackUniqueId!==e){let t=this.#e.defaultResourcePackUniqueId;this.#e.defaultResourcePackUniqueId=e,t&&t.length>4&&await jt.setNewResourcePackId(this,e,t),this._onPropertyChanged.dispatch(this,"defaultResourcePackUniqueId")}}get defaultResourcePackVersion(){if(this.#e.defaultResourcePackVersion===void 0){let e=this.versionMajor?this.versionMajor:0,t=this.versionMinor?this.versionMinor:0,i=this.versionPatch?this.versionPatch:1;return[e,t,i]}return this.#e.defaultResourcePackVersion}set defaultResourcePackVersion(e){this.#e.defaultResourcePackVersion!==e&&(this.#e.defaultResourcePackVersion=e,this._onPropertyChanged.dispatch(this,"defaultResourcePackVersion"))}get defaultBehaviorPackUniqueId(){return this.#e.defaultBehaviorPackUniqueId}set defaultBehaviorPackUniqueId(e){this.#e.defaultBehaviorPackUniqueId!==e&&(this.#e.defaultBehaviorPackUniqueId=e,this._onPropertyChanged.dispatch(this,"defaultBehaviorPackUniqueId"))}async setDefaultBehaviorPackUniqueIdAndUpdateDependencies(e){if(this.#e.defaultBehaviorPackUniqueId!==e){let t=this.#e.defaultBehaviorPackUniqueId;this.#e.defaultBehaviorPackUniqueId=e,t&&t.length>4&&await Et.setNewBehaviorPackId(this,e,t),this._onPropertyChanged.dispatch(this,"defaultBehaviorPackUniqueId")}}get defaultBehaviorPackVersion(){if(this.#e.defaultBehaviorPackVersion===void 0){let e=this.versionMajor?this.versionMajor:0,t=this.versionMinor?this.versionMinor:0,i=this.versionPatch?this.versionPatch:1;return[e,t,i]}return this.#e.defaultBehaviorPackVersion}set defaultBehaviorPackVersion(e){this.#e.defaultBehaviorPackVersion!==e&&(this.#e.defaultBehaviorPackVersion=e,this._onPropertyChanged.dispatch(this,"defaultBehaviorPackVersion"))}get defaultDataUniqueId(){return this.#e.defaultDataUniqueId}set defaultDataUniqueId(e){this.#e.defaultDataUniqueId!==e&&(this.#e.defaultDataUniqueId=e,this._onPropertyChanged.dispatch(this,"defaultDataUniqueId"))}async ensureScriptInDestination(){let e=await this.ensureBehaviorPackScriptsFolder();if(e===void 0)return;let t=S.canonicalizePath(e.storageRelativePath);for(let i of this.#o)if((i.itemType===1||i.itemType===2)&&i.projectPath){let n=S.canonicalizePath(i.projectPath);if(!n.startsWith(t)){let s=n.indexOf("/scripts/");if(s>=0&&(n=n.substring(s+8)),await i.load(),i.file&&i.file.content){let a=await this.ensureItemByProjectPath(S.ensureEndsWithDelimiter(t)+S.ensureNotStartsWithDelimiter(n),0,S.getLeafName(n),69,void 0,0).ensureFileStorage();a&&a.setContent(i.file.content)}}}}async hasScript(){for(let t of this.#o)if(t.itemType===12||t.itemType===1||t.itemType===2||t.itemType===69||t.itemType===13)return!0;let e=await this.getBehaviorPackScriptsFolder();return e?(await e.load(),e.fileCount>0||e.folderCount>0):!1}get projectCabinetFile(){return this.#p}get defaultScriptModuleUniqueId(){return this.#e.defaultScriptModuleUniqueId}set defaultScriptModuleUniqueId(e){this.#e.defaultScriptModuleUniqueId!==e&&(this.#e.defaultScriptModuleUniqueId=e,this._onPropertyChanged.dispatch(this,"defaultScriptModuleUniqueId"))}get focus(){return this.#e.focus}set focus(e){this.#e.focus!==e&&(this.#e.focus=e,this._onPropertyChanged.dispatch(this,"focus"))}notifyProjectItemChanged(e){this._onItemChanged.dispatch(this,e)}clearFolders(){this._unapplyFromProjectFolder(),this.#t&&this.#t.clearAllManagers(),this.#t=null,this.#s=null,this.#F=null,this.#b=null,this.#u=null,this.#g=null,this.#m=null,this.#n=null,this.#y=null,this.#O=null,this.#f=null,this.#P=[]}async inferProjectItemsFromFiles(e){if(!this.#T||e){if(await this.ensureProjectFolder(),this.#p!==null){let t=await this.carto.notifyOperationStarted("Loading project files for '"+this.name+"' from '"+this.#p.fullPath+"'",2);await this.ensureProjectFolderFromCabinet(),this.#t&&await this._inferProjectItemsFromFolder(this.#t,"",0,!1,this.#t,0,void 0,e),await this.carto.notifyOperationEnded(t,"Done loading project files for '"+this.name+"' from file '"+this.#p.fullPath+"'",2),this.#T=!0}else await this.inferProjectItemsFromFilesRootFolder();if(this.#k)for(let t=0;t<this.#k.length;t++)await this._inferProjectItemsFromFolder(this.#k[t],"",0,!1,this.#k[t],0,"o."+this.#k[t].name,e);await mr.calculate(this)}}async inferProjectItemsFromFilesRootFolder(e){let t=await this.ensureProjectFolder(),i=await this.carto.notifyOperationStarted("Loading project files for '"+this.name+"' from folder '"+t.fullPath+"'",2);this.#t&&(await this._inferProjectItemsFromFolder(t,"",0,!1,this.#t,0,void 0,e),await mr.calculate(this)),await this.carto.notifyOperationEnded(i,"Done loading project files for '"+this.name+"' from folder '"+t.fullPath+"'",2),this.#T=!0}async ensureWorldContainer(){if(!this.#f){let e=await this.ensureProjectFolder();e&&(await e.load(!1),e.folders.worlds?this.#f=e.folders.worlds:e.folders.minecraftWorlds?this.#f=e.folders.minecraftWorlds:this.#f=e)}return this.#f}async ensureCatalogIndex(){if(!this.hasScript)return;let e=await this.ensureBehaviorPackScriptsFolder();e&&this.ensureItemByTag("jsindex","index.js",3,S.ensureEndsWithDelimiter(e.storageRelativePath)+"index.js",0,1)}async ensureAutogeneratedBehaviorPackManifest(){let e=await this.ensureDefaultBehaviorPackFolder();e&&this.ensureItemByTag("manifestjson","behaviorpackmanifest",5,S.ensureEndsWithDelimiter(e.storageRelativePath)+"manifest.json",0,1)}dispose(){this.#t&&(this._unapplyFromProjectFolder(),this.#t.dispose(),this.#t=null),this.#p&&(this.#p.dispose(),this.#p=null),this.#a&&(this.#a.dispose(),this.#a=null),this.#l&&(this.#l.dispose(),this.#l=null),this.#c&&(this.#c.dispose(),this.#c=null),this.#d&&(this.#d.dispose(),this.#d=null),this.#m&&(this.#m.dispose(),this.#m=null),this.#f&&(this.#f.dispose(),this.#f=null),this.#g&&(this.#g.dispose(),this.#g=null),this.#s&&(this.#s.dispose(),this.#s=null),this.#u&&(this.#u.dispose(),this.#u=null),this.#y&&(this.#y.dispose(),this.#y=null),this.#n&&(this.#n.dispose(),this.#n=null),this.#S=!0}resetProjectItems(){let e=[];for(let t of this.items)t.itemType!==0&&t.itemType!==6&&e.push(t);this.#o=e}ensureStoragePathIsCollapsed(e){for(let t of this.collapsedStoragePaths)if(t===e)return;this.collapsedStoragePaths.push(e)}ensureStoragePathIsNotCollapsed(e){let t=[];for(let i of this.collapsedStoragePaths)i!==e&&t.push(e);this.#e.collapsedStoragePaths=t}async _inferProjectItemsFromFolder(e,t,i,n,s,o,a,l){if(this.projectFolder===null||e.name.startsWith(".")&&!e.name.startsWith(".vscode")){C.debugAlert("Could not process folder: "+e.storageRelativePath);return}await e.load(l||!1);let u=e.parentFolder;u===this.projectFolder.parentFolder&&(u=null);let c=S.canonicalizePath(S.getFolderPath(e.storageRelativePath));if(c.indexOf("/checkpoint_input")>=0||c.indexOf("/metadata")>=0||c.indexOf("/type_definitions")>=0||c.indexOf("/typedefs")>=0||c.indexOf("/script_modules/")>=0||c.indexOf("/vanilladata_modules/")>=0||c.indexOf("/engine_modules/")>=0||c.indexOf("/command_modules/")>=0?i=6:c.indexOf("/data/")>=0||c.indexOf("/forms/")>=0?i=10:c.indexOf("/.vscode")>=0?i=8:Be.pathLooksLikeBehaviorPackName(c)?i=1:Be.pathLooksLikeResourcePackName(c)?i=2:Be.pathLooksLikeSubPacksFolderName(c)?i=9:Be.pathLooksLikeSkinPackName(c)&&i===0?i=3:Be.pathLooksLikePersonaPackName(c)&&i===0?i=12:Be.pathLooksLikeWorldFolderName(c)&&i===0?(i=5,n=!0):(c.indexOf("/docs/")>=0||c.indexOf("/@minecraft/")>=0||c.indexOf("/mojang-commands")>=0)&&i===0&&(i=4,this.#m===null&&(this.#m=e.parentFolder)),i===0&&(e.files["manifest.json"]||e.files["pack_manifest.json"])&&!e.files["level.dat"]&&!e.files["levelname.txt"])for(let d in e.folders)d&&(d.toLowerCase()==="persona"||d.toLowerCase().startsWith("persona_"))&&(i=12);i===0&&(e.files["manifest.json"]||e.files["pack_manifest.json"])&&!e.files["level.dat"]&&!e.files["levelname.txt"]&&(e.folders.models||e.folders.textures||e.folders.lighting||e.folders.subpacks||e.folders.assets||e.folders.sounds||e.folders.texture_sets||e.folders.sounds||e.folders.ui||e.fullPath.indexOf("/rp/")>=0||e.fullPath.indexOf(" rp/")>=0||e.fullPath.indexOf("/rp ")>=0||e.fullPath.indexOf("esource")>=0?i=2:i=1),(e.files["world_behavior_packs.json"]||e.files["world_resource_packs.json"]||e.files["levelname.txt"])&&(i===0&&(i=5),e.parentFolder&&!this.#f&&(this.#f=e.parentFolder));for(let d in e.files){let h=S.canonicalizeName(d);if(h!=="gulpfile.js"&&h!=="package-lock.json"){let f=e.files[d];if(f!==void 0){let m=null,p;if(t.length>0)p=t+f.fullPath,m=this.getItemByProjectPath(p);else{let g=f.getFolderRelativePath(s);g!==void 0&&(p=S.canonicalizePath(g),m=this.getItemByProjectPath(p))}if(m==null&&p!==void 0){let g=f.type,b=S.getBaseFromName(f.name),F=S.canonicalizePath(S.getFolderPath(p)),w=F.toLowerCase();if(h==="manifest.json"||h==="pack_manifest.json"){if(i===5&&(this.#F=e,this.#f=u),await f.loadContent(!1),f.content!==void 0&&f.content!==""&&typeof f.content=="string")try{let A=JSON.parse(f.content);if(A.header.uuid!==void 0&&(i===1?(this.defaultBehaviorPackUniqueId=A.header.uuid,this.#s=e,this.#g=u,this.ensurePackByFolder(e,1)):i===2&&(this.defaultResourcePackUniqueId=A.header.uuid,this.#n=e,this.#y=u,this.ensurePackByFolder(e,0))),A.modules)for(let T=0;T<A.modules.length;T++){let E=A.modules[T];E.type==="script"&&(this.defaultScriptModuleUniqueId=E.uuid)}A.header.description!==void 0&&(this.description=A.header.description),A.header.name!==void 0&&(this.title=A.header.name),A.header.version!==void 0&&A.header.version.length===3&&i===1&&(this.versionMajor=A.header.version[0],this.versionMinor=A.header.version[1],this.versionPatch=A.header.version[2])}catch{}let _=0,I="";i===1?(_=5,I="behaviorpackmanifest"):i===2?(_=14,I="resourcepackmanifest"):i===3?(_=67,I="skinpackmanifest"):i===12?(_=125,I="personapackmanifest"):i===5&&(_=68,I="worldtemplatemanifest"),this.ensureItemByProjectPath(p,0,f.name,_,a,0,f,I,n)}else if(p.endsWith("/scripts/index.js")){await f.loadContent();let _=0;(f.content===void 0||f.content===""||typeof f.content=="string"&&f.content.indexOf(pp)>=0)&&(_=1),this.ensureItemByTag("jsindex","index.js",3,p,0,_,f,n)}else if(p.endsWith("tasks.json")&&i===8)this.ensureItemByProjectPath(p,0,f.name,76,a,0,f,void 0,n);else if(p.endsWith("launch.json")&&i===8)this.ensureItemByProjectPath(p,0,f.name,75,a,0,f,void 0,n);else if(p.endsWith("settings.json")&&i===8)this.ensureItemByProjectPath(p,0,f.name,77,a,0,f,void 0,n);else if(p.endsWith("extensions.json")&&i===8)this.ensureItemByProjectPath(p,0,f.name,78,a,0,f,void 0,n);else if(p.endsWith("/tick.json"))this.ensureItemByProjectPath(p,0,f.name,81,a,0,f,void 0,n);else if(g==="mcstructure")this.ensureItemByProjectPath(p,0,f.name,4,a,0,f,void 0,n);else if(g==="mcfunction")this.ensureItemByProjectPath(p,0,f.name,9,a,0,f,void 0,n);else if(g==="material")this.ensureItemByProjectPath(p,0,f.name,83,a,0,f,void 0,n);else if(g==="vertex")this.ensureItemByProjectPath(p,0,f.name,85,a,0,f,void 0,n);else if(g==="fragment")this.ensureItemByProjectPath(p,0,f.name,86,a,0,f,void 0,n);else if(g==="geometry")this.ensureItemByProjectPath(p,0,f.name,87,a,0,f,void 0,n);else if(h==="level.dat"&&t.indexOf(".mcworld")<0&&t.indexOf(".mctemplate")<0&&i!==1)n=!0,this.ensureItemByProjectPath(F,1,f.name,16,a,0,f,void 0,n);else if(h==="just.config.ts")this.ensureItemByProjectPath(p,0,f.name,119,a,0,f,void 0,n);else if(h==="eslint.config.mjs")this.ensureItemByProjectPath(p,0,f.name,120,a,0,f,void 0,n);else if(g==="js")this.ensureItemByProjectPath(p,0,f.name,2,a,0,f,void 0,n);else if(g==="ts")this.ensureItemByProjectPath(p,0,f.name,13,a,0,f,void 0,n);else if(g==="mcworld")this.ensureItemByProjectPath(p,0,f.name,7,a,0,f,void 0,n),await this.inferProjectItemsFromZipFile(p,f,l);else if(g==="mcproject")this.ensureItemByProjectPath(p,0,f.name,73,a,0,f,void 0,n),await this.inferProjectItemsFromZipFile(p,f,l);else if(g==="mctemplate")this.ensureItemByProjectPath(p,0,f.name,8,a,0,f,void 0,n),await this.inferProjectItemsFromZipFile(p,f,l);else if(g==="mcaddon")this.ensureItemByProjectPath(p,0,f.name,53,a,0,f,void 0,n),await this.inferProjectItemsFromZipFile(p,f,l);else if(g==="mcpack")this.ensureItemByProjectPath(p,0,f.name,55,a,0,f,void 0,n),await this.inferProjectItemsFromZipFile(p,f,l);else if(g==="zip")this.ensureItemByProjectPath(p,0,f.name,54,a,0,f,void 0,n),await this.inferProjectItemsFromZipFile(p,f,l);else if(g==="png"||g==="jpg"||g==="gif"||g==="jpeg"||g==="tga"){let _=74;w.indexOf("/marketing art/")>=0?_=100:w.indexOf("/store art/")>=0?_=101:w.indexOf("/textures/ui/")>=0?_=102:b==="pack_icon"||e.files["manifest.json"]?_=103:w.indexOf("/textures/")>=0&&(_=99),this.ensureItemByProjectPath(p,0,f.name,_,a,0,f,void 0,n)}else if(g==="ogg"||g==="mp3"||g==="wav")this.ensureItemByProjectPath(p,0,f.name,108,a,0,f,void 0,n);else if(g==="env"&&b==="")this.ensureItemByProjectPath(p,0,f.name,121,a,0,f,void 0,n);else if(g==="lang")this.ensureItemByProjectPath(p,0,f.name,79,a,0,f,void 0,n);else if(g==="json"){let _=6,I=f.name;i===1&&w.indexOf("/loot_tables/")>=0?_=24:i===1&&w.indexOf("/dialogue/")>=0?_=39:i===1&&w.indexOf("/recipes/")>=0?_=43:i===1&&w.indexOf("/spawn_rules/")>=0?_=44:i===1&&w.indexOf("/cameras/")>=0?_=82:i===1&&w.indexOf("/trading/")>=0?_=45:i===1&&w.indexOf("/animation_controllers/")>=0?_=20:i===1&&w.indexOf("/animations/")>=0?_=19:i===2&&(w.indexOf("/models/")>=0||b.endsWith(".geo")||b.endsWith(".geometry"))?_=32:b.endsWith(".mci")?_=112:b.endsWith(".mcr")?_=113:i===1&&w.indexOf("/dimension/")>=0?_=96:i===1&&w.indexOf("/features/")>=0?_=41:i===1&&w.indexOf("/feature_rules/")>=0?_=40:i===2&&w.indexOf("/animation_controllers/")>=0?_=29:i===2&&w.indexOf("/animations/")>=0?_=28:i===2&&w.indexOf("/attachables/")>=0?_=47:i===2&&w.indexOf("/fogs/")>=0?_=31:i===2&&w.indexOf("/particles/")>=0?_=33:i===2&&w.indexOf("/render_controllers/")>=0?_=34:i===2&&w.indexOf("/block_culling/")>=0?_=127:i===1&&w.indexOf("/item_catalog/crafting_item_catalog")>=0?_=128:(i===2||i===9)&&(p.endsWith("terrain_texture.json")||p.endsWith("terrain_textures.json"))?_=93:(i===2||i===9)&&p.endsWith("_global_variables.json")?_=94:(i===2||i===9)&&p.endsWith("flipbook_textures.json")?_=91:(i===2||i===9)&&(p.endsWith("item_texture.json")||p.endsWith("item_textures.json"))?_=92:i===3&&p.endsWith("skins.json")?_=123:i===2&&w.indexOf("/materials/")>=0?_=84:i===2&&w.indexOf("/sounds/")>=0&&b==="sound_definitions"?_=51:i===2&&w.indexOf("/sounds/")>=0&&b==="music_definitions"?_=50:w.indexOf("/texts/")>=0||b==="languages"?_=37:(i===2||i===9)&&w.indexOf("/textures/ui/")>=0?_=35:i===2&&w.indexOf("/texture_sets/")>=0?_=89:(i===2||i===9)&&w.indexOf("/lighting/")>=0?_=88:i===2&&w.indexOf("/ui/")>=0?_=36:i===4&&b==="example_files"?_=105:i===2&&b==="biomes_client"?_=25:(i===2||i===9)&&b==="blocks"?_=26:(i===2||i===9)&&(p.endsWith("texture_list.json")||p.endsWith("textures_list.json"))?_=104:(i===2||i===9)&&p.endsWith("texture_set.json")?_=89:i===2&&w.indexOf("/items/")>=0?_=48:i===2&&b==="sounds"?_=27:b==="world_behavior_packs"?_=17:b==="world_resource_packs"?_=18:b==="world_behavior_pack_history"?_=97:b==="world_resource_pack_history"?_=98:b==="tsconfig"?_=58:b==="docfx"?_=65:b==="jsdoc"?_=66:b==="jsconfig"?_=64:b==="package"?_=59:b==="package.lock"?_=60:b===".prettierrc"?_=122:i===4&&b==="info"?(_=61,this.role=1,I=S.getLeafName(F)):(i===2||i===9)&&w.indexOf("/textures/")>=0?_=35:i===4&&(b==="_example_files"||b==="example_files")?(_=105,this.role=1,I=S.getLeafName(F)):i===6&&w.indexOf("/command_modules")>=0?(_=63,this.role=1):i===10&&w.indexOf("/forms")>=0||p.endsWith(".form.json")?(_=95,this.role=2):i===6&&w.indexOf("/script_modules")>=0?(_=62,this.role=1):i===6&&w.indexOf("/vanilladata_modules")>=0?(_=106,this.role=1):i===6&&w.indexOf("/engine_modules")>=0?(_=107,this.role=1):i===1&&w.indexOf("/items/")>=0?_=23:i===1&&w.indexOf("/blocks/")>=0?_=21:i===2&&(w.indexOf("/entities/")>=0||w.indexOf("/entity/")>=0)?_=30:i===1&&(w.indexOf("/entities/")>=0||w.indexOf("/entity/")>=0)&&(_=10),this.ensureItemByProjectPath(p,0,I,_,a,0,f,void 0,n)}}else m&&p!==void 0&&(m.itemType===7||m.itemType===73||m.itemType===8||m.itemType===53||m.itemType===55||m.itemType===54)&&await this.inferProjectItemsFromZipFile(p,f,l)}}}for(let d in e.folders){let h=e.folders[d];if(h&&!h.errorStatus){let f=S.canonicalizeName(d);f==="build"||f==="out"||f==="dist"?this.#a=e:f==="lib"?this.#l=e:f!=="node_modules"&&(f.startsWith(".vscode")||!f.startsWith("."))&&f!=="test"&&(i!==0||o<4)&&o<10&&h!==void 0&&await this._inferProjectItemsFromFolder(h,t,i,n,s,o+1,a,l)}}}async ensureProjectFolderFromCabinet(){if(!this.#p){C.unexpectedUndefined("EPFFC");return}await this.#p.loadContent();let e=await S.getFileStorageFolder(this.#p);e!==this.#t&&(this._unapplyFromProjectFolder(),e?(this.#t=e,this._applyToProjectFolder()):this.#t=null)}async inferProjectItemsFromZipFile(e,t,i){let n=await this.carto.notifyOperationStarted("Loading package file "+t.name);await t.loadContent();let s=await S.getFileStorageFolder(t);s&&(await this._inferProjectItemsFromFolder(s,e+"#",0,!1,s,0,void 0,i),await mr.calculate(this)),await this.carto.notifyOperationEnded(n,"Done loading package file "+t.name)}async ensureDefaultItems(){if(this.focus===1&&this.projectFolder!==null){let t=(await this.ensureDefaultBehaviorPackFolder()).getFolderRelativePath(this.projectFolder),i=this.ensureItemByTag("gametestjs","Test",1,t+"scripts/test.js",0),n=await i.ensureFileStorage();if(n!==null){let s="";this.preferredScriptLanguage===1?s=Ui.getDefaultTestTypeScript(this.name,S.getBaseFromName("test")):s=Ui.getDefaultTestJavaScript(this.name,S.getBaseFromName("test")),n.setContent(s)}if(await this.ensureJsIndexFile(),i=this.ensureItemByTag("manifestjson","manifest",5,t+"manifest.json",0,1),i=this.ensureItemByTag("gameteststructure","Basic",4,t+"structures/gametests/basic.mcstructure",0),n=await i.ensureFileStorage(),n!==null){let s=Ui.generateDefaultStructure();s!==void 0&&n.setContent(s)}}}async ensureJsIndexFile(){if(this.projectFolder===null)throw new Error("Could not find project folder");let t=(await this.ensureDefaultBehaviorPackFolder()).getFolderRelativePath(this.projectFolder);this.ensureItemByTag("jsindex","index.js",3,t+"scripts/index.js",0,1)}async applyUpdate(e,t){return await new Kr(this).update(e,t)}async getScriptState(){let e={hasScript:!1,hasModule:{}};for(let t=0;t<this.#o.length;t++){let i=this.#o[t];if((i.itemType===2||i.itemType===69||i.itemType===1||i.itemType===13||i.itemType===15)&&(e.hasScript=!0,(i.itemType===2||i.itemType===69||i.itemType===1||i.itemType===13)&&i.file)){await i.file.loadContent();let n=i.file.content;if(n&&typeof n=="string")for(let s=0;s<cl.length;s++){let o=cl[s];n.indexOf(o.id)>=0&&(e.hasModule[o.id]=!0)}}}return e}getFirstItemByType(e){for(let t=0;t<this.#o.length;t++){let i=this.#o[t];if(i.itemType===e)return i}}hasAddonJson(){return!1}async loadFolderStructure(){if(C.assert(!this.#S,"PLFS"),this.#L)return;let e=await this.ensureProjectFolder();await this.processProjectFolder(e),this.#L=!0}async processProjectFolder(e){await e.load();let t=e.files["manifest.json"];if(t===void 0&&(t=e.files["pack_manifest.json"]),!this.#t)throw new Error("Unexpectedly could not find a project folder.");if(t){let i=e.parentFolder;i===this.#t.parentFolder&&(i=null);let n=!1,s=!1;i!==null&&S.canonicalizeName(i.name).indexOf("resource")>=0&&(n=!0),e.files["level.dat"]&&(s=!0),s&&this.#F===null?(this.#F=e,i!==null&&(this.#f=i)):!s&&n&&this.#n===null?(this.#n=e,i!==null&&(this.#y=i)):!s&&this.#s===null&&(this.#s=e,i!==null&&(this.#g=i))}else for(let i in e.folders){let n=e.folders[i];n!==void 0&&!n.errorStatus&&await this.processProjectFolder(n)}}getItemByFile(e){let t=this.getItemByProjectPath(e.storageRelativePath);return t!==void 0?t:this.getItemByExtendedOrProjectPath(e.extendedPath)}getItemByProjectPath(e){return this.#h[di.canonicalizeStoragePath(e)]}getItemByExtendedOrProjectPath(e){let t=di.canonicalizeStoragePath(e),i=this.#h[t];if(i)return i;let n=t.indexOf("/",1);if(n>1&&(i=this.#h[t.substring(n)],i)||(n=t.indexOf("root/",1),n>1&&(n=t.indexOf("/",n+5),n>1&&(i=this.#h[t.substring(n)],i))))return i}ensureItemByProjectPath(e,t,i,n,s,o,a,l,u){let c=this.getItemByProjectPath(e);if(c!==void 0)return!c.file&&a&&c.setFile(a),c;let d=[];return l&&d.push(l),c=this.createItem({itemType:n,projectPath:e,storageType:t,creationType:o,source:s,tags:d,name:i}),a&&c.setFile(a),u!==void 0&&(c.isInWorld=u),c.itemType===6&&n!==6&&(c.itemType=n),c}getItemByTag(e){for(let t=0;t<this.#o.length;t++){let i=this.#o[t];if(i.hasTag(e))return i}return null}getItemByType(e){let t=[];for(let i=0;i<this.#o.length;i++){let n=this.#o[i];n.itemType===e&&t.push(n)}return t}ensureItemByTag(e,t,i,n,s,o,a,l){let u=this.getItemByTag(e);return u!=null||(u=this.createItem({itemType:i,projectPath:n,storageType:s,creationType:o,tags:[e],name:t}),a&&u.setFile(a),u.itemType===6&&i!==6&&(u.itemType=i)),u}async ensureWorkingFolderForFile(e){if(!this.projectFolder)return;let t=e.getFolderRelativePath(this.projectFolder);return t===void 0?void 0:(t=S.canonicalizePath(t),t=S.ensureEndsWithDelimiter(t.replace(/\./gi,"_")),await this.projectFolder.ensureFolder(".working").ensureFolderFromRelativePath(t))}createItem(e){this.#e.items.push(e);let t=new Ro(this,e);return this.#h[di.canonicalizeStoragePath(t.projectPath)]=t,this.#o.push(t),this._onItemAdded.dispatch(this,t),t}async ensureLoadedFromFile(){C.assert(!this.#S,"PLF"),!this.#D&&this.#r!==null&&(await this.#r.loadContent(!1),this.#T=!1,this.#o=[],this.#h={},this.#e.items=[],B.isString(this.#r.content)&&this.#r.content!=null?(this.#e=JSON.parse(this.#r.content),await this.ensureProjectFolder(!0)):await this.ensureProjectFolder(),this._onLoaded.dispatch(this,this),this.#D=!0)}async ensureInflated(){if(C.assert(!this.#S,"PLINF"),!this.#A){if(await this.ensureLoadedFromFile(),this.#o=[],this.#h={},this.#e)for(let e=0;e<this.#e.items.length;e++){let t=this.#e.items[e],i=new Ro(this,t);this.#h[di.canonicalizeStoragePath(i.projectPath)]=i,this.#o.push(i),this._onItemAdded.dispatch(this,i)}this._onInflated.dispatch(this,this),this.initializeWorldSettings(),this.ensureDefaultWorldName(),await mr.calculate(this),this.#A=!0}}async deleteThisProject(){this.#r&&await this.#r.deleteThisFile(),await this.loadFolderStructure(),this.projectFolder&&await this.#t?.deleteThisFolder()}async saveToFile(){if(C.assert(!this.#S,"PSF"),this.#r===null)return;let e=JSON.stringify(this.#e,null,2);this.#r.setContent(e),await this.#r.saveContent()}_handleDeployUpdated(e){this.#i.notifyStatusUpdate(e)}async save(e){if(C.assert(!this.#S,"PSFA"),this.#E)throw new Error("Attempting to save project in read-only mode.");await this.ensureProjectFolder();for(let t=0;t<this.#o.length;t++){let i=this.#o[t];(i.needsSave||e)&&i.isInFileContainer&&(await i.prepareToSave(),this.updateContentsModified(),await this.#o[t].saveContent())}for(let t=0;t<this.#o.length;t++){let i=this.#o[t];(i.needsSave||e)&&!i.isInFileContainer&&(await i.prepareToSave(),this.updateContentsModified(),await this.#o[t].saveContent())}await this.saveToFile(),this.changedFilesSinceLastSaved={},this.projectFolder&&await this.projectFolder.saveAll(),this.autoDeploymentMode===0&&this.#i.deploymentStorage!==null&&this.#i.deployBehaviorPacksFolder!==null&&this.#i.activeMinecraft&&await this.#i.activeMinecraft.syncWithDeployment(),this._onSaved.dispatch(this,this)}async autoCompleteProject(){await this.ensureScriptInDestination(),await this.ensureCatalogIndex(),await this.ensureAutogeneratedBehaviorPackManifest()}updateProjectItemsFromContent(){this.#h={};for(let e of this.items)e&&e.projectPath&&(e.updateProjectPath(),this.#h[e.projectPath]=e)}setProjectFolder(e){this.#t!==e&&(this._unapplyFromProjectFolder(),this.#t=e,this._applyToProjectFolder()),this.#R=!0}_unapplyFromProjectFolder(){this.#t&&(this.#t.storage.onFileContentsUpdated.unsubscribe(this._handleProjectFileContentsUpdated),this.#t.onChildFolderMoved.unsubscribe(this._handleProjectFolderMoved))}_applyToProjectFolder(){this.#t&&(this.#t.storage.readOnly=this.#E,this.#t.storage.onFileContentsUpdated.subscribe(this._handleProjectFileContentsUpdated),this.#t.onChildFolderMoved.subscribe(this._handleProjectFolderMoved))}async ensureProjectFolder(e){if(!e&&this.#t!==null&&this.#R)return this.#t;if(this.#e.localFolderPath!==void 0&&this.#i.ensureLocalFolder!==void 0&&this.#i.localFolderExists!==void 0)if(await this.#i.localFolderExists(this.#e.localFolderPath)){let n=this.#i.ensureLocalFolder(this.#e.localFolderPath);n!==this.#t&&(this._unapplyFromProjectFolder(),await n.ensureExists(),this.#t=n,this._applyToProjectFolder())}else{let n=this.#i.projectsStorage.rootFolder.ensureFolder(di.canonicalizeStoragePath(this.#e.name));n!==this.#t&&(this._unapplyFromProjectFolder(),await n.ensureExists(),this.#t=n,this._applyToProjectFolder(),C.debug("Using project storage root folder as a backup because local folder path could not be found: "+this.#t.fullPath)),this.#_=1}else if(this.#e.mainDeployFolderPath!==void 0&&this.#i.ensureLocalFolder!==void 0&&this.#i.localFolderExists!==void 0){let i=this.#i.projectsStorage.rootFolder.ensureFolder(di.canonicalizeStoragePath(this.#e.name));if(i!==this.#t&&(this._unapplyFromProjectFolder(),await i.ensureExists(),this.#t=i,this._applyToProjectFolder()),await this.#i.localFolderExists(this.#e.mainDeployFolderPath)){let s=this.#i.ensureLocalFolder(this.#e.mainDeployFolderPath);s!==this.#I&&(this.#I=s,this.#x=new ta(this,s),await this.#x.fullIngestIntoProject())}else this.#_=1}else if(this.#e.mainDeployFolderPath!==void 0&&this.#i.isDeployingToComMojang&&this.#i.deploymentStorage){let i=this.#i.projectsStorage.rootFolder.ensureFolder(di.canonicalizeStoragePath(this.#e.name));i!==this.#t&&(this._unapplyFromProjectFolder(),await i.ensureExists(),this.#t=i,this._applyToProjectFolder());let n=await this.#i.deploymentStorage.ensureFolderFromStorageRelativePath(this.#e.mainDeployFolderPath);await n.exists()?n!==this.#I&&(this.#I=i,this.#x=new ta(this,n),await this.#x.fullIngestIntoProject()):this.#_=1}else if(this.#e.localFilePath!==void 0&&this.#i.ensureLocalFolder!==void 0&&this.#i.localFileExists!==void 0&&this.#i.localFolderExists!==void 0){let i=S.getFolderPath(this.#e.localFilePath),n=S.getLeafName(this.#e.localFilePath);if(!n||n.length<2||!i||i.length<2)throw new Error("Could not process file with path: `"+this.#e.localFilePath+"`");let s=this.#i.ensureLocalFolder(i),o=s.ensureFile(n);if(await o.exists()&&(this.#p=o,await this.ensureProjectFolderFromCabinet(),C.assert(this.#t!==void 0,"Could not create a project folder from "+this.#e.localFilePath),this.#v&&this.#t))for(let l=0;l<this.#v.length;l++)if((this.#v[l].startsWith("\\")||this.#v[l].indexOf(":")>=0)&&this.carto.localFileExists&&this.carto.ensureLocalFolder){if(S.isUsableFile(this.#v[l])&&await this.carto.localFileExists(this.#v[l])){let c=this.carto.ensureLocalFolder(S.getFolderPath(this.#v[l]));if(c){c.storage.readOnly=!0;let d=S.getLeafName(this.#v[l]);await c.load();let h=c.files[d];h&&await h.exists()&&(this.#w===null&&(this.#w=[]),this.#w.push(h.parentFolder),this._inferProjectItemFromFile(h,h.parentFolder,h.storageRelativePath))}}}else{let u=s.ensureFile(this.#v[l]);if(await u.exists()){let d=!1;this.#w===null&&(this.#w=[]);for(let h=0;h<this.#w.length;h++){let f=u.getFolderRelativePath(this.#w[h]);f&&(d=!0,this._inferProjectItemFromFile(u,this.#w[h],f))}if(!d&&u.parentFolder){let h=u.getFolderRelativePath(u.parentFolder);h&&(this.#w.push(u.parentFolder),this._inferProjectItemFromFile(u,u.parentFolder,h))}}}if(!this.#t){let l=this.#i.projectsStorage.rootFolder.ensureFolder(di.canonicalizeStoragePath(this.#e.name));l!==this.#t&&(this._unapplyFromProjectFolder(),this.#t=l,this._applyToProjectFolder()),this.#_=1}}else if(this.#B){let i=this.#i.projectsStorage.rootFolder.ensureFolder(this.name);i!==this.#t&&(this._unapplyFromProjectFolder(),this.#t=i,this._applyToProjectFolder())}else{let i=await this.#i.projectsStorage.ensureFolderFromStorageRelativePath(this.#e.dataStorageRelativePath);i!==this.#t&&(this._unapplyFromProjectFolder(),this.#t=i,this._applyToProjectFolder())}let t=await this.#t.ensureExists();return this.#R=t,this.#t}async _inferProjectItemFromFile(e,t,i){let n=S.canonicalizeName(e.name);n.endsWith(".data.json")?this.ensureItemByProjectPath(i,0,e.name,80,void 0,0,e):n.endsWith(".tags.json")&&this.ensureItemByProjectPath(i,0,e.name,124,void 0,0,e)}_handleProjectFolderMoved(e,t){if(this.updateProjectItemsFromContent(),t.previousStoragePath&&this.#t){let i=t.folder.getFolderRelativePath(this.#t);if(i){let n=this.#t.fullPath.substring(0,t.folder.fullPath.length-i.length+1),s=t.previousStoragePath;s.startsWith(n)&&(s=s.substring(n.length));for(let o of this.items)o&&o.projectPath&&o.projectPath.startsWith(s)&&(o.projectPath=i+o.projectPath.substring(s.length))}}}async _handleProjectFileContentsUpdated(e,t){if(!this.#t)return;let i=t.storageRelativePath;this.#t.storageRelativePath.length>0&&i.startsWith(this.#t.storageRelativePath)&&(i=i.substring(this.#t.storageRelativePath.length-1));let n=di.canonicalizeStoragePath(i);this.changedFilesSinceLastSaved[n]||(this.changedFilesSinceLastSaved[n]=t,this._onNeedsSaveChanged.dispatch(this,this));let s=this.#h[n];s&&this.notifyProjectItemChanged(s)}async ensureDistFolder(){if(this.#a)return this.#a;if(await this.loadFolderStructure(),this.#t===void 0||this.#t===null)throw new Error("Unexpectedly could not create project folder");return this.#a===null&&(this.#a=this.#t.ensureFolder("dist"),await this.#a.ensureExists()),this.#a}async ensureDistBuildScriptsFolder(){if(this.#c)return this.#c;if(await this.ensureDistFolder(),this.#a===void 0||this.#a===null)throw new Error("Unexpectedly could not create dist folder");return this.#c===null&&(this.#c=this.#a.ensureFolder("scripts"),await this.#c.ensureExists()),this.#c}getLibFolder(){return this.#l?this.#l:this.#t===void 0||this.#t===null?null:(this.#l===null&&(this.#l=this.#t.ensureFolder("lib")),this.#l)}getDistBuildFolder(){return this.#a?this.#a:this.#t===void 0||this.#t===null?null:(this.#a===null&&(this.#a=this.#t.ensureFolder("dist")),this.#a)}async ensureLibFolder(){if(this.#l)return this.#l;if(await this.loadFolderStructure(),this.#t===void 0||this.#t===null)throw new Error("Unexpectedly could not create project folder");return this.#l===null&&(this.#l=this.#t.ensureFolder("lib"),await this.#l.ensureExists()),this.#l}getLibScriptsFolder(){if(this.#d)return this.#d;let e=this.getLibFolder();return e&&(this.#d=e.ensureFolder("scripts")),this.#d}getDistBuildScriptsFolder(){if(this.#c)return this.#c;let e=this.getDistBuildFolder();return e&&(this.#c=e.ensureFolder("scripts")),this.#c}async ensureLibScriptsFolder(){if(this.#d)return this.#d;if(await this.ensureLibFolder(),this.#l===void 0||this.#l===null)throw new Error("Unexpectedly could not create dist folder");return this.#d===null&&(this.#d=this.#l.ensureFolder("scripts"),await this.#d.ensureExists()),this.#d}async ensureDocsFolder(){if(this.#m!==null)return this.#m;let e=await this.ensureProjectFolder();return this.#m=e.ensureFolder("docs"),this.#m}async ensureDefaultScriptsFolder(){if(this.#u!==null)return this.#u;for(let i=0;i<this.items.length;i++){let n=this.items[i];if((n.itemType===2||n.itemType===13)&&(await n.ensureFileStorage(),n.file&&(this.#u=n.file.parentFolder,this.#u!==null)))return this.#u}if(await this.loadFolderStructure(),this.#t===void 0||this.#t===null)throw new Error("Unexpectedly could not create project folder");if(this.#u!==null)return this.#u;if(this.#u===null){await this.#t.load();let i=this.#t.folders.scripts;if(i&&await i.exists())return this.#u=i,this.#u}let e=await this.ensureDefaultBehaviorPackFolder();if(!e)return this.#t.ensureFolder("scripts");let t=e.ensureFolder("scripts");return await t.ensureExists(),this.#u=t,this.#u}async getDefaultWorldFolder(){return this.#F!==null?this.#F:(await this.loadFolderStructure(),this.#F)}ensurePacks(){for(let e of this.items)if(e.itemType===5){let t=e.file;t&&t.parentFolder&&this.ensurePackByFolder(t.parentFolder,1)}else if(e.itemType===14){let t=e.file;t&&t.parentFolder&&this.ensurePackByFolder(t.parentFolder,0)}else if(e.itemType===67){let t=e.file;t&&t.parentFolder&&this.ensurePackByFolder(t.parentFolder,2)}else if(e.itemType===125){let t=e.file;t&&t.parentFolder&&this.ensurePackByFolder(t.parentFolder,3)}}async getDefaultBehaviorPackFolder(e,t){if(this.#s!==null&&!e)return this.#s;if(await this.loadFolderStructure(),this.#s!==null&&!e)return this.#s;e&&(this.#s=null);for(let i=0;i<this.items.length;i++){let n=this.items[i];if(n.itemType===5&&(t||await n.ensureFileStorage(),n.file&&(this.#s=n.file.parentFolder,this.ensurePackByFolder(this.#s,1,n.isInWorld),this.#s!==null)))return this.#s}return this.#s}async getDefaultBehaviorPack(){let e=await this.getDefaultBehaviorPackFolder(!1,!1);if(e)return await this.ensurePackByFolder(e,1)}async ensureDefaultBehaviorPackFolder(e){if(this.#s!==null&&!e)return this.#s;if(await this.getDefaultBehaviorPackFolder(e),this.#s!==null)return this.#s;if(this.#t===void 0||this.#t===null)throw new Error("Unexpectedly could not create project folder");return this.#g===null&&(this.#g=this.#t.ensureFolder("behavior_packs"),await this.#g.ensureExists()),this.#s=this.#g.ensureFolder(Be.makeNameFolderSafe(this.effectiveShortName+"_bp")),await this.#s.ensureExists(),this.ensurePackByFolder(this.#s,1,!1),this.#s}async ensurePackByFolder(e,t,i){let n=S.canonicalizePath(e.extendedPath);if(!this.projectFolder)throw new Error("PEPBF");for(let u of this.#P)if(u.folder===e||u.folder&&S.canonicalizePath(u.folder.extendedPath)===n)return u;let s=dl.ensureOnFolder(e,t,this);this.#P.includes(s)||this.#P.push(s);let o=109;t===0?o=110:t===2?o=111:t===3&&(o=126);let a=e.getFolderRelativePath(this.projectFolder);if(!a)throw new Error("PEBBFA");let l=this.ensureItemByProjectPath(a,1,e.name,o,void 0,0,void 0,void 0,i);return s.projectItem=l,s}async getDefaultSkinPackFolder(e){if(this.#b!==null&&!e)return this.#b;if(await this.loadFolderStructure(),this.#b!==null&&!e)return this.#b;e&&(this.#b=null);for(let t=0;t<this.items.length;t++){let i=this.items[t];if(i.itemType===67&&(await i.ensureFileStorage(),i.file&&(this.#b=i.file.parentFolder,this.ensurePackByFolder(this.#b,2,i.isInWorld),this.#b!==null)))return this.#b}return null}async getDefaultResourcePackFolder(e){if(this.#n!==null&&!e)return this.#n;if(await this.loadFolderStructure(),this.#n!==null&&!e)return this.#n;e&&(this.#n=null);for(let t=0;t<this.items.length;t++){let i=this.items[t];if(i.itemType===14&&(await i.ensureFileStorage(),i.file&&(this.#n=i.file.parentFolder,this.ensurePackByFolder(this.#n,0,i.isInWorld),this.#n!==null)))return this.#n}return null}async ensureDefaultResourcePackFolder(e){if(this.#n!==null&&!e)return this.#n;if(e&&(this.#n=null),await this.getDefaultResourcePackFolder(e),this.#n!==null)return this.#n;if(await this.loadFolderStructure(),this.#t===void 0||this.#t===null)throw new Error("Unexpectedly could not create project folder");return this.#n!==null?this.#n:(this.#y===null&&(this.#y=this.#t.ensureFolder("resource_packs"),await this.#y.ensureExists()),this.#n=this.#y.ensureFolder(Be.makeNameFolderSafe(this.effectiveShortName+"_rp")),await this.#n.ensureExists(),this.ensurePackByFolder(this.#n,0),this.#n)}async ensureLoadedProjectFolder(e){let t=await this.ensureProjectFolder();return await t.load(e||!1),this.readOnlySafety||await this.save(),t}};var Tn=Le(Je());function cs(){return typeof navigator=="object"&&"userAgent"in navigator?navigator.userAgent:typeof process=="object"&&process.version!==void 0?`Node.js/${process.version.substr(1)} (${process.platform}; ${process.arch})`:"<environment undetectable>"}var FC=Le(Zk());function Yk(r){return Object.prototype.toString.call(r)==="[object Object]"}function Qk(r){var e,t;return Yk(r)===!1?!1:(e=r.constructor,e===void 0?!0:(t=e.prototype,!(Yk(t)===!1||t.hasOwnProperty("isPrototypeOf")===!1)))}function VR(r){return r?Object.keys(r).reduce((e,t)=>(e[t.toLowerCase()]=r[t],e),{}):{}}function iC(r,e){let t=Object.assign({},r);return Object.keys(e).forEach(i=>{Qk(e[i])?i in r?t[i]=iC(r[i],e[i]):Object.assign(t,{[i]:e[i]}):Object.assign(t,{[i]:e[i]})}),t}function eC(r){for(let e in r)r[e]===void 0&&delete r[e];return r}function kg(r,e,t){if(typeof e=="string"){let[n,s]=e.split(" ");t=Object.assign(s?{method:n,url:s}:{url:n},t)}else t=Object.assign({},e);t.headers=VR(t.headers),eC(t),eC(t.headers);let i=iC(r||{},t);return r&&r.mediaType.previews.length&&(i.mediaType.previews=r.mediaType.previews.filter(n=>!i.mediaType.previews.includes(n)).concat(i.mediaType.previews)),i.mediaType.previews=i.mediaType.previews.map(n=>n.replace(/-preview/,"")),i}function WR(r,e){let t=/\?/.test(r)?"&":"?",i=Object.keys(e);return i.length===0?r:r+t+i.map(n=>n==="q"?"q="+e.q.split("+").map(encodeURIComponent).join("+"):`${n}=${encodeURIComponent(e[n])}`).join("&")}var JR=/\{[^}]+\}/g;function $R(r){return r.replace(/^\W+|\W+$/g,"").split(/,/)}function HR(r){let e=r.match(JR);return e?e.map($R).reduce((t,i)=>t.concat(i),[]):[]}function tC(r,e){return Object.keys(r).filter(t=>!e.includes(t)).reduce((t,i)=>(t[i]=r[i],t),{})}function rC(r){return r.split(/(%[0-9A-Fa-f]{2})/g).map(function(e){return/%[0-9A-Fa-f]/.test(e)||(e=encodeURI(e).replace(/%5B/g,"[").replace(/%5D/g,"]")),e}).join("")}function na(r){return encodeURIComponent(r).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function ec(r,e,t){return e=r==="+"||r==="#"?rC(e):na(e),t?na(t)+"="+e:e}function ra(r){return r!=null}function Fg(r){return r===";"||r==="&"||r==="?"}function qR(r,e,t,i){var n=r[t],s=[];if(ra(n)&&n!=="")if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")n=n.toString(),i&&i!=="*"&&(n=n.substring(0,parseInt(i,10))),s.push(ec(e,n,Fg(e)?t:""));else if(i==="*")Array.isArray(n)?n.filter(ra).forEach(function(o){s.push(ec(e,o,Fg(e)?t:""))}):Object.keys(n).forEach(function(o){ra(n[o])&&s.push(ec(e,n[o],o))});else{let o=[];Array.isArray(n)?n.filter(ra).forEach(function(a){o.push(ec(e,a))}):Object.keys(n).forEach(function(a){ra(n[a])&&(o.push(na(a)),o.push(ec(e,n[a].toString())))}),Fg(e)?s.push(na(t)+"="+o.join(",")):o.length!==0&&s.push(o.join(","))}else e===";"?ra(n)&&s.push(na(t)):n===""&&(e==="&"||e==="?")?s.push(na(t)+"="):n===""&&s.push("");return s}function KR(r){return{expand:XR.bind(null,r)}}function XR(r,e){var t=["+","#",".","/",";","?","&"];return r.replace(/\{([^\{\}]+)\}|([^\{\}]+)/g,function(i,n,s){if(n){let a="",l=[];if(t.indexOf(n.charAt(0))!==-1&&(a=n.charAt(0),n=n.substr(1)),n.split(/,/g).forEach(function(u){var c=/([^:\*]*)(?::(\d+)|(\*))?/.exec(u);l.push(qR(e,a,c[1],c[2]||c[3]))}),a&&a!=="+"){var o=",";return a==="?"?o="&":a!=="#"&&(o=a),(l.length!==0?a:"")+l.join(o)}else return l.join(",")}else return rC(s)})}function nC(r){let e=r.method.toUpperCase(),t=(r.url||"/").replace(/:([a-z]\w+)/g,"{$1}"),i=Object.assign({},r.headers),n,s=tC(r,["method","baseUrl","url","headers","request","mediaType"]),o=HR(t);t=KR(t).expand(s),/^http/.test(t)||(t=r.baseUrl+t);let a=Object.keys(r).filter(c=>o.includes(c)).concat("baseUrl"),l=tC(s,a);if(!/application\/octet-stream/i.test(i.accept)&&(r.mediaType.format&&(i.accept=i.accept.split(/,/).map(c=>c.replace(/application\/vnd(\.\w+)(\.v3)?(\.\w+)?(\+json)?$/,`application/vnd$1$2.${r.mediaType.format}`)).join(",")),r.mediaType.previews.length)){let c=i.accept.match(/[\w-]+(?=-preview)/g)||[];i.accept=c.concat(r.mediaType.previews).map(d=>{let h=r.mediaType.format?`.${r.mediaType.format}`:"+json";return`application/vnd.github.${d}-preview${h}`}).join(",")}return["GET","HEAD"].includes(e)?t=WR(t,l):"data"in l?n=l.data:Object.keys(l).length&&(n=l),!i["content-type"]&&typeof n<"u"&&(i["content-type"]="application/json; charset=utf-8"),["PATCH","PUT"].includes(e)&&typeof n>"u"&&(n=""),Object.assign({method:e,url:t,headers:i},typeof n<"u"?{body:n}:null,r.request?{request:r.request}:null)}function ZR(r,e,t){return nC(kg(r,e,t))}function sC(r,e){let t=kg(r,e),i=ZR.bind(null,t);return Object.assign(i,{DEFAULTS:t,defaults:sC.bind(null,t),merge:kg.bind(null,t),parse:nC})}var YR="7.0.6",QR=`octokit-endpoint.js/${YR} ${cs()}`,eB={method:"GET",baseUrl:"https://api.github.com",headers:{accept:"application/vnd.github.v3+json","user-agent":QR},mediaType:{format:"",previews:[]}},oC=sC(null,eB);function aC(r){return Object.prototype.toString.call(r)==="[object Object]"}function lC(r){var e,t;return aC(r)===!1?!1:(e=r.constructor,e===void 0?!0:(t=e.prototype,!(aC(t)===!1||t.hasOwnProperty("isPrototypeOf")===!1)))}var yC=Le(cC());var tc=class extends Error{constructor(e){super(e),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="Deprecation"}};var Sg=Le(gC()),iB=(0,Sg.default)(r=>console.warn(r)),rB=(0,Sg.default)(r=>console.warn(r)),ds=class extends Error{constructor(e,t,i){super(e),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="HttpError",this.status=t;let n;"headers"in i&&typeof i.headers<"u"&&(n=i.headers),"response"in i&&(this.response=i.response,n=i.response.headers);let s=Object.assign({},i.request);i.request.headers.authorization&&(s.headers=Object.assign({},i.request.headers,{authorization:i.request.headers.authorization.replace(/ .*$/," [REDACTED]")})),s.url=s.url.replace(/\bclient_secret=\w+/g,"client_secret=[REDACTED]").replace(/\baccess_token=\w+/g,"access_token=[REDACTED]"),this.request=s,Object.defineProperty(this,"code",{get(){return iB(new tc("[@octokit/request-error] `error.code` is deprecated, use `error.status`.")),t}}),Object.defineProperty(this,"headers",{get(){return rB(new tc("[@octokit/request-error] `error.headers` is deprecated, use `error.response.headers`.")),n||{}}})}};var nB="6.2.8";function sB(r){return r.arrayBuffer()}function bC(r){let e=r.request&&r.request.log?r.request.log:console;(lC(r.body)||Array.isArray(r.body))&&(r.body=JSON.stringify(r.body));let t={},i,n;return(r.request&&r.request.fetch||globalThis.fetch||yC.default)(r.url,Object.assign({method:r.method,body:r.body,headers:r.headers,redirect:r.redirect,...r.body&&{duplex:"half"}},r.request)).then(async o=>{n=o.url,i=o.status;for(let a of o.headers)t[a[0]]=a[1];if("deprecation"in t){let a=t.link&&t.link.match(/<([^>]+)>; rel="deprecation"/),l=a&&a.pop();e.warn(`[@octokit/request] "${r.method} ${r.url}" is deprecated. It is scheduled to be removed on ${t.sunset}${l?`. See ${l}`:""}`)}if(!(i===204||i===205)){if(r.method==="HEAD"){if(i<400)return;throw new ds(o.statusText,i,{response:{url:n,status:i,headers:t,data:void 0},request:r})}if(i===304)throw new ds("Not modified",i,{response:{url:n,status:i,headers:t,data:await Pg(o)},request:r});if(i>=400){let a=await Pg(o);throw new ds(oB(a),i,{response:{url:n,status:i,headers:t,data:a},request:r})}return Pg(o)}}).then(o=>({status:i,url:n,headers:t,data:o})).catch(o=>{throw o instanceof ds||o.name==="AbortError"?o:new ds(o.message,500,{request:r})})}async function Pg(r){let e=r.headers.get("content-type");return/application\/json/.test(e)?r.json():!e||/^text\/|charset=utf-8$/.test(e)?r.text():sB(r)}function oB(r){return typeof r=="string"?r:"message"in r?Array.isArray(r.errors)?`${r.message}: ${r.errors.map(JSON.stringify).join(", ")}`:r.message:`Unknown error: ${JSON.stringify(r)}`}function Eg(r,e){let t=r.defaults(e);return Object.assign(function(n,s){let o=t.merge(n,s);if(!o.request||!o.request.hook)return bC(t.parse(o));let a=(l,u)=>bC(t.parse(t.merge(l,u)));return Object.assign(a,{endpoint:t,defaults:Eg.bind(null,t)}),o.request.hook(a,o)},{endpoint:t,defaults:Eg.bind(null,t)})}var ic=Eg(oC,{headers:{"user-agent":`octokit-request.js/${nB} ${cs()}`}});var aB="5.0.6";function lB(r){return`Request failed due to following response errors:
`+r.errors.map(e=>` - ${e.message}`).join(`
`)}var uB=class extends Error{constructor(r,e,t){super(lB(t)),this.request=r,this.headers=e,this.response=t,this.name="GraphqlResponseError",this.errors=t.errors,this.data=t.data,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}},cB=["method","baseUrl","url","headers","request","query","mediaType"],dB=["query","method","url"],vC=/\/api\/v3\/?$/;function fB(r,e,t){if(t){if(typeof e=="string"&&"query"in t)return Promise.reject(new Error('[@octokit/graphql] "query" cannot be used as variable name'));for(let o in t)if(dB.includes(o))return Promise.reject(new Error(`[@octokit/graphql] "${o}" cannot be used as variable name`))}let i=typeof e=="string"?Object.assign({query:e},t):e,n=Object.keys(i).reduce((o,a)=>cB.includes(a)?(o[a]=i[a],o):(o.variables||(o.variables={}),o.variables[a]=i[a],o),{}),s=i.baseUrl||r.endpoint.DEFAULTS.baseUrl;return vC.test(s)&&(n.url=s.replace(vC,"/api/graphql")),r(n).then(o=>{if(o.data.errors){let a={};for(let l of Object.keys(o.headers))a[l]=o.headers[l];throw new uB(n,a,o.data)}return o.data.data})}function Ig(r,e){let t=r.defaults(e);return Object.assign((n,s)=>fB(t,n,s),{defaults:Ig.bind(null,t),endpoint:t.endpoint})}var mQ=Ig(ic,{headers:{"user-agent":`octokit-graphql.js/${aB} ${cs()}`},method:"POST",url:"/graphql"});function wC(r){return Ig(r,{method:"POST",url:"/graphql"})}var hB=/^v1\./,pB=/^ghs_/,mB=/^ghu_/;async function gB(r){let e=r.split(/\./).length===3,t=hB.test(r)||pB.test(r),i=mB.test(r);return{type:"token",token:r,tokenType:e?"app":t?"installation":i?"user-to-server":"oauth"}}function bB(r){return r.split(/\./).length===3?`bearer ${r}`:`token ${r}`}async function yB(r,e,t,i){let n=e.endpoint.merge(t,i);return n.headers.authorization=bB(r),e(n)}var _C=function(e){if(!e)throw new Error("[@octokit/auth-token] No token passed to createTokenAuth");if(typeof e!="string")throw new Error("[@octokit/auth-token] Token passed to createTokenAuth is not a string");return e=e.replace(/^(token|bearer) +/i,""),Object.assign(gB.bind(null,e),{hook:yB.bind(null,e)})};var kC="4.2.4",Cf=class{static defaults(r){return class extends this{constructor(...t){let i=t[0]||{};if(typeof r=="function"){super(r(i));return}super(Object.assign({},r,i,i.userAgent&&r.userAgent?{userAgent:`${i.userAgent} ${r.userAgent}`}:null))}}}static plugin(...r){var e;let t=this.plugins;return e=class extends this{},e.plugins=t.concat(r.filter(n=>!t.includes(n))),e}constructor(r={}){let e=new FC.Collection,t={baseUrl:ic.endpoint.DEFAULTS.baseUrl,headers:{},request:Object.assign({},r.request,{hook:e.bind(null,"request")}),mediaType:{previews:[],format:""}};if(t.headers["user-agent"]=[r.userAgent,`octokit-core.js/${kC} ${cs()}`].filter(Boolean).join(" "),r.baseUrl&&(t.baseUrl=r.baseUrl),r.previews&&(t.mediaType.previews=r.previews),r.timeZone&&(t.headers["time-zone"]=r.timeZone),this.request=ic.defaults(t),this.graphql=wC(this.request).defaults(t),this.log=Object.assign({debug:()=>{},info:()=>{},warn:console.warn.bind(console),error:console.error.bind(console)},r.log),this.hook=e,r.authStrategy){let{authStrategy:n,...s}=r,o=n(Object.assign({request:this.request,log:this.log,octokit:this,octokitOptions:s},r.auth));e.wrap("request",o.hook),this.auth=o}else if(!r.auth)this.auth=async()=>({type:"unauthenticated"});else{let n=_C(r.auth);e.wrap("request",n.hook),this.auth=n}this.constructor.plugins.forEach(n=>{Object.assign(this,n(this,r))})}};Cf.VERSION=kC;Cf.plugins=[];var vB="1.0.4";function xg(r){r.hook.wrap("request",(e,t)=>{r.log.debug("request",t);let i=Date.now(),n=r.request.endpoint.parse(t),s=n.url.replace(t.baseUrl,"");return e(t).then(o=>(r.log.info(`${n.method} ${s} - ${o.status} in ${Date.now()-i}ms`),o)).catch(o=>{throw r.log.info(`${n.method} ${s} - ${o.status} in ${Date.now()-i}ms`),o})})}xg.VERSION=vB;var wB="6.1.2";function _B(r){if(!r.data)return{...r,data:[]};if(!("total_count"in r.data&&!("url"in r.data)))return r;let t=r.data.incomplete_results,i=r.data.repository_selection,n=r.data.total_count;delete r.data.incomplete_results,delete r.data.repository_selection,delete r.data.total_count;let s=Object.keys(r.data)[0],o=r.data[s];return r.data=o,typeof t<"u"&&(r.data.incomplete_results=t),typeof i<"u"&&(r.data.repository_selection=i),r.data.total_count=n,r}function Tg(r,e,t){let i=typeof e=="function"?e.endpoint(t):r.request.endpoint(e,t),n=typeof e=="function"?e:r.request,s=i.method,o=i.headers,a=i.url;return{[Symbol.asyncIterator]:()=>({async next(){if(!a)return{done:!0};try{let l=await n({method:s,url:a,headers:o}),u=_B(l);return a=((u.headers.link||"").match(/<([^>]+)>;\s*rel="next"/)||[])[1],{value:u}}catch(l){if(l.status!==409)throw l;return a="",{value:{status:200,headers:{},data:[]}}}}})}}function CC(r,e,t,i){return typeof t=="function"&&(i=t,t=void 0),SC(r,[],Tg(r,e,t)[Symbol.asyncIterator](),i)}function SC(r,e,t,i){return t.next().then(n=>{if(n.done)return e;let s=!1;function o(){s=!0}return e=e.concat(i?i(n.value,o):n.value.data),s?e:SC(r,e,t,i)})}var xQ=Object.assign(CC,{iterator:Tg});function Dg(r){return{paginate:Object.assign(CC.bind(null,r),{iterator:Tg.bind(null,r)})}}Dg.VERSION=wB;var PC="7.2.3",FB={actions:{addCustomLabelsToSelfHostedRunnerForOrg:["POST /orgs/{org}/actions/runners/{runner_id}/labels"],addCustomLabelsToSelfHostedRunnerForRepo:["POST /repos/{owner}/{repo}/actions/runners/{runner_id}/labels"],addSelectedRepoToOrgSecret:["PUT /orgs/{org}/actions/secrets/{secret_name}/repositories/{repository_id}"],addSelectedRepoToOrgVariable:["PUT /orgs/{org}/actions/variables/{name}/repositories/{repository_id}"],addSelectedRepoToRequiredWorkflow:["PUT /orgs/{org}/actions/required_workflows/{required_workflow_id}/repositories/{repository_id}"],approveWorkflowRun:["POST /repos/{owner}/{repo}/actions/runs/{run_id}/approve"],cancelWorkflowRun:["POST /repos/{owner}/{repo}/actions/runs/{run_id}/cancel"],createEnvironmentVariable:["POST /repositories/{repository_id}/environments/{environment_name}/variables"],createOrUpdateEnvironmentSecret:["PUT /repositories/{repository_id}/environments/{environment_name}/secrets/{secret_name}"],createOrUpdateOrgSecret:["PUT /orgs/{org}/actions/secrets/{secret_name}"],createOrUpdateRepoSecret:["PUT /repos/{owner}/{repo}/actions/secrets/{secret_name}"],createOrgVariable:["POST /orgs/{org}/actions/variables"],createRegistrationTokenForOrg:["POST /orgs/{org}/actions/runners/registration-token"],createRegistrationTokenForRepo:["POST /repos/{owner}/{repo}/actions/runners/registration-token"],createRemoveTokenForOrg:["POST /orgs/{org}/actions/runners/remove-token"],createRemoveTokenForRepo:["POST /repos/{owner}/{repo}/actions/runners/remove-token"],createRepoVariable:["POST /repos/{owner}/{repo}/actions/variables"],createRequiredWorkflow:["POST /orgs/{org}/actions/required_workflows"],createWorkflowDispatch:["POST /repos/{owner}/{repo}/actions/workflows/{workflow_id}/dispatches"],deleteActionsCacheById:["DELETE /repos/{owner}/{repo}/actions/caches/{cache_id}"],deleteActionsCacheByKey:["DELETE /repos/{owner}/{repo}/actions/caches{?key,ref}"],deleteArtifact:["DELETE /repos/{owner}/{repo}/actions/artifacts/{artifact_id}"],deleteEnvironmentSecret:["DELETE /repositories/{repository_id}/environments/{environment_name}/secrets/{secret_name}"],deleteEnvironmentVariable:["DELETE /repositories/{repository_id}/environments/{environment_name}/variables/{name}"],deleteOrgSecret:["DELETE /orgs/{org}/actions/secrets/{secret_name}"],deleteOrgVariable:["DELETE /orgs/{org}/actions/variables/{name}"],deleteRepoSecret:["DELETE /repos/{owner}/{repo}/actions/secrets/{secret_name}"],deleteRepoVariable:["DELETE /repos/{owner}/{repo}/actions/variables/{name}"],deleteRequiredWorkflow:["DELETE /orgs/{org}/actions/required_workflows/{required_workflow_id}"],deleteSelfHostedRunnerFromOrg:["DELETE /orgs/{org}/actions/runners/{runner_id}"],deleteSelfHostedRunnerFromRepo:["DELETE /repos/{owner}/{repo}/actions/runners/{runner_id}"],deleteWorkflowRun:["DELETE /repos/{owner}/{repo}/actions/runs/{run_id}"],deleteWorkflowRunLogs:["DELETE /repos/{owner}/{repo}/actions/runs/{run_id}/logs"],disableSelectedRepositoryGithubActionsOrganization:["DELETE /orgs/{org}/actions/permissions/repositories/{repository_id}"],disableWorkflow:["PUT /repos/{owner}/{repo}/actions/workflows/{workflow_id}/disable"],downloadArtifact:["GET /repos/{owner}/{repo}/actions/artifacts/{artifact_id}/{archive_format}"],downloadJobLogsForWorkflowRun:["GET /repos/{owner}/{repo}/actions/jobs/{job_id}/logs"],downloadWorkflowRunAttemptLogs:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/attempts/{attempt_number}/logs"],downloadWorkflowRunLogs:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/logs"],enableSelectedRepositoryGithubActionsOrganization:["PUT /orgs/{org}/actions/permissions/repositories/{repository_id}"],enableWorkflow:["PUT /repos/{owner}/{repo}/actions/workflows/{workflow_id}/enable"],generateRunnerJitconfigForOrg:["POST /orgs/{org}/actions/runners/generate-jitconfig"],generateRunnerJitconfigForRepo:["POST /repos/{owner}/{repo}/actions/runners/generate-jitconfig"],getActionsCacheList:["GET /repos/{owner}/{repo}/actions/caches"],getActionsCacheUsage:["GET /repos/{owner}/{repo}/actions/cache/usage"],getActionsCacheUsageByRepoForOrg:["GET /orgs/{org}/actions/cache/usage-by-repository"],getActionsCacheUsageForOrg:["GET /orgs/{org}/actions/cache/usage"],getAllowedActionsOrganization:["GET /orgs/{org}/actions/permissions/selected-actions"],getAllowedActionsRepository:["GET /repos/{owner}/{repo}/actions/permissions/selected-actions"],getArtifact:["GET /repos/{owner}/{repo}/actions/artifacts/{artifact_id}"],getEnvironmentPublicKey:["GET /repositories/{repository_id}/environments/{environment_name}/secrets/public-key"],getEnvironmentSecret:["GET /repositories/{repository_id}/environments/{environment_name}/secrets/{secret_name}"],getEnvironmentVariable:["GET /repositories/{repository_id}/environments/{environment_name}/variables/{name}"],getGithubActionsDefaultWorkflowPermissionsOrganization:["GET /orgs/{org}/actions/permissions/workflow"],getGithubActionsDefaultWorkflowPermissionsRepository:["GET /repos/{owner}/{repo}/actions/permissions/workflow"],getGithubActionsPermissionsOrganization:["GET /orgs/{org}/actions/permissions"],getGithubActionsPermissionsRepository:["GET /repos/{owner}/{repo}/actions/permissions"],getJobForWorkflowRun:["GET /repos/{owner}/{repo}/actions/jobs/{job_id}"],getOrgPublicKey:["GET /orgs/{org}/actions/secrets/public-key"],getOrgSecret:["GET /orgs/{org}/actions/secrets/{secret_name}"],getOrgVariable:["GET /orgs/{org}/actions/variables/{name}"],getPendingDeploymentsForRun:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/pending_deployments"],getRepoPermissions:["GET /repos/{owner}/{repo}/actions/permissions",{},{renamed:["actions","getGithubActionsPermissionsRepository"]}],getRepoPublicKey:["GET /repos/{owner}/{repo}/actions/secrets/public-key"],getRepoRequiredWorkflow:["GET /repos/{org}/{repo}/actions/required_workflows/{required_workflow_id_for_repo}"],getRepoRequiredWorkflowUsage:["GET /repos/{org}/{repo}/actions/required_workflows/{required_workflow_id_for_repo}/timing"],getRepoSecret:["GET /repos/{owner}/{repo}/actions/secrets/{secret_name}"],getRepoVariable:["GET /repos/{owner}/{repo}/actions/variables/{name}"],getRequiredWorkflow:["GET /orgs/{org}/actions/required_workflows/{required_workflow_id}"],getReviewsForRun:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/approvals"],getSelfHostedRunnerForOrg:["GET /orgs/{org}/actions/runners/{runner_id}"],getSelfHostedRunnerForRepo:["GET /repos/{owner}/{repo}/actions/runners/{runner_id}"],getWorkflow:["GET /repos/{owner}/{repo}/actions/workflows/{workflow_id}"],getWorkflowAccessToRepository:["GET /repos/{owner}/{repo}/actions/permissions/access"],getWorkflowRun:["GET /repos/{owner}/{repo}/actions/runs/{run_id}"],getWorkflowRunAttempt:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/attempts/{attempt_number}"],getWorkflowRunUsage:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/timing"],getWorkflowUsage:["GET /repos/{owner}/{repo}/actions/workflows/{workflow_id}/timing"],listArtifactsForRepo:["GET /repos/{owner}/{repo}/actions/artifacts"],listEnvironmentSecrets:["GET /repositories/{repository_id}/environments/{environment_name}/secrets"],listEnvironmentVariables:["GET /repositories/{repository_id}/environments/{environment_name}/variables"],listJobsForWorkflowRun:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/jobs"],listJobsForWorkflowRunAttempt:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/attempts/{attempt_number}/jobs"],listLabelsForSelfHostedRunnerForOrg:["GET /orgs/{org}/actions/runners/{runner_id}/labels"],listLabelsForSelfHostedRunnerForRepo:["GET /repos/{owner}/{repo}/actions/runners/{runner_id}/labels"],listOrgSecrets:["GET /orgs/{org}/actions/secrets"],listOrgVariables:["GET /orgs/{org}/actions/variables"],listRepoOrganizationSecrets:["GET /repos/{owner}/{repo}/actions/organization-secrets"],listRepoOrganizationVariables:["GET /repos/{owner}/{repo}/actions/organization-variables"],listRepoRequiredWorkflows:["GET /repos/{org}/{repo}/actions/required_workflows"],listRepoSecrets:["GET /repos/{owner}/{repo}/actions/secrets"],listRepoVariables:["GET /repos/{owner}/{repo}/actions/variables"],listRepoWorkflows:["GET /repos/{owner}/{repo}/actions/workflows"],listRequiredWorkflowRuns:["GET /repos/{owner}/{repo}/actions/required_workflows/{required_workflow_id_for_repo}/runs"],listRequiredWorkflows:["GET /orgs/{org}/actions/required_workflows"],listRunnerApplicationsForOrg:["GET /orgs/{org}/actions/runners/downloads"],listRunnerApplicationsForRepo:["GET /repos/{owner}/{repo}/actions/runners/downloads"],listSelectedReposForOrgSecret:["GET /orgs/{org}/actions/secrets/{secret_name}/repositories"],listSelectedReposForOrgVariable:["GET /orgs/{org}/actions/variables/{name}/repositories"],listSelectedRepositoriesEnabledGithubActionsOrganization:["GET /orgs/{org}/actions/permissions/repositories"],listSelectedRepositoriesRequiredWorkflow:["GET /orgs/{org}/actions/required_workflows/{required_workflow_id}/repositories"],listSelfHostedRunnersForOrg:["GET /orgs/{org}/actions/runners"],listSelfHostedRunnersForRepo:["GET /repos/{owner}/{repo}/actions/runners"],listWorkflowRunArtifacts:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/artifacts"],listWorkflowRuns:["GET /repos/{owner}/{repo}/actions/workflows/{workflow_id}/runs"],listWorkflowRunsForRepo:["GET /repos/{owner}/{repo}/actions/runs"],reRunJobForWorkflowRun:["POST /repos/{owner}/{repo}/actions/jobs/{job_id}/rerun"],reRunWorkflow:["POST /repos/{owner}/{repo}/actions/runs/{run_id}/rerun"],reRunWorkflowFailedJobs:["POST /repos/{owner}/{repo}/actions/runs/{run_id}/rerun-failed-jobs"],removeAllCustomLabelsFromSelfHostedRunnerForOrg:["DELETE /orgs/{org}/actions/runners/{runner_id}/labels"],removeAllCustomLabelsFromSelfHostedRunnerForRepo:["DELETE /repos/{owner}/{repo}/actions/runners/{runner_id}/labels"],removeCustomLabelFromSelfHostedRunnerForOrg:["DELETE /orgs/{org}/actions/runners/{runner_id}/labels/{name}"],removeCustomLabelFromSelfHostedRunnerForRepo:["DELETE /repos/{owner}/{repo}/actions/runners/{runner_id}/labels/{name}"],removeSelectedRepoFromOrgSecret:["DELETE /orgs/{org}/actions/secrets/{secret_name}/repositories/{repository_id}"],removeSelectedRepoFromOrgVariable:["DELETE /orgs/{org}/actions/variables/{name}/repositories/{repository_id}"],removeSelectedRepoFromRequiredWorkflow:["DELETE /orgs/{org}/actions/required_workflows/{required_workflow_id}/repositories/{repository_id}"],reviewCustomGatesForRun:["POST /repos/{owner}/{repo}/actions/runs/{run_id}/deployment_protection_rule"],reviewPendingDeploymentsForRun:["POST /repos/{owner}/{repo}/actions/runs/{run_id}/pending_deployments"],setAllowedActionsOrganization:["PUT /orgs/{org}/actions/permissions/selected-actions"],setAllowedActionsRepository:["PUT /repos/{owner}/{repo}/actions/permissions/selected-actions"],setCustomLabelsForSelfHostedRunnerForOrg:["PUT /orgs/{org}/actions/runners/{runner_id}/labels"],setCustomLabelsForSelfHostedRunnerForRepo:["PUT /repos/{owner}/{repo}/actions/runners/{runner_id}/labels"],setGithubActionsDefaultWorkflowPermissionsOrganization:["PUT /orgs/{org}/actions/permissions/workflow"],setGithubActionsDefaultWorkflowPermissionsRepository:["PUT /repos/{owner}/{repo}/actions/permissions/workflow"],setGithubActionsPermissionsOrganization:["PUT /orgs/{org}/actions/permissions"],setGithubActionsPermissionsRepository:["PUT /repos/{owner}/{repo}/actions/permissions"],setSelectedReposForOrgSecret:["PUT /orgs/{org}/actions/secrets/{secret_name}/repositories"],setSelectedReposForOrgVariable:["PUT /orgs/{org}/actions/variables/{name}/repositories"],setSelectedReposToRequiredWorkflow:["PUT /orgs/{org}/actions/required_workflows/{required_workflow_id}/repositories"],setSelectedRepositoriesEnabledGithubActionsOrganization:["PUT /orgs/{org}/actions/permissions/repositories"],setWorkflowAccessToRepository:["PUT /repos/{owner}/{repo}/actions/permissions/access"],updateEnvironmentVariable:["PATCH /repositories/{repository_id}/environments/{environment_name}/variables/{name}"],updateOrgVariable:["PATCH /orgs/{org}/actions/variables/{name}"],updateRepoVariable:["PATCH /repos/{owner}/{repo}/actions/variables/{name}"],updateRequiredWorkflow:["PATCH /orgs/{org}/actions/required_workflows/{required_workflow_id}"]},activity:{checkRepoIsStarredByAuthenticatedUser:["GET /user/starred/{owner}/{repo}"],deleteRepoSubscription:["DELETE /repos/{owner}/{repo}/subscription"],deleteThreadSubscription:["DELETE /notifications/threads/{thread_id}/subscription"],getFeeds:["GET /feeds"],getRepoSubscription:["GET /repos/{owner}/{repo}/subscription"],getThread:["GET /notifications/threads/{thread_id}"],getThreadSubscriptionForAuthenticatedUser:["GET /notifications/threads/{thread_id}/subscription"],listEventsForAuthenticatedUser:["GET /users/{username}/events"],listNotificationsForAuthenticatedUser:["GET /notifications"],listOrgEventsForAuthenticatedUser:["GET /users/{username}/events/orgs/{org}"],listPublicEvents:["GET /events"],listPublicEventsForRepoNetwork:["GET /networks/{owner}/{repo}/events"],listPublicEventsForUser:["GET /users/{username}/events/public"],listPublicOrgEvents:["GET /orgs/{org}/events"],listReceivedEventsForUser:["GET /users/{username}/received_events"],listReceivedPublicEventsForUser:["GET /users/{username}/received_events/public"],listRepoEvents:["GET /repos/{owner}/{repo}/events"],listRepoNotificationsForAuthenticatedUser:["GET /repos/{owner}/{repo}/notifications"],listReposStarredByAuthenticatedUser:["GET /user/starred"],listReposStarredByUser:["GET /users/{username}/starred"],listReposWatchedByUser:["GET /users/{username}/subscriptions"],listStargazersForRepo:["GET /repos/{owner}/{repo}/stargazers"],listWatchedReposForAuthenticatedUser:["GET /user/subscriptions"],listWatchersForRepo:["GET /repos/{owner}/{repo}/subscribers"],markNotificationsAsRead:["PUT /notifications"],markRepoNotificationsAsRead:["PUT /repos/{owner}/{repo}/notifications"],markThreadAsRead:["PATCH /notifications/threads/{thread_id}"],setRepoSubscription:["PUT /repos/{owner}/{repo}/subscription"],setThreadSubscription:["PUT /notifications/threads/{thread_id}/subscription"],starRepoForAuthenticatedUser:["PUT /user/starred/{owner}/{repo}"],unstarRepoForAuthenticatedUser:["DELETE /user/starred/{owner}/{repo}"]},apps:{addRepoToInstallation:["PUT /user/installations/{installation_id}/repositories/{repository_id}",{},{renamed:["apps","addRepoToInstallationForAuthenticatedUser"]}],addRepoToInstallationForAuthenticatedUser:["PUT /user/installations/{installation_id}/repositories/{repository_id}"],checkToken:["POST /applications/{client_id}/token"],createFromManifest:["POST /app-manifests/{code}/conversions"],createInstallationAccessToken:["POST /app/installations/{installation_id}/access_tokens"],deleteAuthorization:["DELETE /applications/{client_id}/grant"],deleteInstallation:["DELETE /app/installations/{installation_id}"],deleteToken:["DELETE /applications/{client_id}/token"],getAuthenticated:["GET /app"],getBySlug:["GET /apps/{app_slug}"],getInstallation:["GET /app/installations/{installation_id}"],getOrgInstallation:["GET /orgs/{org}/installation"],getRepoInstallation:["GET /repos/{owner}/{repo}/installation"],getSubscriptionPlanForAccount:["GET /marketplace_listing/accounts/{account_id}"],getSubscriptionPlanForAccountStubbed:["GET /marketplace_listing/stubbed/accounts/{account_id}"],getUserInstallation:["GET /users/{username}/installation"],getWebhookConfigForApp:["GET /app/hook/config"],getWebhookDelivery:["GET /app/hook/deliveries/{delivery_id}"],listAccountsForPlan:["GET /marketplace_listing/plans/{plan_id}/accounts"],listAccountsForPlanStubbed:["GET /marketplace_listing/stubbed/plans/{plan_id}/accounts"],listInstallationReposForAuthenticatedUser:["GET /user/installations/{installation_id}/repositories"],listInstallationRequestsForAuthenticatedApp:["GET /app/installation-requests"],listInstallations:["GET /app/installations"],listInstallationsForAuthenticatedUser:["GET /user/installations"],listPlans:["GET /marketplace_listing/plans"],listPlansStubbed:["GET /marketplace_listing/stubbed/plans"],listReposAccessibleToInstallation:["GET /installation/repositories"],listSubscriptionsForAuthenticatedUser:["GET /user/marketplace_purchases"],listSubscriptionsForAuthenticatedUserStubbed:["GET /user/marketplace_purchases/stubbed"],listWebhookDeliveries:["GET /app/hook/deliveries"],redeliverWebhookDelivery:["POST /app/hook/deliveries/{delivery_id}/attempts"],removeRepoFromInstallation:["DELETE /user/installations/{installation_id}/repositories/{repository_id}",{},{renamed:["apps","removeRepoFromInstallationForAuthenticatedUser"]}],removeRepoFromInstallationForAuthenticatedUser:["DELETE /user/installations/{installation_id}/repositories/{repository_id}"],resetToken:["PATCH /applications/{client_id}/token"],revokeInstallationAccessToken:["DELETE /installation/token"],scopeToken:["POST /applications/{client_id}/token/scoped"],suspendInstallation:["PUT /app/installations/{installation_id}/suspended"],unsuspendInstallation:["DELETE /app/installations/{installation_id}/suspended"],updateWebhookConfigForApp:["PATCH /app/hook/config"]},billing:{getGithubActionsBillingOrg:["GET /orgs/{org}/settings/billing/actions"],getGithubActionsBillingUser:["GET /users/{username}/settings/billing/actions"],getGithubPackagesBillingOrg:["GET /orgs/{org}/settings/billing/packages"],getGithubPackagesBillingUser:["GET /users/{username}/settings/billing/packages"],getSharedStorageBillingOrg:["GET /orgs/{org}/settings/billing/shared-storage"],getSharedStorageBillingUser:["GET /users/{username}/settings/billing/shared-storage"]},checks:{create:["POST /repos/{owner}/{repo}/check-runs"],createSuite:["POST /repos/{owner}/{repo}/check-suites"],get:["GET /repos/{owner}/{repo}/check-runs/{check_run_id}"],getSuite:["GET /repos/{owner}/{repo}/check-suites/{check_suite_id}"],listAnnotations:["GET /repos/{owner}/{repo}/check-runs/{check_run_id}/annotations"],listForRef:["GET /repos/{owner}/{repo}/commits/{ref}/check-runs"],listForSuite:["GET /repos/{owner}/{repo}/check-suites/{check_suite_id}/check-runs"],listSuitesForRef:["GET /repos/{owner}/{repo}/commits/{ref}/check-suites"],rerequestRun:["POST /repos/{owner}/{repo}/check-runs/{check_run_id}/rerequest"],rerequestSuite:["POST /repos/{owner}/{repo}/check-suites/{check_suite_id}/rerequest"],setSuitesPreferences:["PATCH /repos/{owner}/{repo}/check-suites/preferences"],update:["PATCH /repos/{owner}/{repo}/check-runs/{check_run_id}"]},codeScanning:{deleteAnalysis:["DELETE /repos/{owner}/{repo}/code-scanning/analyses/{analysis_id}{?confirm_delete}"],getAlert:["GET /repos/{owner}/{repo}/code-scanning/alerts/{alert_number}",{},{renamedParameters:{alert_id:"alert_number"}}],getAnalysis:["GET /repos/{owner}/{repo}/code-scanning/analyses/{analysis_id}"],getCodeqlDatabase:["GET /repos/{owner}/{repo}/code-scanning/codeql/databases/{language}"],getDefaultSetup:["GET /repos/{owner}/{repo}/code-scanning/default-setup"],getSarif:["GET /repos/{owner}/{repo}/code-scanning/sarifs/{sarif_id}"],listAlertInstances:["GET /repos/{owner}/{repo}/code-scanning/alerts/{alert_number}/instances"],listAlertsForOrg:["GET /orgs/{org}/code-scanning/alerts"],listAlertsForRepo:["GET /repos/{owner}/{repo}/code-scanning/alerts"],listAlertsInstances:["GET /repos/{owner}/{repo}/code-scanning/alerts/{alert_number}/instances",{},{renamed:["codeScanning","listAlertInstances"]}],listCodeqlDatabases:["GET /repos/{owner}/{repo}/code-scanning/codeql/databases"],listRecentAnalyses:["GET /repos/{owner}/{repo}/code-scanning/analyses"],updateAlert:["PATCH /repos/{owner}/{repo}/code-scanning/alerts/{alert_number}"],updateDefaultSetup:["PATCH /repos/{owner}/{repo}/code-scanning/default-setup"],uploadSarif:["POST /repos/{owner}/{repo}/code-scanning/sarifs"]},codesOfConduct:{getAllCodesOfConduct:["GET /codes_of_conduct"],getConductCode:["GET /codes_of_conduct/{key}"]},codespaces:{addRepositoryForSecretForAuthenticatedUser:["PUT /user/codespaces/secrets/{secret_name}/repositories/{repository_id}"],addSelectedRepoToOrgSecret:["PUT /orgs/{org}/codespaces/secrets/{secret_name}/repositories/{repository_id}"],codespaceMachinesForAuthenticatedUser:["GET /user/codespaces/{codespace_name}/machines"],createForAuthenticatedUser:["POST /user/codespaces"],createOrUpdateOrgSecret:["PUT /orgs/{org}/codespaces/secrets/{secret_name}"],createOrUpdateRepoSecret:["PUT /repos/{owner}/{repo}/codespaces/secrets/{secret_name}"],createOrUpdateSecretForAuthenticatedUser:["PUT /user/codespaces/secrets/{secret_name}"],createWithPrForAuthenticatedUser:["POST /repos/{owner}/{repo}/pulls/{pull_number}/codespaces"],createWithRepoForAuthenticatedUser:["POST /repos/{owner}/{repo}/codespaces"],deleteCodespacesBillingUsers:["DELETE /orgs/{org}/codespaces/billing/selected_users"],deleteForAuthenticatedUser:["DELETE /user/codespaces/{codespace_name}"],deleteFromOrganization:["DELETE /orgs/{org}/members/{username}/codespaces/{codespace_name}"],deleteOrgSecret:["DELETE /orgs/{org}/codespaces/secrets/{secret_name}"],deleteRepoSecret:["DELETE /repos/{owner}/{repo}/codespaces/secrets/{secret_name}"],deleteSecretForAuthenticatedUser:["DELETE /user/codespaces/secrets/{secret_name}"],exportForAuthenticatedUser:["POST /user/codespaces/{codespace_name}/exports"],getCodespacesForUserInOrg:["GET /orgs/{org}/members/{username}/codespaces"],getExportDetailsForAuthenticatedUser:["GET /user/codespaces/{codespace_name}/exports/{export_id}"],getForAuthenticatedUser:["GET /user/codespaces/{codespace_name}"],getOrgPublicKey:["GET /orgs/{org}/codespaces/secrets/public-key"],getOrgSecret:["GET /orgs/{org}/codespaces/secrets/{secret_name}"],getPublicKeyForAuthenticatedUser:["GET /user/codespaces/secrets/public-key"],getRepoPublicKey:["GET /repos/{owner}/{repo}/codespaces/secrets/public-key"],getRepoSecret:["GET /repos/{owner}/{repo}/codespaces/secrets/{secret_name}"],getSecretForAuthenticatedUser:["GET /user/codespaces/secrets/{secret_name}"],listDevcontainersInRepositoryForAuthenticatedUser:["GET /repos/{owner}/{repo}/codespaces/devcontainers"],listForAuthenticatedUser:["GET /user/codespaces"],listInOrganization:["GET /orgs/{org}/codespaces",{},{renamedParameters:{org_id:"org"}}],listInRepositoryForAuthenticatedUser:["GET /repos/{owner}/{repo}/codespaces"],listOrgSecrets:["GET /orgs/{org}/codespaces/secrets"],listRepoSecrets:["GET /repos/{owner}/{repo}/codespaces/secrets"],listRepositoriesForSecretForAuthenticatedUser:["GET /user/codespaces/secrets/{secret_name}/repositories"],listSecretsForAuthenticatedUser:["GET /user/codespaces/secrets"],listSelectedReposForOrgSecret:["GET /orgs/{org}/codespaces/secrets/{secret_name}/repositories"],preFlightWithRepoForAuthenticatedUser:["GET /repos/{owner}/{repo}/codespaces/new"],publishForAuthenticatedUser:["POST /user/codespaces/{codespace_name}/publish"],removeRepositoryForSecretForAuthenticatedUser:["DELETE /user/codespaces/secrets/{secret_name}/repositories/{repository_id}"],removeSelectedRepoFromOrgSecret:["DELETE /orgs/{org}/codespaces/secrets/{secret_name}/repositories/{repository_id}"],repoMachinesForAuthenticatedUser:["GET /repos/{owner}/{repo}/codespaces/machines"],setCodespacesBilling:["PUT /orgs/{org}/codespaces/billing"],setCodespacesBillingUsers:["POST /orgs/{org}/codespaces/billing/selected_users"],setRepositoriesForSecretForAuthenticatedUser:["PUT /user/codespaces/secrets/{secret_name}/repositories"],setSelectedReposForOrgSecret:["PUT /orgs/{org}/codespaces/secrets/{secret_name}/repositories"],startForAuthenticatedUser:["POST /user/codespaces/{codespace_name}/start"],stopForAuthenticatedUser:["POST /user/codespaces/{codespace_name}/stop"],stopInOrganization:["POST /orgs/{org}/members/{username}/codespaces/{codespace_name}/stop"],updateForAuthenticatedUser:["PATCH /user/codespaces/{codespace_name}"]},dependabot:{addSelectedRepoToOrgSecret:["PUT /orgs/{org}/dependabot/secrets/{secret_name}/repositories/{repository_id}"],createOrUpdateOrgSecret:["PUT /orgs/{org}/dependabot/secrets/{secret_name}"],createOrUpdateRepoSecret:["PUT /repos/{owner}/{repo}/dependabot/secrets/{secret_name}"],deleteOrgSecret:["DELETE /orgs/{org}/dependabot/secrets/{secret_name}"],deleteRepoSecret:["DELETE /repos/{owner}/{repo}/dependabot/secrets/{secret_name}"],getAlert:["GET /repos/{owner}/{repo}/dependabot/alerts/{alert_number}"],getOrgPublicKey:["GET /orgs/{org}/dependabot/secrets/public-key"],getOrgSecret:["GET /orgs/{org}/dependabot/secrets/{secret_name}"],getRepoPublicKey:["GET /repos/{owner}/{repo}/dependabot/secrets/public-key"],getRepoSecret:["GET /repos/{owner}/{repo}/dependabot/secrets/{secret_name}"],listAlertsForEnterprise:["GET /enterprises/{enterprise}/dependabot/alerts"],listAlertsForOrg:["GET /orgs/{org}/dependabot/alerts"],listAlertsForRepo:["GET /repos/{owner}/{repo}/dependabot/alerts"],listOrgSecrets:["GET /orgs/{org}/dependabot/secrets"],listRepoSecrets:["GET /repos/{owner}/{repo}/dependabot/secrets"],listSelectedReposForOrgSecret:["GET /orgs/{org}/dependabot/secrets/{secret_name}/repositories"],removeSelectedRepoFromOrgSecret:["DELETE /orgs/{org}/dependabot/secrets/{secret_name}/repositories/{repository_id}"],setSelectedReposForOrgSecret:["PUT /orgs/{org}/dependabot/secrets/{secret_name}/repositories"],updateAlert:["PATCH /repos/{owner}/{repo}/dependabot/alerts/{alert_number}"]},dependencyGraph:{createRepositorySnapshot:["POST /repos/{owner}/{repo}/dependency-graph/snapshots"],diffRange:["GET /repos/{owner}/{repo}/dependency-graph/compare/{basehead}"],exportSbom:["GET /repos/{owner}/{repo}/dependency-graph/sbom"]},emojis:{get:["GET /emojis"]},gists:{checkIsStarred:["GET /gists/{gist_id}/star"],create:["POST /gists"],createComment:["POST /gists/{gist_id}/comments"],delete:["DELETE /gists/{gist_id}"],deleteComment:["DELETE /gists/{gist_id}/comments/{comment_id}"],fork:["POST /gists/{gist_id}/forks"],get:["GET /gists/{gist_id}"],getComment:["GET /gists/{gist_id}/comments/{comment_id}"],getRevision:["GET /gists/{gist_id}/{sha}"],list:["GET /gists"],listComments:["GET /gists/{gist_id}/comments"],listCommits:["GET /gists/{gist_id}/commits"],listForUser:["GET /users/{username}/gists"],listForks:["GET /gists/{gist_id}/forks"],listPublic:["GET /gists/public"],listStarred:["GET /gists/starred"],star:["PUT /gists/{gist_id}/star"],unstar:["DELETE /gists/{gist_id}/star"],update:["PATCH /gists/{gist_id}"],updateComment:["PATCH /gists/{gist_id}/comments/{comment_id}"]},git:{createBlob:["POST /repos/{owner}/{repo}/git/blobs"],createCommit:["POST /repos/{owner}/{repo}/git/commits"],createRef:["POST /repos/{owner}/{repo}/git/refs"],createTag:["POST /repos/{owner}/{repo}/git/tags"],createTree:["POST /repos/{owner}/{repo}/git/trees"],deleteRef:["DELETE /repos/{owner}/{repo}/git/refs/{ref}"],getBlob:["GET /repos/{owner}/{repo}/git/blobs/{file_sha}"],getCommit:["GET /repos/{owner}/{repo}/git/commits/{commit_sha}"],getRef:["GET /repos/{owner}/{repo}/git/ref/{ref}"],getTag:["GET /repos/{owner}/{repo}/git/tags/{tag_sha}"],getTree:["GET /repos/{owner}/{repo}/git/trees/{tree_sha}"],listMatchingRefs:["GET /repos/{owner}/{repo}/git/matching-refs/{ref}"],updateRef:["PATCH /repos/{owner}/{repo}/git/refs/{ref}"]},gitignore:{getAllTemplates:["GET /gitignore/templates"],getTemplate:["GET /gitignore/templates/{name}"]},interactions:{getRestrictionsForAuthenticatedUser:["GET /user/interaction-limits"],getRestrictionsForOrg:["GET /orgs/{org}/interaction-limits"],getRestrictionsForRepo:["GET /repos/{owner}/{repo}/interaction-limits"],getRestrictionsForYourPublicRepos:["GET /user/interaction-limits",{},{renamed:["interactions","getRestrictionsForAuthenticatedUser"]}],removeRestrictionsForAuthenticatedUser:["DELETE /user/interaction-limits"],removeRestrictionsForOrg:["DELETE /orgs/{org}/interaction-limits"],removeRestrictionsForRepo:["DELETE /repos/{owner}/{repo}/interaction-limits"],removeRestrictionsForYourPublicRepos:["DELETE /user/interaction-limits",{},{renamed:["interactions","removeRestrictionsForAuthenticatedUser"]}],setRestrictionsForAuthenticatedUser:["PUT /user/interaction-limits"],setRestrictionsForOrg:["PUT /orgs/{org}/interaction-limits"],setRestrictionsForRepo:["PUT /repos/{owner}/{repo}/interaction-limits"],setRestrictionsForYourPublicRepos:["PUT /user/interaction-limits",{},{renamed:["interactions","setRestrictionsForAuthenticatedUser"]}]},issues:{addAssignees:["POST /repos/{owner}/{repo}/issues/{issue_number}/assignees"],addLabels:["POST /repos/{owner}/{repo}/issues/{issue_number}/labels"],checkUserCanBeAssigned:["GET /repos/{owner}/{repo}/assignees/{assignee}"],checkUserCanBeAssignedToIssue:["GET /repos/{owner}/{repo}/issues/{issue_number}/assignees/{assignee}"],create:["POST /repos/{owner}/{repo}/issues"],createComment:["POST /repos/{owner}/{repo}/issues/{issue_number}/comments"],createLabel:["POST /repos/{owner}/{repo}/labels"],createMilestone:["POST /repos/{owner}/{repo}/milestones"],deleteComment:["DELETE /repos/{owner}/{repo}/issues/comments/{comment_id}"],deleteLabel:["DELETE /repos/{owner}/{repo}/labels/{name}"],deleteMilestone:["DELETE /repos/{owner}/{repo}/milestones/{milestone_number}"],get:["GET /repos/{owner}/{repo}/issues/{issue_number}"],getComment:["GET /repos/{owner}/{repo}/issues/comments/{comment_id}"],getEvent:["GET /repos/{owner}/{repo}/issues/events/{event_id}"],getLabel:["GET /repos/{owner}/{repo}/labels/{name}"],getMilestone:["GET /repos/{owner}/{repo}/milestones/{milestone_number}"],list:["GET /issues"],listAssignees:["GET /repos/{owner}/{repo}/assignees"],listComments:["GET /repos/{owner}/{repo}/issues/{issue_number}/comments"],listCommentsForRepo:["GET /repos/{owner}/{repo}/issues/comments"],listEvents:["GET /repos/{owner}/{repo}/issues/{issue_number}/events"],listEventsForRepo:["GET /repos/{owner}/{repo}/issues/events"],listEventsForTimeline:["GET /repos/{owner}/{repo}/issues/{issue_number}/timeline"],listForAuthenticatedUser:["GET /user/issues"],listForOrg:["GET /orgs/{org}/issues"],listForRepo:["GET /repos/{owner}/{repo}/issues"],listLabelsForMilestone:["GET /repos/{owner}/{repo}/milestones/{milestone_number}/labels"],listLabelsForRepo:["GET /repos/{owner}/{repo}/labels"],listLabelsOnIssue:["GET /repos/{owner}/{repo}/issues/{issue_number}/labels"],listMilestones:["GET /repos/{owner}/{repo}/milestones"],lock:["PUT /repos/{owner}/{repo}/issues/{issue_number}/lock"],removeAllLabels:["DELETE /repos/{owner}/{repo}/issues/{issue_number}/labels"],removeAssignees:["DELETE /repos/{owner}/{repo}/issues/{issue_number}/assignees"],removeLabel:["DELETE /repos/{owner}/{repo}/issues/{issue_number}/labels/{name}"],setLabels:["PUT /repos/{owner}/{repo}/issues/{issue_number}/labels"],unlock:["DELETE /repos/{owner}/{repo}/issues/{issue_number}/lock"],update:["PATCH /repos/{owner}/{repo}/issues/{issue_number}"],updateComment:["PATCH /repos/{owner}/{repo}/issues/comments/{comment_id}"],updateLabel:["PATCH /repos/{owner}/{repo}/labels/{name}"],updateMilestone:["PATCH /repos/{owner}/{repo}/milestones/{milestone_number}"]},licenses:{get:["GET /licenses/{license}"],getAllCommonlyUsed:["GET /licenses"],getForRepo:["GET /repos/{owner}/{repo}/license"]},markdown:{render:["POST /markdown"],renderRaw:["POST /markdown/raw",{headers:{"content-type":"text/plain; charset=utf-8"}}]},meta:{get:["GET /meta"],getAllVersions:["GET /versions"],getOctocat:["GET /octocat"],getZen:["GET /zen"],root:["GET /"]},migrations:{cancelImport:["DELETE /repos/{owner}/{repo}/import"],deleteArchiveForAuthenticatedUser:["DELETE /user/migrations/{migration_id}/archive"],deleteArchiveForOrg:["DELETE /orgs/{org}/migrations/{migration_id}/archive"],downloadArchiveForOrg:["GET /orgs/{org}/migrations/{migration_id}/archive"],getArchiveForAuthenticatedUser:["GET /user/migrations/{migration_id}/archive"],getCommitAuthors:["GET /repos/{owner}/{repo}/import/authors"],getImportStatus:["GET /repos/{owner}/{repo}/import"],getLargeFiles:["GET /repos/{owner}/{repo}/import/large_files"],getStatusForAuthenticatedUser:["GET /user/migrations/{migration_id}"],getStatusForOrg:["GET /orgs/{org}/migrations/{migration_id}"],listForAuthenticatedUser:["GET /user/migrations"],listForOrg:["GET /orgs/{org}/migrations"],listReposForAuthenticatedUser:["GET /user/migrations/{migration_id}/repositories"],listReposForOrg:["GET /orgs/{org}/migrations/{migration_id}/repositories"],listReposForUser:["GET /user/migrations/{migration_id}/repositories",{},{renamed:["migrations","listReposForAuthenticatedUser"]}],mapCommitAuthor:["PATCH /repos/{owner}/{repo}/import/authors/{author_id}"],setLfsPreference:["PATCH /repos/{owner}/{repo}/import/lfs"],startForAuthenticatedUser:["POST /user/migrations"],startForOrg:["POST /orgs/{org}/migrations"],startImport:["PUT /repos/{owner}/{repo}/import"],unlockRepoForAuthenticatedUser:["DELETE /user/migrations/{migration_id}/repos/{repo_name}/lock"],unlockRepoForOrg:["DELETE /orgs/{org}/migrations/{migration_id}/repos/{repo_name}/lock"],updateImport:["PATCH /repos/{owner}/{repo}/import"]},orgs:{addSecurityManagerTeam:["PUT /orgs/{org}/security-managers/teams/{team_slug}"],blockUser:["PUT /orgs/{org}/blocks/{username}"],cancelInvitation:["DELETE /orgs/{org}/invitations/{invitation_id}"],checkBlockedUser:["GET /orgs/{org}/blocks/{username}"],checkMembershipForUser:["GET /orgs/{org}/members/{username}"],checkPublicMembershipForUser:["GET /orgs/{org}/public_members/{username}"],convertMemberToOutsideCollaborator:["PUT /orgs/{org}/outside_collaborators/{username}"],createInvitation:["POST /orgs/{org}/invitations"],createWebhook:["POST /orgs/{org}/hooks"],delete:["DELETE /orgs/{org}"],deleteWebhook:["DELETE /orgs/{org}/hooks/{hook_id}"],enableOrDisableSecurityProductOnAllOrgRepos:["POST /orgs/{org}/{security_product}/{enablement}"],get:["GET /orgs/{org}"],getMembershipForAuthenticatedUser:["GET /user/memberships/orgs/{org}"],getMembershipForUser:["GET /orgs/{org}/memberships/{username}"],getWebhook:["GET /orgs/{org}/hooks/{hook_id}"],getWebhookConfigForOrg:["GET /orgs/{org}/hooks/{hook_id}/config"],getWebhookDelivery:["GET /orgs/{org}/hooks/{hook_id}/deliveries/{delivery_id}"],list:["GET /organizations"],listAppInstallations:["GET /orgs/{org}/installations"],listBlockedUsers:["GET /orgs/{org}/blocks"],listFailedInvitations:["GET /orgs/{org}/failed_invitations"],listForAuthenticatedUser:["GET /user/orgs"],listForUser:["GET /users/{username}/orgs"],listInvitationTeams:["GET /orgs/{org}/invitations/{invitation_id}/teams"],listMembers:["GET /orgs/{org}/members"],listMembershipsForAuthenticatedUser:["GET /user/memberships/orgs"],listOutsideCollaborators:["GET /orgs/{org}/outside_collaborators"],listPatGrantRepositories:["GET /organizations/{org}/personal-access-tokens/{pat_id}/repositories"],listPatGrantRequestRepositories:["GET /organizations/{org}/personal-access-token-requests/{pat_request_id}/repositories"],listPatGrantRequests:["GET /organizations/{org}/personal-access-token-requests"],listPatGrants:["GET /organizations/{org}/personal-access-tokens"],listPendingInvitations:["GET /orgs/{org}/invitations"],listPublicMembers:["GET /orgs/{org}/public_members"],listSecurityManagerTeams:["GET /orgs/{org}/security-managers"],listWebhookDeliveries:["GET /orgs/{org}/hooks/{hook_id}/deliveries"],listWebhooks:["GET /orgs/{org}/hooks"],pingWebhook:["POST /orgs/{org}/hooks/{hook_id}/pings"],redeliverWebhookDelivery:["POST /orgs/{org}/hooks/{hook_id}/deliveries/{delivery_id}/attempts"],removeMember:["DELETE /orgs/{org}/members/{username}"],removeMembershipForUser:["DELETE /orgs/{org}/memberships/{username}"],removeOutsideCollaborator:["DELETE /orgs/{org}/outside_collaborators/{username}"],removePublicMembershipForAuthenticatedUser:["DELETE /orgs/{org}/public_members/{username}"],removeSecurityManagerTeam:["DELETE /orgs/{org}/security-managers/teams/{team_slug}"],reviewPatGrantRequest:["POST /organizations/{org}/personal-access-token-requests/{pat_request_id}"],reviewPatGrantRequestsInBulk:["POST /organizations/{org}/personal-access-token-requests"],setMembershipForUser:["PUT /orgs/{org}/memberships/{username}"],setPublicMembershipForAuthenticatedUser:["PUT /orgs/{org}/public_members/{username}"],unblockUser:["DELETE /orgs/{org}/blocks/{username}"],update:["PATCH /orgs/{org}"],updateMembershipForAuthenticatedUser:["PATCH /user/memberships/orgs/{org}"],updatePatAccess:["POST /organizations/{org}/personal-access-tokens/{pat_id}"],updatePatAccesses:["POST /organizations/{org}/personal-access-tokens"],updateWebhook:["PATCH /orgs/{org}/hooks/{hook_id}"],updateWebhookConfigForOrg:["PATCH /orgs/{org}/hooks/{hook_id}/config"]},packages:{deletePackageForAuthenticatedUser:["DELETE /user/packages/{package_type}/{package_name}"],deletePackageForOrg:["DELETE /orgs/{org}/packages/{package_type}/{package_name}"],deletePackageForUser:["DELETE /users/{username}/packages/{package_type}/{package_name}"],deletePackageVersionForAuthenticatedUser:["DELETE /user/packages/{package_type}/{package_name}/versions/{package_version_id}"],deletePackageVersionForOrg:["DELETE /orgs/{org}/packages/{package_type}/{package_name}/versions/{package_version_id}"],deletePackageVersionForUser:["DELETE /users/{username}/packages/{package_type}/{package_name}/versions/{package_version_id}"],getAllPackageVersionsForAPackageOwnedByAnOrg:["GET /orgs/{org}/packages/{package_type}/{package_name}/versions",{},{renamed:["packages","getAllPackageVersionsForPackageOwnedByOrg"]}],getAllPackageVersionsForAPackageOwnedByTheAuthenticatedUser:["GET /user/packages/{package_type}/{package_name}/versions",{},{renamed:["packages","getAllPackageVersionsForPackageOwnedByAuthenticatedUser"]}],getAllPackageVersionsForPackageOwnedByAuthenticatedUser:["GET /user/packages/{package_type}/{package_name}/versions"],getAllPackageVersionsForPackageOwnedByOrg:["GET /orgs/{org}/packages/{package_type}/{package_name}/versions"],getAllPackageVersionsForPackageOwnedByUser:["GET /users/{username}/packages/{package_type}/{package_name}/versions"],getPackageForAuthenticatedUser:["GET /user/packages/{package_type}/{package_name}"],getPackageForOrganization:["GET /orgs/{org}/packages/{package_type}/{package_name}"],getPackageForUser:["GET /users/{username}/packages/{package_type}/{package_name}"],getPackageVersionForAuthenticatedUser:["GET /user/packages/{package_type}/{package_name}/versions/{package_version_id}"],getPackageVersionForOrganization:["GET /orgs/{org}/packages/{package_type}/{package_name}/versions/{package_version_id}"],getPackageVersionForUser:["GET /users/{username}/packages/{package_type}/{package_name}/versions/{package_version_id}"],listDockerMigrationConflictingPackagesForAuthenticatedUser:["GET /user/docker/conflicts"],listDockerMigrationConflictingPackagesForOrganization:["GET /orgs/{org}/docker/conflicts"],listDockerMigrationConflictingPackagesForUser:["GET /users/{username}/docker/conflicts"],listPackagesForAuthenticatedUser:["GET /user/packages"],listPackagesForOrganization:["GET /orgs/{org}/packages"],listPackagesForUser:["GET /users/{username}/packages"],restorePackageForAuthenticatedUser:["POST /user/packages/{package_type}/{package_name}/restore{?token}"],restorePackageForOrg:["POST /orgs/{org}/packages/{package_type}/{package_name}/restore{?token}"],restorePackageForUser:["POST /users/{username}/packages/{package_type}/{package_name}/restore{?token}"],restorePackageVersionForAuthenticatedUser:["POST /user/packages/{package_type}/{package_name}/versions/{package_version_id}/restore"],restorePackageVersionForOrg:["POST /orgs/{org}/packages/{package_type}/{package_name}/versions/{package_version_id}/restore"],restorePackageVersionForUser:["POST /users/{username}/packages/{package_type}/{package_name}/versions/{package_version_id}/restore"]},projects:{addCollaborator:["PUT /projects/{project_id}/collaborators/{username}"],createCard:["POST /projects/columns/{column_id}/cards"],createColumn:["POST /projects/{project_id}/columns"],createForAuthenticatedUser:["POST /user/projects"],createForOrg:["POST /orgs/{org}/projects"],createForRepo:["POST /repos/{owner}/{repo}/projects"],delete:["DELETE /projects/{project_id}"],deleteCard:["DELETE /projects/columns/cards/{card_id}"],deleteColumn:["DELETE /projects/columns/{column_id}"],get:["GET /projects/{project_id}"],getCard:["GET /projects/columns/cards/{card_id}"],getColumn:["GET /projects/columns/{column_id}"],getPermissionForUser:["GET /projects/{project_id}/collaborators/{username}/permission"],listCards:["GET /projects/columns/{column_id}/cards"],listCollaborators:["GET /projects/{project_id}/collaborators"],listColumns:["GET /projects/{project_id}/columns"],listForOrg:["GET /orgs/{org}/projects"],listForRepo:["GET /repos/{owner}/{repo}/projects"],listForUser:["GET /users/{username}/projects"],moveCard:["POST /projects/columns/cards/{card_id}/moves"],moveColumn:["POST /projects/columns/{column_id}/moves"],removeCollaborator:["DELETE /projects/{project_id}/collaborators/{username}"],update:["PATCH /projects/{project_id}"],updateCard:["PATCH /projects/columns/cards/{card_id}"],updateColumn:["PATCH /projects/columns/{column_id}"]},pulls:{checkIfMerged:["GET /repos/{owner}/{repo}/pulls/{pull_number}/merge"],create:["POST /repos/{owner}/{repo}/pulls"],createReplyForReviewComment:["POST /repos/{owner}/{repo}/pulls/{pull_number}/comments/{comment_id}/replies"],createReview:["POST /repos/{owner}/{repo}/pulls/{pull_number}/reviews"],createReviewComment:["POST /repos/{owner}/{repo}/pulls/{pull_number}/comments"],deletePendingReview:["DELETE /repos/{owner}/{repo}/pulls/{pull_number}/reviews/{review_id}"],deleteReviewComment:["DELETE /repos/{owner}/{repo}/pulls/comments/{comment_id}"],dismissReview:["PUT /repos/{owner}/{repo}/pulls/{pull_number}/reviews/{review_id}/dismissals"],get:["GET /repos/{owner}/{repo}/pulls/{pull_number}"],getReview:["GET /repos/{owner}/{repo}/pulls/{pull_number}/reviews/{review_id}"],getReviewComment:["GET /repos/{owner}/{repo}/pulls/comments/{comment_id}"],list:["GET /repos/{owner}/{repo}/pulls"],listCommentsForReview:["GET /repos/{owner}/{repo}/pulls/{pull_number}/reviews/{review_id}/comments"],listCommits:["GET /repos/{owner}/{repo}/pulls/{pull_number}/commits"],listFiles:["GET /repos/{owner}/{repo}/pulls/{pull_number}/files"],listRequestedReviewers:["GET /repos/{owner}/{repo}/pulls/{pull_number}/requested_reviewers"],listReviewComments:["GET /repos/{owner}/{repo}/pulls/{pull_number}/comments"],listReviewCommentsForRepo:["GET /repos/{owner}/{repo}/pulls/comments"],listReviews:["GET /repos/{owner}/{repo}/pulls/{pull_number}/reviews"],merge:["PUT /repos/{owner}/{repo}/pulls/{pull_number}/merge"],removeRequestedReviewers:["DELETE /repos/{owner}/{repo}/pulls/{pull_number}/requested_reviewers"],requestReviewers:["POST /repos/{owner}/{repo}/pulls/{pull_number}/requested_reviewers"],submitReview:["POST /repos/{owner}/{repo}/pulls/{pull_number}/reviews/{review_id}/events"],update:["PATCH /repos/{owner}/{repo}/pulls/{pull_number}"],updateBranch:["PUT /repos/{owner}/{repo}/pulls/{pull_number}/update-branch"],updateReview:["PUT /repos/{owner}/{repo}/pulls/{pull_number}/reviews/{review_id}"],updateReviewComment:["PATCH /repos/{owner}/{repo}/pulls/comments/{comment_id}"]},rateLimit:{get:["GET /rate_limit"]},reactions:{createForCommitComment:["POST /repos/{owner}/{repo}/comments/{comment_id}/reactions"],createForIssue:["POST /repos/{owner}/{repo}/issues/{issue_number}/reactions"],createForIssueComment:["POST /repos/{owner}/{repo}/issues/comments/{comment_id}/reactions"],createForPullRequestReviewComment:["POST /repos/{owner}/{repo}/pulls/comments/{comment_id}/reactions"],createForRelease:["POST /repos/{owner}/{repo}/releases/{release_id}/reactions"],createForTeamDiscussionCommentInOrg:["POST /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments/{comment_number}/reactions"],createForTeamDiscussionInOrg:["POST /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/reactions"],deleteForCommitComment:["DELETE /repos/{owner}/{repo}/comments/{comment_id}/reactions/{reaction_id}"],deleteForIssue:["DELETE /repos/{owner}/{repo}/issues/{issue_number}/reactions/{reaction_id}"],deleteForIssueComment:["DELETE /repos/{owner}/{repo}/issues/comments/{comment_id}/reactions/{reaction_id}"],deleteForPullRequestComment:["DELETE /repos/{owner}/{repo}/pulls/comments/{comment_id}/reactions/{reaction_id}"],deleteForRelease:["DELETE /repos/{owner}/{repo}/releases/{release_id}/reactions/{reaction_id}"],deleteForTeamDiscussion:["DELETE /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/reactions/{reaction_id}"],deleteForTeamDiscussionComment:["DELETE /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments/{comment_number}/reactions/{reaction_id}"],listForCommitComment:["GET /repos/{owner}/{repo}/comments/{comment_id}/reactions"],listForIssue:["GET /repos/{owner}/{repo}/issues/{issue_number}/reactions"],listForIssueComment:["GET /repos/{owner}/{repo}/issues/comments/{comment_id}/reactions"],listForPullRequestReviewComment:["GET /repos/{owner}/{repo}/pulls/comments/{comment_id}/reactions"],listForRelease:["GET /repos/{owner}/{repo}/releases/{release_id}/reactions"],listForTeamDiscussionCommentInOrg:["GET /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments/{comment_number}/reactions"],listForTeamDiscussionInOrg:["GET /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/reactions"]},repos:{acceptInvitation:["PATCH /user/repository_invitations/{invitation_id}",{},{renamed:["repos","acceptInvitationForAuthenticatedUser"]}],acceptInvitationForAuthenticatedUser:["PATCH /user/repository_invitations/{invitation_id}"],addAppAccessRestrictions:["POST /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/apps",{},{mapToData:"apps"}],addCollaborator:["PUT /repos/{owner}/{repo}/collaborators/{username}"],addStatusCheckContexts:["POST /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks/contexts",{},{mapToData:"contexts"}],addTeamAccessRestrictions:["POST /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/teams",{},{mapToData:"teams"}],addUserAccessRestrictions:["POST /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/users",{},{mapToData:"users"}],checkCollaborator:["GET /repos/{owner}/{repo}/collaborators/{username}"],checkVulnerabilityAlerts:["GET /repos/{owner}/{repo}/vulnerability-alerts"],codeownersErrors:["GET /repos/{owner}/{repo}/codeowners/errors"],compareCommits:["GET /repos/{owner}/{repo}/compare/{base}...{head}"],compareCommitsWithBasehead:["GET /repos/{owner}/{repo}/compare/{basehead}"],createAutolink:["POST /repos/{owner}/{repo}/autolinks"],createCommitComment:["POST /repos/{owner}/{repo}/commits/{commit_sha}/comments"],createCommitSignatureProtection:["POST /repos/{owner}/{repo}/branches/{branch}/protection/required_signatures"],createCommitStatus:["POST /repos/{owner}/{repo}/statuses/{sha}"],createDeployKey:["POST /repos/{owner}/{repo}/keys"],createDeployment:["POST /repos/{owner}/{repo}/deployments"],createDeploymentBranchPolicy:["POST /repos/{owner}/{repo}/environments/{environment_name}/deployment-branch-policies"],createDeploymentProtectionRule:["POST /repos/{owner}/{repo}/environments/{environment_name}/deployment_protection_rules"],createDeploymentStatus:["POST /repos/{owner}/{repo}/deployments/{deployment_id}/statuses"],createDispatchEvent:["POST /repos/{owner}/{repo}/dispatches"],createForAuthenticatedUser:["POST /user/repos"],createFork:["POST /repos/{owner}/{repo}/forks"],createInOrg:["POST /orgs/{org}/repos"],createOrUpdateEnvironment:["PUT /repos/{owner}/{repo}/environments/{environment_name}"],createOrUpdateFileContents:["PUT /repos/{owner}/{repo}/contents/{path}"],createOrgRuleset:["POST /orgs/{org}/rulesets"],createPagesDeployment:["POST /repos/{owner}/{repo}/pages/deployment"],createPagesSite:["POST /repos/{owner}/{repo}/pages"],createRelease:["POST /repos/{owner}/{repo}/releases"],createRepoRuleset:["POST /repos/{owner}/{repo}/rulesets"],createTagProtection:["POST /repos/{owner}/{repo}/tags/protection"],createUsingTemplate:["POST /repos/{template_owner}/{template_repo}/generate"],createWebhook:["POST /repos/{owner}/{repo}/hooks"],declineInvitation:["DELETE /user/repository_invitations/{invitation_id}",{},{renamed:["repos","declineInvitationForAuthenticatedUser"]}],declineInvitationForAuthenticatedUser:["DELETE /user/repository_invitations/{invitation_id}"],delete:["DELETE /repos/{owner}/{repo}"],deleteAccessRestrictions:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/restrictions"],deleteAdminBranchProtection:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/enforce_admins"],deleteAnEnvironment:["DELETE /repos/{owner}/{repo}/environments/{environment_name}"],deleteAutolink:["DELETE /repos/{owner}/{repo}/autolinks/{autolink_id}"],deleteBranchProtection:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection"],deleteCommitComment:["DELETE /repos/{owner}/{repo}/comments/{comment_id}"],deleteCommitSignatureProtection:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/required_signatures"],deleteDeployKey:["DELETE /repos/{owner}/{repo}/keys/{key_id}"],deleteDeployment:["DELETE /repos/{owner}/{repo}/deployments/{deployment_id}"],deleteDeploymentBranchPolicy:["DELETE /repos/{owner}/{repo}/environments/{environment_name}/deployment-branch-policies/{branch_policy_id}"],deleteFile:["DELETE /repos/{owner}/{repo}/contents/{path}"],deleteInvitation:["DELETE /repos/{owner}/{repo}/invitations/{invitation_id}"],deleteOrgRuleset:["DELETE /orgs/{org}/rulesets/{ruleset_id}"],deletePagesSite:["DELETE /repos/{owner}/{repo}/pages"],deletePullRequestReviewProtection:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/required_pull_request_reviews"],deleteRelease:["DELETE /repos/{owner}/{repo}/releases/{release_id}"],deleteReleaseAsset:["DELETE /repos/{owner}/{repo}/releases/assets/{asset_id}"],deleteRepoRuleset:["DELETE /repos/{owner}/{repo}/rulesets/{ruleset_id}"],deleteTagProtection:["DELETE /repos/{owner}/{repo}/tags/protection/{tag_protection_id}"],deleteWebhook:["DELETE /repos/{owner}/{repo}/hooks/{hook_id}"],disableAutomatedSecurityFixes:["DELETE /repos/{owner}/{repo}/automated-security-fixes"],disableDeploymentProtectionRule:["DELETE /repos/{owner}/{repo}/environments/{environment_name}/deployment_protection_rules/{protection_rule_id}"],disableLfsForRepo:["DELETE /repos/{owner}/{repo}/lfs"],disableVulnerabilityAlerts:["DELETE /repos/{owner}/{repo}/vulnerability-alerts"],downloadArchive:["GET /repos/{owner}/{repo}/zipball/{ref}",{},{renamed:["repos","downloadZipballArchive"]}],downloadTarballArchive:["GET /repos/{owner}/{repo}/tarball/{ref}"],downloadZipballArchive:["GET /repos/{owner}/{repo}/zipball/{ref}"],enableAutomatedSecurityFixes:["PUT /repos/{owner}/{repo}/automated-security-fixes"],enableLfsForRepo:["PUT /repos/{owner}/{repo}/lfs"],enableVulnerabilityAlerts:["PUT /repos/{owner}/{repo}/vulnerability-alerts"],generateReleaseNotes:["POST /repos/{owner}/{repo}/releases/generate-notes"],get:["GET /repos/{owner}/{repo}"],getAccessRestrictions:["GET /repos/{owner}/{repo}/branches/{branch}/protection/restrictions"],getAdminBranchProtection:["GET /repos/{owner}/{repo}/branches/{branch}/protection/enforce_admins"],getAllDeploymentProtectionRules:["GET /repos/{owner}/{repo}/environments/{environment_name}/deployment_protection_rules"],getAllEnvironments:["GET /repos/{owner}/{repo}/environments"],getAllStatusCheckContexts:["GET /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks/contexts"],getAllTopics:["GET /repos/{owner}/{repo}/topics"],getAppsWithAccessToProtectedBranch:["GET /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/apps"],getAutolink:["GET /repos/{owner}/{repo}/autolinks/{autolink_id}"],getBranch:["GET /repos/{owner}/{repo}/branches/{branch}"],getBranchProtection:["GET /repos/{owner}/{repo}/branches/{branch}/protection"],getBranchRules:["GET /repos/{owner}/{repo}/rules/branches/{branch}"],getClones:["GET /repos/{owner}/{repo}/traffic/clones"],getCodeFrequencyStats:["GET /repos/{owner}/{repo}/stats/code_frequency"],getCollaboratorPermissionLevel:["GET /repos/{owner}/{repo}/collaborators/{username}/permission"],getCombinedStatusForRef:["GET /repos/{owner}/{repo}/commits/{ref}/status"],getCommit:["GET /repos/{owner}/{repo}/commits/{ref}"],getCommitActivityStats:["GET /repos/{owner}/{repo}/stats/commit_activity"],getCommitComment:["GET /repos/{owner}/{repo}/comments/{comment_id}"],getCommitSignatureProtection:["GET /repos/{owner}/{repo}/branches/{branch}/protection/required_signatures"],getCommunityProfileMetrics:["GET /repos/{owner}/{repo}/community/profile"],getContent:["GET /repos/{owner}/{repo}/contents/{path}"],getContributorsStats:["GET /repos/{owner}/{repo}/stats/contributors"],getCustomDeploymentProtectionRule:["GET /repos/{owner}/{repo}/environments/{environment_name}/deployment_protection_rules/{protection_rule_id}"],getDeployKey:["GET /repos/{owner}/{repo}/keys/{key_id}"],getDeployment:["GET /repos/{owner}/{repo}/deployments/{deployment_id}"],getDeploymentBranchPolicy:["GET /repos/{owner}/{repo}/environments/{environment_name}/deployment-branch-policies/{branch_policy_id}"],getDeploymentStatus:["GET /repos/{owner}/{repo}/deployments/{deployment_id}/statuses/{status_id}"],getEnvironment:["GET /repos/{owner}/{repo}/environments/{environment_name}"],getLatestPagesBuild:["GET /repos/{owner}/{repo}/pages/builds/latest"],getLatestRelease:["GET /repos/{owner}/{repo}/releases/latest"],getOrgRuleset:["GET /orgs/{org}/rulesets/{ruleset_id}"],getOrgRulesets:["GET /orgs/{org}/rulesets"],getPages:["GET /repos/{owner}/{repo}/pages"],getPagesBuild:["GET /repos/{owner}/{repo}/pages/builds/{build_id}"],getPagesHealthCheck:["GET /repos/{owner}/{repo}/pages/health"],getParticipationStats:["GET /repos/{owner}/{repo}/stats/participation"],getPullRequestReviewProtection:["GET /repos/{owner}/{repo}/branches/{branch}/protection/required_pull_request_reviews"],getPunchCardStats:["GET /repos/{owner}/{repo}/stats/punch_card"],getReadme:["GET /repos/{owner}/{repo}/readme"],getReadmeInDirectory:["GET /repos/{owner}/{repo}/readme/{dir}"],getRelease:["GET /repos/{owner}/{repo}/releases/{release_id}"],getReleaseAsset:["GET /repos/{owner}/{repo}/releases/assets/{asset_id}"],getReleaseByTag:["GET /repos/{owner}/{repo}/releases/tags/{tag}"],getRepoRuleset:["GET /repos/{owner}/{repo}/rulesets/{ruleset_id}"],getRepoRulesets:["GET /repos/{owner}/{repo}/rulesets"],getStatusChecksProtection:["GET /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks"],getTeamsWithAccessToProtectedBranch:["GET /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/teams"],getTopPaths:["GET /repos/{owner}/{repo}/traffic/popular/paths"],getTopReferrers:["GET /repos/{owner}/{repo}/traffic/popular/referrers"],getUsersWithAccessToProtectedBranch:["GET /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/users"],getViews:["GET /repos/{owner}/{repo}/traffic/views"],getWebhook:["GET /repos/{owner}/{repo}/hooks/{hook_id}"],getWebhookConfigForRepo:["GET /repos/{owner}/{repo}/hooks/{hook_id}/config"],getWebhookDelivery:["GET /repos/{owner}/{repo}/hooks/{hook_id}/deliveries/{delivery_id}"],listAutolinks:["GET /repos/{owner}/{repo}/autolinks"],listBranches:["GET /repos/{owner}/{repo}/branches"],listBranchesForHeadCommit:["GET /repos/{owner}/{repo}/commits/{commit_sha}/branches-where-head"],listCollaborators:["GET /repos/{owner}/{repo}/collaborators"],listCommentsForCommit:["GET /repos/{owner}/{repo}/commits/{commit_sha}/comments"],listCommitCommentsForRepo:["GET /repos/{owner}/{repo}/comments"],listCommitStatusesForRef:["GET /repos/{owner}/{repo}/commits/{ref}/statuses"],listCommits:["GET /repos/{owner}/{repo}/commits"],listContributors:["GET /repos/{owner}/{repo}/contributors"],listCustomDeploymentRuleIntegrations:["GET /repos/{owner}/{repo}/environments/{environment_name}/deployment_protection_rules/apps"],listDeployKeys:["GET /repos/{owner}/{repo}/keys"],listDeploymentBranchPolicies:["GET /repos/{owner}/{repo}/environments/{environment_name}/deployment-branch-policies"],listDeploymentStatuses:["GET /repos/{owner}/{repo}/deployments/{deployment_id}/statuses"],listDeployments:["GET /repos/{owner}/{repo}/deployments"],listForAuthenticatedUser:["GET /user/repos"],listForOrg:["GET /orgs/{org}/repos"],listForUser:["GET /users/{username}/repos"],listForks:["GET /repos/{owner}/{repo}/forks"],listInvitations:["GET /repos/{owner}/{repo}/invitations"],listInvitationsForAuthenticatedUser:["GET /user/repository_invitations"],listLanguages:["GET /repos/{owner}/{repo}/languages"],listPagesBuilds:["GET /repos/{owner}/{repo}/pages/builds"],listPublic:["GET /repositories"],listPullRequestsAssociatedWithCommit:["GET /repos/{owner}/{repo}/commits/{commit_sha}/pulls"],listReleaseAssets:["GET /repos/{owner}/{repo}/releases/{release_id}/assets"],listReleases:["GET /repos/{owner}/{repo}/releases"],listTagProtection:["GET /repos/{owner}/{repo}/tags/protection"],listTags:["GET /repos/{owner}/{repo}/tags"],listTeams:["GET /repos/{owner}/{repo}/teams"],listWebhookDeliveries:["GET /repos/{owner}/{repo}/hooks/{hook_id}/deliveries"],listWebhooks:["GET /repos/{owner}/{repo}/hooks"],merge:["POST /repos/{owner}/{repo}/merges"],mergeUpstream:["POST /repos/{owner}/{repo}/merge-upstream"],pingWebhook:["POST /repos/{owner}/{repo}/hooks/{hook_id}/pings"],redeliverWebhookDelivery:["POST /repos/{owner}/{repo}/hooks/{hook_id}/deliveries/{delivery_id}/attempts"],removeAppAccessRestrictions:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/apps",{},{mapToData:"apps"}],removeCollaborator:["DELETE /repos/{owner}/{repo}/collaborators/{username}"],removeStatusCheckContexts:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks/contexts",{},{mapToData:"contexts"}],removeStatusCheckProtection:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks"],removeTeamAccessRestrictions:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/teams",{},{mapToData:"teams"}],removeUserAccessRestrictions:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/users",{},{mapToData:"users"}],renameBranch:["POST /repos/{owner}/{repo}/branches/{branch}/rename"],replaceAllTopics:["PUT /repos/{owner}/{repo}/topics"],requestPagesBuild:["POST /repos/{owner}/{repo}/pages/builds"],setAdminBranchProtection:["POST /repos/{owner}/{repo}/branches/{branch}/protection/enforce_admins"],setAppAccessRestrictions:["PUT /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/apps",{},{mapToData:"apps"}],setStatusCheckContexts:["PUT /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks/contexts",{},{mapToData:"contexts"}],setTeamAccessRestrictions:["PUT /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/teams",{},{mapToData:"teams"}],setUserAccessRestrictions:["PUT /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/users",{},{mapToData:"users"}],testPushWebhook:["POST /repos/{owner}/{repo}/hooks/{hook_id}/tests"],transfer:["POST /repos/{owner}/{repo}/transfer"],update:["PATCH /repos/{owner}/{repo}"],updateBranchProtection:["PUT /repos/{owner}/{repo}/branches/{branch}/protection"],updateCommitComment:["PATCH /repos/{owner}/{repo}/comments/{comment_id}"],updateDeploymentBranchPolicy:["PUT /repos/{owner}/{repo}/environments/{environment_name}/deployment-branch-policies/{branch_policy_id}"],updateInformationAboutPagesSite:["PUT /repos/{owner}/{repo}/pages"],updateInvitation:["PATCH /repos/{owner}/{repo}/invitations/{invitation_id}"],updateOrgRuleset:["PUT /orgs/{org}/rulesets/{ruleset_id}"],updatePullRequestReviewProtection:["PATCH /repos/{owner}/{repo}/branches/{branch}/protection/required_pull_request_reviews"],updateRelease:["PATCH /repos/{owner}/{repo}/releases/{release_id}"],updateReleaseAsset:["PATCH /repos/{owner}/{repo}/releases/assets/{asset_id}"],updateRepoRuleset:["PUT /repos/{owner}/{repo}/rulesets/{ruleset_id}"],updateStatusCheckPotection:["PATCH /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks",{},{renamed:["repos","updateStatusCheckProtection"]}],updateStatusCheckProtection:["PATCH /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks"],updateWebhook:["PATCH /repos/{owner}/{repo}/hooks/{hook_id}"],updateWebhookConfigForRepo:["PATCH /repos/{owner}/{repo}/hooks/{hook_id}/config"],uploadReleaseAsset:["POST /repos/{owner}/{repo}/releases/{release_id}/assets{?name,label}",{baseUrl:"https://uploads.github.com"}]},search:{code:["GET /search/code"],commits:["GET /search/commits"],issuesAndPullRequests:["GET /search/issues"],labels:["GET /search/labels"],repos:["GET /search/repositories"],topics:["GET /search/topics"],users:["GET /search/users"]},secretScanning:{getAlert:["GET /repos/{owner}/{repo}/secret-scanning/alerts/{alert_number}"],listAlertsForEnterprise:["GET /enterprises/{enterprise}/secret-scanning/alerts"],listAlertsForOrg:["GET /orgs/{org}/secret-scanning/alerts"],listAlertsForRepo:["GET /repos/{owner}/{repo}/secret-scanning/alerts"],listLocationsForAlert:["GET /repos/{owner}/{repo}/secret-scanning/alerts/{alert_number}/locations"],updateAlert:["PATCH /repos/{owner}/{repo}/secret-scanning/alerts/{alert_number}"]},securityAdvisories:{createPrivateVulnerabilityReport:["POST /repos/{owner}/{repo}/security-advisories/reports"],createRepositoryAdvisory:["POST /repos/{owner}/{repo}/security-advisories"],getRepositoryAdvisory:["GET /repos/{owner}/{repo}/security-advisories/{ghsa_id}"],listRepositoryAdvisories:["GET /repos/{owner}/{repo}/security-advisories"],updateRepositoryAdvisory:["PATCH /repos/{owner}/{repo}/security-advisories/{ghsa_id}"]},teams:{addOrUpdateMembershipForUserInOrg:["PUT /orgs/{org}/teams/{team_slug}/memberships/{username}"],addOrUpdateProjectPermissionsInOrg:["PUT /orgs/{org}/teams/{team_slug}/projects/{project_id}"],addOrUpdateRepoPermissionsInOrg:["PUT /orgs/{org}/teams/{team_slug}/repos/{owner}/{repo}"],checkPermissionsForProjectInOrg:["GET /orgs/{org}/teams/{team_slug}/projects/{project_id}"],checkPermissionsForRepoInOrg:["GET /orgs/{org}/teams/{team_slug}/repos/{owner}/{repo}"],create:["POST /orgs/{org}/teams"],createDiscussionCommentInOrg:["POST /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments"],createDiscussionInOrg:["POST /orgs/{org}/teams/{team_slug}/discussions"],deleteDiscussionCommentInOrg:["DELETE /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments/{comment_number}"],deleteDiscussionInOrg:["DELETE /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}"],deleteInOrg:["DELETE /orgs/{org}/teams/{team_slug}"],getByName:["GET /orgs/{org}/teams/{team_slug}"],getDiscussionCommentInOrg:["GET /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments/{comment_number}"],getDiscussionInOrg:["GET /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}"],getMembershipForUserInOrg:["GET /orgs/{org}/teams/{team_slug}/memberships/{username}"],list:["GET /orgs/{org}/teams"],listChildInOrg:["GET /orgs/{org}/teams/{team_slug}/teams"],listDiscussionCommentsInOrg:["GET /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments"],listDiscussionsInOrg:["GET /orgs/{org}/teams/{team_slug}/discussions"],listForAuthenticatedUser:["GET /user/teams"],listMembersInOrg:["GET /orgs/{org}/teams/{team_slug}/members"],listPendingInvitationsInOrg:["GET /orgs/{org}/teams/{team_slug}/invitations"],listProjectsInOrg:["GET /orgs/{org}/teams/{team_slug}/projects"],listReposInOrg:["GET /orgs/{org}/teams/{team_slug}/repos"],removeMembershipForUserInOrg:["DELETE /orgs/{org}/teams/{team_slug}/memberships/{username}"],removeProjectInOrg:["DELETE /orgs/{org}/teams/{team_slug}/projects/{project_id}"],removeRepoInOrg:["DELETE /orgs/{org}/teams/{team_slug}/repos/{owner}/{repo}"],updateDiscussionCommentInOrg:["PATCH /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments/{comment_number}"],updateDiscussionInOrg:["PATCH /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}"],updateInOrg:["PATCH /orgs/{org}/teams/{team_slug}"]},users:{addEmailForAuthenticated:["POST /user/emails",{},{renamed:["users","addEmailForAuthenticatedUser"]}],addEmailForAuthenticatedUser:["POST /user/emails"],addSocialAccountForAuthenticatedUser:["POST /user/social_accounts"],block:["PUT /user/blocks/{username}"],checkBlocked:["GET /user/blocks/{username}"],checkFollowingForUser:["GET /users/{username}/following/{target_user}"],checkPersonIsFollowedByAuthenticated:["GET /user/following/{username}"],createGpgKeyForAuthenticated:["POST /user/gpg_keys",{},{renamed:["users","createGpgKeyForAuthenticatedUser"]}],createGpgKeyForAuthenticatedUser:["POST /user/gpg_keys"],createPublicSshKeyForAuthenticated:["POST /user/keys",{},{renamed:["users","createPublicSshKeyForAuthenticatedUser"]}],createPublicSshKeyForAuthenticatedUser:["POST /user/keys"],createSshSigningKeyForAuthenticatedUser:["POST /user/ssh_signing_keys"],deleteEmailForAuthenticated:["DELETE /user/emails",{},{renamed:["users","deleteEmailForAuthenticatedUser"]}],deleteEmailForAuthenticatedUser:["DELETE /user/emails"],deleteGpgKeyForAuthenticated:["DELETE /user/gpg_keys/{gpg_key_id}",{},{renamed:["users","deleteGpgKeyForAuthenticatedUser"]}],deleteGpgKeyForAuthenticatedUser:["DELETE /user/gpg_keys/{gpg_key_id}"],deletePublicSshKeyForAuthenticated:["DELETE /user/keys/{key_id}",{},{renamed:["users","deletePublicSshKeyForAuthenticatedUser"]}],deletePublicSshKeyForAuthenticatedUser:["DELETE /user/keys/{key_id}"],deleteSocialAccountForAuthenticatedUser:["DELETE /user/social_accounts"],deleteSshSigningKeyForAuthenticatedUser:["DELETE /user/ssh_signing_keys/{ssh_signing_key_id}"],follow:["PUT /user/following/{username}"],getAuthenticated:["GET /user"],getByUsername:["GET /users/{username}"],getContextForUser:["GET /users/{username}/hovercard"],getGpgKeyForAuthenticated:["GET /user/gpg_keys/{gpg_key_id}",{},{renamed:["users","getGpgKeyForAuthenticatedUser"]}],getGpgKeyForAuthenticatedUser:["GET /user/gpg_keys/{gpg_key_id}"],getPublicSshKeyForAuthenticated:["GET /user/keys/{key_id}",{},{renamed:["users","getPublicSshKeyForAuthenticatedUser"]}],getPublicSshKeyForAuthenticatedUser:["GET /user/keys/{key_id}"],getSshSigningKeyForAuthenticatedUser:["GET /user/ssh_signing_keys/{ssh_signing_key_id}"],list:["GET /users"],listBlockedByAuthenticated:["GET /user/blocks",{},{renamed:["users","listBlockedByAuthenticatedUser"]}],listBlockedByAuthenticatedUser:["GET /user/blocks"],listEmailsForAuthenticated:["GET /user/emails",{},{renamed:["users","listEmailsForAuthenticatedUser"]}],listEmailsForAuthenticatedUser:["GET /user/emails"],listFollowedByAuthenticated:["GET /user/following",{},{renamed:["users","listFollowedByAuthenticatedUser"]}],listFollowedByAuthenticatedUser:["GET /user/following"],listFollowersForAuthenticatedUser:["GET /user/followers"],listFollowersForUser:["GET /users/{username}/followers"],listFollowingForUser:["GET /users/{username}/following"],listGpgKeysForAuthenticated:["GET /user/gpg_keys",{},{renamed:["users","listGpgKeysForAuthenticatedUser"]}],listGpgKeysForAuthenticatedUser:["GET /user/gpg_keys"],listGpgKeysForUser:["GET /users/{username}/gpg_keys"],listPublicEmailsForAuthenticated:["GET /user/public_emails",{},{renamed:["users","listPublicEmailsForAuthenticatedUser"]}],listPublicEmailsForAuthenticatedUser:["GET /user/public_emails"],listPublicKeysForUser:["GET /users/{username}/keys"],listPublicSshKeysForAuthenticated:["GET /user/keys",{},{renamed:["users","listPublicSshKeysForAuthenticatedUser"]}],listPublicSshKeysForAuthenticatedUser:["GET /user/keys"],listSocialAccountsForAuthenticatedUser:["GET /user/social_accounts"],listSocialAccountsForUser:["GET /users/{username}/social_accounts"],listSshSigningKeysForAuthenticatedUser:["GET /user/ssh_signing_keys"],listSshSigningKeysForUser:["GET /users/{username}/ssh_signing_keys"],setPrimaryEmailVisibilityForAuthenticated:["PATCH /user/email/visibility",{},{renamed:["users","setPrimaryEmailVisibilityForAuthenticatedUser"]}],setPrimaryEmailVisibilityForAuthenticatedUser:["PATCH /user/email/visibility"],unblock:["DELETE /user/blocks/{username}"],unfollow:["DELETE /user/following/{username}"],updateAuthenticated:["PATCH /user"]}},kB=FB,rc=new Map;for(let[r,e]of Object.entries(kB))for(let[t,i]of Object.entries(e)){let[n,s,o]=i,[a,l]=n.split(/ /),u=Object.assign({method:a,url:l},s);rc.has(r)||rc.set(r,new Map),rc.get(r).set(t,{scope:r,methodName:t,endpointDefaults:u,decorations:o})}var CB={get({octokit:r,scope:e,cache:t},i){if(t[i])return t[i];let{decorations:n,endpointDefaults:s}=rc.get(e).get(i);return n?t[i]=SB(r,e,i,s,n):t[i]=r.request.defaults(s),t[i]}};function EC(r){let e={};for(let t of rc.keys())e[t]=new Proxy({octokit:r,scope:t,cache:{}},CB);return e}function SB(r,e,t,i,n){let s=r.request.defaults(i);function o(...a){let l=s.endpoint.merge(...a);if(n.mapToData)return l=Object.assign({},l,{data:l[n.mapToData],[n.mapToData]:void 0}),s(l);if(n.renamed){let[u,c]=n.renamed;r.log.warn(`octokit.${e}.${t}() has been renamed to octokit.${u}.${c}()`)}if(n.deprecated&&r.log.warn(n.deprecated),n.renamedParameters){let u=s.endpoint.merge(...a);for(let[c,d]of Object.entries(n.renamedParameters))c in u&&(r.log.warn(`"${c}" parameter is deprecated for "octokit.${e}.${t}()". Use "${d}" instead`),d in u||(u[d]=u[c]),delete u[c]);return s(u)}return s(...a)}return Object.assign(o,s)}function PB(r){return{rest:EC(r)}}PB.VERSION=PC;function Ag(r){let e=EC(r);return{...e,rest:e}}Ag.VERSION=PC;var EB="19.0.13",Rg=Cf.plugin(xg,Ag,Dg).defaults({userAgent:`octokit-rest.js/${EB}`});var IC=Le(Je());var fs=class r{constructor(e){this._isUserStateLoaded=!1;this._onAuthenticated=this._onAuthenticated.bind(this),this._octokit=new Rg({auth:"",userAgent:Yr.name+" "+Yr.version}),this._prefsFile=e}static{this._tokenFromLogin=""}static{this._tokenFromPrefs=""}static{this._onAuthenticated=new IC.EventDispatcher}static githubAuthenticationCompleted(e){r._tokenFromLogin=e,r._onAuthenticated.dispatch("","")}static get isSignedIn(){return this._tokenFromLogin!==void 0&&this._tokenFromLogin!==""||this._tokenFromPrefs!==void 0&&this._tokenFromPrefs!==""}static signIn(){if(typeof window<"u"){if(window.prompt("This is really really preview. You should not use any work or meaningful GitHub accounts with this - yet. Type yes to go ahead anyways.")!=="yes")return;window.open("/Auth/Login","login","width=600,height=700,resizable=off")}}static get onAuthenticated(){return r._onAuthenticated.asEvent()}static init(){typeof window<"u"&&(window.githubAuthenticationCompleted=r.githubAuthenticationCompleted)}get repos(){if(this._reposResponse!==void 0)return this._reposResponse.data}get authenticatedUser(){if(this._userResponse!==void 0)return this._userResponse.data}get octokit(){return this._octokit}_onAuthenticated(e,t){this._savePrefs()}async _loadPrefs(){this._prefsFile!==void 0&&(await this._prefsFile.loadContent(),this._prefsFile.content!==void 0&&typeof this._prefsFile.content=="string"&&(this._data=JSON.parse(this._prefsFile.content)),(this._data===void 0||this._data.authToken===void 0)&&r._tokenFromLogin!==void 0?this._savePrefs():this._data!==void 0&&this._data.authToken!==void 0&&(r._tokenFromPrefs===void 0&&(r._tokenFromPrefs=this._data.authToken),this._octokit=new Rg({userAgent:Yr.name+" "+Yr.version})))}async _savePrefs(){this._prefsFile!==void 0&&(this._data===void 0&&(this._data={}),r._tokenFromLogin!==void 0&&(this._data.authToken=r._tokenFromLogin),this.authenticatedUser!==void 0&&this.authenticatedUser.name!==null&&(this._data.userName=this.authenticatedUser.name),this._prefsFile.setContent(JSON.stringify(this._data)),await this._prefsFile.saveContent())}async ensureUserStateLoaded(){if(this._isUserStateLoaded)return;await this._loadPrefs();let e=await this._octokit.rest.users.getAuthenticated();this._userResponse=e;let t=await this._octokit.rest.repos.listForAuthenticatedUser();this._reposResponse=t,this._isUserStateLoaded=!0}async createRepo(e,t){return(await this._octokit.repos.createForAuthenticatedUser({name:e,description:t,auto_init:!0})).data}async commitToRepo(e,t,i="main",n="",s,o){let a=await this.getCurrentCommit(e,t,i),l=[],u=[];for(let h=0;h<o.fileDifferences.length;h++){let f=o.fileDifferences[h];if((f.type===1||f.type===2)&&f.updated!==void 0){let m=f.updated;if(await m.loadContent(),m.content!==null){let p=f.path;p=n+p,p.startsWith("/")&&(p=p.substring(1,p.length));let g=await this.createBlobForFile(e,t,m.content);l.push(g),u.push(p)}}}let c=await this.createNewTree(e,t,l,u,a.treeSha),d=await this.createNewCommit(e,t,s,c.sha,a.commitSha);this.setBranchToCommit(e,t,i,d.sha)}async createBlobForFile(e,t,i){let n="utf-8";return i instanceof Uint8Array&&(i=B.uint8ArrayToBase64(i),n="base64"),(await this._octokit.git.createBlob({owner:e,repo:t,content:i,encoding:n})).data}async getCurrentCommit(e,t,i="main"){let{data:n}=await this._octokit.git.getRef({owner:e,repo:t,ref:"heads/"+i}),s=n.object.sha,{data:o}=await this._octokit.git.getCommit({owner:e,repo:t,commit_sha:s});return{commitSha:s,treeSha:o.tree.sha}}async createNewTree(e,t,i,n,s){let o=i.map(({sha:l},u)=>({path:n[u],mode:"100644",type:"blob",sha:l})),{data:a}=await this._octokit.git.createTree({owner:e,repo:t,tree:o,base_tree:s});return a}async createNewCommit(e,t,i,n,s){return(await this._octokit.git.createCommit({owner:e,repo:t,message:i,tree:n,parents:[s]})).data}setBranchToCommit(e,t,i="main",n){this._octokit.git.updateRef({owner:e,repo:t,ref:`heads/${i}`,sha:n})}};var nc=class{get value(){if(this._type===0&&this._pos!==void 0){let e=this._pos.toString();return this._coordinateType===2?e="^"+e:this._coordinateType===1&&(e="~"+e),e}return this._content}get position(){return this._pos===void 0?0:this._pos}set position(e){this._pos=e}get coordinateType(){return this._coordinateType===void 0?0:this._coordinateType}set coordinateType(e){this._coordinateType=e}get type(){return this._type}get location(){return this._location}set location(e){this._location=e}constructor(e){this._content=e,this._type=1,this.setValue(e)}setValue(e){this._content=e;let t=this._content.startsWith("^"),i=this._content.startsWith("~");if(t||i){let n=this._content.substring(1,this._content.length);B.isNumeric(n)?(this._type=0,i?this._coordinateType=1:t&&(this._coordinateType=2),this._pos=parseInt(n)):this._type=1}else B.isNumeric(this._content)?(this._type=0,this._coordinateType=0,this._pos=parseInt(e)):this._type=1}toString(){return this.value}};var sc=class{constructor(e){let t=e.indexOf(" ");this._arguments=[];let i=-1;if(t<0)this._commandName=e;else{this._commandName=e.substring(0,t);let n=e.substring(t+1,e.length).split(" ");for(let s=0;s<n.length;s++){let o=new nc(n[s]);o.type===0?(i++,i>=3&&(i=0),i===0?o.location=0:i===1?o.location=1:i===2&&(o.location=2)):i=-1,this._arguments.push(o)}}this._commandName.startsWith("/")&&(this._commandName=this._commandName.substring(1,this._commandName.length))}absolutizeCoordinates(e,t,i){for(let n=0;n<this._arguments.length;n++){let s=this._arguments[n];s.type===0&&s.coordinateType===1&&(s.location===0?(s.coordinateType=0,s.position=e+s.position):s.location===1?(s.coordinateType=0,s.position=t+s.position):s.location===2&&(s.coordinateType=0,s.position=i+s.position))}}get hasRelativeOrLocalCoordinates(){for(let e=0;e<this._arguments.length;e++){let t=this._arguments[e];if(t.type===0&&t.coordinateType!==0)return!0}return!1}get firstX(){for(let e=0;e<this._arguments.length;e++){let t=this._arguments[e];if(t.type===0&&t.location===0)return t}}get firstY(){for(let e=0;e<this._arguments.length;e++){let t=this._arguments[e];if(t.type===0&&t.location===1)return t}}get firstZ(){for(let e=0;e<this._arguments.length;e++){let t=this._arguments[e];if(t.type===0&&t.location===2)return t}}toString(){let e=this._commandName;for(let t=0;t<this._arguments.length;t++)e+=" ",e+=this._arguments[t].toString();return e}};var oc=class r{static async runCustomTool(e,t){e.activeMinecraftState,6;let i=e.getCustomTool(t-1),n=t+"";i.name!==void 0&&i.name.length>0&&(n=i.name);let s=await e.notifyOperationStarted("Running command "+n);i.text!==void 0&&await r.runCommandText(e,i.text),await e.notifyOperationEnded(s,"Command "+n+" complete.")}static async runCommandText(e,t){let i=t.split(`
`);await this.runCommandList(e,i)}static async runCommandList(e,t){let i=[],n=-1,s=-1,o=-1,a,l,u,c=!1;for(let d=0;d<t.length;d++){let h=t[d].trim();if(h.length>4&&!h.startsWith("#")){h.startsWith("/")||(h="/"+h);let f=new Date,m=new sc(h);m.hasRelativeOrLocalCoordinates&&c&&a!==void 0&&l!==void 0&&u!==void 0&&m.absolutizeCoordinates(n-a,s-l,o-u),h=m.toString(),await e.notifyStatusUpdate("Running command '"+h+"'");let g=(await e.runCommand(h))?.data,b;if(g!=null&&g.indexOf("{")>=0){try{b=JSON.parse(g)}catch{}if(b!==void 0&&b.position!==void 0&&!c){n=b.position.x,s=b.position.y,o=b.position.z;let w=m.firstX;w!==void 0&&(a=w.position);let _=m.firstY;_!==void 0&&(l=_.position);let I=m.firstZ;I!==void 0&&(u=I.position),c=!0}}let F={lineNumber:d,dateTime:f,response:b};i.push(F)}}return i}};var ac=class{get isWorldType(){return this.type===1||this.type===2}constructor(e,t){this.name=e,this.storagePath=t,this.baseName=S.getBaseFromName(e),this.type=this._getPackTypeFromPath(t)}_getPackTypeFromPath(e){switch(S.getTypeFromName(e)){case"mcworld":return 1;case"mcproject":return 4;case"mctemplate":return 2;case"mcaddon":case"mcpack":return 0;default:return 3}}async ensureData(e,t){this.file=t;let i=t.parentFolder.ensureFile(t.name+".report.html"),n=await i.exists(),s;if(n){await i.loadContent();let o=i.content;if(o&&typeof o=="string"){let a=o.indexOf("function _addReportJson("),l=o.indexOf("_addReportJson(");if(l>=0&&(a===l-9&&(l=o.indexOf("_addReportJson(",l+10)),l>=0)){let u=o.indexOf("<\/script>",l);if(u>l){let c=o.lastIndexOf(");",u);if(c>l&&c<u){let d=o.substring(l+15,c);try{s=JSON.parse(d)}catch{}s&&(this.reportFile=i),s&&s.generatorVersion!==Yr.version&&(s=void 0)}}}}}if(!s&&(await t.loadContent(),t.content&&t.content instanceof Uint8Array)){let o;if(!t.fileContainerStorage){let d=new yt;d.storagePath=t.storageRelativePath+"#",await d.loadFromUint8Array(t.content,t.name),t.fileContainerStorage=d}o=t.fileContainerStorage.rootFolder;let a=new sr(e,t.name,null);a.setProjectFolder(o),await a.inferProjectItemsFromFiles();let l=a.infoSet;await l.generateForProject();let u=await t.getHash(),c=l.getReportHtml(t.name,t.storageRelativePath,u);i.setContent(c),await i.saveContent(),this.reportFile=i,s=l.getDataObject(t.name,t.storageRelativePath,u)}s&&(this.data=s)}createReference(){let e=[],t=[];if(this.data&&this.data.items)for(let n=0;n<this.data.items.length;n++){let s=this.data.items[n];if(s.gId==="PACK"&&s.gIx===6&&s.d&&typeof s.d=="string"){let o=this.getRefFromString(s.d);o&&e.push(o)}else if(s.gId==="PACK"&&s.gIx===16&&s.d&&typeof s.d=="string"){let o=this.getRefFromString(s.d);o&&t.push(o)}}return{name:this.name,hash:this.data?.sourceHash,behaviorPackReferences:e,resourcePackReferences:t}}getRefFromString(e){let t=e.split("|");if(t.length!==2)return;let i=t[1].split(".");if(i.length!==3)return;let n=[];try{n.push(parseInt(i[0])),n.push(parseInt(i[1])),n.push(parseInt(i[2]))}catch{}if(n.length===3)return{uuid:t[0],version:n}}matches(e,t){let i=this.name.toLowerCase(),n=this.baseName.toLowerCase();return e=e.toLowerCase(),n.toLowerCase()===e&&(t===void 0||t===!0&&(this.type===1||this.type===2)||t===!1&&this.type!==1&&this.type!==2)||i===e}};var oa=Le(Je());var lc=Le(Je());var uc=class{constructor(e){this._playerLocationHistory=[];this._playerLocationHistoryTimes=[];this._itemInteractedLocationHistory=[];this._itemInteractedLocationHistoryTimes=[];this._playerMajorLocationHistory=[];this._playerMajorLocationHistoryTimes=[];this.curTick=0;this.pendingLocationChangeProcess=-1;this._eventsSeen={};this._onPlayerTravelled=new lc.EventDispatcher;this._onItemInteracted=new lc.EventDispatcher;this._onBlockBroken=new lc.EventDispatcher;this._onPlayerMajorTravelled=new lc.EventDispatcher;this._tick=this._tick.bind(this),typeof window<"u"&&window.setInterval(this._tick,50)}get playerMajorLocationHistory(){return this._playerMajorLocationHistory}get playerLocationHistory(){return this._playerLocationHistory}get itemInteractedHistory(){return this._itemInteractedLocationHistory}get playerLocation(){return this._playerLocation}get onPlayerTravelled(){return this._onPlayerTravelled.asEvent()}get onPlayerMajorTravelled(){return this._onPlayerMajorTravelled.asEvent()}get onItemInteracted(){return this._onItemInteracted.asEvent()}get onBlockBroken(){return this._onBlockBroken.asEvent()}_tick(){let e=this.curTick++;if(this.pendingLocationChangeProcess===e&&this._lastPlayerTravelledMessage){this.pendingLocationChangeProcess=-1;let t=this._playerLocationHistory[this._playerLocationHistory.length-1],i=this._playerMajorLocationHistoryTimes[this._playerMajorLocationHistoryTimes.length-1];this._playerMajorLocationHistory.push(t),this._playerMajorLocationHistoryTimes.push(i),this._onPlayerMajorTravelled.dispatch(this,this._lastPlayerTravelledMessage)}}handleEvent(e){if(!e.header)return;let t=e.eventId;if(t){if(this._eventsSeen[t]===!0)return;this._eventsSeen[t]=!0}let i=e.header.eventName;if(i)switch(i){case"BlockBroken":let n=e;this._onBlockBroken.dispatch(this,n);break;case"ItemInteracted":let s=e,o=new Date,a=new dr(0,0,0);this._lastPlayerTravelledMessage&&(a=new dr(this._lastPlayerTravelledMessage.body.player.position.x,this._lastPlayerTravelledMessage.body.player.position.y,this._lastPlayerTravelledMessage.body.player.position.z)),this._itemInteractedLocationHistory.push(a),this._itemInteractedLocationHistoryTimes.push(o),this._onItemInteracted.dispatch(this,s),C.verbose("Item was interacted");break;case"PlayerTravelled":let l=e,u=new dr(l.body.player.position.x,l.body.player.position.y,l.body.player.position.z),c=new Date;this._lastPlayerTravelledMessage=l,this._playerLocationHistory.push(u),this._playerLocationHistoryTimes.push(c),this._playerLocation=u,this._onPlayerTravelled.dispatch(this,l);let d=!1;if(this._playerMajorLocationHistory.length===0)d=!0;else{let h=this._playerMajorLocationHistory[this._playerMajorLocationHistory.length-1];u.distanceTo(h)>2&&(d=!0)}d?(this._playerMajorLocationHistory.push(u),this._playerMajorLocationHistoryTimes.push(c),this._onPlayerMajorTravelled.dispatch(this,l)):this.pendingLocationChangeProcess=this.curTick+60;break}}};var cc=class{constructor(e){this._onStateChanged=new oa.EventDispatcher;this._onRefreshed=new oa.EventDispatcher;this._onWorldFolderReady=new oa.EventDispatcher;this._onProjectFolderReady=new oa.EventDispatcher;this._onMessage=new oa.EventDispatcher;this._carto=e,this._gameStateManager=new uc(this._carto),this.state=0}get onWorldFolderReady(){return this._onWorldFolderReady.asEvent()}get onProjectFolderReady(){return this._onProjectFolderReady.asEvent()}get onMessage(){return this._onMessage.asEvent()}get canDeployFiles(){return!0}get onRefreshed(){return this._onRefreshed.asEvent()}get onStateChanged(){return this._onStateChanged.asEvent()}async updateStatus(){return this.state}get activeProject(){return this._project}set activeProject(e){this._project=e}get gameStateManager(){return this._gameStateManager}notifyStateChanged(e){this.state=e,this._onStateChanged.dispatch(this,e)}async initialize(){await this.start()}async prepare(e){}async runCommand(e){}processExternalMessage(e,t){}async pushWorld(){if(!this._carto||this._carto.deploymentStorage===null||!this._project)return;let e=this._project.name+"_mct",t=await wn.ensureMinecraftWorldsFolder(this._carto);if(!t){C.debug("Could not find a Minecraft world.");return}let i=t.ensureFolder(e);return await i.ensureExists(),await wn.syncFlatPackRefWorldTo(this._carto,this._project,i,e),e=B.getSimpleString(this._project.name)+"_mct",await i.saveAll(),e}async syncWithDeployment(){if(this._carto.deploymentStorage==null||this._carto.deployBehaviorPacksFolder==null||this._carto.minecraftGameMode===2)throw new Error("This instance doesn't support deployment");if(!this._project)return;await this._carto.deployBehaviorPacksFolder.exists()&&await wn.deployProject(this._carto,this._project,this._carto.deploymentStorage.rootFolder)}canPrepare(){return!0}async prepareAndStart(e){let t;return e.project&&(this._project=e.project,await this.syncWithDeployment()),e.worldType&&(t=await this.pushWorld()),await this.start(),{type:1,worldName:t}}async stop(){}async start(){!Ci.hasAppService&&B.isDebug?this.notifyStateChanged(8):(this.state===0||this.state===9||this.state===11)&&this.notifyStateChanged(1)}};var xC=880,TC=280,dc=class{constructor(e,t,i,n,s,o,a,l){this.contentRoot="";this._pendingPackLoadRequests=[];this._arePacksLoading=!1;this.mcLogs={};this._galleryLoaded=!1;this.isDeployingToComMojang=!1;this.hasAttemptedPersistentBrowserStorageSwitch=!1;this._onDeploymentStorageChanged=new Tn.EventDispatcher;this._onMinecraftStateChanged=new Tn.EventDispatcher;this._onMinecraftRefreshed=new Tn.EventDispatcher;this._onPropertyChanged=new Tn.EventDispatcher;this._onLoaded=new Tn.EventDispatcher;this._onStatusAdded=new Tn.EventDispatcher;this._onOperationCompleted=new Tn.EventDispatcher;this._onStatusAddedAsync=[];this._onGalleryLoaded=new Tn.EventDispatcher;this.prefsStorage=e,this.projectsStorage=t,this.deploymentStorage=i,this.previewDeploymentStorage=n,this.packStorage=o,this.worldStorage=s,this.workingStorage=a,this._deployBehaviorPacksFolder=null,this._deployResourcePacksFolder=null,l&&(this.contentRoot=l),this._handleMessageFromAppService=this._handleMessageFromAppService.bind(this),this._bubbleMinecraftStateChanged=this._bubbleMinecraftStateChanged.bind(this),this._bubbleMinecraftRefreshed=this._bubbleMinecraftRefreshed.bind(this),Ci.onMessage.subscribe(this._handleMessageFromAppService),this.#e={successfullyConnectedWebSocketToMinecraft:!1,successfullyStartedMinecraftServer:!1,successfullyConnectedToRemoteMinecraft:!1,autoStartMinecraft:!0,showScreenOnConnect:!0,customTools:[]},Ne.baseUrl&&(this.setMinecraftFlavor(1),this.successfullyConnectedWebSocketToMinecraft=!0),this._isLoaded=!1,this.projects=[],this.status=[],this.activeOperations=[],this.updateDeploymentStorage(i)}#e;get isLoaded(){return this._isLoaded}get collapsedTypes(){return this.#e.collapsedTypes||(this.#e.collapsedTypes=[]),this.#e.collapsedTypes}set collapsedTypes(e){this.#e.collapsedTypes=e}get worldSettings(){return this.#e.worldSettings}get editorWorldSettings(){return this.#e.editorWorldSettings}get activeMinecraftState(){return this.activeMinecraft===void 0?0:this.activeMinecraft.state}get onMinecraftStateChanged(){return this._onMinecraftStateChanged.asEvent()}get onDeploymentStorageChanged(){return this._onDeploymentStorageChanged.asEvent()}get formatBeforeSave(){return this.#e.formatBeforeSave===void 0?!0:this.#e.formatBeforeSave}set formatBeforeSave(e){this.#e.formatBeforeSave=e}get conversionJarPath(){return this.#e.conversionJarPath}set conversionJarPath(e){this.#e.conversionJarPath=e}get preferredTextSize(){return this.#e.preferredTextSize===void 0?16:this.#e.preferredTextSize}set preferredTextSize(e){this.#e.preferredTextSize=e}get itemSidePaneWidth(){return this.#e.itemSidePaneWidth===void 0?300:this.#e.itemSidePaneWidth<TC?TC:this.#e.itemSidePaneWidth>xC?xC:this.#e.itemSidePaneWidth}set itemSidePaneWidth(e){this.#e.itemSidePaneWidth=e}get preferredSuite(){return this.#e.preferredSuite}set preferredSuite(e){this.#e.preferredSuite=e}get track(){return this.#e.track}set track(e){e!==this.#e.track&&(this.#e.track=e,this._onPropertyChanged.dispatch(this,"track"))}get effectiveTrack(){return this.#e.track!==void 0?this.#e.track:0}get useEditor(){return this.#e.useEditor}set useEditor(e){e!==this.#e.useEditor&&(this.#e.useEditor=e)}get windowX(){return this.#e.windowX===void 0?0:this.#e.windowX}set windowX(e){this.#e.windowX=e}get windowY(){return this.#e.windowY===void 0?0:this.#e.windowY}set windowY(e){this.#e.windowY=e}get windowWidth(){return this.#e.windowWidth===void 0?1200:this.#e.windowWidth}set windowWidth(e){this.#e.windowWidth=e}get windowHeight(){return this.#e.windowHeight===void 0?900:this.#e.windowHeight}set windowHeight(e){this.#e.windowHeight=e}get windowSlot(){return this.#e.windowSlot===void 0?0:this.#e.windowSlot}set windowSlot(e){this.#e.windowSlot=e}get creator(){return this.#e.creator}set creator(e){this.#e.creator!==e&&(this.#e.creator=e,this._onPropertyChanged.dispatch(this,"creator"))}get windowState(){return this.#e.windowState===void 0?0:this.#e.windowState}set windowState(e){this.#e.windowState=e}get lastActiveMinecraftFlavor(){return this.#e.lastActiveMinecraftFlavor}set lastActiveMinecraftFlavor(e){e!==this.#e.lastActiveMinecraftFlavor&&(this.#e.lastActiveMinecraftFlavor=e)}get remoteServerUrl(){return this.#e.remoteServerUrl===void 0&&Ne.baseUrl?B.getBaseUrl(Ne.baseUrl):this.#e.remoteServerUrl}get fullRemoteServerUrl(){if(!this.remoteServerUrl)return;let e=this.remoteServerUrl.toLowerCase();return!e.startsWith("http")&&e.indexOf("//")<0&&(e.indexOf("localhost")>=0?e="http://"+e:e="https://"+e),e=B.ensureEndsWithSlash(e),e}set remoteServerUrl(e){e!==this.#e.remoteServerUrl&&(this.#e.remoteServerUrl=e)}get iAgreeToTheMinecraftEndUserLicenseAgreementAndPrivacyPolicyAtMinecraftDotNetSlashEula(){return this.#e.iAgreeToTheMinecraftEndUserLicenseAgreementAndPrivacyPolicyAtMinecraftDotNetSlashEula}set iAgreeToTheMinecraftEndUserLicenseAgreementAndPrivacyPolicyAtMinecraftDotNetSlashEula(e){this.#e.iAgreeToTheMinecraftEndUserLicenseAgreementAndPrivacyPolicyAtMinecraftDotNetSlashEula=e}get dedicatedServerSlotCount(){return this.#e.dedicatedServerSlotCount}set dedicatedServerSlotCount(e){this.#e.dedicatedServerSlotCount=e}get dedicatedServerMode(){return this.#e.dedicatedServerMode===void 0?0:this.#e.dedicatedServerMode}set dedicatedServerMode(e){this.#e.dedicatedServerMode=e}get dedicatedServerPath(){return this.#e.dedicatedServerPath}set minecraftGameMode(e){this.#e.webSocketMode=e}get minecraftGameMode(){return this.#e.webSocketMode}set dedicatedServerPath(e){this.#e.dedicatedServerPath=e}get remoteServerPort(){return this.#e.remoteServerPort===void 0?0:this.#e.remoteServerPort}set remoteServerPort(e){this.#e.remoteServerPort=e}get remoteServerAccessLevel(){return this.#e.remoteServerAccessLevel}set remoteServerAccessLevel(e){this.#e.remoteServerAccessLevel=e}get remoteServerPasscode(){return this.#e.remoteServerPasscode}set remoteServerPasscode(e){this.#e.remoteServerPasscode=e}get remoteServerAuthToken(){return this.#e.remoteServerAuthToken}set remoteServerAuthToken(e){this.#e.remoteServerAuthToken=e}get editorViewMode(){return this.#e.editorViewMode===void 0?0:this.#e.editorViewMode}set editorViewMode(e){this.#e.editorViewMode=e}get gallery(){return this._gallery}get galleryLoaded(){return this._galleryLoaded}get userGitHub(){return this._userGitHub===void 0&&(this._userGitHub=new fs(this.prefsStorage.rootFolder.ensureFile("github.json"))),this._userGitHub}get anonGitHub(){return this._anonGitHub===void 0&&(this._anonGitHub=new fs),this._anonGitHub}get onLoaded(){return this._onLoaded.asEvent()}get onGalleryLoaded(){return this._onGalleryLoaded.asEvent()}get onPropertyChanged(){return this._onPropertyChanged.asEvent()}get onStatusAdded(){return this._onStatusAdded.asEvent()}get onOperationCompleted(){return this._onOperationCompleted.asEvent()}get successfullyConnectedWebSocketToMinecraft(){return this.#e.successfullyConnectedWebSocketToMinecraft===void 0?!1:this.#e.successfullyConnectedWebSocketToMinecraft}set successfullyConnectedWebSocketToMinecraft(e){this.#e.successfullyConnectedWebSocketToMinecraft=e}get successfullyStartedMinecraftServer(){return this.#e.successfullyStartedMinecraftServer===void 0?!1:this.#e.successfullyStartedMinecraftServer}set successfullyStartedMinecraftServer(e){this.#e.successfullyStartedMinecraftServer=e}get successfullyConnectedToRemoteMinecraft(){return this.#e.successfullyConnectedToRemoteMinecraft===void 0?!1:this.#e.successfullyConnectedToRemoteMinecraft}set successfullyConnectedToRemoteMinecraft(e){this.#e.successfullyConnectedToRemoteMinecraft=e}get defaultMinecraftFlavor(){return this.#e.lastActiveMinecraftFlavor===void 0?Ne.isAppServiceWeb?2:1:this.#e.lastActiveMinecraftFlavor}subscribeStatusAddedAsync(e){this._onStatusAddedAsync.push(e)}unsubscribeStatusAddedAsync(e){let t=[];for(let i=0;i<this._onStatusAddedAsync.length;i++)this._onStatusAddedAsync[i]!==e&&t.push(this._onStatusAddedAsync[i]);this._onStatusAddedAsync=t}setMinecraftFlavor(e){this.ensureMinecraft(e)}get autoStartMinecraft(){return this.#e.autoStartMinecraft===void 0?!0:this.#e.autoStartMinecraft}set autoStartMinecraft(e){this.#e.autoStartMinecraft=e}get file(){return this.prefsStorage.rootFolder.ensureFile("mctools.json")}get prefsProjectsFolder(){return this.prefsStorage.rootFolder.ensureFolder("projects")}get deployBehaviorPacksFolder(){return this._deployBehaviorPacksFolder}get deployResourcePacksFolder(){return this._deployResourcePacksFolder}updateDeploymentStorage(e){this.deploymentStorage=e,this.deploymentStorage!=null?(this._deployBehaviorPacksFolder=this.deploymentStorage.rootFolder.ensureFolder("development_behavior_packs"),this._deployResourcePacksFolder=this.deploymentStorage.rootFolder.ensureFolder("development_resource_packs")):(this._deployBehaviorPacksFolder=null,this._deployResourcePacksFolder=null),this._onDeploymentStorageChanged.dispatch(this,e)}initializeWorldSettings(){this.#e.worldSettings===void 0&&(this.#e.worldSettings={gameType:1,generator:1,randomSeed:"2000",backupType:2,useCustomSettings:!1,isEditor:!1,packageReferences:[]},this.ensureDefaultWorldName())}ensureDefaultWorldName(){this.worldSettings&&this.worldSettings.name===void 0&&(this.worldSettings.name="world "+B.getDateStr(new Date))}initializeEditorWorldSettings(){this.#e.editorWorldSettings===void 0&&(this.#e.editorWorldSettings={gameType:1,generator:1,backupType:2,useCustomSettings:!1,isEditor:!0,packageReferences:[]},this.ensureDefaultEditorWorldName())}ensureDefaultEditorWorldName(){this.editorWorldSettings&&this.editorWorldSettings.name===void 0&&(this.editorWorldSettings.name="editor project "+B.getDateStr(new Date))}getCustomTool(e){for(this.#e.customTools===void 0&&(this.#e.customTools=[]);this.#e.customTools.length<=e;)this.#e.customTools.push({name:"",type:0,text:void 0,lastRunResult:void 0});return this.#e.customTools[e]}get defaultFunction(){return this.#e===void 0||this.#e.defaultFunction===void 0?"":this.#e.defaultFunction}set defaultFunction(e){this.#e!==void 0&&(this.#e.defaultFunction=B.makeSafeForJson(e))}async runCommand(e,t){return await wi.main.runCommand({carto:this,project:t,minecraft:this.activeMinecraft,host:Ne.hostManager},e)}async runMinecraftCommand(e){if(this.activeMinecraft===void 0)throw new Error("No minecraft active.");return await this.activeMinecraft.runCommand(e)}async loadPacks(){if(!this.packStorage)throw new Error("Could not find pack storage");if(this._arePacksLoading){let e=this._pendingPackLoadRequests,t=(i,n)=>{e.push(i)};await new Promise(t)}else{this._arePacksLoading=!0,this.packs=[],await this.loadPacksFromFolder(this.packStorage.rootFolder),this._arePacksLoading=!1;let e=this._pendingPackLoadRequests;this._pendingPackLoadRequests=[];for(let t of e)t(void 0)}}ensureAllTypesCollapsedExcept(e){let t=[];for(let i=0;i<Gn;i++)i!==e&&t.push(i);this.collapsedTypes=t}ensureTypeIsCollapsed(e){for(let t of this.collapsedTypes)if(t===e)return;this.collapsedTypes.push(e)}ensureTypeIsNotCollapsed(e){let t=[];for(let i of this.collapsedTypes)i!==e&&t.push(i);this.#e.collapsedTypes=t}async loadPacksFromFolder(e){await e.load();for(let t in e.files){let i=e.files[t];i&&S.isContainerFile(i.storageRelativePath)&&await this.ensurePackForFile(i)}}getPackByName(e,t){if(!this.packs){C.unexpectedUndefined("GPN");return}for(let i=0;i<this.packs.length;i++)if(this.packs[i].matches(e,t))return this.packs[i]}getPackageByNameAndHash(e,t){if(!this.packs){C.unexpectedUndefined("GPNH");return}for(let i=0;i<this.packs.length;i++)if(this.packs[i].matches(e,!1)&&(t===void 0||t===this.packs[i].data?.sourceHash))return this.packs[i];return this.getPackByName(e)}async ensurePackForFile(e){let t=this._ensurePack(e.storageRelativePath);return await t.ensureData(this,e),t}_ensurePack(e){this.packs===void 0&&(this.packs=[]);for(let i=0;i<this.packs.length;i++)if(this.packs[i].storagePath===e)return this.packs[i];let t=new ac(S.getLeafName(e),e);return this.packs.push(t),t}_handleMessageFromAppService(e,t){switch(e){case"externalKeyPress":if(t.startsWith("command")){let s=parseInt(t.substring(7,t.length));oc.runCustomTool(this,s)}break;case"statusMessage":let i=t.indexOf("|"),n=t.substring(i+1,t.length);try{let s=JSON.parse(n);this.notifyExternalStatus(s)}catch{}break;case"mctSavedInAppService":this.load(!0);break;case"logFileUpdated":try{if(t){let s=t.indexOf("|");if(s>0){let o=t.substring(0,s),a=t.substring(s+1,t.length);this._handleLogFileUpdated(o,a)}}}catch(s){C.fail("Error parsing inbound log: "+s)}break;default:this.deploymentStorageMinecraft&&this.deploymentStorageMinecraft.processExternalMessage(e,t),this.processHostedMinecraft&&this.processHostedMinecraft.processExternalMessage(e,t),this.gameMinecraft&&this.gameMinecraft.processExternalMessage(e,t),this.remoteMinecraft&&this.remoteMinecraft.processExternalMessage(e,t);break}}_handleLogFileUpdated(e,t){if(t==null||e===null||e===void 0)return;let i=this.mcLogs[e];i===void 0&&(i=[],this.mcLogs[e]=i);let n=t.split("\r");for(let s=n.length-1;s>=0;s--){let o=n[s];o!==void 0&&o.length>3&&(i.includes(o)||(i.push(o),this.notifyStatusUpdate(o)))}}async notifyStatusUpdate(e,t){if(e.trim().toLowerCase().length>1){let n={time:new Date,message:e,topic:t,type:0};this.status.push(n),await this.callStatusAddedListeners(n),this.ensureStatusArrayIsTrimmed()}}ensureStatusArrayIsTrimmed(){if(this.status.length>1e4){let e=[];for(let t=this.status.length-9e3;t<this.status.length;t++)e.push(this.status[t]);this.status=e}}async callStatusAddedListeners(e){if(this._onStatusAdded.dispatch(this,e),this._onStatusAddedAsync.length>0){let t=[];for(let i=0;i<this._onStatusAddedAsync.length;i++)t.push(this._onStatusAddedAsync[i](this,e));await Promise.all(t)}}notifyExternalStatus(e){return this.status.push(e),e.type===1?this.activeOperations.push(e):(e.type===2||e.type===3)&&e.operationId!==null&&e.operationId!==void 0&&this.removeOperation(e.operationId),this.callStatusAddedListeners(e),e.operationId}async notifyOperationStarted(e,t){let i={time:new Date,message:e,type:1,topic:t};return i.operationId=i.time.getTime(),this.status.push(i),this.activeOperations.push(i),this.ensureStatusArrayIsTrimmed(),await this.callStatusAddedListeners(i),i.operationId}async notifyOperationEnded(e,t,i,n){if(this.ensureStatusArrayIsTrimmed(),this.removeOperation(e),this._onOperationCompleted.dispatch(this,e),!t)return;let s={message:t,operationId:e,type:n?3:2,time:new Date,topic:i};this.status.push(s),await this.callStatusAddedListeners(s)}removeOperation(e){let t=[];for(let i=0;i<this.activeOperations.length;i++){let n=this.activeOperations[i];n.operationId!==e&&t.push(n)}this.activeOperations=t}async save(){let e=this.file;e.setContent(JSON.stringify(this.#e,null,2)),await e.saveContent(),Ci.hasAppService&&Ci.sendAsync("reloadMct","")}async loadGallery(){let e=null;if(typeof window<"u"){let t=this.contentRoot+"data/gallery.json";try{e=await zt.get(t),e&&(this._gallery=e.data)}catch(i){C.fail("Could not load gallery: "+i+" from '"+t+"'")}}else if(this.local){try{e=await this.local.readJsonFile("data/gallery.json")}catch(t){C.fail("Could not load local file: "+t+" from 'data/gallery.json'")}e!==null&&(this._gallery=e)}if(this._gallery){for(let t of this._gallery.items)if(t.sampleSet&&(t.gitHubOwner="microsoft",t.gitHubRepoName="minecraft-scripting-samples",t.type===5?(t.gitHubFolder="/editor-script-box",t.tags||(t.tags=["editor"])):t.gitHubFolder="/script-box"),t.fileList){let i=[];for(let n of t.fileList)i.push(Be.replaceMinecraftPathTokens(n));t.fileList=i}}return this._galleryLoaded=!0,this._onGalleryLoaded.dispatch(this,this._gallery),this._gallery}async getGalleryProjectByGitHub(e,t,i,n,s){if(this._galleryLoaded||await this.loadGallery(),!(this._galleryLoaded===!1||this._gallery===void 0||this._gallery.items===void 0)){e=e.toLowerCase(),t=t.toLowerCase();for(let o of this._gallery.items)if(o.gitHubRepoName.toLowerCase()===e&&o.gitHubOwner.toLowerCase()===t&&i===o.gitHubBranch&&n===o.gitHubFolder&&(!s||o.fileList))return o}}async getGalleryProjectById(e){if(this._galleryLoaded||await this.loadGallery(),!(this._galleryLoaded===!1||this._gallery===void 0||this._gallery.items===void 0)){e=e.toLowerCase(),e=e.replace(/-/gi,"");for(let t of this._gallery.items)if(t.id.toLowerCase()===e)return t}}async getNewProjectName(e){await this.load();let t=e,i=0;for(;this.prefsProjectsFolder.fileExists(t+".json")||this.projectsStorage.rootFolder.folderExists(t);)i++,t=e+" "+i;return t}async createNewProject(e,t,i,n,s){await this.load();let o=await this.getNewProjectName(e),a=await this.prefsProjectsFolder.createFile(o+".json"),l=new sr(this,o,a);return t&&(l.mainDeployFolderPath=t),s&&(l.preferredScriptLanguage=s),await l.ensureProjectFolder(),l.focus=i,n&&await l.ensureDefaultItems(),this.projects.push(l),l}async createNewProjectFromFolder(e){await this.load();let t=S.getLeafName(e),i=0;for(;this.prefsProjectsFolder.fileExists(t+".json")||this.projectsStorage.rootFolder.folderExists(t);)i++,t=S.getLeafName(e)+" "+i;let n=await this.prefsProjectsFolder.createFile(t+".json"),s=new sr(this,t,n);return s.mainDeployFolderPath=e,await s.ensureProjectFolder(),await s.ensureInflated(),await s.inferProjectItemsFromFiles(),this.projects.push(s),s}async deleteProjectByName(e){let t;for(let i=0;i<this.projects.length;i++){let n=this.projects[i];if(n.name===e){if(t!==void 0){C.fail("Encountered multiple projects with the same name.");return}t=n}}t&&(await t.deleteThisProject(),this.removeProject(t),t.dispose())}removeProject(e){let t=[];for(let i=0;i<this.projects.length;i++){let n=this.projects[i];n!==e&&t.push(n)}this.projects=t}getProjectByName(e){for(let t=0;t<this.projects.length;t++){let i=this.projects[t];if(i.name===e)return i}}getProjectByMainLocalFolderPath(e){e=S.canonicalizePath(e);for(let t=0;t<this.projects.length;t++){let i=this.projects[t];if(i.mainDeployFolderPath&&S.canonicalizePath(i.mainDeployFolderPath)===e)return i}}async ensureProjectFromLocalStoragePath(e){if(!this.local){C.fail("Could not find local utilities.");return}await this.load();let t=S.canonicalizePathAsFileName(e),i=this.getProjectByName(t),n=S.canonicalizePath(e);if(i!==void 0&&(await i.ensureLoadedFromFile(),i.mainDeployFolderPath!==void 0&&n===S.canonicalizePath(i.mainDeployFolderPath)))return await i.ensureInflated(),await i.inferProjectItemsFromFiles(),i;let s=0;for(;this.prefsProjectsFolder.fileExists(t+".json")||this.projectsStorage.rootFolder.folderExists(t);)s++,t=S.canonicalizePathAsFileName(e)+" "+s;let o=await this.prefsProjectsFolder.createFile(t+".json"),a=new sr(this,t,o);a.mainDeployFolderPath=e,a.originalFullPath=e;let l=await this.local.createStorage(e);if(l===null){C.fail("Could not create local storage.");return}return a.setProjectFolder(l.rootFolder),await a.ensureProjectFolder(),await mr.calculate(a),await a.inferProjectItemsFromFiles(),this.projects.push(a),a}async ensureProjectForFolder(e,t,i){await this.load();let n="";t!==void 0?n=t:n=S.getLeafName(e);let s=S.canonicalizePath(e),o=this.getProjectByMainLocalFolderPath(e);if(o||(o=this.getProjectByName(n)),o!==void 0&&!i){if(await o.ensureLoadedFromFile(),o.mainDeployFolderPath!==void 0&&s===S.canonicalizePath(o.mainDeployFolderPath))return await o.ensureInflated(),await o.inferProjectItemsFromFiles(),o}else if(o&&i)for(let c=1;c<99&&(n=S.getLeafName(e)+" "+c,s=S.canonicalizePath(e)+" "+c,t!==void 0&&(n=t),!!this.getProjectByName(n));c++);for(let c=0;c<this.projects.length;c++)if(o=this.projects[c],await o.ensureLoadedFromFile(),o.mainDeployFolderPath!==void 0&&s===S.canonicalizePath(o.mainDeployFolderPath))return await o.ensureInflated(),await o.inferProjectItemsFromFiles(),o;let a=0;for(;this.prefsProjectsFolder.fileExists(n+".json")||this.projectsStorage.rootFolder.folderExists(n);)a++,n=S.getLeafName(e)+" "+a;let l=await this.prefsProjectsFolder.createFile(n+".json"),u=new sr(this,n,l);return u.mainDeployFolderPath=e,u.originalFullPath=e,await u.ensureProjectFolder(),await u.inferProjectItemsFromFiles(),this.projects.push(u),u}async getExportZip(){let e=new yt,t=e.rootFolder;await this.load();for(let i=0;i<this.projects.length;i++){let n=this.projects[i];if(await n.ensureLoadedFromFile(),await n.ensureProjectFolder(),n.projectFolder){let s=t.ensureFolder(n.name);await S.syncFolderTo(n.projectFolder,s,!0,!0,!1)}}return await t.saveAll(),e}async load(e){if(this._isLoaded&&!e)return;let t=this.file;await t.loadContent(!1),t.content!==null&&t.content!==void 0&&typeof t.content=="string"&&(this.#e=JSON.parse(t.content));let i=this.prefsProjectsFolder;await i.load(),await this.projectsStorage.rootFolder.load(),this.projects=[];for(let n in i.files){let s=S.getBaseFromName(n),o=i.files[n];if(o!==void 0){let a=new sr(this,s,o);this.projects.push(a)}}this.considerStartingMinecraft(),this.initializeWorldSettings(),this.ensureDefaultWorldName(),this._onLoaded.dispatch(this,this),this._isLoaded=!0}async considerStartingMinecraft(){(Ne.hostType===8||Ne.hostType===0)&&(this.successfullyConnectedWebSocketToMinecraft&&(this.autoStartMinecraft||this.lastActiveMinecraftFlavor===1)&&(this.ensureRemoteMinecraft(),this.remoteMinecraft&&Ne.hostType===0&&Ne.carto&&Ne.carto.remoteServerUrl&&Ne.carto.remoteServerUrl.length>4&&(this.remoteMinecraft.initialize(),!this.activeMinecraft&&this.lastActiveMinecraftFlavor===1&&(this.activeMinecraft=this.remoteMinecraft,this.lastActiveMinecraftFlavor=1)),Ne.isAppServiceWeb&&(this.ensureGameMinecraft(),this.gameMinecraft&&this.gameMinecraft.initialize(),!this.activeMinecraft&&this.lastActiveMinecraftFlavor===3&&(this.activeMinecraft=this.gameMinecraft,this.lastActiveMinecraftFlavor=3))),this.successfullyStartedMinecraftServer&&this.lastActiveMinecraftFlavor===2&&this.autoStartMinecraft&&await this.connectToMinecraft())}async connectToMinecraft(){if(this.lastActiveMinecraftFlavor&&(this.ensureMinecraft(this.lastActiveMinecraftFlavor),this.activeMinecraft)){let e=await this.activeMinecraft.updateStatus();(e===11||e===9||e===0||e===8||e===7||e===10)&&await this.activeMinecraft.initialize()}}canPrepareAndStartMinecraft(){return!(!this.activeMinecraft||this.activeMinecraftState!==2&&this.activeMinecraftState!==3&&this.activeMinecraftState!==4&&this.activeMinecraftState!==5&&this.activeMinecraftState!==6)}async prepareAndStartToMinecraft(e){!this.canPrepareAndStartMinecraft||!this.activeMinecraft||await this.activeMinecraft.prepareAndStart(e)}_bubbleMinecraftRefreshed(e,t){e===this.activeMinecraft&&this._onMinecraftRefreshed.dispatch(e,t)}_bubbleMinecraftStateChanged(e,t){e===this.activeMinecraft&&(!this.successfullyConnectedWebSocketToMinecraft&&t===2&&(this.successfullyConnectedWebSocketToMinecraft=!0,this.save()),t===4?C.message("Minecraft is ready."):t===6||t===7&&C.message("Disconnecting from Minecraft."),this._onMinecraftStateChanged.dispatch(e,t))}ensureRemoteMinecraft(){return this.remoteMinecraft}ensureProcessHostedMinecraft(){return this.processHostedMinecraft}ensureDeploymentStorageMinecraft(){return this.deploymentStorageMinecraft===void 0&&(this.deploymentStorageMinecraft=new cc(this)),this.deploymentStorageMinecraft}ensureGameMinecraft(){return this.gameMinecraft}ensureMinecraft(e){if(e!==0){if(this.activeMinecraft&&this.lastActiveMinecraftFlavor===e)return this.activeMinecraft;if(this.ensureRemoteMinecraft(),e===2?this.ensureProcessHostedMinecraft():e===4?this.ensureDeploymentStorageMinecraft():e===3&&this.ensureGameMinecraft(),this.activeMinecraft&&(this.activeMinecraft.onStateChanged.unsubscribe(this._bubbleMinecraftStateChanged),this.activeMinecraft.onRefreshed.unsubscribe(this._bubbleMinecraftRefreshed)),e===1){if(!this.remoteMinecraft){C.throwUnexpectedUndefined("EMR");return}if(this.activeMinecraft=this.remoteMinecraft,this.lastActiveMinecraftFlavor!==1&&(this.lastActiveMinecraftFlavor=1,this.save()),this._onMinecraftStateChanged.dispatch(this.activeMinecraft,10),this.activeMinecraft===void 0){C.unexpectedUndefined("EMA");return}this.activeMinecraft.onStateChanged.subscribe(this._bubbleMinecraftStateChanged),this.activeMinecraft.onRefreshed.subscribe(this._bubbleMinecraftRefreshed)}else if(e===3){if(!this.gameMinecraft){C.throwUnexpectedUndefined("EMG");return}if(this.activeMinecraft=this.gameMinecraft,this.lastActiveMinecraftFlavor!==3&&(this.lastActiveMinecraftFlavor=3,this.save()),this._onMinecraftStateChanged.dispatch(this.activeMinecraft,10),this.activeMinecraft===void 0){C.unexpectedUndefined("EMB");return}this.activeMinecraft.onStateChanged.subscribe(this._bubbleMinecraftStateChanged),this.activeMinecraft.onRefreshed.subscribe(this._bubbleMinecraftRefreshed)}else if(e===2){if(!this.processHostedMinecraft){C.throwUnexpectedUndefined("EMC");return}if(this.activeMinecraft=this.processHostedMinecraft,this.lastActiveMinecraftFlavor!==2&&(this.lastActiveMinecraftFlavor=2,this.save()),this._onMinecraftStateChanged.dispatch(this.activeMinecraft,10),this.activeMinecraft===void 0){C.unexpectedUndefined("EMD");return}this.activeMinecraft.onStateChanged.subscribe(this._bubbleMinecraftStateChanged),this.activeMinecraft.onRefreshed.subscribe(this._bubbleMinecraftRefreshed)}else if(e===4){if(!this.deploymentStorageMinecraft){C.throwUnexpectedUndefined("EMCD");return}if(this.activeMinecraft=this.deploymentStorageMinecraft,this.lastActiveMinecraftFlavor!==4&&(this.lastActiveMinecraftFlavor=4,this.save()),this._onMinecraftStateChanged.dispatch(this.activeMinecraft,10),this.activeMinecraft===void 0){C.unexpectedUndefined("EMDD");return}this.activeMinecraft.onStateChanged.subscribe(this._bubbleMinecraftStateChanged),this.activeMinecraft.onRefreshed.subscribe(this._bubbleMinecraftRefreshed)}else if(this.createMinecraft===void 0||this.canCreateMinecraft===void 0||!this.canCreateMinecraft(e))C.debugAlert("Requested creation of an unavailable Minecraft."),e=0;else{let t=this.createMinecraft(e,this);t?(this.activeMinecraft=t,this.lastActiveMinecraftFlavor=e,this._onMinecraftStateChanged.dispatch(this.activeMinecraft,10),this.activeMinecraft.onStateChanged.subscribe(this._bubbleMinecraftStateChanged),this.activeMinecraft.onRefreshed.subscribe(this._bubbleMinecraftRefreshed)):(C.debugAlert("Could not create a requested Minecraft."),e=0)}return this.lastActiveMinecraftFlavor=e,this.save(),this.activeMinecraft}}};var aa=Le(Sf());var fc=class extends Cr{get name(){return this._name}get parentFolder(){return this._parentFolder}get fullPath(){return this._parentFolder.fullPath+bi.slashFolderDelimiter+this.name}get size(){return this.content==null?-1:this.content.length}constructor(e,t){super(),this.sizeAtLoad=void 0,this._parentFolder=e,this._name=t}get isContentLoaded(){return this.lastLoadedOrSaved!=null||this.modified!=null}async deleteThisFile(e){if(this.parentFolder.storage.readOnly)throw new Error("Can't save read-only file.");return e!==!0&&(this._parentFolder._removeFile(this),await this._parentFolder.save(!1)),await aa.default.removeItem(this.fullPath),!0}async moveTo(e){let t=S.getFolderPath(e),i=S.getLeafName(e);if(i.length<2)throw new Error("New path is not correct.");let n=await this._parentFolder.storage.ensureFolderFromStorageRelativePath(t);if(n.files[i]!==void 0)throw new Error("File exists at specified path.");await this.loadContent();let s=this.fullPath;return this._name=i,this._parentFolder=n,this.modified=new Date,n._addExistingFile(this),await aa.default.removeItem(s),!0}async loadContent(e){return(e||!this.lastLoadedOrSaved)&&(this._lastLoadedPath=this.fullPath,this._content=await aa.default.getItem(this.fullPath),this.lastLoadedOrSaved=new Date),this.lastLoadedOrSaved}async resaveAfterMove(){if(this._lastLoadedPath!==void 0&&this._lastLoadedPath!==this.fullPath){let e=this._lastLoadedPath;await this.saveContent(!0,!0),await aa.default.removeItem(e)}}setContent(e){S.contentsAreEqual(this._content,e)||(this.lastLoadedOrSaved||(this.lastLoadedOrSaved=new Date,this.lastLoadedOrSaved=new Date(this.lastLoadedOrSaved.getTime()-1)),this._content=e,this.contentWasModified())}async saveContent(e,t){if(this.parentFolder.storage.readOnly)throw new Error("Can't save read-only file.");return(this.needsSave||e)&&(C.assert(this.content!==null,"Null content found."),this._lastLoadedPath=this.fullPath,await aa.default.setItem(this.fullPath,this.content),this.lastLoadedOrSaved=new Date,t!==!0&&await this._parentFolder.save(!1)),this.lastLoadedOrSaved===null&&(this.lastLoadedOrSaved=new Date),this.lastLoadedOrSaved}};var la=Le(Sf());var hc=class r extends Sr{get storage(){return this._storage}get parentFolder(){return this._parentFolder}get name(){return this._name}get fullPath(){return this._parentPath+bi.slashFolderDelimiter+S.canonicalizeName(this.name)}constructor(e,t,i,n){super(),this._storage=e,this._parentFolder=t,this._parentPath=i,this._name=n,this._lastSavedContent="",this.lastSavedFileCount=0,this.folders={},this.files={}}ensureFile(e){let t=S.canonicalizeName(e),i=this.files[t];return i==null&&(i=new fc(this,e),this.files[t]=i,this.storage.notifyFileAdded(i)),i}async exists(){return!0}async ensureExists(){return!0}async deleteThisFolder(){if(this.storage.readOnly)throw new Error("Can't save read-only file.");let e=await this.recursiveDeleteThisFolder();return await la.default.removeItem(this.fullPath+bi.slashFolderDelimiter),e}async deleteAllFolderContents(){throw new Error("Deletion of all folder contents at "+this.fullPath+" is not supported.")}ensureFolder(e){let t=S.canonicalizeName(e),i=this.folders[t];return i||(i=new r(this._storage,this,this.fullPath,e),this.folders[t]=i),i}_removeFile(e){let t=S.canonicalizeName(e.name),i=this.files[t];C.assert(i===e,"Files don't match."),this.files[t]=void 0,this.storage.notifyFileRemoved(this.storageRelativePath+e.name)}_addExistingFile(e){let t=S.canonicalizeName(e.name);this.files[t]=e}async moveTo(e,t){let i=S.getFolderPath(e),n=S.getLeafName(e);if(n.length<2)throw new Error("New path is not correct.");if(this.isSameFolder(e))return!1;await this.load();let s=this._lastLoadedPath;if(this._parentFolder!==null){let o=await this._parentFolder.storage.ensureFolderFromStorageRelativePath(i);if(o.folders[n]!==void 0)throw new Error("Folder exists at specified path.");this._parentFolder._clearExistingFolder(this),this._parentFolder=o,this._name=n,o._addExistingFolder(this)}this._name=n;for(let o in this.files){let a=this.files[o];a&&await a.resaveAfterMove()}for(let o in this.folders){let a=this.folders[o];a&&await a.resaveAfterMove(this.fullPath)}return await this.save(!0),s&&await la.default.removeItem(s),this._parentFolder!==null&&!t&&await this._parentFolder.save(!0),t||this.notifyFolderMoved({previousStoragePath:s,newStoragePath:this.fullPath,folder:this}),!0}async createFile(e){let t=this.ensureFile(e);return this.storage.notifyFileAdded(t),t}async load(e){if(this.lastLoadedOrSaved!=null&&!e)return this.lastLoadedOrSaved;this._lastLoadedPath=this.fullPath+bi.slashFolderDelimiter;let t=await la.default.getItem(this.fullPath+bi.slashFolderDelimiter);if(t!=null){this._lastSavedContent=t;let s;try{s=JSON.parse(t)}catch(o){C.debugAlert("Failure to parse browser folder content JSON:"+o.toString())}if(s){for(var i=0;i<s.files.length;i++){let o=s.files[i];o.modified!=null&&!(o.modified instanceof Date)&&(o.modified=new Date(o.modified));let a=this.ensureFile(o.name);a.modifiedAtLoad=o.modified==null?null:o.modified,a.sizeAtLoad===void 0&&(a.sizeAtLoad=o.size)}for(var n=0;n<s.folders.length;n++){let o=s.folders[n];o.modified!=null&&!(o.modified instanceof Date)&&(o.modified=new Date(o.modified));let a=this.ensureFolder(o.name);a.modifiedAtLoad=o.modified,a.lastSavedFileCount=o.fileCount}}}return this.updateLastLoadedOrSaved(),this.lastLoadedOrSaved}async resaveAfterMove(e){this._parentPath=e;for(let t in this.files){let i=this.files[t];i&&await i.resaveAfterMove()}for(let t in this.folders){let i=this.folders[t];i&&await i.resaveAfterMove(this.fullPath)}if(this._lastLoadedPath!==void 0&&this._lastLoadedPath!==S.ensureEndsWithDelimiter(this.fullPath)){let t=this._lastLoadedPath;await this.save(!0),await la.default.removeItem(t)}}async save(e){this.isLoaded||await this.load(!1),this.updateLastLoadedOrSaved();let t={updated:this.lastLoadedOrSaved,files:[],folders:[]};for(let n in this.files){let s=this.files[n];if(s!==void 0){let o={name:s.name,size:s.size,modified:s.latestModified==null?new Date:s.latestModified};t.files.push(o)}}for(let n in this.folders){let s=this.folders[n];if(s!==void 0&&!s.errorStatus){let o={name:s.name,fileCount:B.lengthOfDictionary(s.files),modified:s.modifiedAtLoad==null?new Date:s.modifiedAtLoad};t.folders.push(o)}}let i=JSON.stringify(t);return(this._lastSavedContent!==i||e)&&(this._lastSavedContent=i,this._lastLoadedPath=this.fullPath+bi.slashFolderDelimiter,await la.default.setItem(this.fullPath+bi.slashFolderDelimiter,i)),this.lastLoadedOrSaved}async saveAll(e){this.isDisposed&&C.throwIsDisposed();let t=new Date().getTime(),i=!1;for(let n in this.files){let s=this.files[n];s!==void 0&&(s.needsSave||e)&&(await s.saveContent(e,!0)).getTime()>t&&(i=!0)}for(let n in this.folders){let s=this.folders[n];s!==void 0&&!s.errorStatus&&(i=!0,await s.saveAll(e))}return(i||this._lastSavedContent===void 0||e===!0)&&await this.save(e),!0}};var AC=Le(Sf()),bi=class r extends Ni{static{this.isConfigured=!1}static ensureConfigured(){r.isConfigured||(AC.default.config({name:"Minecraft Creator Tools",storeName:"minecraft_creator_tools",version:1}),r.isConfigured=!0)}constructor(e){super(),e==null?e="":e="."+e,r.ensureConfigured(),this.rootFolder=new hc(this,null,"fs"+e,"root")}};var Lg=Le(Je());var pc=class r{static async debugProjectInformation(e,t,i){if(!e.project)return{status:1};let n="N: "+e.project.name;return e.project.projectFolder&&(n+=" PF: "+e.project.projectFolder.fullPath),C.message(n),{status:100}}static async debugMinecraft(e,t,i){let n="LAM: "+e.carto.lastActiveMinecraftFlavor;return e.carto.remoteServerUrl&&(n+=" RSURL: "+e.carto.remoteServerUrl),e.carto.remoteServerPort&&(n+=" RSP: "+e.carto.remoteServerPort),e.carto.dedicatedServerMode&&(n+=" DSM: "+e.carto.dedicatedServerMode),e.carto.dedicatedServerPath&&(n+=" DSP: "+e.carto.dedicatedServerPath),e.carto.dedicatedServerSlotCount&&(n+=" DSS: "+e.carto.dedicatedServerSlotCount),C.message(n),{status:100}}static async startMinecraft(e,t,i){if(!e.minecraft&&!e.carto.lastActiveMinecraftFlavor)return{status:2};let n=e.minecraft;return!n&&e.carto.lastActiveMinecraftFlavor&&(n=e.carto.ensureMinecraft(e.carto.lastActiveMinecraftFlavor)),n?(C.message("Starting server."),await n.prepareAndStart({project:e.project}),{status:100}):{status:2}}static async stopMinecraft(e,t,i){return e.minecraft?(C.message("Stopping server."),await e.minecraft.stop(),{status:100}):{status:2}}static async updateMinecraft(e,t,i){return e.minecraft&&e.minecraft.prepare(!0),{status:100}}static registerCommonCommands(){wi.main.registerCommand("dbgproj",10,r.debugProjectInformation),wi.main.registerCommand("dbgmc",10,r.debugMinecraft),wi.main.registerCommand("startmc",1,r.startMinecraft),wi.main.registerCommand("stopmc",3,r.stopMinecraft),wi.main.registerCommand("updatemc",3,r.updateMinecraft)}};var Ne=class r{static{this._onInitialized=new Lg.EventDispatcher}static{this._initializing=!1}static{this._initialized=!1}static{this.isLocalNode=!1}static{this.hostType=0}static{this.hostManager=void 0}static{this.theme=0}static{this.contentRoot=""}static{this.projectPath=""}static{this.baseUrl=""}static{this.initialMode=null}static{this.modeParameter=null}static{this.prefsStorage=null}static{this.projectsStorage=null}static{this.deploymentStorage=null}static{this.previewDeploymentStorage=null}static{this.worldStorage=null}static{this.packStorage=null}static{this.workingStorage=null}static{this._onMessage=new Lg.EventDispatcher}static get isNodeJs(){return!1}static get isVsCode(){return!1}static get isWeb(){return this.hostType===8||this.hostType===0||this.hostType===3}static get isAppServiceWeb(){return this.hostType===3||this.hostType===5}static get onMessage(){return r._onMessage.asEvent()}static get onInitialized(){return r._onInitialized.asEvent()}static get carto(){return r._carto}static notifyNewMessage(e,t){r._onMessage.dispatch(e,t)}static setHostType(e){this.hostType=e}static init(){if(!(r._initializing||r._initialized)){if(r._initializing=!0,typeof g_contentRoot<"u"&&(r.contentRoot=S.ensureEndsWithDelimiter(g_contentRoot)),typeof g_initialMode<"u"&&(r.initialMode=g_initialMode),typeof g_modeParameter<"u"&&(r.modeParameter=g_modeParameter),typeof g_projectPath<"u"&&(r.projectPath=g_projectPath),typeof g_baseUrl<"u"&&(r.baseUrl=g_baseUrl),Ci.init(),fs.init(),oe.load(),pc.registerCommonCommands(),r.generateCryptoRandomNumber=e=>{if(!r.carto||!r.carto.local)throw new Error("Could not generate key.");return r.carto.local.generateCryptoRandomNumber(e)},r.projectsStorage!==null&&r.prefsStorage!==null||typeof window<"u"&&(r.prefsStorage=new bi("mctprefs"),r.projectsStorage=new bi("mctprojects"),r.deploymentStorage=new bi("mctdeploy"),r.workingStorage=new bi("mctworking"),r.worldStorage=new bi("mctworlds"),r.packStorage=new bi("mctpacks"),r.generateCryptoRandomNumber=e=>window.crypto.getRandomValues(new Uint32Array(1))[0]%16),r.prefsStorage===null||r.projectsStorage===null)throw new Error("Unexpected uninitialized storage.");r._carto=new dc(r.prefsStorage,r.projectsStorage,r.deploymentStorage,r.previewDeploymentStorage,r.worldStorage,r.packStorage,r.workingStorage,r.contentRoot),r.ensureLocalFolder&&(r._carto.ensureLocalFolder=r.ensureLocalFolder,r._carto.localFolderExists=r.localFolderExists,r._carto.localFileExists=r.localFileExists),r._carto.createMinecraft=r.createMinecraft,r._carto.canCreateMinecraft=r.canCreateMinecraft,r._initialized=!0,this._onInitialized.dispatch(r._carto,r._carto)}}};var RC=Le(Je());var mc=class{constructor(e,t,i,n){this.level=t,this.message=e,this.created=new Date,this.context=i,this.category=n,this.level===10&&(this.operId=C.items.length)}},C=class r{static{this._suppressedLogs={}}static{this._log=[]}static{this._onItemAdded=new RC.EventDispatcher}static get items(){return r._log}static get onItemAdded(){return this._onItemAdded.asEvent()}static message(e,t,i){this.log(e,2,t,i)}static important(e,t,i){this.log(e,4,t,i)}static verbose(e,t,i){this.log(e,1,t,i)}static error(e,t,i){this.log(e,3,t,i)}static unexpectedUndefined(e){r.fail("Unexpected undefined condition found."+(e?" ("+e+")":""))}static unexpectedIsDisposed(e){r.fail("Unexpected usage of a disposed object."+(e?" ("+e+")":""))}static throwIsDisposed(e){throw this.unexpectedIsDisposed(e),new Error("Unexpected usage of a disposed object."+(e?" ("+e+")":""))}static throwUnexpectedUndefined(e){throw this.unexpectedUndefined(e),new Error("Unexpected undefined condition found."+(e?" ("+e+")":""))}static unexpectedNull(e){r.fail("Unexpected null condition found."+(e?" ("+e+")":""))}static unexpectedContentState(e){r.fail("Unexpected state of content."+(e?" ("+e+")":""))}static unexpectedState(e){r.fail("Unexpected state of internal variables."+(e?" ("+e+")":""))}static unexpectedArguments(e){r.fail("Unexpected arguments found."+(e?" ("+e+")":""))}static log(e,t,i,n){let s=new mc(e,t,i,n);return this._log.push(s),r._onItemAdded.dispatch(this,s),s.operId}static debug(e,t){this.log(e,0,t)}static assertIsInt(e,t){e!==Math.round(e)&&r.debugAlert("Unexpectedly found number "+e+" is not an integer. "+(t||""))}static assert(e,t,i){e||(t?r.debugAlert("Assertion failed: "+t,i):r.debugAlert("Assertion failed.",i))}static assertDefined(e,t){if(!e){r.unexpectedUndefined("LAD."+(t||""));debugger}return e!=null}static fail(e,t){r.debugAlert("Failure case: "+e,t)}static unexpectedError(e,t){throw B.isDebug&&r.debugAlert(e,t),new Error(e)}static debugAlert(e,t){if(r._suppressedLogs.all===!0||(r.debug(e,t),!B.isDebug))return;let i="",n="",s=new Error;s.stack!==void 0&&(i=s.stack);let o=i.lastIndexOf("at Function.");if(o>=0&&(o=i.indexOf("at ",o+1),o>=4)){i=i.substring(o,i.length);let u=i.indexOf(" ",8);u>=0&&(n="=== "+i.substring(7,u)+` ===\r
\r
`)}let a=n+e+`\r
`+i;if(mc.alertFunction){let u=i;u.length>80&&(u=u.substring(0,80)),mc.alertFunction(e+`\r
\r
`+u);return}else if(Ci.hasAppService&&Ne.isWeb){alert(n+e+`\r
\r
`+i);debugger;return}else if(typeof window>"u"){console.log(n+e+`\r
\r
`+i);return}let l=prompt(a,"b to break, s to suppress, a to suppress all");if(l==="s"){r._suppressedLogs[e]=!0;return}else if(l==="b")debugger;else l==="a"&&(r._suppressedLogs.all=!0)}};var Rt=class{constructor(e,t){this.byteLength=0;this.value=0;this.fileBytes=e,this.startIndex=t;let i=0;for(;this.fileBytes[this.startIndex+i]>=128&&this.startIndex+i<e.length;)i++;for(this.byteLength=i+1,this.value=this.fileBytes[this.startIndex+i];i>0;)this.value*=128,this.value+=this.fileBytes[this.startIndex+i-1]-128,i--}};var lo=class{get unsharedKey(){if(this.unsharedKeyBytes===void 0)return;let e=new DataView(this.unsharedKeyBytes.buffer,this.unsharedKeyBytes.byteOffset,this.unsharedKeyBytes.byteLength);return B.getAsciiString(e,0,e.byteLength)}get key(){if(this.keyCached)return this.keyCached;let e=this.previousKey,t="";e!==void 0&&(t=e.key.substring(0,this.sharedByteLength));let i=this.unsharedKey;return i!==void 0&&(t+=i),this.keyCached=t,t}get keyBytes(){if(!this.unsharedKeyBytes)return;if(this.fullBytesCached)return this.fullBytesCached;if(this.sharedByteLength===void 0||this.sharedByteLength===0)return this.unsharedKeyBytes;if(this.previousKey===void 0)throw new Error("Unexpected shared key without a previous");let e=this.previousKey.keyBytes;if(e===void 0)throw new Error("Unexpected shared key without previous bytes");let t=new Uint8Array(this.sharedByteLength+this.unsharedKeyBytes.length),i=this.sharedByteLength;for(let n=0;n<i;n++)t[n]=e[n];for(let n=0;n<this.unsharedKeyBytes.length;n++)t[n+i]=this.unsharedKeyBytes[n];return this.fullBytesCached=t,t}get isRestart(){return this.sharedByteLength===0}loadFromLdb(e,t,i){this.fileBytes=e,this.startIndex=t;let n=0,s=new Rt(this.fileBytes,this.startIndex);this.sharedByteLength=s.value,n+=s.byteLength,this.sharedByteLength>0&&(this.previousKey=i);let o=new Rt(this.fileBytes,this.startIndex+n);n+=o.byteLength;let a=new Rt(this.fileBytes,this.startIndex+n);n+=a.byteLength,this.unsharedKeyBytes=e.subarray(t+n,t+n+o.value-8),n+=o.value,this.value=e.subarray(t+n,t+n+a.value),n+=a.value,this.length=n}};var Dl=class{constructor(e,t,i,n){this.ldbFiles=e,this.logFiles=t,this.manifestFiles=i,this.context=n,this.keys={}}_pushError(e,t){this.isInErrorState=!0,this.errorMessages===void 0&&(this.errorMessages=[]);let i;return t?i=this.context?this.context+"-"+t:t:i=this.context,C.error(e+(i?" "+i:"")),this.errorMessages.push({message:e,context:i}),e}async init(e){this.keys={},this.isInErrorState=!1,this.errorMessages=void 0;for(let s=0;s<this.manifestFiles.length;s++){await this.manifestFiles[s].loadContent(!1);let o=this.manifestFiles[s].content;o instanceof Uint8Array&&o.length>0&&(this.parseManifestContent(o,this.manifestFiles[s].storageRelativePath),e&&await e("Loaded map manifest file '"+this.manifestFiles[s].fullPath+"'."))}let t=[];for(let s=0;s<this.ldbFiles.length;s++){let o=this.ldbFiles[s];try{let a=parseInt(o.name);if(!this.deletedFileNumber||!this.deletedFileNumber.includes(a)){let l=0;if(this.newFileLevel&&this.newFileNumber&&(C.assert(this.newFileLevel.length===this.newFileNumber.length),this.newFileLevel.length===this.newFileNumber.length))for(let u=0;u<this.newFileNumber.length;u++)this.newFileNumber[u]===a&&(l=this.newFileLevel[u]);t.push({index:a,file:o,isDeleted:!1,level:l})}}catch(a){this._pushError("Error including LDB file: "+o.fullPath+" Error: "+a.toString())}}let i=t.sort((s,o)=>s.level===o.level?s.index-o.index:o.level-s.level);for(let s=0;s<i.length;s++){let o=i[s].file;await o.loadContent(!1);let a=o.content;if(a instanceof Uint8Array&&a.length>0){let l=this.parseLdbContent(a,o.storageRelativePath);e&&await e("Loaded map record file '"+o.fullPath+"'. Records: "+l)}}let n=this.logFiles.sort((s,o)=>s.name.localeCompare(o.name));for(let s=0;s<n.length;s++){await n[s].loadContent(!1);let o=n[s].content;if(o instanceof Uint8Array&&o.length>0){let a=this.parseLogContent(o,n[s].storageRelativePath);e&&await e("Loaded map latest-updates file '"+n[s].fullPath+"'. Records: "+a)}}}parseLdbContent(e,t){let i=0;if(e.length<=8||e[e.length-8]!==87||e[e.length-7]!==251||e[e.length-6]!==128||e[e.length-5]!==139||e[e.length-4]!==36||e[e.length-3]!==117||e[e.length-2]!==71||e[e.length-1]!==219){this._pushError("Unexpected bytes in LDB file. File seems unreadable.",t);return}let n=e.length-48,s=new Rt(e,n);n+=s.byteLength;let o=new Rt(e,n);n+=o.byteLength;let a=new Rt(e,n);n+=a.byteLength;let l=new Rt(e,n);if(n+=l.byteLength,a.value<=0||a.value+l.value>=e.length)return this._pushError("LDB content index offset not within bounds.",t),!1;if(s.value<=0||s.value+o.value>=e.length)return this._pushError("LDB meta index offset not within bounds.",t),!1;let u=e.subarray(a.value,a.value+l.value),c;try{c=Ia(u,{raw:!0})}catch{}if(!c)try{c=Ia(u)}catch{}if(c||(c=u,this._pushError("Treating level DB content as compressed.",t)),c){let d={};if(!this.parseIndexBytes(c,0,c.length,d,t))return!1;for(let h in d){let f=d[h];if(f&&f.value){let m=f.value,p=0,g=new Rt(m,p);p+=g.byteLength;let b=new Rt(m,p);if(p+=b.byteLength,g.value<0||g.value+b.value>=e.length){this._pushError("Block offset does not appear correct",t);return}if(p!==m.length){this._pushError("Index byte index is not correct",t);return}let F=e.subarray(g.value,g.value+b.value),w;try{w=Ia(F,{raw:!0})}catch{}if(!w)try{w=Ia(F)}catch{}w||(w=F),i+=this.parseLdbBlockBytes(w,0,w.length,t)}else this._pushError("Could not find index key.",t)}}return i===0&&this._pushError("No keys found in LDB.",t),i}parseIndexBytes(e,t,i,n,s){let o=t,a,u=Lt.getUnsignedInteger(e[i-4],e[i-3],e[i-2],e[i-1],!0)*4+4;for(;o<t+i-u;){let c=new lo;c.loadFromLdb(e,o,a);let d=c.key;if(a=c,n[d]=c,c.length===void 0)return this._pushError("Unexpected parse of level key value "+d,s),!1;o+=c.length}return!0}parseLdbBlockBytes(e,t,i,n){let s=t,o=0,a,u=Lt.getUnsignedInteger(e[i-4],e[i-3],e[i-2],e[i-1],!0)*4+4;if(u>t+i)return this._pushError("Unexpected size received for LDB bytes. File could be corrupt.",n),0;for(;s<t+i-u;){let c=new lo;c.loadFromLdb(e,s,a);let d=c.key;if(a=c,this.keys[d]=c,c.length===void 0||c.length<0)throw new Error(this._pushError("Unexpected parse of key "+d,n));o++,s+=c.length}return o}parseLogContent(e,t){let i=0,n,s=0;for(;i<e.length-6;){let o=Lt.getUnsignedShort(e[i+4],e[i+5],!0),a=e[i+6];if(i+=7,a===1)s+=this.addValueFromLog(e,i,o,t);else if(a===2)n=new Uint8Array(e.buffer,i,o);else if(a===3||a===4)if(n!==void 0){let u=new Uint8Array(e.buffer,i,o),c=new Uint8Array(n.byteLength+u.byteLength);c.set(n),c.set(u,n.byteLength),n=c,a===4&&(s+=this.addValueFromLog(n,0,n.length,t))}else{this._pushError("Unexpected middle to a set of bytes found within LevelDB content. File seems unreadable.",t);return}else{this._pushError("Unexpected type for log file. File seems unreadable.",t);return}i+=o;let l=32768-i%32768;for(;l<=6&&l>0;)l--,e[i]!==0&&this._pushError("Unexpectedly found a padding trailer with data",t),i++}return s<=0&&this._pushError("Did not find any keys in log file",t),s}addValueFromLog(e,t,i,n){let s=t;t+=12;let o=0;for(;t<=s+i-5;){let a=e[t];t++;let l=new Rt(e,t);t+=l.byteLength;let u=new Uint8Array(l.value);for(let c=0;c<l.value;c++)u[c]=e[t+c];if(t+=l.value,t>e.length&&this._pushError("Unexpected log file length issue.",n),t<=e.length){let c=B.getAsciiStringFromUint8Array(u);if(c===void 0&&this._pushError("Unexpected empty key in a log file. File could be unreadable.",n),o++,a){t>=e.length&&this._pushError("Unexpectedly leftover content in a log file. File could be unreadable.",n);let d=new Rt(e,t);if(t+=d.byteLength,d.value+t<=e.buffer.byteLength){let h=new Uint8Array(e.buffer,t,d.value);t+=d.value;let f=new lo;f.sharedKey="",f.keyDelta=c,f.unsharedKeyBytes=u,f.value=h,this.keys[c]=f}}else this.keys[c]=!1}}return o}parseManifestContent(e,t){let i=0,n;for(this.comparator=void 0,this.logNumber=void 0,this.nextFileNumber=void 0,this.lastSequence=void 0,this.compactPointerLevels=void 0,this.compactPointerStrings=void 0,this.deletedFileLevel=void 0,this.deletedFileNumber=void 0,this.newFileLevel=void 0,this.newFileNumber=void 0,this.newFileSize=void 0,this.newFileSmallest=void 0,this.newFileLargest=void 0;i<e.length-6;){let s=Lt.getUnsignedShort(e[i+4],e[i+5],!0),o=e[i+6];if(i+=7,o===1)this.addValueFromManifest(e,i,s);else if(o===2)n=new Uint8Array(e.buffer,i,s);else if(o===3||o===4)if(n!==void 0){let l=new Uint8Array(e.buffer,i,s),u=new Uint8Array(n.byteLength+l.byteLength);u.set(n),u.set(l,n.byteLength),n=u,o===4&&this.addValueFromManifest(n,0,n.length)}else{this._pushError("Unexpected middle to a set of bytes found within a manifest file. File could be unreadable.",t);return}else{this._pushError("Unexpected type for manifest file.  File could be unreadable.",t);return}i+=s;let a=32768-i%32768;for(;a<=6&&a>0;)a--,e[i]!==0&&this._pushError("Unexpectedly found a padding trailer with data in a manifest file.",t),i++}}addValueFromManifest(e,t,i,n){let s=t;for(;t<s+i;){let o=new Rt(e,t);switch(t+=o.byteLength,o.value){case 1:let a=new Rt(e,t);t+=a.byteLength;let l=new Uint8Array(a.value);for(let K=0;K<a.value;K++)l[K]=e[t+K];t+=a.value,t>e.length&&this._pushError("Unexpected manifest file length issue.",n),this.comparator=B.getAsciiStringFromUint8Array(l),this.comparator===void 0&&this._pushError("Unexpected comparator.",n);break;case 2:let u=new Rt(e,t);t+=u.byteLength,this.logNumber=u.value;break;case 3:let c=new Rt(e,t);t+=c.byteLength,this.nextFileNumber=c.value;break;case 4:let d=new Rt(e,t);t+=d.byteLength,this.lastSequence=d.value;break;case 5:this.compactPointerLevels===void 0&&(this.compactPointerLevels=[]),this.compactPointerStrings===void 0&&(this.compactPointerStrings=[]);let h=new Rt(e,t);t+=h.byteLength,this.compactPointerLevels.push(h.value);let f=new Rt(e,t);t+=f.byteLength;let m=new Uint8Array(f.value);for(let K=0;K<f.value;K++)m[K]=e[t+K];t+=f.value,t>e.length&&this._pushError("Unexpected manifest file length issue at compact pointer.",n),this.compactPointerStrings.push(B.getAsciiStringFromUint8Array(m)),this.compactPointerStrings[this.compactPointerStrings.length-1]===void 0&&this._pushError("Unexpected compact pointer string.",n);break;case 6:this.deletedFileLevel===void 0&&(this.deletedFileLevel=[]),this.deletedFileNumber===void 0&&(this.deletedFileNumber=[]);let p=new Rt(e,t);t+=p.byteLength,this.deletedFileLevel.push(p.value);let g=new Rt(e,t);t+=g.byteLength,this.deletedFileNumber.push(g.value);break;case 7:this.newFileLargest===void 0&&(this.newFileLargest=[]),this.newFileLevel===void 0&&(this.newFileLevel=[]),this.newFileNumber===void 0&&(this.newFileNumber=[]),this.newFileSmallest===void 0&&(this.newFileSmallest=[]),this.newFileSize===void 0&&(this.newFileSize=[]);let b=new Rt(e,t);t+=b.byteLength,this.newFileLevel.push(b.value);let F=new Rt(e,t);t+=F.byteLength,this.newFileNumber.push(F.value);let w=new Rt(e,t);t+=w.byteLength,this.newFileSize.push(w.value);let _=new Rt(e,t);t+=_.byteLength;let I=new Uint8Array(_.value);for(let K=0;K<_.value;K++)I[K]=e[t+K];t+=_.value,t>e.length&&this._pushError("Unexpected manifest file length issue at new file smallest.",n),this.newFileSmallest.push(B.getAsciiStringFromUint8Array(I)),this.newFileSmallest[this.newFileSmallest.length-1]===void 0&&this._pushError("Unexpected file smallest tag string.",n);let A=new Rt(e,t);t+=A.byteLength;let T=new Uint8Array(A.value);for(let K=0;K<A.value;K++)T[K]=e[t+K];t+=A.value,t>e.length&&this._pushError("Unexpected manifest file length issue at new file largest.",n),this.newFileLargest.push(B.getAsciiStringFromUint8Array(T)),this.newFileLargest[this.newFileLargest.length-1]===void 0&&this._pushError("Unexpected file largest tag string.",n);break;case 9:let E=new Rt(e,t);t+=E.byteLength,this.previousLogNumber=E.value;break;default:this._pushError("Unexpected manifest item: "+o.value,n)}}}};export{Dl as default};
/*! Bundled license information:

ste-core/dist/index.js:
  (*!
   * Strongly Typed Events for TypeScript - Core
   * https://github.com/KeesCBakker/StronlyTypedEvents/
   * http://keestalkstech.com
   *
   * Copyright Kees C. Bakker / KeesTalksTech
   * Released under the MIT license
   *)

ste-events/dist/index.js:
  (*!
   * Strongly Typed Events for TypeScript - Core
   * https://github.com/KeesCBakker/StronlyTypedEvents/
   * http://keestalkstech.com
   *
   * Copyright Kees C. Bakker / KeesTalksTech
   * Released under the MIT license
   *)

jszip/dist/jszip.min.js:
  (*!
  
  JSZip v3.10.1 - A JavaScript class for generating and reading zip files
  <http://stuartk.com/jszip>
  
  (c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
  Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.
  
  JSZip uses the library pako released under the MIT license :
  https://github.com/nodeca/pako/blob/main/LICENSE
  *)

js-md5/src/md5.js:
  (**
   * [js-md5]{@link https://github.com/emn178/js-md5}
   *
   * @namespace md5
   * @version 0.7.3
   * @author Chen, Yi-Cyuan [emn178@gmail.com]
   * @copyright Chen, Yi-Cyuan 2014-2017
   * @license MIT
   *)

localforage/dist/localforage.js:
  (*!
      localForage -- Offline Storage, Improved
      Version 1.9.0
      https://localforage.github.io/localForage
      (c) 2013-2017 Mozilla, Apache License 2.0
  *)

pako/dist/pako.esm.mjs:
  (*! pako 2.0.4 https://github.com/nodeca/pako @license (MIT AND Zlib) *)

is-plain-object/dist/is-plain-object.mjs:
  (*!
   * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
   *
   * Copyright (c) 2014-2017, Jon Schlinkert.
   * Released under the MIT License.
   *)

is-plain-object/dist/is-plain-object.mjs:
  (*!
   * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
   *
   * Copyright (c) 2014-2017, Jon Schlinkert.
   * Released under the MIT License.
   *)
*/
